{"meta": {"timestamp": "2023-03-22T10:25:35.257971", "version": "5.0.0", "argv": ["tests/data/al-khaser_x64.exe_", "--json"], "sample": {"md5": "3cb21ae76ff3da4b7e02d77ff76e82be", "sha1": "7156270661549f75c253f169fe8988690f6fc700", "sha256": "c2c49f2592f78b7a70fd984dbbb25f7251dd1c851caa884f39ff1c8075f0b228", "path": "tests/data/al-khaser_x64.exe_"}, "analysis": {"format": "pe", "arch": "amd64", "os": "windows", "extractor": "VivisectFeatureExtractor", "rules": ["/home/user/code-personal/capa/rules"], "base_address": {"type": "absolute", "value": 5368709120}, "layout": {"functions": [{"address": {"type": "absolute", "value": 5368811525}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368840006}}]}, {"address": {"type": "absolute", "value": 5368811530}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5369013168}}]}, {"address": {"type": "absolute", "value": 5368811535}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368811540}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5369005200}}, {"address": {"type": "absolute", "value": 5369005266}}]}, {"address": {"type": "absolute", "value": 5368811550}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368811555}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368811560}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368811565}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368959552}}, {"address": {"type": "absolute", "value": 5368959757}}, {"address": {"type": "absolute", "value": 5368960000}}]}, {"address": {"type": "absolute", "value": 5368811570}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368846160}}]}, {"address": {"type": "absolute", "value": 5368811585}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368811590}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368811605}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368811620}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368811625}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368811630}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368811655}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368924448}}]}, {"address": {"type": "absolute", "value": 5368811660}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368890800}}]}, {"address": {"type": "absolute", "value": 5368811670}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368811675}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368931316}}]}, {"address": {"type": "absolute", "value": 5368811680}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368872240}}]}, {"address": {"type": "absolute", "value": 5368811685}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368811690}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5369010288}}]}, {"address": {"type": "absolute", "value": 5368811695}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368940992}}]}, {"address": {"type": "absolute", "value": 5368811705}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368811715}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368951744}}, {"address": {"type": "absolute", "value": 5368951918}}, {"address": {"type": "absolute", "value": 5368952263}}, {"address": {"type": "absolute", "value": 5368952518}}, {"address": {"type": "absolute", "value": 5368952779}}]}, {"address": {"type": "absolute", "value": 5368811720}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368861728}}]}, {"address": {"type": "absolute", "value": 5368811740}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368935773}}]}, {"address": {"type": "absolute", "value": 5368811745}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368811750}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368811755}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368915808}}]}, {"address": {"type": "absolute", "value": 5368811760}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368811765}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368854880}}, {"address": {"type": "absolute", "value": 5368854976}}]}, {"address": {"type": "absolute", "value": 5368811770}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368811775}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368811780}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368811785}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5369013600}}]}, {"address": {"type": "absolute", "value": 5368811790}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368811795}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368811800}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368811805}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368851327}}, {"address": {"type": "absolute", "value": 5368851370}}, {"address": {"type": "absolute", "value": 5368851795}}]}, {"address": {"type": "absolute", "value": 5368811810}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368939152}}]}, {"address": {"type": "absolute", "value": 5368811820}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368917392}}]}, {"address": {"type": "absolute", "value": 5368811825}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5369013504}}]}, {"address": {"type": "absolute", "value": 5368811830}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368811835}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368811850}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368811855}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368811865}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368811870}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368858960}}]}, {"address": {"type": "absolute", "value": 5368811875}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368922416}}]}, {"address": {"type": "absolute", "value": 5368811880}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368811885}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368811890}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368811895}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368811905}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368869472}}]}, {"address": {"type": "absolute", "value": 5368811910}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368811915}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368811920}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368811925}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368984512}}]}, {"address": {"type": "absolute", "value": 5368811930}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368811955}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368811960}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368811965}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368811970}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368811975}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368811980}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368811985}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368811990}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368844166}}]}, {"address": {"type": "absolute", "value": 5368812010}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368893712}}, {"address": {"type": "absolute", "value": 5368893848}}]}, {"address": {"type": "absolute", "value": 5368812015}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368839769}}]}, {"address": {"type": "absolute", "value": 5368812020}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5369019328}}, {"address": {"type": "absolute", "value": 5369019343}}, {"address": {"type": "absolute", "value": 5369019390}}, {"address": {"type": "absolute", "value": 5369019817}}, {"address": {"type": "absolute", "value": 5369019949}}, {"address": {"type": "absolute", "value": 5369020147}}]}, {"address": {"type": "absolute", "value": 5368812030}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368812035}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368852559}}, {"address": {"type": "absolute", "value": 5368852602}}, {"address": {"type": "absolute", "value": 5368852710}}]}, {"address": {"type": "absolute", "value": 5368812040}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368812050}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368812055}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368962880}}]}, {"address": {"type": "absolute", "value": 5368812065}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368812070}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368812075}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368812080}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368812085}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368812095}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368812100}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368855200}}, {"address": {"type": "absolute", "value": 5368855365}}]}, {"address": {"type": "absolute", "value": 5368812105}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368812110}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368925360}}]}, {"address": {"type": "absolute", "value": 5368812115}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368938720}}]}, {"address": {"type": "absolute", "value": 5368812120}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368935952}}]}, {"address": {"type": "absolute", "value": 5368812130}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368812140}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368812145}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368812150}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368863408}}, {"address": {"type": "absolute", "value": 5368863518}}, {"address": {"type": "absolute", "value": 5368863684}}, {"address": {"type": "absolute", "value": 5368863767}}, {"address": {"type": "absolute", "value": 5368863913}}]}, {"address": {"type": "absolute", "value": 5368812155}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368812165}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368812170}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368812175}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368812180}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368859792}}, {"address": {"type": "absolute", "value": 5368860125}}]}, {"address": {"type": "absolute", "value": 5368812185}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368920720}}]}, {"address": {"type": "absolute", "value": 5368812190}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368812195}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5369013857}}]}, {"address": {"type": "absolute", "value": 5368812205}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368812210}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368812220}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5369005424}}]}, {"address": {"type": "absolute", "value": 5368812230}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368999623}}, {"address": {"type": "absolute", "value": 5368999700}}]}, {"address": {"type": "absolute", "value": 5368812235}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368812240}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368812250}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368812255}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368862720}}]}, {"address": {"type": "absolute", "value": 5368812265}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368812270}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368977872}}]}, {"address": {"type": "absolute", "value": 5368812275}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368812285}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368905856}}, {"address": {"type": "absolute", "value": 5368905952}}, {"address": {"type": "absolute", "value": 5368906011}}]}, {"address": {"type": "absolute", "value": 5368812290}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5369004455}}]}, {"address": {"type": "absolute", "value": 5368812295}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368812300}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368812305}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368812310}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368812315}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368812320}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5369017312}}, {"address": {"type": "absolute", "value": 5369017341}}]}, {"address": {"type": "absolute", "value": 5368812325}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368831168}}]}, {"address": {"type": "absolute", "value": 5368812330}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368915696}}]}, {"address": {"type": "absolute", "value": 5368812335}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368812340}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368993792}}, {"address": {"type": "absolute", "value": 5368994097}}]}, {"address": {"type": "absolute", "value": 5368812350}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5369007888}}]}, {"address": {"type": "absolute", "value": 5368812360}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368953552}}, {"address": {"type": "absolute", "value": 5368953892}}, {"address": {"type": "absolute", "value": 5368953985}}, {"address": {"type": "absolute", "value": 5368954205}}, {"address": {"type": "absolute", "value": 5368954290}}]}, {"address": {"type": "absolute", "value": 5368812380}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368812385}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368857936}}]}, {"address": {"type": "absolute", "value": 5368812390}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368812395}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368911264}}, {"address": {"type": "absolute", "value": 5368911394}}, {"address": {"type": "absolute", "value": 5368911647}}]}, {"address": {"type": "absolute", "value": 5368812405}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368812415}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368812425}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368812430}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368844868}}]}, {"address": {"type": "absolute", "value": 5368812445}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368812455}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368992784}}]}, {"address": {"type": "absolute", "value": 5368812465}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5369013777}}]}, {"address": {"type": "absolute", "value": 5368812475}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368812480}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368812485}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368925584}}]}, {"address": {"type": "absolute", "value": 5368812495}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368812500}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368812505}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368812530}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5369000672}}]}, {"address": {"type": "absolute", "value": 5368812550}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368986160}}]}, {"address": {"type": "absolute", "value": 5368812565}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368812575}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368989264}}]}, {"address": {"type": "absolute", "value": 5368812580}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368812585}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368812590}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368945360}}, {"address": {"type": "absolute", "value": 5368945480}}]}, {"address": {"type": "absolute", "value": 5368812600}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368967072}}]}, {"address": {"type": "absolute", "value": 5368812615}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368928480}}]}, {"address": {"type": "absolute", "value": 5368812640}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368855536}}]}, {"address": {"type": "absolute", "value": 5368812645}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368812650}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368812660}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368812665}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368812670}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368925952}}]}, {"address": {"type": "absolute", "value": 5368812675}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368914304}}]}, {"address": {"type": "absolute", "value": 5368812680}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368997776}}]}, {"address": {"type": "absolute", "value": 5368812685}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5369007998}}]}, {"address": {"type": "absolute", "value": 5368812690}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368812695}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368812700}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368865536}}]}, {"address": {"type": "absolute", "value": 5368812710}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368812715}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368968522}}]}, {"address": {"type": "absolute", "value": 5368812725}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368812730}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368812735}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368963792}}]}, {"address": {"type": "absolute", "value": 5368812740}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368812745}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368812750}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368812770}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368812775}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368812780}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368859424}}]}, {"address": {"type": "absolute", "value": 5368812785}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368915584}}]}, {"address": {"type": "absolute", "value": 5368812805}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368812810}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368812830}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368812840}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368812845}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5369002128}}]}, {"address": {"type": "absolute", "value": 5368812855}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368812860}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368812865}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5369013632}}]}, {"address": {"type": "absolute", "value": 5368812870}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368812875}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368852912}}, {"address": {"type": "absolute", "value": 5368853061}}, {"address": {"type": "absolute", "value": 5368853126}}, {"address": {"type": "absolute", "value": 5368853235}}, {"address": {"type": "absolute", "value": 5368853300}}]}, {"address": {"type": "absolute", "value": 5368812880}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368812890}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368812895}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368988624}}, {"address": {"type": "absolute", "value": 5368988760}}]}, {"address": {"type": "absolute", "value": 5368812900}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368812910}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368983248}}, {"address": {"type": "absolute", "value": 5368983445}}]}, {"address": {"type": "absolute", "value": 5368812920}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368812925}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368907312}}]}, {"address": {"type": "absolute", "value": 5368812935}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5369017488}}, {"address": {"type": "absolute", "value": 5369017534}}, {"address": {"type": "absolute", "value": 5369017543}}]}, {"address": {"type": "absolute", "value": 5368812950}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368812955}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368812960}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368812970}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368972656}}]}, {"address": {"type": "absolute", "value": 5368812975}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368812980}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368812985}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368812990}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5369001472}}]}, {"address": {"type": "absolute", "value": 5368812995}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5369013328}}]}, {"address": {"type": "absolute", "value": 5368813005}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368813020}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368813025}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368813030}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368813035}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368978288}}, {"address": {"type": "absolute", "value": 5368978428}}]}, {"address": {"type": "absolute", "value": 5368813040}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368914624}}]}, {"address": {"type": "absolute", "value": 5368813050}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368813055}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368813060}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368813065}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368867136}}]}, {"address": {"type": "absolute", "value": 5368813070}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368813075}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368813080}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368908976}}]}, {"address": {"type": "absolute", "value": 5368813085}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368813095}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368813100}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368813105}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368845952}}]}, {"address": {"type": "absolute", "value": 5368813115}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368813120}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368869616}}]}, {"address": {"type": "absolute", "value": 5368813125}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368813130}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368813135}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368813145}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368813155}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368813170}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5369011040}}, {"address": {"type": "absolute", "value": 5369011098}}]}, {"address": {"type": "absolute", "value": 5368813175}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368959159}}]}, {"address": {"type": "absolute", "value": 5368813180}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368949696}}]}, {"address": {"type": "absolute", "value": 5368813185}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368813190}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368876128}}]}, {"address": {"type": "absolute", "value": 5368813195}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368940096}}]}, {"address": {"type": "absolute", "value": 5368813200}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368946880}}]}, {"address": {"type": "absolute", "value": 5368813205}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368813215}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5369004272}}, {"address": {"type": "absolute", "value": 5369004285}}, {"address": {"type": "absolute", "value": 5369004330}}]}, {"address": {"type": "absolute", "value": 5368813220}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368813225}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368813235}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368813240}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368813245}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368813250}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368813255}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368813260}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5369010208}}]}, {"address": {"type": "absolute", "value": 5368813265}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368813275}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368995360}}, {"address": {"type": "absolute", "value": 5368995656}}]}, {"address": {"type": "absolute", "value": 5368813280}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368858112}}]}, {"address": {"type": "absolute", "value": 5368813285}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5369005387}}]}, {"address": {"type": "absolute", "value": 5368813290}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368813305}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368813310}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368813315}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368996618}}, {"address": {"type": "absolute", "value": 5368996644}}]}, {"address": {"type": "absolute", "value": 5368813335}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368943320}}]}, {"address": {"type": "absolute", "value": 5368813345}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368813350}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368894864}}]}, {"address": {"type": "absolute", "value": 5368813355}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368982784}}]}, {"address": {"type": "absolute", "value": 5368813365}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368813380}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5369013664}}]}, {"address": {"type": "absolute", "value": 5368813390}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368813395}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368941664}}]}, {"address": {"type": "absolute", "value": 5368813400}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368813405}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5369006893}}]}, {"address": {"type": "absolute", "value": 5368813415}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368813420}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368965144}}, {"address": {"type": "absolute", "value": 5368965203}}]}, {"address": {"type": "absolute", "value": 5368813435}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368893968}}, {"address": {"type": "absolute", "value": 5368894104}}]}, {"address": {"type": "absolute", "value": 5368813440}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368840864}}]}, {"address": {"type": "absolute", "value": 5368813445}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368923680}}]}, {"address": {"type": "absolute", "value": 5368813460}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368813465}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368813470}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368813475}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368877280}}]}, {"address": {"type": "absolute", "value": 5368813485}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368813490}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368813500}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368967728}}]}, {"address": {"type": "absolute", "value": 5368813505}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368915472}}]}, {"address": {"type": "absolute", "value": 5368813515}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368813525}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368837088}}]}, {"address": {"type": "absolute", "value": 5368813540}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368898912}}]}, {"address": {"type": "absolute", "value": 5368813545}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368813550}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368813555}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5369013937}}]}, {"address": {"type": "absolute", "value": 5368813560}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368858352}}]}, {"address": {"type": "absolute", "value": 5368813565}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368914432}}]}, {"address": {"type": "absolute", "value": 5368813575}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368813580}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368813585}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368895248}}, {"address": {"type": "absolute", "value": 5368895480}}]}, {"address": {"type": "absolute", "value": 5368813590}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368928880}}]}, {"address": {"type": "absolute", "value": 5368813595}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368921760}}]}, {"address": {"type": "absolute", "value": 5368813600}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368813610}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5369007594}}]}, {"address": {"type": "absolute", "value": 5368813615}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368813620}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368813625}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368813630}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5369015968}}]}, {"address": {"type": "absolute", "value": 5368813635}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368839184}}, {"address": {"type": "absolute", "value": 5368839341}}]}, {"address": {"type": "absolute", "value": 5368813650}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368813665}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368813670}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368905440}}, {"address": {"type": "absolute", "value": 5368905536}}, {"address": {"type": "absolute", "value": 5368905595}}]}, {"address": {"type": "absolute", "value": 5368813675}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368813680}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368898240}}, {"address": {"type": "absolute", "value": 5368898405}}]}, {"address": {"type": "absolute", "value": 5368813685}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368848000}}]}, {"address": {"type": "absolute", "value": 5368813695}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368923568}}]}, {"address": {"type": "absolute", "value": 5368813700}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5369002064}}]}, {"address": {"type": "absolute", "value": 5368813705}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368926928}}]}, {"address": {"type": "absolute", "value": 5368813710}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368813715}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368813720}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368813730}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368813735}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368813745}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368986448}}]}, {"address": {"type": "absolute", "value": 5368813750}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368950592}}, {"address": {"type": "absolute", "value": 5368950804}}, {"address": {"type": "absolute", "value": 5368950968}}, {"address": {"type": "absolute", "value": 5368951220}}, {"address": {"type": "absolute", "value": 5368951296}}]}, {"address": {"type": "absolute", "value": 5368813755}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368813760}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368910688}}, {"address": {"type": "absolute", "value": 5368910818}}, {"address": {"type": "absolute", "value": 5368910906}}]}, {"address": {"type": "absolute", "value": 5368813770}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368898576}}, {"address": {"type": "absolute", "value": 5368898741}}]}, {"address": {"type": "absolute", "value": 5368813780}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368813785}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368813795}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368813800}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368813805}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368813810}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368813815}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368923216}}]}, {"address": {"type": "absolute", "value": 5368813820}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368925472}}]}, {"address": {"type": "absolute", "value": 5368813825}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5369016224}}]}, {"address": {"type": "absolute", "value": 5368813830}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368865680}}]}, {"address": {"type": "absolute", "value": 5368813835}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368813840}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368958453}}]}, {"address": {"type": "absolute", "value": 5368813845}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368813860}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368813865}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368813875}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368813890}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368813895}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368938016}}]}, {"address": {"type": "absolute", "value": 5368813900}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368813910}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368866222}}]}, {"address": {"type": "absolute", "value": 5368813915}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368813920}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368813925}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368848272}}]}, {"address": {"type": "absolute", "value": 5368813930}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368899264}}]}, {"address": {"type": "absolute", "value": 5368813935}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368926592}}]}, {"address": {"type": "absolute", "value": 5368813950}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368813960}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368871664}}]}, {"address": {"type": "absolute", "value": 5368813970}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368813975}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5369014016}}]}, {"address": {"type": "absolute", "value": 5368813980}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5369008240}}]}, {"address": {"type": "absolute", "value": 5368813990}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368890032}}, {"address": {"type": "absolute", "value": 5368890242}}]}, {"address": {"type": "absolute", "value": 5368814000}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368814015}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368814020}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368814025}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368947424}}]}, {"address": {"type": "absolute", "value": 5368814030}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368814035}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368907625}}]}, {"address": {"type": "absolute", "value": 5368814040}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368864464}}, {"address": {"type": "absolute", "value": 5368864594}}, {"address": {"type": "absolute", "value": 5368864642}}]}, {"address": {"type": "absolute", "value": 5368814045}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368814050}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368814055}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368814060}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368814065}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5369017216}}]}, {"address": {"type": "absolute", "value": 5368814075}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368814090}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368847824}}]}, {"address": {"type": "absolute", "value": 5368814100}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368862560}}]}, {"address": {"type": "absolute", "value": 5368814110}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368814130}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368838128}}]}, {"address": {"type": "absolute", "value": 5368814135}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368935120}}, {"address": {"type": "absolute", "value": 5368935273}}]}, {"address": {"type": "absolute", "value": 5368814145}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368976496}}]}, {"address": {"type": "absolute", "value": 5368814160}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368814165}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368814175}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368814180}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368814195}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368814200}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5369002562}}]}, {"address": {"type": "absolute", "value": 5368814205}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368999904}}, {"address": {"type": "absolute", "value": 5369000118}}]}, {"address": {"type": "absolute", "value": 5368814210}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5369001216}}]}, {"address": {"type": "absolute", "value": 5368814215}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368814225}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368814230}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368884334}}]}, {"address": {"type": "absolute", "value": 5368814235}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368814240}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368918544}}]}, {"address": {"type": "absolute", "value": 5368814250}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368814255}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368814260}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368814270}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368814275}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368814290}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368907088}}, {"address": {"type": "absolute", "value": 5368907176}}, {"address": {"type": "absolute", "value": 5368907213}}]}, {"address": {"type": "absolute", "value": 5368814295}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368814300}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5369006077}}]}, {"address": {"type": "absolute", "value": 5368814305}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368853616}}, {"address": {"type": "absolute", "value": 5368853752}}]}, {"address": {"type": "absolute", "value": 5368814310}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368814315}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368814325}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368814330}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368814335}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368996768}}]}, {"address": {"type": "absolute", "value": 5368814340}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368814345}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368891040}}, {"address": {"type": "absolute", "value": 5368891218}}]}, {"address": {"type": "absolute", "value": 5368814355}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368814360}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368814365}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368814375}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368814390}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368870592}}]}, {"address": {"type": "absolute", "value": 5368814400}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368814405}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368814410}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368814415}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5369007856}}]}, {"address": {"type": "absolute", "value": 5368814425}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5369000320}}, {"address": {"type": "absolute", "value": 5369000497}}]}, {"address": {"type": "absolute", "value": 5368814435}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368923456}}]}, {"address": {"type": "absolute", "value": 5368814440}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368814445}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368814450}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368814455}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368916256}}]}, {"address": {"type": "absolute", "value": 5368814460}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368814465}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368814470}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368814485}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368814490}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368925696}}, {"address": {"type": "absolute", "value": 5368925779}}]}, {"address": {"type": "absolute", "value": 5368814495}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368814500}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368909568}}, {"address": {"type": "absolute", "value": 5368909711}}, {"address": {"type": "absolute", "value": 5368910144}}]}, {"address": {"type": "absolute", "value": 5368814520}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368814530}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368814540}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368842752}}]}, {"address": {"type": "absolute", "value": 5368814545}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368814550}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368814555}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368893136}}]}, {"address": {"type": "absolute", "value": 5368814560}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368814585}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368814590}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368931728}}]}, {"address": {"type": "absolute", "value": 5368814600}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368997120}}]}, {"address": {"type": "absolute", "value": 5368814605}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368986672}}]}, {"address": {"type": "absolute", "value": 5368814615}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368814620}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5369016272}}, {"address": {"type": "absolute", "value": 5369016379}}]}, {"address": {"type": "absolute", "value": 5368814630}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368853872}}]}, {"address": {"type": "absolute", "value": 5368814640}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368908237}}]}, {"address": {"type": "absolute", "value": 5368814645}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368814650}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368814665}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368814680}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368814685}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368814690}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5369015535}}, {"address": {"type": "absolute", "value": 5369015736}}]}, {"address": {"type": "absolute", "value": 5368814695}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368814700}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368846752}}]}, {"address": {"type": "absolute", "value": 5368814705}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5369007028}}, {"address": {"type": "absolute", "value": 5369007110}}]}, {"address": {"type": "absolute", "value": 5368814710}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368867760}}]}, {"address": {"type": "absolute", "value": 5368814715}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368814720}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368814725}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368814730}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368814735}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368869042}}, {"address": {"type": "absolute", "value": 5368869087}}]}, {"address": {"type": "absolute", "value": 5368814740}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368814745}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368814750}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5369005760}}]}, {"address": {"type": "absolute", "value": 5368814755}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368814760}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368814765}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368814775}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368858838}}, {"address": {"type": "absolute", "value": 5368858872}}]}, {"address": {"type": "absolute", "value": 5368814780}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368814790}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368814795}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368814800}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368929888}}]}, {"address": {"type": "absolute", "value": 5368814810}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368874096}}, {"address": {"type": "absolute", "value": 5368874319}}, {"address": {"type": "absolute", "value": 5368874689}}]}, {"address": {"type": "absolute", "value": 5368814815}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368814820}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368814830}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5369015264}}, {"address": {"type": "absolute", "value": 5369015293}}]}, {"address": {"type": "absolute", "value": 5368814835}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368814850}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368871952}}]}, {"address": {"type": "absolute", "value": 5368814855}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368814865}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368919549}}, {"address": {"type": "absolute", "value": 5368919896}}, {"address": {"type": "absolute", "value": 5368919951}}, {"address": {"type": "absolute", "value": 5368920014}}, {"address": {"type": "absolute", "value": 5368920079}}, {"address": {"type": "absolute", "value": 5368920205}}, {"address": {"type": "absolute", "value": 5368920268}}]}, {"address": {"type": "absolute", "value": 5368814870}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368841264}}]}, {"address": {"type": "absolute", "value": 5368814875}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368877056}}]}, {"address": {"type": "absolute", "value": 5368814880}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368993008}}]}, {"address": {"type": "absolute", "value": 5368814890}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368814895}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368990848}}, {"address": {"type": "absolute", "value": 5368991013}}]}, {"address": {"type": "absolute", "value": 5368814900}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5369014144}}]}, {"address": {"type": "absolute", "value": 5368814905}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368932480}}, {"address": {"type": "absolute", "value": 5368932788}}]}, {"address": {"type": "absolute", "value": 5368814910}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368814925}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368814935}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368908512}}, {"address": {"type": "absolute", "value": 5368908692}}]}, {"address": {"type": "absolute", "value": 5368814940}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368814945}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368874928}}]}, {"address": {"type": "absolute", "value": 5368814955}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368814960}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368814965}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368814970}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368915920}}]}, {"address": {"type": "absolute", "value": 5368814980}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368858534}}, {"address": {"type": "absolute", "value": 5368858568}}]}, {"address": {"type": "absolute", "value": 5368814985}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368814990}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368907712}}]}, {"address": {"type": "absolute", "value": 5368814995}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368815005}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368892464}}]}, {"address": {"type": "absolute", "value": 5368815010}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368815025}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368815040}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368927760}}, {"address": {"type": "absolute", "value": 5368928040}}]}, {"address": {"type": "absolute", "value": 5368815045}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368815050}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368881759}}]}, {"address": {"type": "absolute", "value": 5368815055}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368815060}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368872528}}]}, {"address": {"type": "absolute", "value": 5368815070}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368859600}}]}, {"address": {"type": "absolute", "value": 5368815085}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368815090}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368934160}}]}, {"address": {"type": "absolute", "value": 5368815100}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368973264}}]}, {"address": {"type": "absolute", "value": 5368815105}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368815115}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368840336}}]}, {"address": {"type": "absolute", "value": 5368815125}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368815130}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368815130}}, {"address": {"type": "absolute", "value": 5369002823}}]}, {"address": {"type": "absolute", "value": 5368815135}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368815140}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5369010256}}]}, {"address": {"type": "absolute", "value": 5368815145}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368815150}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368899968}}]}, {"address": {"type": "absolute", "value": 5368815160}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368966608}}, {"address": {"type": "absolute", "value": 5368966703}}]}, {"address": {"type": "absolute", "value": 5368815165}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368984784}}]}, {"address": {"type": "absolute", "value": 5368815170}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368860320}}, {"address": {"type": "absolute", "value": 5368860417}}, {"address": {"type": "absolute", "value": 5368860540}}, {"address": {"type": "absolute", "value": 5368860552}}]}, {"address": {"type": "absolute", "value": 5368815175}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368914080}}]}, {"address": {"type": "absolute", "value": 5368815180}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368815185}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368815190}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368948908}}]}, {"address": {"type": "absolute", "value": 5368815195}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368815200}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368985322}}]}, {"address": {"type": "absolute", "value": 5368815205}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368815210}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368845568}}, {"address": {"type": "absolute", "value": 5368845680}}, {"address": {"type": "absolute", "value": 5368845739}}, {"address": {"type": "absolute", "value": 5368845793}}]}, {"address": {"type": "absolute", "value": 5368815215}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368962560}}]}, {"address": {"type": "absolute", "value": 5368815225}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368815230}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368921024}}]}, {"address": {"type": "absolute", "value": 5368815240}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368815245}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368944304}}]}, {"address": {"type": "absolute", "value": 5368815250}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368815255}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368815260}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368815265}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368899616}}]}, {"address": {"type": "absolute", "value": 5368815270}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368815280}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368815290}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368815300}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368969872}}]}, {"address": {"type": "absolute", "value": 5368815305}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368815310}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368815315}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368884640}}, {"address": {"type": "absolute", "value": 5368884960}}, {"address": {"type": "absolute", "value": 5368884998}}, {"address": {"type": "absolute", "value": 5368885084}}, {"address": {"type": "absolute", "value": 5368885421}}, {"address": {"type": "absolute", "value": 5368885459}}, {"address": {"type": "absolute", "value": 5368885632}}, {"address": {"type": "absolute", "value": 5368885693}}]}, {"address": {"type": "absolute", "value": 5368815320}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368815325}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368837568}}]}, {"address": {"type": "absolute", "value": 5368815335}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368815340}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368924704}}]}, {"address": {"type": "absolute", "value": 5368815350}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368815360}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368815365}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368815370}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368906656}}]}, {"address": {"type": "absolute", "value": 5368815380}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368815385}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5369020497}}]}, {"address": {"type": "absolute", "value": 5368815390}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368865840}}]}, {"address": {"type": "absolute", "value": 5368815400}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368815415}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368815435}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368815440}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368815450}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368815460}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368815470}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368815475}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368815480}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368897904}}, {"address": {"type": "absolute", "value": 5368898069}}]}, {"address": {"type": "absolute", "value": 5368815490}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368815495}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368815500}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368906928}}, {"address": {"type": "absolute", "value": 5368906998}}]}, {"address": {"type": "absolute", "value": 5368815505}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368815510}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368815515}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5369017088}}]}, {"address": {"type": "absolute", "value": 5368815520}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368815525}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368918304}}]}, {"address": {"type": "absolute", "value": 5368815530}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368815535}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368815550}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368815555}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368871008}}]}, {"address": {"type": "absolute", "value": 5368815570}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368815575}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5369016016}}, {"address": {"type": "absolute", "value": 5369016067}}, {"address": {"type": "absolute", "value": 5369016177}}]}, {"address": {"type": "absolute", "value": 5368815585}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5369001792}}, {"address": {"type": "absolute", "value": 5369001893}}]}, {"address": {"type": "absolute", "value": 5368815590}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368971024}}]}, {"address": {"type": "absolute", "value": 5368815595}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368815600}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368815610}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368964656}}]}, {"address": {"type": "absolute", "value": 5368815615}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368815625}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368998896}}]}, {"address": {"type": "absolute", "value": 5368815630}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368815635}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368815640}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368815645}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368815655}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368815660}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5369007252}}, {"address": {"type": "absolute", "value": 5369007274}}]}, {"address": {"type": "absolute", "value": 5368815670}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5369007296}}, {"address": {"type": "absolute", "value": 5369007416}}]}, {"address": {"type": "absolute", "value": 5368815675}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368965504}}, {"address": {"type": "absolute", "value": 5368965587}}, {"address": {"type": "absolute", "value": 5368965631}}, {"address": {"type": "absolute", "value": 5368965660}}, {"address": {"type": "absolute", "value": 5368965720}}]}, {"address": {"type": "absolute", "value": 5368815680}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368849296}}]}, {"address": {"type": "absolute", "value": 5368815685}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368815690}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368970112}}, {"address": {"type": "absolute", "value": 5368970395}}, {"address": {"type": "absolute", "value": 5368970461}}, {"address": {"type": "absolute", "value": 5368970515}}, {"address": {"type": "absolute", "value": 5368970547}}, {"address": {"type": "absolute", "value": 5368970619}}, {"address": {"type": "absolute", "value": 5368970649}}]}, {"address": {"type": "absolute", "value": 5368815700}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368815705}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368815715}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368841536}}, {"address": {"type": "absolute", "value": 5368841775}}, {"address": {"type": "absolute", "value": 5368841964}}, {"address": {"type": "absolute", "value": 5368842047}}]}, {"address": {"type": "absolute", "value": 5368815720}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368815725}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368894224}}, {"address": {"type": "absolute", "value": 5368894360}}]}, {"address": {"type": "absolute", "value": 5368815735}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368815745}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5369013008}}]}, {"address": {"type": "absolute", "value": 5368815755}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368974336}}]}, {"address": {"type": "absolute", "value": 5368815765}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368930496}}]}, {"address": {"type": "absolute", "value": 5368815770}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368894480}}]}, {"address": {"type": "absolute", "value": 5368815775}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368815780}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368847040}}]}, {"address": {"type": "absolute", "value": 5368815785}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5369007824}}]}, {"address": {"type": "absolute", "value": 5368815795}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368815805}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5369014192}}, {"address": {"type": "absolute", "value": 5369014382}}, {"address": {"type": "absolute", "value": 5369014472}}, {"address": {"type": "absolute", "value": 5369014657}}, {"address": {"type": "absolute", "value": 5369014716}}, {"address": {"type": "absolute", "value": 5369014938}}, {"address": {"type": "absolute", "value": 5369015008}}]}, {"address": {"type": "absolute", "value": 5368815820}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368815830}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368815835}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368815850}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368815855}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368815865}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368890480}}]}, {"address": {"type": "absolute", "value": 5368815870}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368916144}}]}, {"address": {"type": "absolute", "value": 5368815880}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368815890}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368999336}}]}, {"address": {"type": "absolute", "value": 5368815895}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5369006544}}, {"address": {"type": "absolute", "value": 5369006612}}]}, {"address": {"type": "absolute", "value": 5368815900}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368815905}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368877504}}]}, {"address": {"type": "absolute", "value": 5368815910}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368840608}}]}, {"address": {"type": "absolute", "value": 5368815920}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368815925}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368815930}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368913856}}]}, {"address": {"type": "absolute", "value": 5368815940}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368815945}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368815955}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368920912}}]}, {"address": {"type": "absolute", "value": 5368815960}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368953248}}]}, {"address": {"type": "absolute", "value": 5368815965}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5369013968}}]}, {"address": {"type": "absolute", "value": 5368815970}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368886745}}, {"address": {"type": "absolute", "value": 5368886781}}]}, {"address": {"type": "absolute", "value": 5368815975}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368815980}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5369008302}}]}, {"address": {"type": "absolute", "value": 5368815985}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368815990}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368815995}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368816000}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368858656}}]}, {"address": {"type": "absolute", "value": 5368816005}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368816010}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368887327}}, {"address": {"type": "absolute", "value": 5368887482}}, {"address": {"type": "absolute", "value": 5368887733}}, {"address": {"type": "absolute", "value": 5368887794}}, {"address": {"type": "absolute", "value": 5368887937}}]}, {"address": {"type": "absolute", "value": 5368816015}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368816020}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368816025}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368997936}}]}, {"address": {"type": "absolute", "value": 5368816040}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368816045}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368996944}}]}, {"address": {"type": "absolute", "value": 5368816055}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368816060}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368994400}}, {"address": {"type": "absolute", "value": 5368994791}}]}, {"address": {"type": "absolute", "value": 5368816065}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368873312}}]}, {"address": {"type": "absolute", "value": 5368816070}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368816080}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368882496}}]}, {"address": {"type": "absolute", "value": 5368816085}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5369016848}}, {"address": {"type": "absolute", "value": 5369016959}}]}, {"address": {"type": "absolute", "value": 5368816095}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368816100}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368869250}}, {"address": {"type": "absolute", "value": 5368869313}}, {"address": {"type": "absolute", "value": 5368869337}}]}, {"address": {"type": "absolute", "value": 5368816105}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5369003728}}, {"address": {"type": "absolute", "value": 5369003794}}, {"address": {"type": "absolute", "value": 5369003826}}, {"address": {"type": "absolute", "value": 5369003841}}]}, {"address": {"type": "absolute", "value": 5368816110}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368816120}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368816125}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368816135}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5369004352}}]}, {"address": {"type": "absolute", "value": 5368816145}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368816155}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368912320}}, {"address": {"type": "absolute", "value": 5368912450}}, {"address": {"type": "absolute", "value": 5368912538}}]}, {"address": {"type": "absolute", "value": 5368816160}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368979385}}]}, {"address": {"type": "absolute", "value": 5368816165}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368888611}}, {"address": {"type": "absolute", "value": 5368888766}}, {"address": {"type": "absolute", "value": 5368889163}}, {"address": {"type": "absolute", "value": 5368889407}}, {"address": {"type": "absolute", "value": 5368889461}}]}, {"address": {"type": "absolute", "value": 5368816170}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368816180}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368816185}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5369005472}}]}, {"address": {"type": "absolute", "value": 5368816195}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368816205}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368965328}}]}, {"address": {"type": "absolute", "value": 5368816215}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368933200}}]}, {"address": {"type": "absolute", "value": 5368816220}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368816225}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368928768}}]}, {"address": {"type": "absolute", "value": 5368816230}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368816235}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368816240}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368816245}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368954848}}, {"address": {"type": "absolute", "value": 5368955014}}, {"address": {"type": "absolute", "value": 5368955356}}, {"address": {"type": "absolute", "value": 5368955764}}]}, {"address": {"type": "absolute", "value": 5368816250}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368816265}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5369014064}}, {"address": {"type": "absolute", "value": 5369014111}}]}, {"address": {"type": "absolute", "value": 5368816270}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368816275}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368816280}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368816290}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368816295}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368816310}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368945965}}]}, {"address": {"type": "absolute", "value": 5368816320}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368966232}}, {"address": {"type": "absolute", "value": 5368966291}}, {"address": {"type": "absolute", "value": 5368966375}}, {"address": {"type": "absolute", "value": 5368966434}}]}, {"address": {"type": "absolute", "value": 5368816335}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368816340}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368816345}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368816355}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368816360}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368870800}}]}, {"address": {"type": "absolute", "value": 5368816365}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5369010176}}]}, {"address": {"type": "absolute", "value": 5368816375}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368816380}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368816385}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368816400}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368845408}}]}, {"address": {"type": "absolute", "value": 5368816405}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368816415}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368816420}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368816425}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368816430}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368816445}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5369017392}}, {"address": {"type": "absolute", "value": 5369017438}}, {"address": {"type": "absolute", "value": 5369017447}}]}, {"address": {"type": "absolute", "value": 5368816450}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5369007194}}]}, {"address": {"type": "absolute", "value": 5368816455}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368816460}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368956192}}]}, {"address": {"type": "absolute", "value": 5368816465}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5369002562}}, {"address": {"type": "absolute", "value": 5369002568}}]}, {"address": {"type": "absolute", "value": 5368816470}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368816480}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368816485}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368816490}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368816495}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368816500}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368816505}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368816510}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368816515}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368916032}}]}, {"address": {"type": "absolute", "value": 5368816525}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368816530}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368816540}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368816545}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368816550}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368816555}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368821600}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368821728}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368821728}}]}, {"address": {"type": "absolute", "value": 5368822176}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368822176}}]}, {"address": {"type": "absolute", "value": 5368824096}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368824096}}]}, {"address": {"type": "absolute", "value": 5368838672}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368838672}}]}, {"address": {"type": "absolute", "value": 5368882832}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368882832}}, {"address": {"type": "absolute", "value": 5368882955}}, {"address": {"type": "absolute", "value": 5368883232}}]}, {"address": {"type": "absolute", "value": 5368891376}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368891498}}]}, {"address": {"type": "absolute", "value": 5368891792}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368891898}}]}, {"address": {"type": "absolute", "value": 5368892096}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368892096}}]}, {"address": {"type": "absolute", "value": 5368892304}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368892304}}]}, {"address": {"type": "absolute", "value": 5368909136}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368909136}}]}, {"address": {"type": "absolute", "value": 5368960864}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368961024}}, {"address": {"type": "absolute", "value": 5368961046}}]}, {"address": {"type": "absolute", "value": 5368963056}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368964112}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368964112}}]}, {"address": {"type": "absolute", "value": 5368964496}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368964496}}]}, {"address": {"type": "absolute", "value": 5368971776}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368971888}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5368986896}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368987018}}]}, {"address": {"type": "absolute", "value": 5368987312}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368987418}}]}, {"address": {"type": "absolute", "value": 5368988000}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368988000}}]}, {"address": {"type": "absolute", "value": 5368988208}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 5368988208}}]}, {"address": {"type": "absolute", "value": 5369005504}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5369005792}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5369008832}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5369009024}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5369009248}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5369009472}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5369009504}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5369009536}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5369009568}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5369010096}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5369010320}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5369010400}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5369011536}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5369011568}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5369012336}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5369016608}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5369017584}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5369018000}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5369018864}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 5369037280}, "matched_basic_blocks": []}]}, "feature_counts": {"file": 2213, "functions": [{"address": {"type": "absolute", "value": 5368811525}, "count": 62}, {"address": {"type": "absolute", "value": 5368811530}, "count": 27}, {"address": {"type": "absolute", "value": 5368811535}, "count": 12}, {"address": {"type": "absolute", "value": 5368811540}, "count": 39}, {"address": {"type": "absolute", "value": 5368811550}, "count": 10}, {"address": {"type": "absolute", "value": 5368811555}, "count": 33}, {"address": {"type": "absolute", "value": 5368811560}, "count": 8}, {"address": {"type": "absolute", "value": 5368811565}, "count": 81}, {"address": {"type": "absolute", "value": 5368811570}, "count": 38}, {"address": {"type": "absolute", "value": 5368811585}, "count": 12}, {"address": {"type": "absolute", "value": 5368811590}, "count": 53}, {"address": {"type": "absolute", "value": 5368811605}, "count": 31}, {"address": {"type": "absolute", "value": 5368811620}, "count": 30}, {"address": {"type": "absolute", "value": 5368811625}, "count": 33}, {"address": {"type": "absolute", "value": 5368811630}, "count": 30}, {"address": {"type": "absolute", "value": 5368811655}, "count": 42}, {"address": {"type": "absolute", "value": 5368811660}, "count": 54}, {"address": {"type": "absolute", "value": 5368811670}, "count": 53}, {"address": {"type": "absolute", "value": 5368811675}, "count": 71}, {"address": {"type": "absolute", "value": 5368811680}, "count": 42}, {"address": {"type": "absolute", "value": 5368811685}, "count": 10}, {"address": {"type": "absolute", "value": 5368811690}, "count": 14}, {"address": {"type": "absolute", "value": 5368811695}, "count": 64}, {"address": {"type": "absolute", "value": 5368811705}, "count": 28}, {"address": {"type": "absolute", "value": 5368811715}, "count": 143}, {"address": {"type": "absolute", "value": 5368811720}, "count": 38}, {"address": {"type": "absolute", "value": 5368811740}, "count": 60}, {"address": {"type": "absolute", "value": 5368811745}, "count": 31}, {"address": {"type": "absolute", "value": 5368811750}, "count": 34}, {"address": {"type": "absolute", "value": 5368811755}, "count": 36}, {"address": {"type": "absolute", "value": 5368811760}, "count": 31}, {"address": {"type": "absolute", "value": 5368811765}, "count": 59}, {"address": {"type": "absolute", "value": 5368811770}, "count": 50}, {"address": {"type": "absolute", "value": 5368811775}, "count": 10}, {"address": {"type": "absolute", "value": 5368811780}, "count": 35}, {"address": {"type": "absolute", "value": 5368811785}, "count": 19}, {"address": {"type": "absolute", "value": 5368811790}, "count": 10}, {"address": {"type": "absolute", "value": 5368811795}, "count": 30}, {"address": {"type": "absolute", "value": 5368811800}, "count": 30}, {"address": {"type": "absolute", "value": 5368811805}, "count": 105}, {"address": {"type": "absolute", "value": 5368811810}, "count": 65}, {"address": {"type": "absolute", "value": 5368811820}, "count": 62}, {"address": {"type": "absolute", "value": 5368811825}, "count": 32}, {"address": {"type": "absolute", "value": 5368811830}, "count": 32}, {"address": {"type": "absolute", "value": 5368811835}, "count": 36}, {"address": {"type": "absolute", "value": 5368811850}, "count": 32}, {"address": {"type": "absolute", "value": 5368811855}, "count": 30}, {"address": {"type": "absolute", "value": 5368811865}, "count": 60}, {"address": {"type": "absolute", "value": 5368811870}, "count": 37}, {"address": {"type": "absolute", "value": 5368811875}, "count": 71}, {"address": {"type": "absolute", "value": 5368811880}, "count": 33}, {"address": {"type": "absolute", "value": 5368811885}, "count": 33}, {"address": {"type": "absolute", "value": 5368811890}, "count": 10}, {"address": {"type": "absolute", "value": 5368811895}, "count": 35}, {"address": {"type": "absolute", "value": 5368811905}, "count": 40}, {"address": {"type": "absolute", "value": 5368811910}, "count": 31}, {"address": {"type": "absolute", "value": 5368811915}, "count": 8}, {"address": {"type": "absolute", "value": 5368811920}, "count": 32}, {"address": {"type": "absolute", "value": 5368811925}, "count": 56}, {"address": {"type": "absolute", "value": 5368811930}, "count": 31}, {"address": {"type": "absolute", "value": 5368811955}, "count": 39}, {"address": {"type": "absolute", "value": 5368811960}, "count": 33}, {"address": {"type": "absolute", "value": 5368811965}, "count": 49}, {"address": {"type": "absolute", "value": 5368811970}, "count": 10}, {"address": {"type": "absolute", "value": 5368811975}, "count": 11}, {"address": {"type": "absolute", "value": 5368811980}, "count": 31}, {"address": {"type": "absolute", "value": 5368811985}, "count": 12}, {"address": {"type": "absolute", "value": 5368811990}, "count": 51}, {"address": {"type": "absolute", "value": 5368812010}, "count": 40}, {"address": {"type": "absolute", "value": 5368812015}, "count": 41}, {"address": {"type": "absolute", "value": 5368812020}, "count": 118}, {"address": {"type": "absolute", "value": 5368812030}, "count": 37}, {"address": {"type": "absolute", "value": 5368812035}, "count": 69}, {"address": {"type": "absolute", "value": 5368812040}, "count": 31}, {"address": {"type": "absolute", "value": 5368812050}, "count": 38}, {"address": {"type": "absolute", "value": 5368812055}, "count": 39}, {"address": {"type": "absolute", "value": 5368812065}, "count": 38}, {"address": {"type": "absolute", "value": 5368812070}, "count": 31}, {"address": {"type": "absolute", "value": 5368812075}, "count": 28}, {"address": {"type": "absolute", "value": 5368812080}, "count": 33}, {"address": {"type": "absolute", "value": 5368812085}, "count": 30}, {"address": {"type": "absolute", "value": 5368812095}, "count": 28}, {"address": {"type": "absolute", "value": 5368812100}, "count": 62}, {"address": {"type": "absolute", "value": 5368812105}, "count": 37}, {"address": {"type": "absolute", "value": 5368812110}, "count": 36}, {"address": {"type": "absolute", "value": 5368812115}, "count": 51}, {"address": {"type": "absolute", "value": 5368812120}, "count": 92}, {"address": {"type": "absolute", "value": 5368812130}, "count": 10}, {"address": {"type": "absolute", "value": 5368812140}, "count": 84}, {"address": {"type": "absolute", "value": 5368812145}, "count": 33}, {"address": {"type": "absolute", "value": 5368812150}, "count": 92}, {"address": {"type": "absolute", "value": 5368812155}, "count": 10}, {"address": {"type": "absolute", "value": 5368812165}, "count": 30}, {"address": {"type": "absolute", "value": 5368812170}, "count": 55}, {"address": {"type": "absolute", "value": 5368812175}, "count": 16}, {"address": {"type": "absolute", "value": 5368812180}, "count": 47}, {"address": {"type": "absolute", "value": 5368812185}, "count": 34}, {"address": {"type": "absolute", "value": 5368812190}, "count": 31}, {"address": {"type": "absolute", "value": 5368812195}, "count": 32}, {"address": {"type": "absolute", "value": 5368812205}, "count": 37}, {"address": {"type": "absolute", "value": 5368812210}, "count": 10}, {"address": {"type": "absolute", "value": 5368812220}, "count": 21}, {"address": {"type": "absolute", "value": 5368812230}, "count": 67}, {"address": {"type": "absolute", "value": 5368812235}, "count": 28}, {"address": {"type": "absolute", "value": 5368812240}, "count": 31}, {"address": {"type": "absolute", "value": 5368812250}, "count": 10}, {"address": {"type": "absolute", "value": 5368812255}, "count": 32}, {"address": {"type": "absolute", "value": 5368812265}, "count": 10}, {"address": {"type": "absolute", "value": 5368812270}, "count": 63}, {"address": {"type": "absolute", "value": 5368812275}, "count": 31}, {"address": {"type": "absolute", "value": 5368812285}, "count": 73}, {"address": {"type": "absolute", "value": 5368812290}, "count": 37}, {"address": {"type": "absolute", "value": 5368812295}, "count": 30}, {"address": {"type": "absolute", "value": 5368812300}, "count": 38}, {"address": {"type": "absolute", "value": 5368812305}, "count": 36}, {"address": {"type": "absolute", "value": 5368812310}, "count": 44}, {"address": {"type": "absolute", "value": 5368812315}, "count": 28}, {"address": {"type": "absolute", "value": 5368812320}, "count": 28}, {"address": {"type": "absolute", "value": 5368812325}, "count": 42}, {"address": {"type": "absolute", "value": 5368812330}, "count": 36}, {"address": {"type": "absolute", "value": 5368812335}, "count": 40}, {"address": {"type": "absolute", "value": 5368812340}, "count": 77}, {"address": {"type": "absolute", "value": 5368812350}, "count": 30}, {"address": {"type": "absolute", "value": 5368812360}, "count": 124}, {"address": {"type": "absolute", "value": 5368812380}, "count": 38}, {"address": {"type": "absolute", "value": 5368812385}, "count": 38}, {"address": {"type": "absolute", "value": 5368812390}, "count": 12}, {"address": {"type": "absolute", "value": 5368812395}, "count": 109}, {"address": {"type": "absolute", "value": 5368812405}, "count": 28}, {"address": {"type": "absolute", "value": 5368812415}, "count": 30}, {"address": {"type": "absolute", "value": 5368812425}, "count": 9}, {"address": {"type": "absolute", "value": 5368812430}, "count": 47}, {"address": {"type": "absolute", "value": 5368812445}, "count": 23}, {"address": {"type": "absolute", "value": 5368812455}, "count": 51}, {"address": {"type": "absolute", "value": 5368812465}, "count": 32}, {"address": {"type": "absolute", "value": 5368812475}, "count": 28}, {"address": {"type": "absolute", "value": 5368812480}, "count": 70}, {"address": {"type": "absolute", "value": 5368812485}, "count": 36}, {"address": {"type": "absolute", "value": 5368812495}, "count": 26}, {"address": {"type": "absolute", "value": 5368812500}, "count": 35}, {"address": {"type": "absolute", "value": 5368812505}, "count": 30}, {"address": {"type": "absolute", "value": 5368812530}, "count": 84}, {"address": {"type": "absolute", "value": 5368812550}, "count": 53}, {"address": {"type": "absolute", "value": 5368812565}, "count": 30}, {"address": {"type": "absolute", "value": 5368812575}, "count": 59}, {"address": {"type": "absolute", "value": 5368812580}, "count": 30}, {"address": {"type": "absolute", "value": 5368812585}, "count": 32}, {"address": {"type": "absolute", "value": 5368812590}, "count": 77}, {"address": {"type": "absolute", "value": 5368812600}, "count": 56}, {"address": {"type": "absolute", "value": 5368812615}, "count": 36}, {"address": {"type": "absolute", "value": 5368812640}, "count": 59}, {"address": {"type": "absolute", "value": 5368812645}, "count": 10}, {"address": {"type": "absolute", "value": 5368812650}, "count": 30}, {"address": {"type": "absolute", "value": 5368812660}, "count": 27}, {"address": {"type": "absolute", "value": 5368812665}, "count": 10}, {"address": {"type": "absolute", "value": 5368812670}, "count": 59}, {"address": {"type": "absolute", "value": 5368812675}, "count": 46}, {"address": {"type": "absolute", "value": 5368812680}, "count": 51}, {"address": {"type": "absolute", "value": 5368812685}, "count": 60}, {"address": {"type": "absolute", "value": 5368812690}, "count": 10}, {"address": {"type": "absolute", "value": 5368812695}, "count": 49}, {"address": {"type": "absolute", "value": 5368812700}, "count": 39}, {"address": {"type": "absolute", "value": 5368812710}, "count": 25}, {"address": {"type": "absolute", "value": 5368812715}, "count": 83}, {"address": {"type": "absolute", "value": 5368812725}, "count": 35}, {"address": {"type": "absolute", "value": 5368812730}, "count": 31}, {"address": {"type": "absolute", "value": 5368812735}, "count": 52}, {"address": {"type": "absolute", "value": 5368812740}, "count": 8}, {"address": {"type": "absolute", "value": 5368812745}, "count": 35}, {"address": {"type": "absolute", "value": 5368812750}, "count": 10}, {"address": {"type": "absolute", "value": 5368812770}, "count": 9}, {"address": {"type": "absolute", "value": 5368812775}, "count": 27}, {"address": {"type": "absolute", "value": 5368812780}, "count": 44}, {"address": {"type": "absolute", "value": 5368812785}, "count": 36}, {"address": {"type": "absolute", "value": 5368812805}, "count": 39}, {"address": {"type": "absolute", "value": 5368812810}, "count": 28}, {"address": {"type": "absolute", "value": 5368812830}, "count": 28}, {"address": {"type": "absolute", "value": 5368812840}, "count": 33}, {"address": {"type": "absolute", "value": 5368812845}, "count": 58}, {"address": {"type": "absolute", "value": 5368812855}, "count": 31}, {"address": {"type": "absolute", "value": 5368812860}, "count": 33}, {"address": {"type": "absolute", "value": 5368812865}, "count": 19}, {"address": {"type": "absolute", "value": 5368812870}, "count": 8}, {"address": {"type": "absolute", "value": 5368812875}, "count": 92}, {"address": {"type": "absolute", "value": 5368812880}, "count": 37}, {"address": {"type": "absolute", "value": 5368812890}, "count": 31}, {"address": {"type": "absolute", "value": 5368812895}, "count": 40}, {"address": {"type": "absolute", "value": 5368812900}, "count": 37}, {"address": {"type": "absolute", "value": 5368812910}, "count": 88}, {"address": {"type": "absolute", "value": 5368812920}, "count": 33}, {"address": {"type": "absolute", "value": 5368812925}, "count": 31}, {"address": {"type": "absolute", "value": 5368812935}, "count": 36}, {"address": {"type": "absolute", "value": 5368812950}, "count": 27}, {"address": {"type": "absolute", "value": 5368812955}, "count": 28}, {"address": {"type": "absolute", "value": 5368812960}, "count": 39}, {"address": {"type": "absolute", "value": 5368812970}, "count": 36}, {"address": {"type": "absolute", "value": 5368812975}, "count": 24}, {"address": {"type": "absolute", "value": 5368812980}, "count": 35}, {"address": {"type": "absolute", "value": 5368812985}, "count": 33}, {"address": {"type": "absolute", "value": 5368812990}, "count": 61}, {"address": {"type": "absolute", "value": 5368812995}, "count": 25}, {"address": {"type": "absolute", "value": 5368813005}, "count": 9}, {"address": {"type": "absolute", "value": 5368813020}, "count": 33}, {"address": {"type": "absolute", "value": 5368813025}, "count": 12}, {"address": {"type": "absolute", "value": 5368813030}, "count": 33}, {"address": {"type": "absolute", "value": 5368813035}, "count": 69}, {"address": {"type": "absolute", "value": 5368813040}, "count": 36}, {"address": {"type": "absolute", "value": 5368813050}, "count": 26}, {"address": {"type": "absolute", "value": 5368813055}, "count": 10}, {"address": {"type": "absolute", "value": 5368813060}, "count": 32}, {"address": {"type": "absolute", "value": 5368813065}, "count": 42}, {"address": {"type": "absolute", "value": 5368813070}, "count": 31}, {"address": {"type": "absolute", "value": 5368813075}, "count": 37}, {"address": {"type": "absolute", "value": 5368813080}, "count": 41}, {"address": {"type": "absolute", "value": 5368813085}, "count": 27}, {"address": {"type": "absolute", "value": 5368813095}, "count": 29}, {"address": {"type": "absolute", "value": 5368813100}, "count": 31}, {"address": {"type": "absolute", "value": 5368813105}, "count": 36}, {"address": {"type": "absolute", "value": 5368813115}, "count": 33}, {"address": {"type": "absolute", "value": 5368813120}, "count": 40}, {"address": {"type": "absolute", "value": 5368813125}, "count": 25}, {"address": {"type": "absolute", "value": 5368813130}, "count": 12}, {"address": {"type": "absolute", "value": 5368813135}, "count": 27}, {"address": {"type": "absolute", "value": 5368813145}, "count": 31}, {"address": {"type": "absolute", "value": 5368813155}, "count": 63}, {"address": {"type": "absolute", "value": 5368813170}, "count": 66}, {"address": {"type": "absolute", "value": 5368813175}, "count": 61}, {"address": {"type": "absolute", "value": 5368813180}, "count": 45}, {"address": {"type": "absolute", "value": 5368813185}, "count": 10}, {"address": {"type": "absolute", "value": 5368813190}, "count": 44}, {"address": {"type": "absolute", "value": 5368813195}, "count": 72}, {"address": {"type": "absolute", "value": 5368813200}, "count": 63}, {"address": {"type": "absolute", "value": 5368813205}, "count": 32}, {"address": {"type": "absolute", "value": 5368813215}, "count": 28}, {"address": {"type": "absolute", "value": 5368813220}, "count": 35}, {"address": {"type": "absolute", "value": 5368813225}, "count": 35}, {"address": {"type": "absolute", "value": 5368813235}, "count": 52}, {"address": {"type": "absolute", "value": 5368813240}, "count": 37}, {"address": {"type": "absolute", "value": 5368813245}, "count": 34}, {"address": {"type": "absolute", "value": 5368813250}, "count": 10}, {"address": {"type": "absolute", "value": 5368813255}, "count": 10}, {"address": {"type": "absolute", "value": 5368813260}, "count": 22}, {"address": {"type": "absolute", "value": 5368813265}, "count": 31}, {"address": {"type": "absolute", "value": 5368813275}, "count": 54}, {"address": {"type": "absolute", "value": 5368813280}, "count": 46}, {"address": {"type": "absolute", "value": 5368813285}, "count": 40}, {"address": {"type": "absolute", "value": 5368813290}, "count": 33}, {"address": {"type": "absolute", "value": 5368813305}, "count": 10}, {"address": {"type": "absolute", "value": 5368813310}, "count": 31}, {"address": {"type": "absolute", "value": 5368813315}, "count": 49}, {"address": {"type": "absolute", "value": 5368813335}, "count": 78}, {"address": {"type": "absolute", "value": 5368813345}, "count": 28}, {"address": {"type": "absolute", "value": 5368813350}, "count": 59}, {"address": {"type": "absolute", "value": 5368813355}, "count": 65}, {"address": {"type": "absolute", "value": 5368813365}, "count": 12}, {"address": {"type": "absolute", "value": 5368813380}, "count": 29}, {"address": {"type": "absolute", "value": 5368813390}, "count": 10}, {"address": {"type": "absolute", "value": 5368813395}, "count": 68}, {"address": {"type": "absolute", "value": 5368813400}, "count": 37}, {"address": {"type": "absolute", "value": 5368813405}, "count": 63}, {"address": {"type": "absolute", "value": 5368813415}, "count": 31}, {"address": {"type": "absolute", "value": 5368813420}, "count": 63}, {"address": {"type": "absolute", "value": 5368813435}, "count": 40}, {"address": {"type": "absolute", "value": 5368813440}, "count": 52}, {"address": {"type": "absolute", "value": 5368813445}, "count": 70}, {"address": {"type": "absolute", "value": 5368813460}, "count": 38}, {"address": {"type": "absolute", "value": 5368813465}, "count": 53}, {"address": {"type": "absolute", "value": 5368813470}, "count": 34}, {"address": {"type": "absolute", "value": 5368813475}, "count": 43}, {"address": {"type": "absolute", "value": 5368813485}, "count": 27}, {"address": {"type": "absolute", "value": 5368813490}, "count": 300}, {"address": {"type": "absolute", "value": 5368813500}, "count": 40}, {"address": {"type": "absolute", "value": 5368813505}, "count": 36}, {"address": {"type": "absolute", "value": 5368813515}, "count": 62}, {"address": {"type": "absolute", "value": 5368813525}, "count": 51}, {"address": {"type": "absolute", "value": 5368813540}, "count": 59}, {"address": {"type": "absolute", "value": 5368813545}, "count": 35}, {"address": {"type": "absolute", "value": 5368813550}, "count": 33}, {"address": {"type": "absolute", "value": 5368813555}, "count": 32}, {"address": {"type": "absolute", "value": 5368813560}, "count": 29}, {"address": {"type": "absolute", "value": 5368813565}, "count": 40}, {"address": {"type": "absolute", "value": 5368813575}, "count": 10}, {"address": {"type": "absolute", "value": 5368813580}, "count": 39}, {"address": {"type": "absolute", "value": 5368813585}, "count": 65}, {"address": {"type": "absolute", "value": 5368813590}, "count": 58}, {"address": {"type": "absolute", "value": 5368813595}, "count": 31}, {"address": {"type": "absolute", "value": 5368813600}, "count": 44}, {"address": {"type": "absolute", "value": 5368813610}, "count": 28}, {"address": {"type": "absolute", "value": 5368813615}, "count": 10}, {"address": {"type": "absolute", "value": 5368813620}, "count": 12}, {"address": {"type": "absolute", "value": 5368813625}, "count": 31}, {"address": {"type": "absolute", "value": 5368813630}, "count": 14}, {"address": {"type": "absolute", "value": 5368813635}, "count": 69}, {"address": {"type": "absolute", "value": 5368813650}, "count": 27}, {"address": {"type": "absolute", "value": 5368813665}, "count": 53}, {"address": {"type": "absolute", "value": 5368813670}, "count": 73}, {"address": {"type": "absolute", "value": 5368813675}, "count": 31}, {"address": {"type": "absolute", "value": 5368813680}, "count": 62}, {"address": {"type": "absolute", "value": 5368813685}, "count": 41}, {"address": {"type": "absolute", "value": 5368813695}, "count": 36}, {"address": {"type": "absolute", "value": 5368813700}, "count": 40}, {"address": {"type": "absolute", "value": 5368813705}, "count": 74}, {"address": {"type": "absolute", "value": 5368813710}, "count": 52}, {"address": {"type": "absolute", "value": 5368813715}, "count": 34}, {"address": {"type": "absolute", "value": 5368813720}, "count": 30}, {"address": {"type": "absolute", "value": 5368813730}, "count": 27}, {"address": {"type": "absolute", "value": 5368813735}, "count": 10}, {"address": {"type": "absolute", "value": 5368813745}, "count": 51}, {"address": {"type": "absolute", "value": 5368813750}, "count": 119}, {"address": {"type": "absolute", "value": 5368813755}, "count": 37}, {"address": {"type": "absolute", "value": 5368813760}, "count": 78}, {"address": {"type": "absolute", "value": 5368813770}, "count": 62}, {"address": {"type": "absolute", "value": 5368813780}, "count": 10}, {"address": {"type": "absolute", "value": 5368813785}, "count": 34}, {"address": {"type": "absolute", "value": 5368813795}, "count": 9}, {"address": {"type": "absolute", "value": 5368813800}, "count": 37}, {"address": {"type": "absolute", "value": 5368813805}, "count": 33}, {"address": {"type": "absolute", "value": 5368813810}, "count": 30}, {"address": {"type": "absolute", "value": 5368813815}, "count": 41}, {"address": {"type": "absolute", "value": 5368813820}, "count": 36}, {"address": {"type": "absolute", "value": 5368813825}, "count": 18}, {"address": {"type": "absolute", "value": 5368813830}, "count": 36}, {"address": {"type": "absolute", "value": 5368813835}, "count": 41}, {"address": {"type": "absolute", "value": 5368813840}, "count": 65}, {"address": {"type": "absolute", "value": 5368813845}, "count": 30}, {"address": {"type": "absolute", "value": 5368813860}, "count": 27}, {"address": {"type": "absolute", "value": 5368813865}, "count": 31}, {"address": {"type": "absolute", "value": 5368813875}, "count": 43}, {"address": {"type": "absolute", "value": 5368813890}, "count": 10}, {"address": {"type": "absolute", "value": 5368813895}, "count": 65}, {"address": {"type": "absolute", "value": 5368813900}, "count": 8}, {"address": {"type": "absolute", "value": 5368813910}, "count": 52}, {"address": {"type": "absolute", "value": 5368813915}, "count": 8}, {"address": {"type": "absolute", "value": 5368813920}, "count": 31}, {"address": {"type": "absolute", "value": 5368813925}, "count": 39}, {"address": {"type": "absolute", "value": 5368813930}, "count": 59}, {"address": {"type": "absolute", "value": 5368813935}, "count": 50}, {"address": {"type": "absolute", "value": 5368813950}, "count": 35}, {"address": {"type": "absolute", "value": 5368813960}, "count": 41}, {"address": {"type": "absolute", "value": 5368813970}, "count": 30}, {"address": {"type": "absolute", "value": 5368813975}, "count": 20}, {"address": {"type": "absolute", "value": 5368813980}, "count": 17}, {"address": {"type": "absolute", "value": 5368813990}, "count": 69}, {"address": {"type": "absolute", "value": 5368814000}, "count": 22}, {"address": {"type": "absolute", "value": 5368814015}, "count": 28}, {"address": {"type": "absolute", "value": 5368814020}, "count": 35}, {"address": {"type": "absolute", "value": 5368814025}, "count": 46}, {"address": {"type": "absolute", "value": 5368814030}, "count": 27}, {"address": {"type": "absolute", "value": 5368814035}, "count": 43}, {"address": {"type": "absolute", "value": 5368814040}, "count": 52}, {"address": {"type": "absolute", "value": 5368814045}, "count": 34}, {"address": {"type": "absolute", "value": 5368814050}, "count": 43}, {"address": {"type": "absolute", "value": 5368814055}, "count": 38}, {"address": {"type": "absolute", "value": 5368814060}, "count": 33}, {"address": {"type": "absolute", "value": 5368814065}, "count": 29}, {"address": {"type": "absolute", "value": 5368814075}, "count": 35}, {"address": {"type": "absolute", "value": 5368814090}, "count": 41}, {"address": {"type": "absolute", "value": 5368814100}, "count": 44}, {"address": {"type": "absolute", "value": 5368814110}, "count": 12}, {"address": {"type": "absolute", "value": 5368814130}, "count": 67}, {"address": {"type": "absolute", "value": 5368814135}, "count": 80}, {"address": {"type": "absolute", "value": 5368814145}, "count": 43}, {"address": {"type": "absolute", "value": 5368814160}, "count": 35}, {"address": {"type": "absolute", "value": 5368814165}, "count": 35}, {"address": {"type": "absolute", "value": 5368814175}, "count": 35}, {"address": {"type": "absolute", "value": 5368814180}, "count": 54}, {"address": {"type": "absolute", "value": 5368814195}, "count": 12}, {"address": {"type": "absolute", "value": 5368814200}, "count": 34}, {"address": {"type": "absolute", "value": 5368814205}, "count": 72}, {"address": {"type": "absolute", "value": 5368814210}, "count": 44}, {"address": {"type": "absolute", "value": 5368814215}, "count": 10}, {"address": {"type": "absolute", "value": 5368814225}, "count": 31}, {"address": {"type": "absolute", "value": 5368814230}, "count": 82}, {"address": {"type": "absolute", "value": 5368814235}, "count": 8}, {"address": {"type": "absolute", "value": 5368814240}, "count": 72}, {"address": {"type": "absolute", "value": 5368814250}, "count": 33}, {"address": {"type": "absolute", "value": 5368814255}, "count": 34}, {"address": {"type": "absolute", "value": 5368814260}, "count": 10}, {"address": {"type": "absolute", "value": 5368814270}, "count": 32}, {"address": {"type": "absolute", "value": 5368814275}, "count": 8}, {"address": {"type": "absolute", "value": 5368814290}, "count": 48}, {"address": {"type": "absolute", "value": 5368814295}, "count": 30}, {"address": {"type": "absolute", "value": 5368814300}, "count": 44}, {"address": {"type": "absolute", "value": 5368814305}, "count": 40}, {"address": {"type": "absolute", "value": 5368814310}, "count": 32}, {"address": {"type": "absolute", "value": 5368814315}, "count": 62}, {"address": {"type": "absolute", "value": 5368814325}, "count": 33}, {"address": {"type": "absolute", "value": 5368814330}, "count": 30}, {"address": {"type": "absolute", "value": 5368814335}, "count": 41}, {"address": {"type": "absolute", "value": 5368814340}, "count": 28}, {"address": {"type": "absolute", "value": 5368814345}, "count": 62}, {"address": {"type": "absolute", "value": 5368814355}, "count": 10}, {"address": {"type": "absolute", "value": 5368814360}, "count": 37}, {"address": {"type": "absolute", "value": 5368814365}, "count": 43}, {"address": {"type": "absolute", "value": 5368814375}, "count": 29}, {"address": {"type": "absolute", "value": 5368814390}, "count": 36}, {"address": {"type": "absolute", "value": 5368814400}, "count": 31}, {"address": {"type": "absolute", "value": 5368814405}, "count": 10}, {"address": {"type": "absolute", "value": 5368814410}, "count": 31}, {"address": {"type": "absolute", "value": 5368814415}, "count": 19}, {"address": {"type": "absolute", "value": 5368814425}, "count": 67}, {"address": {"type": "absolute", "value": 5368814435}, "count": 36}, {"address": {"type": "absolute", "value": 5368814440}, "count": 32}, {"address": {"type": "absolute", "value": 5368814445}, "count": 45}, {"address": {"type": "absolute", "value": 5368814450}, "count": 61}, {"address": {"type": "absolute", "value": 5368814455}, "count": 54}, {"address": {"type": "absolute", "value": 5368814460}, "count": 30}, {"address": {"type": "absolute", "value": 5368814465}, "count": 33}, {"address": {"type": "absolute", "value": 5368814470}, "count": 10}, {"address": {"type": "absolute", "value": 5368814485}, "count": 33}, {"address": {"type": "absolute", "value": 5368814490}, "count": 43}, {"address": {"type": "absolute", "value": 5368814495}, "count": 12}, {"address": {"type": "absolute", "value": 5368814500}, "count": 107}, {"address": {"type": "absolute", "value": 5368814520}, "count": 10}, {"address": {"type": "absolute", "value": 5368814530}, "count": 39}, {"address": {"type": "absolute", "value": 5368814540}, "count": 48}, {"address": {"type": "absolute", "value": 5368814545}, "count": 33}, {"address": {"type": "absolute", "value": 5368814550}, "count": 33}, {"address": {"type": "absolute", "value": 5368814555}, "count": 54}, {"address": {"type": "absolute", "value": 5368814560}, "count": 27}, {"address": {"type": "absolute", "value": 5368814585}, "count": 10}, {"address": {"type": "absolute", "value": 5368814590}, "count": 87}, {"address": {"type": "absolute", "value": 5368814600}, "count": 41}, {"address": {"type": "absolute", "value": 5368814605}, "count": 49}, {"address": {"type": "absolute", "value": 5368814615}, "count": 36}, {"address": {"type": "absolute", "value": 5368814620}, "count": 45}, {"address": {"type": "absolute", "value": 5368814630}, "count": 59}, {"address": {"type": "absolute", "value": 5368814640}, "count": 65}, {"address": {"type": "absolute", "value": 5368814645}, "count": 31}, {"address": {"type": "absolute", "value": 5368814650}, "count": 43}, {"address": {"type": "absolute", "value": 5368814665}, "count": 33}, {"address": {"type": "absolute", "value": 5368814680}, "count": 28}, {"address": {"type": "absolute", "value": 5368814685}, "count": 33}, {"address": {"type": "absolute", "value": 5368814690}, "count": 116}, {"address": {"type": "absolute", "value": 5368814695}, "count": 27}, {"address": {"type": "absolute", "value": 5368814700}, "count": 41}, {"address": {"type": "absolute", "value": 5368814705}, "count": 55}, {"address": {"type": "absolute", "value": 5368814710}, "count": 38}, {"address": {"type": "absolute", "value": 5368814715}, "count": 38}, {"address": {"type": "absolute", "value": 5368814720}, "count": 32}, {"address": {"type": "absolute", "value": 5368814725}, "count": 32}, {"address": {"type": "absolute", "value": 5368814730}, "count": 32}, {"address": {"type": "absolute", "value": 5368814735}, "count": 54}, {"address": {"type": "absolute", "value": 5368814740}, "count": 30}, {"address": {"type": "absolute", "value": 5368814745}, "count": 31}, {"address": {"type": "absolute", "value": 5368814750}, "count": 16}, {"address": {"type": "absolute", "value": 5368814755}, "count": 33}, {"address": {"type": "absolute", "value": 5368814760}, "count": 10}, {"address": {"type": "absolute", "value": 5368814765}, "count": 10}, {"address": {"type": "absolute", "value": 5368814775}, "count": 56}, {"address": {"type": "absolute", "value": 5368814780}, "count": 33}, {"address": {"type": "absolute", "value": 5368814790}, "count": 38}, {"address": {"type": "absolute", "value": 5368814795}, "count": 24}, {"address": {"type": "absolute", "value": 5368814800}, "count": 62}, {"address": {"type": "absolute", "value": 5368814810}, "count": 60}, {"address": {"type": "absolute", "value": 5368814815}, "count": 30}, {"address": {"type": "absolute", "value": 5368814820}, "count": 68}, {"address": {"type": "absolute", "value": 5368814830}, "count": 28}, {"address": {"type": "absolute", "value": 5368814835}, "count": 31}, {"address": {"type": "absolute", "value": 5368814850}, "count": 41}, {"address": {"type": "absolute", "value": 5368814855}, "count": 31}, {"address": {"type": "absolute", "value": 5368814865}, "count": 129}, {"address": {"type": "absolute", "value": 5368814870}, "count": 50}, {"address": {"type": "absolute", "value": 5368814875}, "count": 43}, {"address": {"type": "absolute", "value": 5368814880}, "count": 66}, {"address": {"type": "absolute", "value": 5368814890}, "count": 24}, {"address": {"type": "absolute", "value": 5368814895}, "count": 62}, {"address": {"type": "absolute", "value": 5368814900}, "count": 23}, {"address": {"type": "absolute", "value": 5368814905}, "count": 84}, {"address": {"type": "absolute", "value": 5368814910}, "count": 10}, {"address": {"type": "absolute", "value": 5368814925}, "count": 35}, {"address": {"type": "absolute", "value": 5368814935}, "count": 78}, {"address": {"type": "absolute", "value": 5368814940}, "count": 33}, {"address": {"type": "absolute", "value": 5368814945}, "count": 41}, {"address": {"type": "absolute", "value": 5368814955}, "count": 27}, {"address": {"type": "absolute", "value": 5368814960}, "count": 28}, {"address": {"type": "absolute", "value": 5368814965}, "count": 33}, {"address": {"type": "absolute", "value": 5368814970}, "count": 36}, {"address": {"type": "absolute", "value": 5368814980}, "count": 53}, {"address": {"type": "absolute", "value": 5368814985}, "count": 31}, {"address": {"type": "absolute", "value": 5368814990}, "count": 59}, {"address": {"type": "absolute", "value": 5368814995}, "count": 31}, {"address": {"type": "absolute", "value": 5368815005}, "count": 54}, {"address": {"type": "absolute", "value": 5368815010}, "count": 33}, {"address": {"type": "absolute", "value": 5368815025}, "count": 10}, {"address": {"type": "absolute", "value": 5368815040}, "count": 93}, {"address": {"type": "absolute", "value": 5368815045}, "count": 10}, {"address": {"type": "absolute", "value": 5368815050}, "count": 85}, {"address": {"type": "absolute", "value": 5368815055}, "count": 37}, {"address": {"type": "absolute", "value": 5368815060}, "count": 52}, {"address": {"type": "absolute", "value": 5368815070}, "count": 39}, {"address": {"type": "absolute", "value": 5368815085}, "count": 42}, {"address": {"type": "absolute", "value": 5368815090}, "count": 71}, {"address": {"type": "absolute", "value": 5368815100}, "count": 41}, {"address": {"type": "absolute", "value": 5368815105}, "count": 30}, {"address": {"type": "absolute", "value": 5368815115}, "count": 53}, {"address": {"type": "absolute", "value": 5368815125}, "count": 31}, {"address": {"type": "absolute", "value": 5368815130}, "count": 15}, {"address": {"type": "absolute", "value": 5368815135}, "count": 12}, {"address": {"type": "absolute", "value": 5368815140}, "count": 17}, {"address": {"type": "absolute", "value": 5368815145}, "count": 33}, {"address": {"type": "absolute", "value": 5368815150}, "count": 63}, {"address": {"type": "absolute", "value": 5368815160}, "count": 56}, {"address": {"type": "absolute", "value": 5368815165}, "count": 69}, {"address": {"type": "absolute", "value": 5368815170}, "count": 62}, {"address": {"type": "absolute", "value": 5368815175}, "count": 55}, {"address": {"type": "absolute", "value": 5368815180}, "count": 35}, {"address": {"type": "absolute", "value": 5368815185}, "count": 30}, {"address": {"type": "absolute", "value": 5368815190}, "count": 75}, {"address": {"type": "absolute", "value": 5368815195}, "count": 30}, {"address": {"type": "absolute", "value": 5368815200}, "count": 79}, {"address": {"type": "absolute", "value": 5368815205}, "count": 31}, {"address": {"type": "absolute", "value": 5368815210}, "count": 87}, {"address": {"type": "absolute", "value": 5368815215}, "count": 56}, {"address": {"type": "absolute", "value": 5368815225}, "count": 12}, {"address": {"type": "absolute", "value": 5368815230}, "count": 94}, {"address": {"type": "absolute", "value": 5368815240}, "count": 25}, {"address": {"type": "absolute", "value": 5368815245}, "count": 42}, {"address": {"type": "absolute", "value": 5368815250}, "count": 34}, {"address": {"type": "absolute", "value": 5368815255}, "count": 32}, {"address": {"type": "absolute", "value": 5368815260}, "count": 31}, {"address": {"type": "absolute", "value": 5368815265}, "count": 59}, {"address": {"type": "absolute", "value": 5368815270}, "count": 31}, {"address": {"type": "absolute", "value": 5368815280}, "count": 38}, {"address": {"type": "absolute", "value": 5368815290}, "count": 33}, {"address": {"type": "absolute", "value": 5368815300}, "count": 54}, {"address": {"type": "absolute", "value": 5368815305}, "count": 32}, {"address": {"type": "absolute", "value": 5368815310}, "count": 33}, {"address": {"type": "absolute", "value": 5368815315}, "count": 88}, {"address": {"type": "absolute", "value": 5368815320}, "count": 42}, {"address": {"type": "absolute", "value": 5368815325}, "count": 45}, {"address": {"type": "absolute", "value": 5368815335}, "count": 35}, {"address": {"type": "absolute", "value": 5368815340}, "count": 64}, {"address": {"type": "absolute", "value": 5368815350}, "count": 80}, {"address": {"type": "absolute", "value": 5368815360}, "count": 27}, {"address": {"type": "absolute", "value": 5368815365}, "count": 39}, {"address": {"type": "absolute", "value": 5368815370}, "count": 42}, {"address": {"type": "absolute", "value": 5368815380}, "count": 37}, {"address": {"type": "absolute", "value": 5368815385}, "count": 32}, {"address": {"type": "absolute", "value": 5368815390}, "count": 36}, {"address": {"type": "absolute", "value": 5368815400}, "count": 9}, {"address": {"type": "absolute", "value": 5368815415}, "count": 28}, {"address": {"type": "absolute", "value": 5368815435}, "count": 81}, {"address": {"type": "absolute", "value": 5368815440}, "count": 52}, {"address": {"type": "absolute", "value": 5368815450}, "count": 28}, {"address": {"type": "absolute", "value": 5368815460}, "count": 31}, {"address": {"type": "absolute", "value": 5368815470}, "count": 28}, {"address": {"type": "absolute", "value": 5368815475}, "count": 32}, {"address": {"type": "absolute", "value": 5368815480}, "count": 62}, {"address": {"type": "absolute", "value": 5368815490}, "count": 31}, {"address": {"type": "absolute", "value": 5368815495}, "count": 30}, {"address": {"type": "absolute", "value": 5368815500}, "count": 46}, {"address": {"type": "absolute", "value": 5368815505}, "count": 33}, {"address": {"type": "absolute", "value": 5368815510}, "count": 31}, {"address": {"type": "absolute", "value": 5368815515}, "count": 17}, {"address": {"type": "absolute", "value": 5368815520}, "count": 33}, {"address": {"type": "absolute", "value": 5368815525}, "count": 45}, {"address": {"type": "absolute", "value": 5368815530}, "count": 29}, {"address": {"type": "absolute", "value": 5368815535}, "count": 32}, {"address": {"type": "absolute", "value": 5368815550}, "count": 37}, {"address": {"type": "absolute", "value": 5368815555}, "count": 36}, {"address": {"type": "absolute", "value": 5368815570}, "count": 10}, {"address": {"type": "absolute", "value": 5368815575}, "count": 64}, {"address": {"type": "absolute", "value": 5368815585}, "count": 47}, {"address": {"type": "absolute", "value": 5368815590}, "count": 69}, {"address": {"type": "absolute", "value": 5368815595}, "count": 32}, {"address": {"type": "absolute", "value": 5368815600}, "count": 35}, {"address": {"type": "absolute", "value": 5368815610}, "count": 57}, {"address": {"type": "absolute", "value": 5368815615}, "count": 29}, {"address": {"type": "absolute", "value": 5368815625}, "count": 42}, {"address": {"type": "absolute", "value": 5368815630}, "count": 28}, {"address": {"type": "absolute", "value": 5368815635}, "count": 35}, {"address": {"type": "absolute", "value": 5368815640}, "count": 40}, {"address": {"type": "absolute", "value": 5368815645}, "count": 24}, {"address": {"type": "absolute", "value": 5368815655}, "count": 50}, {"address": {"type": "absolute", "value": 5368815660}, "count": 29}, {"address": {"type": "absolute", "value": 5368815670}, "count": 40}, {"address": {"type": "absolute", "value": 5368815675}, "count": 75}, {"address": {"type": "absolute", "value": 5368815680}, "count": 43}, {"address": {"type": "absolute", "value": 5368815685}, "count": 21}, {"address": {"type": "absolute", "value": 5368815690}, "count": 88}, {"address": {"type": "absolute", "value": 5368815700}, "count": 30}, {"address": {"type": "absolute", "value": 5368815705}, "count": 31}, {"address": {"type": "absolute", "value": 5368815715}, "count": 86}, {"address": {"type": "absolute", "value": 5368815720}, "count": 31}, {"address": {"type": "absolute", "value": 5368815725}, "count": 40}, {"address": {"type": "absolute", "value": 5368815735}, "count": 39}, {"address": {"type": "absolute", "value": 5368815745}, "count": 30}, {"address": {"type": "absolute", "value": 5368815755}, "count": 52}, {"address": {"type": "absolute", "value": 5368815765}, "count": 48}, {"address": {"type": "absolute", "value": 5368815770}, "count": 59}, {"address": {"type": "absolute", "value": 5368815775}, "count": 38}, {"address": {"type": "absolute", "value": 5368815780}, "count": 52}, {"address": {"type": "absolute", "value": 5368815785}, "count": 19}, {"address": {"type": "absolute", "value": 5368815795}, "count": 10}, {"address": {"type": "absolute", "value": 5368815805}, "count": 132}, {"address": {"type": "absolute", "value": 5368815820}, "count": 25}, {"address": {"type": "absolute", "value": 5368815830}, "count": 10}, {"address": {"type": "absolute", "value": 5368815835}, "count": 35}, {"address": {"type": "absolute", "value": 5368815850}, "count": 28}, {"address": {"type": "absolute", "value": 5368815855}, "count": 6}, {"address": {"type": "absolute", "value": 5368815865}, "count": 56}, {"address": {"type": "absolute", "value": 5368815870}, "count": 36}, {"address": {"type": "absolute", "value": 5368815880}, "count": 39}, {"address": {"type": "absolute", "value": 5368815890}, "count": 48}, {"address": {"type": "absolute", "value": 5368815895}, "count": 33}, {"address": {"type": "absolute", "value": 5368815900}, "count": 24}, {"address": {"type": "absolute", "value": 5368815905}, "count": 43}, {"address": {"type": "absolute", "value": 5368815910}, "count": 49}, {"address": {"type": "absolute", "value": 5368815920}, "count": 10}, {"address": {"type": "absolute", "value": 5368815925}, "count": 64}, {"address": {"type": "absolute", "value": 5368815930}, "count": 43}, {"address": {"type": "absolute", "value": 5368815940}, "count": 27}, {"address": {"type": "absolute", "value": 5368815945}, "count": 31}, {"address": {"type": "absolute", "value": 5368815955}, "count": 34}, {"address": {"type": "absolute", "value": 5368815960}, "count": 67}, {"address": {"type": "absolute", "value": 5368815965}, "count": 20}, {"address": {"type": "absolute", "value": 5368815970}, "count": 57}, {"address": {"type": "absolute", "value": 5368815975}, "count": 8}, {"address": {"type": "absolute", "value": 5368815980}, "count": 45}, {"address": {"type": "absolute", "value": 5368815985}, "count": 32}, {"address": {"type": "absolute", "value": 5368815990}, "count": 32}, {"address": {"type": "absolute", "value": 5368815995}, "count": 35}, {"address": {"type": "absolute", "value": 5368816000}, "count": 38}, {"address": {"type": "absolute", "value": 5368816005}, "count": 31}, {"address": {"type": "absolute", "value": 5368816010}, "count": 94}, {"address": {"type": "absolute", "value": 5368816015}, "count": 27}, {"address": {"type": "absolute", "value": 5368816020}, "count": 33}, {"address": {"type": "absolute", "value": 5368816025}, "count": 52}, {"address": {"type": "absolute", "value": 5368816040}, "count": 37}, {"address": {"type": "absolute", "value": 5368816045}, "count": 41}, {"address": {"type": "absolute", "value": 5368816055}, "count": 32}, {"address": {"type": "absolute", "value": 5368816060}, "count": 88}, {"address": {"type": "absolute", "value": 5368816065}, "count": 52}, {"address": {"type": "absolute", "value": 5368816070}, "count": 40}, {"address": {"type": "absolute", "value": 5368816080}, "count": 45}, {"address": {"type": "absolute", "value": 5368816085}, "count": 31}, {"address": {"type": "absolute", "value": 5368816095}, "count": 28}, {"address": {"type": "absolute", "value": 5368816100}, "count": 59}, {"address": {"type": "absolute", "value": 5368816105}, "count": 55}, {"address": {"type": "absolute", "value": 5368816110}, "count": 31}, {"address": {"type": "absolute", "value": 5368816120}, "count": 40}, {"address": {"type": "absolute", "value": 5368816125}, "count": 30}, {"address": {"type": "absolute", "value": 5368816135}, "count": 19}, {"address": {"type": "absolute", "value": 5368816145}, "count": 33}, {"address": {"type": "absolute", "value": 5368816155}, "count": 80}, {"address": {"type": "absolute", "value": 5368816160}, "count": 164}, {"address": {"type": "absolute", "value": 5368816165}, "count": 113}, {"address": {"type": "absolute", "value": 5368816170}, "count": 33}, {"address": {"type": "absolute", "value": 5368816180}, "count": 32}, {"address": {"type": "absolute", "value": 5368816185}, "count": 17}, {"address": {"type": "absolute", "value": 5368816195}, "count": 38}, {"address": {"type": "absolute", "value": 5368816205}, "count": 43}, {"address": {"type": "absolute", "value": 5368816215}, "count": 71}, {"address": {"type": "absolute", "value": 5368816220}, "count": 10}, {"address": {"type": "absolute", "value": 5368816225}, "count": 36}, {"address": {"type": "absolute", "value": 5368816230}, "count": 80}, {"address": {"type": "absolute", "value": 5368816235}, "count": 33}, {"address": {"type": "absolute", "value": 5368816240}, "count": 10}, {"address": {"type": "absolute", "value": 5368816245}, "count": 126}, {"address": {"type": "absolute", "value": 5368816250}, "count": 37}, {"address": {"type": "absolute", "value": 5368816265}, "count": 31}, {"address": {"type": "absolute", "value": 5368816270}, "count": 27}, {"address": {"type": "absolute", "value": 5368816275}, "count": 29}, {"address": {"type": "absolute", "value": 5368816280}, "count": 34}, {"address": {"type": "absolute", "value": 5368816290}, "count": 8}, {"address": {"type": "absolute", "value": 5368816295}, "count": 39}, {"address": {"type": "absolute", "value": 5368816310}, "count": 60}, {"address": {"type": "absolute", "value": 5368816320}, "count": 69}, {"address": {"type": "absolute", "value": 5368816335}, "count": 10}, {"address": {"type": "absolute", "value": 5368816340}, "count": 32}, {"address": {"type": "absolute", "value": 5368816345}, "count": 31}, {"address": {"type": "absolute", "value": 5368816355}, "count": 37}, {"address": {"type": "absolute", "value": 5368816360}, "count": 36}, {"address": {"type": "absolute", "value": 5368816365}, "count": 19}, {"address": {"type": "absolute", "value": 5368816375}, "count": 24}, {"address": {"type": "absolute", "value": 5368816380}, "count": 36}, {"address": {"type": "absolute", "value": 5368816385}, "count": 46}, {"address": {"type": "absolute", "value": 5368816400}, "count": 41}, {"address": {"type": "absolute", "value": 5368816405}, "count": 33}, {"address": {"type": "absolute", "value": 5368816415}, "count": 32}, {"address": {"type": "absolute", "value": 5368816420}, "count": 31}, {"address": {"type": "absolute", "value": 5368816425}, "count": 10}, {"address": {"type": "absolute", "value": 5368816430}, "count": 10}, {"address": {"type": "absolute", "value": 5368816445}, "count": 37}, {"address": {"type": "absolute", "value": 5368816450}, "count": 28}, {"address": {"type": "absolute", "value": 5368816455}, "count": 28}, {"address": {"type": "absolute", "value": 5368816460}, "count": 72}, {"address": {"type": "absolute", "value": 5368816465}, "count": 36}, {"address": {"type": "absolute", "value": 5368816470}, "count": 31}, {"address": {"type": "absolute", "value": 5368816480}, "count": 30}, {"address": {"type": "absolute", "value": 5368816485}, "count": 32}, {"address": {"type": "absolute", "value": 5368816490}, "count": 39}, {"address": {"type": "absolute", "value": 5368816495}, "count": 27}, {"address": {"type": "absolute", "value": 5368816500}, "count": 59}, {"address": {"type": "absolute", "value": 5368816505}, "count": 29}, {"address": {"type": "absolute", "value": 5368816510}, "count": 37}, {"address": {"type": "absolute", "value": 5368816515}, "count": 36}, {"address": {"type": "absolute", "value": 5368816525}, "count": 10}, {"address": {"type": "absolute", "value": 5368816530}, "count": 31}, {"address": {"type": "absolute", "value": 5368816540}, "count": 31}, {"address": {"type": "absolute", "value": 5368816545}, "count": 37}, {"address": {"type": "absolute", "value": 5368816550}, "count": 41}, {"address": {"type": "absolute", "value": 5368816555}, "count": 30}, {"address": {"type": "absolute", "value": 5368821600}, "count": 25}, {"address": {"type": "absolute", "value": 5368821728}, "count": 60}, {"address": {"type": "absolute", "value": 5368822176}, "count": 115}, {"address": {"type": "absolute", "value": 5368824096}, "count": 60}, {"address": {"type": "absolute", "value": 5368838672}, "count": 41}, {"address": {"type": "absolute", "value": 5368882832}, "count": 98}, {"address": {"type": "absolute", "value": 5368891376}, "count": 59}, {"address": {"type": "absolute", "value": 5368891792}, "count": 57}, {"address": {"type": "absolute", "value": 5368892096}, "count": 44}, {"address": {"type": "absolute", "value": 5368892304}, "count": 43}, {"address": {"type": "absolute", "value": 5368909136}, "count": 46}, {"address": {"type": "absolute", "value": 5368960864}, "count": 59}, {"address": {"type": "absolute", "value": 5368963056}, "count": 39}, {"address": {"type": "absolute", "value": 5368964112}, "count": 53}, {"address": {"type": "absolute", "value": 5368964496}, "count": 43}, {"address": {"type": "absolute", "value": 5368971776}, "count": 31}, {"address": {"type": "absolute", "value": 5368971888}, "count": 29}, {"address": {"type": "absolute", "value": 5368986896}, "count": 59}, {"address": {"type": "absolute", "value": 5368987312}, "count": 57}, {"address": {"type": "absolute", "value": 5368988000}, "count": 44}, {"address": {"type": "absolute", "value": 5368988208}, "count": 43}, {"address": {"type": "absolute", "value": 5369037280}, "count": 21}]}, "library_functions": [{"address": {"type": "absolute", "value": 5369005504}, "name": "?find_pe_section@@YAPEAU_IMAGE_SECTION_HEADER@@QEAE_K@Z"}, {"address": {"type": "absolute", "value": 5369005792}, "name": "?is_potentially_valid_image_base@@YA_NQEAX@Z"}, {"address": {"type": "absolute", "value": 5369008832}, "name": "?"}, {"address": {"type": "absolute", "value": 5369009024}, "name": "?"}, {"address": {"type": "absolute", "value": 5369009248}, "name": "?pre_c_initialization@@YAHXZ"}, {"address": {"type": "absolute", "value": 5369009472}, "name": "mbedtls_des_setkey_enc"}, {"address": {"type": "absolute", "value": 5369009504}, "name": "?pre_cpp_initialization@@YAXXZ"}, {"address": {"type": "absolute", "value": 5369009536}, "name": "?__scrt_common_main@@YAHXZ"}, {"address": {"type": "absolute", "value": 5369009568}, "name": "?__scrt_common_main_seh@@YAHXZ"}, {"address": {"type": "absolute", "value": 5369010096}, "name": "?invoke_main@@YAHXZ"}, {"address": {"type": "absolute", "value": 5369010320}, "name": "?DebuggerProbe@@YA_NK@Z"}, {"address": {"type": "absolute", "value": 5369010400}, "name": "?DebuggerRuntime@@YA_NKHPEAXPEB_W@Z"}, {"address": {"type": "absolute", "value": 5369011536}, "name": "?_strlen_priv@@YA_KPEBD@Z"}, {"address": {"type": "absolute", "value": 5369011568}, "name": "?failwithmessage@@YAXPEAXHHPEBD@Z"}, {"address": {"type": "absolute", "value": 5369012336}, "name": "?notify_debugger@@YAXAEBUtagEXCEPTION_VISUALCPP_DEBUG_INFO@@@Z"}, {"address": {"type": "absolute", "value": 5369016608}, "name": "__get_entropy"}, {"address": {"type": "absolute", "value": 5369017584}, "name": "?GetPdbDll@@YAPEAUHINSTANCE__@@XZ"}, {"address": {"type": "absolute", "value": 5369018000}, "name": "?GetPdbDllFromInstallPath@@YAPEAUHINSTANCE__@@XZ"}, {"address": {"type": "absolute", "value": 5369018864}, "name": "?GetPdbDllPathFromFilePath@@YAHPEB_WPEA_W_K@Z"}]}}, "rules": {"calculate modulo 256 via x86 assembly": {"meta": {"name": "calculate modulo 256 via x86 assembly", "authors": ["moritz.raabe@mandiant.com"], "scope": "instruction", "attack": [], "mbc": [{"parts": ["Data", "Modulo"], "objective": "Data", "behavior": "Modulo", "method": "", "id": "C0058"}], "references": [], "examples": ["9324D1A8AE37A36AE560C37448C9705A:0x4049A9"], "description": "", "lib": true, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: calculate modulo 256 via x86 assembly\n    authors:\n      - moritz.raabe@mandiant.com\n    lib: true\n    scope: instruction\n    mbc:\n      - Data::Modulo [C0058]\n    examples:\n      - 9324D1A8AE37A36AE560C37448C9705A:0x4049A9\n  features:\n    #  and ecx, 800000FFh\n    #  and ecx, 0FFh\n    - and:\n      - mnemonic: and\n      - or:\n        - number: 0x800000FF\n        - number: 0xFF\n", "matches": [[{"type": "absolute", "value": 5368911666}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "mnemonic", "mnemonic": "and"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368911666}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "number", "number": 2147483903}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 255}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368911666}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "reference absolute stream path on Windows": {"meta": {"name": "reference absolute stream path on Windows", "namespace": "host-interaction/file-system", "authors": ["blas.kojusner@mandiant.com", "william.ballenthin@mandiant.com"], "scope": "basic block", "attack": [], "mbc": [], "references": ["https://learn.microsoft.com/en-us/windows/win32/fileio/file-streams"], "examples": ["51828683DC26BFABD3994494099AE97D:0x11A9"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: reference absolute stream path on Windows\n    namespace: host-interaction/file-system\n    authors:\n      - blas.kojusner@mandiant.com\n      - william.ballenthin@mandiant.com\n    scope: basic block\n    references:\n      - https://learn.microsoft.com/en-us/windows/win32/fileio/file-streams\n    examples:\n      - 51828683DC26BFABD3994494099AE97D:0x11A9\n  features:\n    - and:\n      - string: /^(..\\?\\\\)?([\\w]\\:|\\\\)(\\\\+((?![\\<\\>\\\"\\/\\|\\*\\?\\:\\\\])[\\x20-\\x5B\\x5D-\\x7E])+)+(\\:\\$?([a-zA-Z0-9_]+))?/\n        # ^(..\\?\\\\)? -> Check for path starting with \"\\\\?\\\"\n        # ([\\w]\\:|\\\\) -> Check for absolute path beginning\n        # (\\\\+((?![\\<\\>\\\"\\/\\|\\*\\?\\:\\\\])[\\x20-\\x5B\\x5D-\\x7E])+)+ -> Check for valid path and filename\n        #   \\\\+ -> Check for at least one backslash path separator\n        #   (?![\\<\\>\\\"\\/\\|\\*\\?\\:\\\\]) -> path component must not start with <, >, \", ...\n        #   [\\x20-\\x5B\\x5D-\\x7E] -> path component must be printable ASCII, except backslash path separator\n        # : -> Check for start of stream filename\n        # \\$?([a-zA-Z0-9_]+))? -> Check for valid stream filename\n        ### Example Matches:\n        ### \\\\\\\\server\\share\\\\file:stream\n        ### \\\\\\\\server\\share\\dir.ext\\\\file.ext:stream \n        ### \\\\\\\\server\\share\\dir.ext\\\\file.tar.gz:stream\n        ### \\\\\\\\server\\share\\dir.ext\\\\file:stream.tar.gz\n        ### \\\\\\\\server\\share\\dir\\\\file.ext:stream.ext\n        ### \\\\\\\\?\\C:\\dir1\\dir2\\\\file:stream\n        ### C:\\dir\\\\file:stream.ext\n        ### C:\\dir\\\\file:}{+,.';[]-=-0987654321`~!@#$%^&()_+-.ext\n", "matches": [[{"type": "absolute", "value": 5368959757}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "regex", "regex": "/^(..\\?\\\\)?([\\w]\\:|\\\\)(\\\\+((?![\\<\\>\\\"\\/\\|\\*\\?\\:\\\\])[\\x20-\\x5B\\x5D-\\x7E])+)+(\\:\\$?([a-zA-Z0-9_]+))?/"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368959769}], "captures": {"C:\\Users\\spring\\Desktop\\al-khaser-master\\al-khaser\\Shared\\APIs.cpp": [{"type": "absolute", "value": 5368959769}]}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368960000}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "regex", "regex": "/^(..\\?\\\\)?([\\w]\\:|\\\\)(\\\\+((?![\\<\\>\\\"\\/\\|\\*\\?\\:\\\\])[\\x20-\\x5B\\x5D-\\x7E])+)+(\\:\\$?([a-zA-Z0-9_]+))?/"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368960012}], "captures": {"C:\\Users\\spring\\Desktop\\al-khaser-master\\al-khaser\\Shared\\APIs.cpp": [{"type": "absolute", "value": 5368960012}]}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368905952}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "regex", "regex": "/^(..\\?\\\\)?([\\w]\\:|\\\\)(\\\\+((?![\\<\\>\\\"\\/\\|\\*\\?\\:\\\\])[\\x20-\\x5B\\x5D-\\x7E])+)+(\\:\\$?([a-zA-Z0-9_]+))?/"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368905985}], "captures": {"C:\\Program Files (x86)\\Microsoft Visual Studio\\2019\\Professional\\VC\\Tools\\MSVC\\14.22.27905\\include\\vector": [{"type": "absolute", "value": 5368905985}]}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368906011}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "regex", "regex": "/^(..\\?\\\\)?([\\w]\\:|\\\\)(\\\\+((?![\\<\\>\\\"\\/\\|\\*\\?\\:\\\\])[\\x20-\\x5B\\x5D-\\x7E])+)+(\\:\\$?([a-zA-Z0-9_]+))?/"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368906026}], "captures": {"C:\\Program Files (x86)\\Microsoft Visual Studio\\2019\\Professional\\VC\\Tools\\MSVC\\14.22.27905\\include\\vector": [{"type": "absolute", "value": 5368906026}]}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368945360}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "regex", "regex": "/^(..\\?\\\\)?([\\w]\\:|\\\\)(\\\\+((?![\\<\\>\\\"\\/\\|\\*\\?\\:\\\\])[\\x20-\\x5B\\x5D-\\x7E])+)+(\\:\\$?([a-zA-Z0-9_]+))?/"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368945419}, {"type": "absolute", "value": 5368945430}], "captures": {"\\\\.\\HGFS": [{"type": "absolute", "value": 5368945419}], "\\\\.\\vmci": [{"type": "absolute", "value": 5368945430}]}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368853061}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "regex", "regex": "/^(..\\?\\\\)?([\\w]\\:|\\\\)(\\\\+((?![\\<\\>\\\"\\/\\|\\*\\?\\:\\\\])[\\x20-\\x5B\\x5D-\\x7E])+)+(\\:\\$?([a-zA-Z0-9_]+))?/"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368853100}], "captures": {"C:\\Program Files (x86)\\Microsoft Visual Studio\\2019\\Professional\\VC\\Tools\\MSVC\\14.22.27905\\include\\xmemory": [{"type": "absolute", "value": 5368853100}]}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368853126}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "regex", "regex": "/^(..\\?\\\\)?([\\w]\\:|\\\\)(\\\\+((?![\\<\\>\\\"\\/\\|\\*\\?\\:\\\\])[\\x20-\\x5B\\x5D-\\x7E])+)+(\\:\\$?([a-zA-Z0-9_]+))?/"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368853147}], "captures": {"C:\\Program Files (x86)\\Microsoft Visual Studio\\2019\\Professional\\VC\\Tools\\MSVC\\14.22.27905\\include\\xmemory": [{"type": "absolute", "value": 5368853147}]}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368853235}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "regex", "regex": "/^(..\\?\\\\)?([\\w]\\:|\\\\)(\\\\+((?![\\<\\>\\\"\\/\\|\\*\\?\\:\\\\])[\\x20-\\x5B\\x5D-\\x7E])+)+(\\:\\$?([a-zA-Z0-9_]+))?/"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368853274}], "captures": {"C:\\Program Files (x86)\\Microsoft Visual Studio\\2019\\Professional\\VC\\Tools\\MSVC\\14.22.27905\\include\\xmemory": [{"type": "absolute", "value": 5368853274}]}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368853300}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "regex", "regex": "/^(..\\?\\\\)?([\\w]\\:|\\\\)(\\\\+((?![\\<\\>\\\"\\/\\|\\*\\?\\:\\\\])[\\x20-\\x5B\\x5D-\\x7E])+)+(\\:\\$?([a-zA-Z0-9_]+))?/"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368853321}], "captures": {"C:\\Program Files (x86)\\Microsoft Visual Studio\\2019\\Professional\\VC\\Tools\\MSVC\\14.22.27905\\include\\xmemory": [{"type": "absolute", "value": 5368853321}]}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368959159}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "regex", "regex": "/^(..\\?\\\\)?([\\w]\\:|\\\\)(\\\\+((?![\\<\\>\\\"\\/\\|\\*\\?\\:\\\\])[\\x20-\\x5B\\x5D-\\x7E])+)+(\\:\\$?([a-zA-Z0-9_]+))?/"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368959171}], "captures": {"C:\\Users\\spring\\Desktop\\al-khaser-master\\al-khaser\\Shared\\APIs.cpp": [{"type": "absolute", "value": 5368959171}]}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368965144}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "regex", "regex": "/^(..\\?\\\\)?([\\w]\\:|\\\\)(\\\\+((?![\\<\\>\\\"\\/\\|\\*\\?\\:\\\\])[\\x20-\\x5B\\x5D-\\x7E])+)+(\\:\\$?([a-zA-Z0-9_]+))?/"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368965177}], "captures": {"C:\\Program Files (x86)\\Microsoft Visual Studio\\2019\\Professional\\VC\\Tools\\MSVC\\14.22.27905\\include\\xstring": [{"type": "absolute", "value": 5368965177}]}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368965203}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "regex", "regex": "/^(..\\?\\\\)?([\\w]\\:|\\\\)(\\\\+((?![\\<\\>\\\"\\/\\|\\*\\?\\:\\\\])[\\x20-\\x5B\\x5D-\\x7E])+)+(\\:\\$?([a-zA-Z0-9_]+))?/"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368965218}], "captures": {"C:\\Program Files (x86)\\Microsoft Visual Studio\\2019\\Professional\\VC\\Tools\\MSVC\\14.22.27905\\include\\xstring": [{"type": "absolute", "value": 5368965218}]}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368905536}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "regex", "regex": "/^(..\\?\\\\)?([\\w]\\:|\\\\)(\\\\+((?![\\<\\>\\\"\\/\\|\\*\\?\\:\\\\])[\\x20-\\x5B\\x5D-\\x7E])+)+(\\:\\$?([a-zA-Z0-9_]+))?/"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368905569}], "captures": {"C:\\Program Files (x86)\\Microsoft Visual Studio\\2019\\Professional\\VC\\Tools\\MSVC\\14.22.27905\\include\\vector": [{"type": "absolute", "value": 5368905569}]}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368905595}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "regex", "regex": "/^(..\\?\\\\)?([\\w]\\:|\\\\)(\\\\+((?![\\<\\>\\\"\\/\\|\\*\\?\\:\\\\])[\\x20-\\x5B\\x5D-\\x7E])+)+(\\:\\$?([a-zA-Z0-9_]+))?/"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368905610}], "captures": {"C:\\Program Files (x86)\\Microsoft Visual Studio\\2019\\Professional\\VC\\Tools\\MSVC\\14.22.27905\\include\\vector": [{"type": "absolute", "value": 5368905610}]}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368958453}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "regex", "regex": "/^(..\\?\\\\)?([\\w]\\:|\\\\)(\\\\+((?![\\<\\>\\\"\\/\\|\\*\\?\\:\\\\])[\\x20-\\x5B\\x5D-\\x7E])+)+(\\:\\$?([a-zA-Z0-9_]+))?/"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368958465}], "captures": {"C:\\Users\\spring\\Desktop\\al-khaser-master\\al-khaser\\Shared\\APIs.cpp": [{"type": "absolute", "value": 5368958465}]}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368935120}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "regex", "regex": "/^(..\\?\\\\)?([\\w]\\:|\\\\)(\\\\+((?![\\<\\>\\\"\\/\\|\\*\\?\\:\\\\])[\\x20-\\x5B\\x5D-\\x7E])+)+(\\:\\$?([a-zA-Z0-9_]+))?/"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368935201}, {"type": "absolute", "value": 5368935190}, {"type": "absolute", "value": 5368935223}, {"type": "absolute", "value": 5368935179}, {"type": "absolute", "value": 5368935212}], "captures": {"\\\\.\\VBoxMiniRdrDN": [{"type": "absolute", "value": 5368935179}], "\\\\.\\VBoxGuest": [{"type": "absolute", "value": 5368935190}], "\\\\.\\pipe\\VBoxMiniRdDN": [{"type": "absolute", "value": 5368935201}], "\\\\.\\VBoxTrayIPC": [{"type": "absolute", "value": 5368935212}], "\\\\.\\pipe\\VBoxTrayIPC": [{"type": "absolute", "value": 5368935223}]}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368919549}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "regex", "regex": "/^(..\\?\\\\)?([\\w]\\:|\\\\)(\\\\+((?![\\<\\>\\\"\\/\\|\\*\\?\\:\\\\])[\\x20-\\x5B\\x5D-\\x7E])+)+(\\:\\$?([a-zA-Z0-9_]+))?/"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368919578}], "captures": {"\\\\.\\%C:": [{"type": "absolute", "value": 5368919578}]}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368919896}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "regex", "regex": "/^(..\\?\\\\)?([\\w]\\:|\\\\)(\\\\+((?![\\<\\>\\\"\\/\\|\\*\\?\\:\\\\])[\\x20-\\x5B\\x5D-\\x7E])+)+(\\:\\$?([a-zA-Z0-9_]+))?/"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368919918}], "captures": {"\\\\.\\PhysicalDrive%u": [{"type": "absolute", "value": 5368919918}]}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368920205}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "regex", "regex": "/^(..\\?\\\\)?([\\w]\\:|\\\\)(\\\\+((?![\\<\\>\\\"\\/\\|\\*\\?\\:\\\\])[\\x20-\\x5B\\x5D-\\x7E])+)+(\\:\\$?([a-zA-Z0-9_]+))?/"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368920244}], "captures": {"\\\\.\\PhysicalDrive0": [{"type": "absolute", "value": 5368920244}]}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368966703}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "regex", "regex": "/^(..\\?\\\\)?([\\w]\\:|\\\\)(\\\\+((?![\\<\\>\\\"\\/\\|\\*\\?\\:\\\\])[\\x20-\\x5B\\x5D-\\x7E])+)+(\\:\\$?([a-zA-Z0-9_]+))?/"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368966772}], "captures": {"C:\\Users\\spring\\Desktop\\al-khaser-master\\al-khaser\\Shared\\Common.cpp": [{"type": "absolute", "value": 5368966772}]}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368845680}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "regex", "regex": "/^(..\\?\\\\)?([\\w]\\:|\\\\)(\\\\+((?![\\<\\>\\\"\\/\\|\\*\\?\\:\\\\])[\\x20-\\x5B\\x5D-\\x7E])+)+(\\:\\$?([a-zA-Z0-9_]+))?/"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368845713}], "captures": {"C:\\Program Files (x86)\\Microsoft Visual Studio\\2019\\Professional\\VC\\Tools\\MSVC\\14.22.27905\\include\\xmemory": [{"type": "absolute", "value": 5368845713}]}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368845739}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "regex", "regex": "/^(..\\?\\\\)?([\\w]\\:|\\\\)(\\\\+((?![\\<\\>\\\"\\/\\|\\*\\?\\:\\\\])[\\x20-\\x5B\\x5D-\\x7E])+)+(\\:\\$?([a-zA-Z0-9_]+))?/"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368845754}], "captures": {"C:\\Program Files (x86)\\Microsoft Visual Studio\\2019\\Professional\\VC\\Tools\\MSVC\\14.22.27905\\include\\xmemory": [{"type": "absolute", "value": 5368845754}]}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368965660}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "regex", "regex": "/^(..\\?\\\\)?([\\w]\\:|\\\\)(\\\\+((?![\\<\\>\\\"\\/\\|\\*\\?\\:\\\\])[\\x20-\\x5B\\x5D-\\x7E])+)+(\\:\\$?([a-zA-Z0-9_]+))?/"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368965693}], "captures": {"C:\\Program Files (x86)\\Microsoft Visual Studio\\2019\\Professional\\VC\\Tools\\MSVC\\14.22.27905\\include\\xmemory": [{"type": "absolute", "value": 5368965693}]}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368965720}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "regex", "regex": "/^(..\\?\\\\)?([\\w]\\:|\\\\)(\\\\+((?![\\<\\>\\\"\\/\\|\\*\\?\\:\\\\])[\\x20-\\x5B\\x5D-\\x7E])+)+(\\:\\$?([a-zA-Z0-9_]+))?/"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368965735}], "captures": {"C:\\Program Files (x86)\\Microsoft Visual Studio\\2019\\Professional\\VC\\Tools\\MSVC\\14.22.27905\\include\\xmemory": [{"type": "absolute", "value": 5368965735}]}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368966232}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "regex", "regex": "/^(..\\?\\\\)?([\\w]\\:|\\\\)(\\\\+((?![\\<\\>\\\"\\/\\|\\*\\?\\:\\\\])[\\x20-\\x5B\\x5D-\\x7E])+)+(\\:\\$?([a-zA-Z0-9_]+))?/"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368966265}], "captures": {"C:\\Program Files (x86)\\Microsoft Visual Studio\\2019\\Professional\\VC\\Tools\\MSVC\\14.22.27905\\include\\xstring": [{"type": "absolute", "value": 5368966265}]}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368966291}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "regex", "regex": "/^(..\\?\\\\)?([\\w]\\:|\\\\)(\\\\+((?![\\<\\>\\\"\\/\\|\\*\\?\\:\\\\])[\\x20-\\x5B\\x5D-\\x7E])+)+(\\:\\$?([a-zA-Z0-9_]+))?/"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368966306}], "captures": {"C:\\Program Files (x86)\\Microsoft Visual Studio\\2019\\Professional\\VC\\Tools\\MSVC\\14.22.27905\\include\\xstring": [{"type": "absolute", "value": 5368966306}]}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368966375}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "regex", "regex": "/^(..\\?\\\\)?([\\w]\\:|\\\\)(\\\\+((?![\\<\\>\\\"\\/\\|\\*\\?\\:\\\\])[\\x20-\\x5B\\x5D-\\x7E])+)+(\\:\\$?([a-zA-Z0-9_]+))?/"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368966408}], "captures": {"C:\\Program Files (x86)\\Microsoft Visual Studio\\2019\\Professional\\VC\\Tools\\MSVC\\14.22.27905\\include\\xstring": [{"type": "absolute", "value": 5368966408}]}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368966434}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "regex", "regex": "/^(..\\?\\\\)?([\\w]\\:|\\\\)(\\\\+((?![\\<\\>\\\"\\/\\|\\*\\?\\:\\\\])[\\x20-\\x5B\\x5D-\\x7E])+)+(\\:\\$?([a-zA-Z0-9_]+))?/"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368966449}], "captures": {"C:\\Program Files (x86)\\Microsoft Visual Studio\\2019\\Professional\\VC\\Tools\\MSVC\\14.22.27905\\include\\xstring": [{"type": "absolute", "value": 5368966449}]}}], "locations": [], "captures": {}}]]}, "delay execution": {"meta": {"name": "delay execution", "authors": ["michael.hunhoff@mandiant.com", "@ramen0x3f"], "scope": "basic block", "attack": [], "mbc": [{"parts": ["Anti-Behavioral Analysis", "Dynamic Analysis Evasion", "Delayed Execution"], "objective": "Anti-Behavioral Analysis", "behavior": "Dynamic Analysis Evasion", "method": "Delayed Execution", "id": "B0003.003"}], "references": ["https://docs.microsoft.com/en-us/windows/win32/sync/wait-functions", "https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/TimingAttacks/timing.cpp"], "examples": ["al-khaser_x86.exe_:0x449770", "B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x402FA6"], "description": "", "lib": true, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: delay execution\n    authors:\n      - michael.hunhoff@mandiant.com\n      - \"@ramen0x3f\"\n    lib: true\n    scope: basic block\n    mbc:\n      - Anti-Behavioral Analysis::Dynamic Analysis Evasion::Delayed Execution [B0003.003]\n    references:\n      - https://docs.microsoft.com/en-us/windows/win32/sync/wait-functions\n      - https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/TimingAttacks/timing.cpp\n    examples:\n      - al-khaser_x86.exe_:0x449770\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x402FA6\n  features:\n    - or:\n      - and:\n        - os: windows\n        - or:\n          - api: kernel32.Sleep\n          - api: kernel32.SleepEx\n          - api: kernel32.WaitForSingleObject\n          - api: kernel32.SignalObjectAndWait\n          - api: kernel32.WaitForSingleObjectEx\n          - api: kernel32.WaitForMultipleObjects\n          - api: kernel32.WaitForMultipleObjectsEx\n          - api: kernel32.RegisterWaitForSingleObject\n          - api: WaitOnAddress\n          - api: user32.MsgWaitForMultipleObjects\n          - api: user32.MsgWaitForMultipleObjectsEx\n          - api: NtDelayExecution\n          - api: KeWaitForSingleObject\n          - api: KeDelayExecutionThread\n      - and:\n        - os: linux\n        - or:\n          - api: sleep\n          - api: usleep\n", "matches": [[{"type": "absolute", "value": 5368924448}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "os", "os": "linux"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "sleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "usleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.Sleep"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368924554}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SleepEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SignalObjectAndWait"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObjectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.RegisterWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "WaitOnAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtDelayExecution"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeDelayExecutionThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368952779}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "os", "os": "linux"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "sleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "usleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.Sleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SleepEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368952803}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SignalObjectAndWait"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObjectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.RegisterWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "WaitOnAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtDelayExecution"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeDelayExecutionThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368844166}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "os", "os": "linux"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "sleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "usleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.Sleep"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368844171}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SleepEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SignalObjectAndWait"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObjectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.RegisterWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "WaitOnAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtDelayExecution"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeDelayExecutionThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368914432}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "os", "os": "linux"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "sleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "usleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.Sleep"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368914514}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SleepEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SignalObjectAndWait"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObjectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.RegisterWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "WaitOnAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtDelayExecution"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeDelayExecutionThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5369002064}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "os", "os": "linux"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "sleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "usleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.Sleep"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5369002067}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SleepEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SignalObjectAndWait"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObjectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.RegisterWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "WaitOnAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtDelayExecution"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeDelayExecutionThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368951296}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "os", "os": "linux"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "sleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "usleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.Sleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SleepEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368951317}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SignalObjectAndWait"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObjectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.RegisterWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "WaitOnAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtDelayExecution"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeDelayExecutionThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5369000118}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "os", "os": "linux"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "sleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "usleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.Sleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SleepEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5369000134}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SignalObjectAndWait"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObjectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.RegisterWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "WaitOnAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtDelayExecution"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeDelayExecutionThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5369000497}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "os", "os": "linux"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "sleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "usleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.Sleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SleepEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5369000506}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SignalObjectAndWait"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObjectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.RegisterWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "WaitOnAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtDelayExecution"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeDelayExecutionThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368908237}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "os", "os": "linux"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "sleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "usleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.Sleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SleepEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368908249}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SignalObjectAndWait"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObjectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.RegisterWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "WaitOnAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtDelayExecution"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeDelayExecutionThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368908692}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "os", "os": "linux"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "sleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "usleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.Sleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SleepEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368908704}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SignalObjectAndWait"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObjectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.RegisterWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "WaitOnAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtDelayExecution"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeDelayExecutionThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5369001893}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "os", "os": "linux"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "sleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "usleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.Sleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SleepEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5369001903}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SignalObjectAndWait"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObjectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.RegisterWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "WaitOnAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtDelayExecution"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeDelayExecutionThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368955764}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "os", "os": "linux"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "sleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "usleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.Sleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SleepEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368955788}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SignalObjectAndWait"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObjectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.RegisterWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "WaitOnAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtDelayExecution"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeDelayExecutionThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "open process": {"meta": {"name": "open process", "authors": ["0x534a@mailbox.org"], "scope": "basic block", "attack": [], "mbc": [{"parts": ["Process", "Open Process"], "objective": "Process", "behavior": "Open Process", "method": "", "id": "C0065"}], "references": [], "examples": ["Practical Malware Analysis Lab 17-02.dll_:0x1000D10D"], "description": "", "lib": true, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: open process\n    authors:\n      - 0x534a@mailbox.org\n    lib: true\n    scope: basic block\n    mbc:\n      - Process::Open Process [C0065]\n    examples:\n      - Practical Malware Analysis Lab 17-02.dll_:0x1000D10D\n  features:\n    - or:\n      - api: kernel32.OpenProcess\n      - api: NtOpenProcess\n      - api: ZwOpenProcess\n", "matches": [[{"type": "absolute", "value": 5368951918}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.OpenProcess"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368951944}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtOpenProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368863684}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.OpenProcess"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368863698}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtOpenProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368953892}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.OpenProcess"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368953943}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtOpenProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368950804}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.OpenProcess"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368950815}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtOpenProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368993008}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.OpenProcess"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368993126}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtOpenProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368906656}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.OpenProcess"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368906713}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtOpenProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368955014}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.OpenProcess"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368955040}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtOpenProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "allocate memory": {"meta": {"name": "allocate memory", "authors": ["0x534a@mailbox.org"], "scope": "basic block", "attack": [], "mbc": [{"parts": ["Memory", "Allocate Memory"], "objective": "Memory", "behavior": "Allocate Memory", "method": "", "id": "C0007"}], "references": [], "examples": ["Practical Malware Analysis Lab 03-03.exe_:0x4010EA", "563653399B82CD443F120ECEFF836EA3678D4CF11D9B351BB737573C2D856299:0x140001ABA"], "description": "", "lib": true, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: allocate memory\n    authors:\n      - 0x534a@mailbox.org\n    lib: true\n    scope: basic block\n    mbc:\n      - Memory::Allocate Memory [C0007]\n    examples:\n      - Practical Malware Analysis Lab 03-03.exe_:0x4010EA\n      # ntdll\n      - 563653399B82CD443F120ECEFF836EA3678D4CF11D9B351BB737573C2D856299:0x140001ABA\n  features:\n    - or:\n      - api: kernel32.VirtualAlloc\n      - api: kernel32.VirtualAllocEx\n      - api: kernel32.VirtualAllocExNuma\n      - api: kernel32.VirtualProtect\n      - api: kernel32.VirtualProtectEx\n      - api: NtAllocateVirtualMemory\n      - api: ZwAllocateVirtualMemory\n      - api: NtMapViewOfSection\n      - api: ZwMapViewOfSection\n", "matches": [[{"type": "absolute", "value": 5368952263}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAlloc"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocEx"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368952388}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocExNuma"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtect"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368953985}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAlloc"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocEx"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368954085}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocExNuma"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtect"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368911264}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAlloc"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368911349}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocExNuma"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtect"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368911394}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAlloc"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368911413}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocExNuma"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtect"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368839184}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAlloc"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368839314}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocExNuma"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtect"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368839341}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAlloc"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocExNuma"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtect"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368839386}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368950968}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAlloc"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocEx"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368951096}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocExNuma"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtect"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368910688}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAlloc"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368910773}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocExNuma"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtect"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368910818}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAlloc"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368910837}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocExNuma"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtect"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368838128}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAlloc"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368838196}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocExNuma"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtect"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368909568}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAlloc"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368909660}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocExNuma"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtect"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368909711}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAlloc"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368909730}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocExNuma"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtect"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368841536}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAlloc"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368841679}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocExNuma"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtect"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368913856}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAlloc"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocExNuma"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtect"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368913965}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368912320}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAlloc"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368912405}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocExNuma"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtect"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368912450}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAlloc"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368912469}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocExNuma"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtect"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368955356}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAlloc"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocEx"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368955481}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocExNuma"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtect"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "allocate RW memory": {"meta": {"name": "allocate RW memory", "authors": ["0x534a@mailbox.org"], "scope": "basic block", "attack": [], "mbc": [{"parts": ["Memory", "Allocate Memory"], "objective": "Memory", "behavior": "Allocate Memory", "method": "", "id": "C0007"}], "references": [], "examples": ["Practical Malware Analysis Lab 17-02.dll_:0x1000D10D"], "description": "", "lib": true, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: allocate RW memory\n    authors:\n      - 0x534a@mailbox.org\n    lib: true\n    scope: basic block\n    mbc:\n      - Memory::Allocate Memory [C0007]\n    examples:\n      - Practical Malware Analysis Lab 17-02.dll_:0x1000D10D\n  features:\n    - and:\n      - match: allocate memory\n      - number: 0x4 = PAGE_READWRITE\n", "matches": [[{"type": "absolute", "value": 5368952263}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "allocate memory"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAlloc"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocEx"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368952388}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocExNuma"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtect"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 5368952263}], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 4, "description": "PAGE_READWRITE"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368952361}], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368953985}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "allocate memory"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAlloc"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocEx"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368954085}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocExNuma"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtect"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 5368953985}], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 4, "description": "PAGE_READWRITE"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368954055}], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368911264}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "allocate memory"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAlloc"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368911349}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocExNuma"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtect"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 5368911264}], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 4, "description": "PAGE_READWRITE"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368911330}], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368950968}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "allocate memory"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAlloc"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocEx"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368951096}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocExNuma"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtect"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 5368950968}], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 4, "description": "PAGE_READWRITE"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368951069}], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368910688}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "allocate memory"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAlloc"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368910773}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocExNuma"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtect"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 5368910688}], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 4, "description": "PAGE_READWRITE"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368910754}], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368910818}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "allocate memory"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAlloc"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368910837}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocExNuma"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtect"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 5368910818}], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 4, "description": "PAGE_READWRITE"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368910818}], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368838128}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "allocate memory"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAlloc"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368838196}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocExNuma"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtect"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 5368838128}], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 4, "description": "PAGE_READWRITE"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368838177}], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368909568}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "allocate memory"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAlloc"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368909660}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocExNuma"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtect"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 5368909568}], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 4, "description": "PAGE_READWRITE"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368909641}], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368909711}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "allocate memory"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAlloc"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368909730}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocExNuma"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtect"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 5368909711}], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 4, "description": "PAGE_READWRITE"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368909711}], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368841536}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "allocate memory"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAlloc"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368841679}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocExNuma"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtect"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 5368841536}], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 4, "description": "PAGE_READWRITE"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368841634}, {"type": "absolute", "value": 5368841663}], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368913856}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "allocate memory"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAlloc"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocExNuma"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtect"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368913965}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 5368913856}], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 4, "description": "PAGE_READWRITE"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368913950}], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368912320}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "allocate memory"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAlloc"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368912405}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocExNuma"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtect"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 5368912320}], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 4, "description": "PAGE_READWRITE"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368912386}], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368912450}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "allocate memory"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAlloc"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368912469}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocExNuma"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtect"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 5368912450}], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 4, "description": "PAGE_READWRITE"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368912450}], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368955356}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "allocate memory"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAlloc"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocEx"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368955481}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocExNuma"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtect"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 5368955356}], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 4, "description": "PAGE_READWRITE"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368955454}], "captures": {}}], "locations": [], "captures": {}}]]}, "get Program Files directory": {"meta": {"name": "get Program Files directory", "namespace": "host-interaction/file-system", "authors": ["moritz.raabe@mandiant.com"], "scope": "basic block", "attack": [{"parts": ["Discovery", "File and Directory Discovery"], "tactic": "Discovery", "technique": "File and Directory Discovery", "subtechnique": "", "id": "T1083"}], "mbc": [], "references": [], "examples": ["BC452CC1128CCF7FA9F76D83CDA79132740414973600FED14509749FE946816E:0x407880"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: get Program Files directory\n    namespace: host-interaction/file-system\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: basic block\n    att&ck:\n      - Discovery::File and Directory Discovery [T1083]\n    examples:\n      - BC452CC1128CCF7FA9F76D83CDA79132740414973600FED14509749FE946816E:0x407880\n  features:\n    - and:\n      - or:\n        - number: 0x26 = CSIDL_PROGRAM_FILES\n        - number: 0x2A = CSIDL_PROGRAM_FILESX86\n      - or:\n        - api: shell32.SHGetFolderPath\n        - api: shell32.SHGetFolderLocation\n        - api: shell32.SHGetSpecialFolderPath\n        - api: shell32.SHGetSpecialFolderLocation\n", "matches": [[{"type": "absolute", "value": 5368935773}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "number", "number": 38, "description": "CSIDL_PROGRAM_FILES"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368935776}], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 42, "description": "CSIDL_PROGRAM_FILESX86"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetFolderPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetFolderLocation"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "shell32.SHGetSpecialFolderPath"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368935788}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetSpecialFolderLocation"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368945965}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "number", "number": 38, "description": "CSIDL_PROGRAM_FILES"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368945968}], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 42, "description": "CSIDL_PROGRAM_FILESX86"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetFolderPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetFolderLocation"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "shell32.SHGetSpecialFolderPath"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368945980}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetSpecialFolderLocation"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "create or open registry key": {"meta": {"name": "create or open registry key", "authors": ["michael.hunhoff@mandiant.com", "anushka.virgaonkar@mandiant.com"], "scope": "basic block", "attack": [], "mbc": [{"parts": ["Operating System", "Registry", "Create Registry Key"], "objective": "Operating System", "behavior": "Registry", "method": "Create Registry Key", "id": "C0036.004"}, {"parts": ["Operating System", "Registry", "Open Registry Key"], "objective": "Operating System", "behavior": "Registry", "method": "Open Registry Key", "id": "C0036.003"}], "references": [], "examples": ["Practical Malware Analysis Lab 03-02.dll_:0x10004706", "Practical Malware Analysis Lab 11-01.exe_:0x401000", "493167E85E45363D09495D0841C30648:0x404D60", "B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x4045F2", "B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x40433E", "692f7fd6d198e804d6af98eb9e390d61:0x6000003"], "description": "", "lib": true, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: create or open registry key\n    authors:\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    lib: true\n    scope: basic block\n    mbc:\n      - Operating System::Registry::Create Registry Key [C0036.004]\n      - Operating System::Registry::Open Registry Key [C0036.003]\n    examples:\n      - Practical Malware Analysis Lab 03-02.dll_:0x10004706\n      - Practical Malware Analysis Lab 11-01.exe_:0x401000\n      - 493167E85E45363D09495D0841C30648:0x404D60\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x4045F2\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x40433E\n      - 692f7fd6d198e804d6af98eb9e390d61:0x6000003\n  features:\n    - or:\n      - api: advapi32.RegOpenKey\n      - api: advapi32.RegOpenKeyEx\n      - api: advapi32.RegCreateKey\n      - api: advapi32.RegCreateKeyEx\n      - api: advapi32.RegOpenCurrentUser\n      - api: advapi32.RegOpenKeyTransacted\n      - api: advapi32.RegOpenUserClassesRoot\n      - api: advapi32.RegCreateKeyTransacted\n      - api: ZwOpenKey\n      - api: ZwOpenKeyEx\n      - api: ZwCreateKey\n      - api: ZwOpenKeyTransacted\n      - api: ZwOpenKeyTransactedEx\n      - api: ZwCreateKeyTransacted\n      - api: NtOpenKey\n      - api: NtCreateKey\n      - api: SHRegOpenUSKey\n      - api: SHRegCreateUSKey\n      - api: RtlCreateRegistryKey\n      - api: Microsoft.Win32.RegistryKey::OpenSubKey\n      - api: Microsoft.Win32.RegistryKey::OpenBaseKey\n      - api: Microsoft.Win32.RegistryKey::OpenRemoteBaseKey\n      - api: Microsoft.Win32.RegistryKey::CreateSubKey\n", "matches": [[{"type": "absolute", "value": 5368984512}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenKeyEx"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368984654}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegCreateKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegCreateKeyEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenCurrentUser"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenUserClassesRoot"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegCreateKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKeyEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKeyTransactedEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtOpenKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtCreateKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegOpenUSKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegCreateUSKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "RtlCreateRegistryKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::OpenSubKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::OpenBaseKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::OpenRemoteBaseKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::CreateSubKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368984784}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenKeyEx"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368984936}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegCreateKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegCreateKeyEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenCurrentUser"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenUserClassesRoot"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegCreateKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKeyEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKeyTransactedEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtOpenKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtCreateKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegOpenUSKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegCreateUSKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "RtlCreateRegistryKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::OpenSubKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::OpenBaseKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::OpenRemoteBaseKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::CreateSubKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "get process image filename": {"meta": {"name": "get process image filename", "namespace": "host-interaction/process", "authors": ["michael.hunhoff@mandiant.com"], "scope": "basic block", "attack": [], "mbc": [], "references": [], "examples": [], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "# generated using capa explorer for IDA Pro\nrule:\n  meta:\n    name: get process image filename\n    namespace: host-interaction/process\n    authors:\n      - michael.hunhoff@mandiant.com\n    scope: basic block\n  features:\n    - or:\n      - and:\n        - os: windows\n        - or:\n          - api: kernel32.K32GetProcessImageFileName\n          - api: kernel32.GetProcessImageFileName\n      - and:\n        - api: System.Diagnostics.Process::GetCurrentProcess\n        - property/read: System.Diagnostics.Process::MainModule\n        - property/read: System.Diagnostics.ProcessModule::FileName\n", "matches": [[{"type": "absolute", "value": 5368863767}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.K32GetProcessImageFileName"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368863804}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetProcessImageFileName"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "System.Diagnostics.Process::GetCurrentProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.Diagnostics.Process::MainModule"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.Diagnostics.ProcessModule::FileName"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368881759}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.K32GetProcessImageFileName"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368881799}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetProcessImageFileName"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "System.Diagnostics.Process::GetCurrentProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.Diagnostics.Process::MainModule"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.Diagnostics.ProcessModule::FileName"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368815130}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.K32GetProcessImageFileName"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368815130}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetProcessImageFileName"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "System.Diagnostics.Process::GetCurrentProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.Diagnostics.Process::MainModule"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.Diagnostics.ProcessModule::FileName"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5369002823}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.K32GetProcessImageFileName"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5369002823}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetProcessImageFileName"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "System.Diagnostics.Process::GetCurrentProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.Diagnostics.Process::MainModule"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.Diagnostics.ProcessModule::FileName"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "open thread": {"meta": {"name": "open thread", "authors": ["0x534a@mailbox.org"], "scope": "basic block", "attack": [], "mbc": [{"parts": ["Process", "Open Thread"], "objective": "Process", "behavior": "Open Thread", "method": "", "id": "C0066"}], "references": [], "examples": ["787cbc8a6d1bc58ea169e51e1ad029a637f22560660cc129ab8a099a745bd50e:00502F4C"], "description": "", "lib": true, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: open thread\n    authors:\n      - 0x534a@mailbox.org\n    lib: true\n    scope: basic block\n    mbc:\n      - Process::Open Thread [C0066]\n    examples:\n      - 787cbc8a6d1bc58ea169e51e1ad029a637f22560660cc129ab8a099a745bd50e:00502F4C\n  features:\n    - or:\n      - api: kernel32.OpenThread\n      - api: NtOpenThread\n      - api: ZwOpenThread\n", "matches": [[{"type": "absolute", "value": 5368954290}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.OpenThread"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368954304}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtOpenThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368978428}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.OpenThread"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368978439}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtOpenThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "get Explorer PID": {"meta": {"name": "get Explorer PID", "namespace": "host-interaction/process/list", "authors": ["michael.hunhoff@mandiant.com"], "scope": "basic block", "attack": [{"parts": ["Discovery", "Process Discovery"], "tactic": "Discovery", "technique": "Process Discovery", "subtechnique": "", "id": "T1057"}], "mbc": [], "references": ["https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiDebug/ParentProcess.cpp"], "examples": ["al-khaser_x86.exe_:0x425210"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: get Explorer PID\n    namespace: host-interaction/process/list\n    authors:\n      - michael.hunhoff@mandiant.com\n    scope: basic block\n    att&ck:\n      - Discovery::Process Discovery [T1057]\n    references:\n      - https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiDebug/ParentProcess.cpp\n    examples:\n      - al-khaser_x86.exe_:0x425210\n  features:\n    - and:\n      - api: GetShellWindow\n      - api: GetWindowThreadProcessId\n", "matches": [[{"type": "absolute", "value": 5368857936}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "GetShellWindow"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368858002}], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "GetWindowThreadProcessId"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368858015}], "captures": {}}], "locations": [], "captures": {}}]]}, "allocate RWX memory": {"meta": {"name": "allocate RWX memory", "namespace": "host-interaction/process/inject", "authors": ["moritz.raabe@mandiant.com"], "scope": "basic block", "attack": [], "mbc": [{"parts": ["Memory", "Allocate Memory"], "objective": "Memory", "behavior": "Allocate Memory", "method": "", "id": "C0007"}], "references": [], "examples": ["Practical Malware Analysis Lab 03-03.exe_:0x4010EA", "563653399B82CD443F120ECEFF836EA3678D4CF11D9B351BB737573C2D856299:0x140001ABA"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: allocate RWX memory\n    namespace: host-interaction/process/inject\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: basic block\n    mbc:\n      - Memory::Allocate Memory [C0007]\n    examples:\n      - Practical Malware Analysis Lab 03-03.exe_:0x4010EA\n      # ntdll\n      - 563653399B82CD443F120ECEFF836EA3678D4CF11D9B351BB737573C2D856299:0x140001ABA\n  features:\n    - and:\n      - match: allocate memory\n      - number: 0x40 = PAGE_EXECUTE_READWRITE\n", "matches": [[{"type": "absolute", "value": 5368911394}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "allocate memory"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAlloc"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368911413}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocExNuma"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtect"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 5368911394}], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 64, "description": "PAGE_EXECUTE_READWRITE"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368911394}], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368839184}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "allocate memory"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAlloc"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368839314}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocExNuma"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtect"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 5368839184}], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 64, "description": "PAGE_EXECUTE_READWRITE"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368839298}], "captures": {}}], "locations": [], "captures": {}}]]}, "check for OutputDebugString error": {"meta": {"name": "check for OutputDebugString error", "namespace": "anti-analysis/anti-debugging/debugger-detection", "authors": ["michael.hunhoff@mandiant.com"], "scope": "basic block", "attack": [], "mbc": [{"parts": ["Anti-Behavioral Analysis", "Debugger Detection", "OutputDebugString"], "objective": "Anti-Behavioral Analysis", "behavior": "Debugger Detection", "method": "OutputDebugString", "id": "B0001.016"}], "references": [], "examples": ["Practical Malware Analysis Lab 16-02.exe_:0x401020"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: check for OutputDebugString error\n    namespace: anti-analysis/anti-debugging/debugger-detection\n    authors:\n      - michael.hunhoff@mandiant.com\n    scope: basic block\n    mbc:\n      - Anti-Behavioral Analysis::Debugger Detection::OutputDebugString [B0001.016]\n    examples:\n      - Practical Malware Analysis Lab 16-02.exe_:0x401020\n  features:\n    - and:\n      - api: kernel32.SetLastError\n      - api: kernel32.GetLastError\n      - api: kernel32.OutputDebugString\n", "matches": [[{"type": "absolute", "value": 5368844868}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.SetLastError"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368844871}], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetLastError"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368844890}], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.OutputDebugString"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368844884}], "captures": {}}], "locations": [], "captures": {}}]]}, "create or open file": {"meta": {"name": "create or open file", "authors": ["michael.hunhoff@mandiant.com", "joakim@intezer.com"], "scope": "basic block", "attack": [], "mbc": [{"parts": ["File System", "Create File"], "objective": "File System", "behavior": "Create File", "method": "", "id": "C0016"}], "references": [], "examples": ["B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x401D7E"], "description": "", "lib": true, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: create or open file\n    authors:\n      - michael.hunhoff@mandiant.com\n      - joakim@intezer.com\n    lib: true\n    scope: basic block\n    mbc:\n      - File System::Create File [C0016]\n    examples:\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x401D7E\n  features:\n    - or:\n      - api: CreateFile\n      - api: CreateFileEx\n      - api: IoCreateFile\n      - api: IoCreateFileEx\n      - api: ZwOpenFile\n      - api: ZwCreateFile\n      - api: NtOpenFile\n      - api: NtCreateFile\n      - api: fopen\n      - api: fopen64\n      - api: fdopen\n      - api: freopen\n      - api: open\n      - api: openat\n", "matches": [[{"type": "absolute", "value": 5368945480}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "CreateFile"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368945528}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "CreateFileEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "IoCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "IoCreateFileEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtOpenFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "fopen"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "fopen64"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "fdopen"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "freopen"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "open"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "openat"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368935273}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "CreateFile"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368935321}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "CreateFileEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "IoCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "IoCreateFileEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtOpenFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "fopen"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "fopen64"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "fdopen"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "freopen"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "open"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "openat"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368919549}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "CreateFile"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368919649}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "CreateFileEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "IoCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "IoCreateFileEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtOpenFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "fopen"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "fopen64"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "fdopen"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "freopen"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "open"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "openat"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368919951}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "CreateFile"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368919997}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "CreateFileEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "IoCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "IoCreateFileEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtOpenFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "fopen"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "fopen64"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "fdopen"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "freopen"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "open"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "openat"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368920205}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "CreateFile"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368920251}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "CreateFileEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "IoCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "IoCreateFileEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtOpenFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "fopen"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "fopen64"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "fdopen"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "freopen"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "open"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "openat"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "PEB access": {"meta": {"name": "PEB access", "authors": ["michael.hunhoff@mandiant.com"], "scope": "basic block", "attack": [], "mbc": [{"parts": ["Anti-Behavioral Analysis", "Debugger Detection", "Process Environment Block"], "objective": "Anti-Behavioral Analysis", "behavior": "Debugger Detection", "method": "Process Environment Block", "id": "B0001.019"}], "references": ["https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiDebug/NtGlobalFlag.cpp"], "examples": ["al-khaser_x86.exe_:0x420D20"], "description": "", "lib": true, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: PEB access\n    authors:\n      - michael.hunhoff@mandiant.com\n    lib: true\n    scope: basic block\n    mbc:\n      - Anti-Behavioral Analysis::Debugger Detection::Process Environment Block [B0001.019]\n    references:\n      - https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiDebug/NtGlobalFlag.cpp\n    examples:\n      - al-khaser_x86.exe_:0x420D20\n  features:\n    - or:\n      - characteristic: peb access\n      - and:\n        # https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiDebug/NtGlobalFlag.cpp#L41\n        - arch: i386\n        - characteristic: fs access\n        - or:\n          # in 0f5d5d07c6533bc6d991836ce79daaa1\n          # then we have:\n          #\n          #     xor edx, edx\n          #     mov edx, fs:[edx+30h]\n          - offset: 0x30\n          - instruction:\n            # in the case of CallObfuscator, gs:[rax]\n            - mnemonic: add\n            - number: 0x30\n      - and:\n        - arch: amd64\n        - characteristic: gs access\n        - or:\n          - offset: 0x60\n          - instruction:\n            - mnemonic: add\n            - number: 0x60\n      - and:\n        # WoW64 PEB address is fetched via the WoW64 Thread Environment Block (TEB) at FS:[0x18]-0x2000\n        # https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiDebug/NtGlobalFlag.cpp#L45\n        - characteristic: fs access\n        - instruction:\n          - mnemonic: sub\n          - number: 0x2000\n", "matches": [[{"type": "absolute", "value": 5368914304}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "peb access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368914346}], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "fs access"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/aee9ee4a3df44121b21acb950535f6a7"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "arch", "arch": "i386"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "fs access"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "offset", "offset": 48}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/b86186bb56c74ecaa2b476462ebf83f3"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "arch", "arch": "amd64"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "gs access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368914346}], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "offset", "offset": 96}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/fc87da307f6f4da2b8fde64519f87688"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368858838}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "peb access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368858838}], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "fs access"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/aee9ee4a3df44121b21acb950535f6a7"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "arch", "arch": "i386"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "fs access"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "offset", "offset": 48}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368858847}], "captures": {}}, {"success": true, "node": {"statement": {"scope": "instruction", "type": "subscope"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "mnemonic", "mnemonic": "add"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368858847}], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 48}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368858847}], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 5368858847}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "arch", "arch": "amd64"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "gs access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368858838}], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "offset", "offset": 96}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/fc87da307f6f4da2b8fde64519f87688"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368858872}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "peb access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368858872}], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "fs access"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/aee9ee4a3df44121b21acb950535f6a7"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "arch", "arch": "i386"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "fs access"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "offset", "offset": 48}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368858881}], "captures": {}}, {"success": true, "node": {"statement": {"scope": "instruction", "type": "subscope"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "mnemonic", "mnemonic": "add"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368858881}], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 48}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368858881}], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 5368858881}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "arch", "arch": "amd64"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "gs access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368858872}], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "offset", "offset": 96}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/fc87da307f6f4da2b8fde64519f87688"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368858534}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "peb access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368858534}], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "fs access"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/aee9ee4a3df44121b21acb950535f6a7"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "arch", "arch": "i386"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "fs access"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "offset", "offset": 48}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368858543}], "captures": {}}, {"success": true, "node": {"statement": {"scope": "instruction", "type": "subscope"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "mnemonic", "mnemonic": "add"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368858543}], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 48}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368858543}], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 5368858543}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "arch", "arch": "amd64"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "gs access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368858534}], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "offset", "offset": 96}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/fc87da307f6f4da2b8fde64519f87688"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368858568}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "peb access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368858568}], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "fs access"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/aee9ee4a3df44121b21acb950535f6a7"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "arch", "arch": "i386"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "fs access"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "offset", "offset": 48}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368858577}], "captures": {}}, {"success": true, "node": {"statement": {"scope": "instruction", "type": "subscope"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "mnemonic", "mnemonic": "add"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368858577}], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 48}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368858577}], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 5368858577}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "arch", "arch": "amd64"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "gs access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368858568}], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "offset", "offset": 96}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/fc87da307f6f4da2b8fde64519f87688"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368840336}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "peb access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368840394}], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "fs access"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/aee9ee4a3df44121b21acb950535f6a7"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "arch", "arch": "i386"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "fs access"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "offset", "offset": 48}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/b86186bb56c74ecaa2b476462ebf83f3"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "arch", "arch": "amd64"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "gs access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368840394}], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "offset", "offset": 96}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/fc87da307f6f4da2b8fde64519f87688"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368914080}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "peb access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368914122}], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "fs access"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/aee9ee4a3df44121b21acb950535f6a7"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "arch", "arch": "i386"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "fs access"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "offset", "offset": 48}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368914227}], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/b86186bb56c74ecaa2b476462ebf83f3"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "arch", "arch": "amd64"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "gs access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368914122}], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "offset", "offset": 96}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/fc87da307f6f4da2b8fde64519f87688"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368921024}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "peb access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368921171}], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "fs access"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/aee9ee4a3df44121b21acb950535f6a7"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "arch", "arch": "i386"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "fs access"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "offset", "offset": 48}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/b86186bb56c74ecaa2b476462ebf83f3"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "arch", "arch": "amd64"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "gs access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368921171}], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "offset", "offset": 96}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/fc87da307f6f4da2b8fde64519f87688"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368837568}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "peb access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368837610}], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "fs access"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/aee9ee4a3df44121b21acb950535f6a7"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "arch", "arch": "i386"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "fs access"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "offset", "offset": 48}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/b86186bb56c74ecaa2b476462ebf83f3"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "arch", "arch": "amd64"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "gs access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368837610}], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "offset", "offset": 96}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/fc87da307f6f4da2b8fde64519f87688"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "get file attributes": {"meta": {"name": "get file attributes", "namespace": "host-interaction/file-system/meta", "authors": ["michael.hunhoff@mandiant.com", "anushka.virgaonkar@mandiant.com"], "scope": "basic block", "attack": [], "mbc": [{"parts": ["File System", "Get File Attributes"], "objective": "File System", "behavior": "Get File Attributes", "method": "", "id": "C0049"}], "references": [], "examples": ["03B236B23B1EC37C663527C1F53AF3FE:0x180019824", "B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x4028B6", "B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x4029E0"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: get file attributes\n    namespace: host-interaction/file-system/meta\n    authors:\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scope: basic block\n    mbc:\n      - File System::Get File Attributes [C0049]\n    examples:\n      - 03B236B23B1EC37C663527C1F53AF3FE:0x180019824\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x4028B6\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x4029E0\n  features:\n    - or:\n      - api: kernel32.GetFileAttributes\n      - api: ZwQueryDirectoryFile\n      - api: ZwQueryInformationFile\n      - api: NtQueryDirectoryFile\n      - api: NtQueryInformationFile\n      - api: System.IO.File::GetAttributes\n      - api: System.IO.File::GetCreationTime\n      - api: System.IO.File::GetCreationTimeUtc\n      - api: System.IO.File::GetLastAccessTime\n      - api: System.IO.File::GetLastAccessTimeUtc\n      - api: System.IO.File::GetLastWriteTime\n      - api: System.IO.File::GetLastWriteTimeUtc\n      - property/read: System.IO.FileSystemInfo::Attributes\n", "matches": [[{"type": "absolute", "value": 5368997776}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetFileAttributes"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368997837}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwQueryDirectoryFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwQueryInformationFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtQueryDirectoryFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtQueryInformationFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::GetAttributes"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::GetCreationTime"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::GetCreationTimeUtc"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::GetLastAccessTime"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::GetLastAccessTimeUtc"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::GetLastWriteTime"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::GetLastWriteTimeUtc"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.IO.FileSystemInfo::Attributes"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368997936}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetFileAttributes"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368997997}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwQueryDirectoryFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwQueryInformationFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtQueryDirectoryFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtQueryInformationFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::GetAttributes"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::GetCreationTime"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::GetCreationTimeUtc"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::GetLastAccessTime"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::GetLastAccessTimeUtc"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::GetLastWriteTime"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::GetLastWriteTimeUtc"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.IO.FileSystemInfo::Attributes"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "check for trap flag exception": {"meta": {"name": "check for trap flag exception", "namespace": "anti-analysis/anti-debugging/debugger-detection", "authors": ["michael.hunhoff@mandiant.com"], "scope": "basic block", "attack": [], "mbc": [{"parts": ["Anti-Behavioral Analysis", "Debugger Detection"], "objective": "Anti-Behavioral Analysis", "behavior": "Debugger Detection", "method": "", "id": "B0001"}], "references": ["https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiDebug/TrapFlag.cpp"], "examples": ["al-khaser_x86.exe_:0x431680", "al-khaser_x64.exe_:0x140030CB0"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: check for trap flag exception\n    namespace: anti-analysis/anti-debugging/debugger-detection\n    authors:\n      - michael.hunhoff@mandiant.com\n    scope: basic block\n    mbc:\n      - Anti-Behavioral Analysis::Debugger Detection [B0001]\n    references:\n      - https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiDebug/TrapFlag.cpp\n    examples:\n      - al-khaser_x86.exe_:0x431680\n      - al-khaser_x64.exe_:0x140030CB0\n  features:\n    - and:\n      - or:\n        - description: read/write EFLAGS register\n        - and:\n          - mnemonic: pushf\n          - mnemonic: popf\n        - and:\n          - mnemonic: pushfd\n          - mnemonic: popfd\n        - and:\n          - mnemonic: pushfq\n          - mnemonic: popfq\n      - or:\n        - description: set trap flag\n        - instruction:\n          - mnemonic: or\n          - number: 0x100\n        - instruction:\n          - mnemonic: bts\n          - number: 0x8\n", "matches": [[{"type": "absolute", "value": 5368908976}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "or", "description": "set trap flag"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "match", "match": "check for trap flag exception/851875cfd0cc42c48a602b4e57505ef8"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"scope": "instruction", "type": "subscope"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "mnemonic", "mnemonic": "bts"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368909061}], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 8}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368909061}], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 5368909061}], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or", "description": "read/write EFLAGS register"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "mnemonic", "mnemonic": "pushf"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "mnemonic", "mnemonic": "popf"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "mnemonic", "mnemonic": "pushfd"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368909050}], "captures": {}}, {"success": true, "node": {"feature": {"type": "mnemonic", "mnemonic": "popfd"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368909075}], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "mnemonic", "mnemonic": "pushfq"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "mnemonic", "mnemonic": "popfq"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "create thread": {"meta": {"name": "create thread", "namespace": "host-interaction/thread/create", "authors": ["moritz.raabe@mandiant.com", "michael.hunhoff@mandiant.com", "joakim@intezer.com", "anushka.virgaonkar@mandiant.com"], "scope": "basic block", "attack": [], "mbc": [{"parts": ["Process", "Create Thread"], "objective": "Process", "behavior": "Create Thread", "method": "", "id": "C0038"}], "references": [], "examples": ["946A99F36A46D335DEC080D9A4371940:0x10001DA0", "B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x408020"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: create thread\n    namespace: host-interaction/thread/create\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n      - joakim@intezer.com\n      - anushka.virgaonkar@mandiant.com\n    scope: basic block\n    mbc:\n      - Process::Create Thread [C0038]\n    examples:\n      - 946A99F36A46D335DEC080D9A4371940:0x10001DA0\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x408020\n  features:\n    - or:\n      - and:\n        - os: windows\n        - or:\n          - api: kernel32.CreateThread\n          - api: _beginthread\n          - api: _beginthreadex\n          - api: PsCreateSystemThread\n          - api: SHCreateThread\n          - api: SHCreateThreadWithHandle\n          - api: kernel32.CreateRemoteThread\n          - api: kernel32.CreateRemoteThreadEx\n          - api: RtlCreateUserThread\n          - api: ntdll.NtCreateThread\n          - api: ntdll.NtCreateThreadEx\n          - api: ntdll.ZwCreateThread\n          - api: ntdll.ZwCreateThreadEx\n      - and:\n        - os: linux\n        - api: pthread_create\n      - and:\n        - api: System.Threading.Thread::Start\n        - optional:\n          - api: System.Threading.Thread::ctor\n", "matches": [[{"type": "absolute", "value": 5368951220}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "os", "os": "linux"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "pthread_create"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "System.Threading.Thread::Start"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "System.Threading.Thread::ctor"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.CreateThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "_beginthread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "_beginthreadex"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "PsCreateSystemThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHCreateThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHCreateThreadWithHandle"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.CreateRemoteThread"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368951265}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.CreateRemoteThreadEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "RtlCreateUserThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtCreateThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtCreateThreadEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.ZwCreateThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.ZwCreateThreadEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368908512}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "os", "os": "linux"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "pthread_create"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "System.Threading.Thread::Start"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "System.Threading.Thread::ctor"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.CreateThread"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368908592}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "_beginthread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "_beginthreadex"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "PsCreateSystemThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHCreateThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHCreateThreadWithHandle"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.CreateRemoteThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.CreateRemoteThreadEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "RtlCreateUserThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtCreateThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtCreateThreadEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.ZwCreateThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.ZwCreateThreadEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "check for unexpected memory writes": {"meta": {"name": "check for unexpected memory writes", "namespace": "anti-analysis/anti-debugging/debugger-detection", "authors": ["michael.hunhoff@mandiant.com"], "scope": "basic block", "attack": [], "mbc": [{"parts": ["Anti-Behavioral Analysis", "Debugger Detection", "Memory Write Watching"], "objective": "Anti-Behavioral Analysis", "behavior": "Debugger Detection", "method": "Memory Write Watching", "id": "B0001.010"}], "references": ["https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiDebug/WriteWatch.cpp"], "examples": ["al-khaser_x86.exe_:0x431EBC"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: check for unexpected memory writes\n    namespace: anti-analysis/anti-debugging/debugger-detection\n    authors:\n      - michael.hunhoff@mandiant.com\n    scope: basic block\n    mbc:\n      - Anti-Behavioral Analysis::Debugger Detection::Memory Write Watching [B0001.010]\n    references:\n      - https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiDebug/WriteWatch.cpp\n    examples:\n      - al-khaser_x86.exe_:0x431EBC\n  features:\n    - and:\n      - api: kernel32.GetWriteWatch\n      - number: 0x0\n", "matches": [[{"type": "absolute", "value": 5368910906}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetWriteWatch"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368910974}], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 0}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368910911}], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368910144}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetWriteWatch"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368910180}], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 0}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368910156}], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368912538}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetWriteWatch"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368912608}], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 0}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368912549}], "captures": {}}], "locations": [], "captures": {}}]]}, "get process heap force flags": {"meta": {"name": "get process heap force flags", "namespace": "host-interaction/process", "authors": ["michael.hunhoff@mandiant.com"], "scope": "basic block", "attack": [{"parts": ["Discovery", "Process Discovery"], "tactic": "Discovery", "technique": "Process Discovery", "subtechnique": "", "id": "T1057"}], "mbc": [], "references": ["https://github.com/LordNoteworthy/al-khaser/blob/bed03d2f849d9060c68f8d5905bd204d0cb3f593/al-khaser/AntiDebug/ProcessHeap_ForceFlags.cpp#L14"], "examples": ["al-khaser_x86.exe_:0x425470"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: get process heap force flags\n    namespace: host-interaction/process\n    authors:\n      - michael.hunhoff@mandiant.com\n    scope: basic block\n    att&ck:\n      - Discovery::Process Discovery [T1057]\n    references:\n      - https://github.com/LordNoteworthy/al-khaser/blob/bed03d2f849d9060c68f8d5905bd204d0cb3f593/al-khaser/AntiDebug/ProcessHeap_ForceFlags.cpp#L14\n    examples:\n      - al-khaser_x86.exe_:0x425470\n  features:\n    - and:\n      - match: PEB access\n      - or:\n        - and:\n          - arch: i386\n          - number: 0x18 = PEB->ProcessHeap\n          - or:\n            - number: 0x44 = ProcessHeap->ForceFlags >= Vista\n            - number: 0x10 = ProcessHeap->ForceFlags < Vista\n        - and:\n          - arch: amd64\n          - number: 0x30 = PEB->ProcessHeap\n          - or:\n            - number: 0x74 = ProcessHeap->ForceFlags >= Vista\n            - number: 0x18 = ProcessHeap->ForceFlags < Vista\n", "matches": [[{"type": "absolute", "value": 5368858838}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "PEB access"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "peb access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368858838}], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "fs access"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/aee9ee4a3df44121b21acb950535f6a7"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "arch", "arch": "i386"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "fs access"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "offset", "offset": 48}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368858847}], "captures": {}}, {"success": true, "node": {"statement": {"scope": "instruction", "type": "subscope"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "mnemonic", "mnemonic": "add"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368858847}], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 48}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368858847}], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 5368858847}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "arch", "arch": "amd64"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "gs access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368858838}], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "offset", "offset": 96}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/fc87da307f6f4da2b8fde64519f87688"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 5368858838}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "arch", "arch": "i386"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 24, "description": "PEB->ProcessHeap"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "number", "number": 68, "description": "ProcessHeap->ForceFlags >= Vista"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 16, "description": "ProcessHeap->ForceFlags < Vista"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "arch", "arch": "amd64"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 48, "description": "PEB->ProcessHeap"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368858847}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "number", "number": 116, "description": "ProcessHeap->ForceFlags >= Vista"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368858862}], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 24, "description": "ProcessHeap->ForceFlags < Vista"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368858872}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "PEB access"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "peb access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368858872}], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "fs access"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/aee9ee4a3df44121b21acb950535f6a7"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "arch", "arch": "i386"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "fs access"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "offset", "offset": 48}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368858881}], "captures": {}}, {"success": true, "node": {"statement": {"scope": "instruction", "type": "subscope"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "mnemonic", "mnemonic": "add"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368858881}], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 48}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368858881}], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 5368858881}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "arch", "arch": "amd64"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "gs access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368858872}], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "offset", "offset": 96}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/fc87da307f6f4da2b8fde64519f87688"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 5368858872}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "arch", "arch": "i386"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 24, "description": "PEB->ProcessHeap"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368858896}], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "number", "number": 68, "description": "ProcessHeap->ForceFlags >= Vista"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 16, "description": "ProcessHeap->ForceFlags < Vista"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "arch", "arch": "amd64"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 48, "description": "PEB->ProcessHeap"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368858881}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "number", "number": 116, "description": "ProcessHeap->ForceFlags >= Vista"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 24, "description": "ProcessHeap->ForceFlags < Vista"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368858896}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "access PEB ldr_data": {"meta": {"name": "access PEB ldr_data", "namespace": "linking/runtime-linking", "authors": ["moritz.raabe@mandiant.com"], "scope": "basic block", "attack": [{"parts": ["Execution", "Shared Modules"], "tactic": "Execution", "technique": "Shared Modules", "subtechnique": "", "id": "T1129"}], "mbc": [], "references": ["https://www.geoffchappell.com/studies/windows/win32/ntdll/structs/peb_ldr_data.htm", "https://github.com/d35ha/CallObfuscator/blob/5834aff9ff4511f1408ae4ce80b79737af4ae77b/ShellCode/shell_x64.asm#L8"], "examples": ["3FDFB2D522E7DEECAAAF2F87420F7E75:0x4117B7"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: access PEB ldr_data\n    namespace: linking/runtime-linking\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: basic block\n    att&ck:\n      - Execution::Shared Modules [T1129]\n    references:\n      - https://www.geoffchappell.com/studies/windows/win32/ntdll/structs/peb_ldr_data.htm\n      - https://github.com/d35ha/CallObfuscator/blob/5834aff9ff4511f1408ae4ce80b79737af4ae77b/ShellCode/shell_x64.asm#L8\n    examples:\n      - 3FDFB2D522E7DEECAAAF2F87420F7E75:0x4117B7\n  features:\n    - or:\n      - and:\n        - arch: i386\n        - description: x32\n\n        - match: PEB access\n\n        # x86 Windows uses fs:0 to access the TIB which contains SEH information at offset 0\n        # checking for fs:0 and a (possibly unrelated) number or offset often results in false positives\n\n        - offset: 0x0C = PEB.LDR_DATA\n\n        - or:\n          - description: resolve a module list\n          - offset: 0x0C = PEB.LDR_DATA.InLoadOrderModuleList\n          - offset: 0x14 = PEB.LDR_DATA.InMemoryOrderModuleList\n          - offset: 0x1C = PEB.LDR_DATA.InInitializationOrderModuleList\n\n      - and:\n        - arch: amd64\n        - description: x64\n\n        - match: PEB access\n\n        - offset: 0x18 = PEB.LDR_DATA\n\n        - or:\n          - description: resolve a module list\n          - offset: 0x10 = PEB.LDR_DATA.InLoadOrderModuleList\n          - offset: 0x20 = PEB.LDR_DATA.InMemoryOrderModuleList\n          - offset: 0x30 = PEB.LDR_DATA.InInitializationOrderModuleList\n", "matches": [[{"type": "absolute", "value": 5368858872}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and", "description": "x32"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "arch", "arch": "i386"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "match", "match": "PEB access"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "peb access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368858872}], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "fs access"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/aee9ee4a3df44121b21acb950535f6a7"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "arch", "arch": "i386"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "fs access"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "offset", "offset": 48}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368858881}], "captures": {}}, {"success": true, "node": {"statement": {"scope": "instruction", "type": "subscope"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "mnemonic", "mnemonic": "add"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368858881}], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 48}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368858881}], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 5368858881}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "arch", "arch": "amd64"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "gs access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368858872}], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "offset", "offset": 96}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/fc87da307f6f4da2b8fde64519f87688"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 5368858872}], "captures": {}}, {"success": false, "node": {"feature": {"type": "offset", "offset": 12, "description": "PEB.LDR_DATA"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or", "description": "resolve a module list"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "offset", "offset": 12, "description": "PEB.LDR_DATA.InLoadOrderModuleList"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "offset", "offset": 20, "description": "PEB.LDR_DATA.InMemoryOrderModuleList"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "offset", "offset": 28, "description": "PEB.LDR_DATA.InInitializationOrderModuleList"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and", "description": "x64"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "arch", "arch": "amd64"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"feature": {"type": "match", "match": "PEB access"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "peb access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368858872}], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "fs access"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/aee9ee4a3df44121b21acb950535f6a7"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "arch", "arch": "i386"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "fs access"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "offset", "offset": 48}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368858881}], "captures": {}}, {"success": true, "node": {"statement": {"scope": "instruction", "type": "subscope"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "mnemonic", "mnemonic": "add"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368858881}], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 48}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368858881}], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 5368858881}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "arch", "arch": "amd64"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "gs access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368858872}], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "offset", "offset": 96}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/fc87da307f6f4da2b8fde64519f87688"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 5368858872}], "captures": {}}, {"success": true, "node": {"feature": {"type": "offset", "offset": 24, "description": "PEB.LDR_DATA"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368858896}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or", "description": "resolve a module list"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "offset", "offset": 16, "description": "PEB.LDR_DATA.InLoadOrderModuleList"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "offset", "offset": 32, "description": "PEB.LDR_DATA.InMemoryOrderModuleList"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "offset", "offset": 48, "description": "PEB.LDR_DATA.InInitializationOrderModuleList"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368858881}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368914080}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and", "description": "x32"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "arch", "arch": "i386"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "match", "match": "PEB access"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "peb access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368914122}], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "fs access"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/aee9ee4a3df44121b21acb950535f6a7"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "arch", "arch": "i386"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "fs access"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "offset", "offset": 48}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368914227}], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/b86186bb56c74ecaa2b476462ebf83f3"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "arch", "arch": "amd64"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "gs access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368914122}], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "offset", "offset": 96}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/fc87da307f6f4da2b8fde64519f87688"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 5368914080}], "captures": {}}, {"success": false, "node": {"feature": {"type": "offset", "offset": 12, "description": "PEB.LDR_DATA"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or", "description": "resolve a module list"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "offset", "offset": 12, "description": "PEB.LDR_DATA.InLoadOrderModuleList"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "offset", "offset": 20, "description": "PEB.LDR_DATA.InMemoryOrderModuleList"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "offset", "offset": 28, "description": "PEB.LDR_DATA.InInitializationOrderModuleList"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and", "description": "x64"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "arch", "arch": "amd64"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"feature": {"type": "match", "match": "PEB access"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "peb access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368914122}], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "fs access"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/aee9ee4a3df44121b21acb950535f6a7"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "arch", "arch": "i386"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "fs access"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "offset", "offset": 48}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368914227}], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/b86186bb56c74ecaa2b476462ebf83f3"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "arch", "arch": "amd64"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "gs access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368914122}], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "offset", "offset": 96}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/fc87da307f6f4da2b8fde64519f87688"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 5368914080}], "captures": {}}, {"success": true, "node": {"feature": {"type": "offset", "offset": 24, "description": "PEB.LDR_DATA"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368914151}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or", "description": "resolve a module list"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "offset", "offset": 16, "description": "PEB.LDR_DATA.InLoadOrderModuleList"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "offset", "offset": 32, "description": "PEB.LDR_DATA.InMemoryOrderModuleList"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368914090}], "captures": {}}, {"success": true, "node": {"feature": {"type": "offset", "offset": 48, "description": "PEB.LDR_DATA.InInitializationOrderModuleList"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368914227}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "get kernel32 base address": {"meta": {"name": "get kernel32 base address", "namespace": "linking/runtime-linking", "authors": ["moritz.raabe@mandiant.com"], "scope": "basic block", "attack": [{"parts": ["Execution", "Shared Modules"], "tactic": "Execution", "technique": "Shared Modules", "subtechnique": "", "id": "T1129"}], "mbc": [], "references": ["https://idafchev.github.io/exploit/2017/09/26/writing_windows_shellcode.html", "https://www.geoffchappell.com/studies/windows/win32/ntdll/structs/ldr_data_table_entry.htm"], "examples": ["67f8302a2fd28d15f62d6d20d748bfe350334e5353cbdef112bd1f8231b5599d:0x406936"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: get kernel32 base address\n    namespace: linking/runtime-linking\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: basic block\n    att&ck:\n      - Execution::Shared Modules [T1129]\n    references:\n      - https://idafchev.github.io/exploit/2017/09/26/writing_windows_shellcode.html\n      - https://www.geoffchappell.com/studies/windows/win32/ntdll/structs/ldr_data_table_entry.htm\n    examples:\n      - 67f8302a2fd28d15f62d6d20d748bfe350334e5353cbdef112bd1f8231b5599d:0x406936\n  features:\n    - and:\n      # PEB -> PEB.Ldr -> PEB_LDR_DATA.InLoadOrderModuleList.Flink\n      - match: access PEB ldr_data\n      # -> current module -> ntdll\n      - count(offset(0)): 2\n      # -> kernel32 -> LDR_DATA_TABLE_ENTRY.DllBase\n      - or:\n        - and:\n          - arch: i386\n          - offset: 0x18 = LDR_DATA_TABLE_ENTRY.DllBase\n        - and:\n          - arch: amd64\n          - offset: 0x30 = LDR_DATA_TABLE_ENTRY.DllBase\n", "matches": [[{"type": "absolute", "value": 5368858872}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "access PEB ldr_data"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and", "description": "x32"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "arch", "arch": "i386"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "match", "match": "PEB access"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "peb access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368858872}], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "fs access"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/aee9ee4a3df44121b21acb950535f6a7"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "arch", "arch": "i386"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "fs access"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "offset", "offset": 48}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368858881}], "captures": {}}, {"success": true, "node": {"statement": {"scope": "instruction", "type": "subscope"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "mnemonic", "mnemonic": "add"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368858881}], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 48}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368858881}], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 5368858881}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "arch", "arch": "amd64"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "gs access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368858872}], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "offset", "offset": 96}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/fc87da307f6f4da2b8fde64519f87688"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 5368858872}], "captures": {}}, {"success": false, "node": {"feature": {"type": "offset", "offset": 12, "description": "PEB.LDR_DATA"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or", "description": "resolve a module list"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "offset", "offset": 12, "description": "PEB.LDR_DATA.InLoadOrderModuleList"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "offset", "offset": 20, "description": "PEB.LDR_DATA.InMemoryOrderModuleList"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "offset", "offset": 28, "description": "PEB.LDR_DATA.InInitializationOrderModuleList"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and", "description": "x64"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "arch", "arch": "amd64"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"feature": {"type": "match", "match": "PEB access"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "peb access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368858872}], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "fs access"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/aee9ee4a3df44121b21acb950535f6a7"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "arch", "arch": "i386"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "fs access"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "offset", "offset": 48}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368858881}], "captures": {}}, {"success": true, "node": {"statement": {"scope": "instruction", "type": "subscope"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "mnemonic", "mnemonic": "add"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368858881}], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 48}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368858881}], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 5368858881}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "arch", "arch": "amd64"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "gs access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368858872}], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "offset", "offset": 96}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/fc87da307f6f4da2b8fde64519f87688"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 5368858872}], "captures": {}}, {"success": true, "node": {"feature": {"type": "offset", "offset": 24, "description": "PEB.LDR_DATA"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368858896}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or", "description": "resolve a module list"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "offset", "offset": 16, "description": "PEB.LDR_DATA.InLoadOrderModuleList"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "offset", "offset": 32, "description": "PEB.LDR_DATA.InMemoryOrderModuleList"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "offset", "offset": 48, "description": "PEB.LDR_DATA.InInitializationOrderModuleList"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368858881}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 5368858872}], "captures": {}}, {"success": true, "node": {"statement": {"min": 2, "max": 2, "child": {"type": "offset", "offset": 0}, "type": "range"}, "type": "statement"}, "children": [], "locations": [{"type": "absolute", "value": 5368858872}, {"type": "absolute", "value": 5368858893}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "arch", "arch": "i386"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "offset", "offset": 24, "description": "LDR_DATA_TABLE_ENTRY.DllBase"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368858896}], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "arch", "arch": "amd64"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"feature": {"type": "offset", "offset": 48, "description": "LDR_DATA_TABLE_ENTRY.DllBase"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368858881}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368914080}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "access PEB ldr_data"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and", "description": "x32"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "arch", "arch": "i386"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "match", "match": "PEB access"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "peb access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368914122}], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "fs access"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/aee9ee4a3df44121b21acb950535f6a7"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "arch", "arch": "i386"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "fs access"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "offset", "offset": 48}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368914227}], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/b86186bb56c74ecaa2b476462ebf83f3"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "arch", "arch": "amd64"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "gs access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368914122}], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "offset", "offset": 96}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/fc87da307f6f4da2b8fde64519f87688"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 5368914080}], "captures": {}}, {"success": false, "node": {"feature": {"type": "offset", "offset": 12, "description": "PEB.LDR_DATA"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or", "description": "resolve a module list"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "offset", "offset": 12, "description": "PEB.LDR_DATA.InLoadOrderModuleList"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "offset", "offset": 20, "description": "PEB.LDR_DATA.InMemoryOrderModuleList"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "offset", "offset": 28, "description": "PEB.LDR_DATA.InInitializationOrderModuleList"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and", "description": "x64"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "arch", "arch": "amd64"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"feature": {"type": "match", "match": "PEB access"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "peb access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368914122}], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "fs access"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/aee9ee4a3df44121b21acb950535f6a7"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "arch", "arch": "i386"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "fs access"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "offset", "offset": 48}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368914227}], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/b86186bb56c74ecaa2b476462ebf83f3"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "arch", "arch": "amd64"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "gs access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368914122}], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "offset", "offset": 96}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/fc87da307f6f4da2b8fde64519f87688"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 5368914080}], "captures": {}}, {"success": true, "node": {"feature": {"type": "offset", "offset": 24, "description": "PEB.LDR_DATA"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368914151}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or", "description": "resolve a module list"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "offset", "offset": 16, "description": "PEB.LDR_DATA.InLoadOrderModuleList"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "offset", "offset": 32, "description": "PEB.LDR_DATA.InMemoryOrderModuleList"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368914090}], "captures": {}}, {"success": true, "node": {"feature": {"type": "offset", "offset": 48, "description": "PEB.LDR_DATA.InInitializationOrderModuleList"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368914227}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 5368914080}], "captures": {}}, {"success": true, "node": {"statement": {"min": 2, "max": 2, "child": {"type": "offset", "offset": 0}, "type": "range"}, "type": "statement"}, "children": [], "locations": [{"type": "absolute", "value": 5368914241}, {"type": "absolute", "value": 5368914122}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "arch", "arch": "i386"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "offset", "offset": 24, "description": "LDR_DATA_TABLE_ENTRY.DllBase"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368914151}], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "arch", "arch": "amd64"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"feature": {"type": "offset", "offset": 48, "description": "LDR_DATA_TABLE_ENTRY.DllBase"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368914227}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "get process heap flags": {"meta": {"name": "get process heap flags", "namespace": "host-interaction/process", "authors": ["michael.hunhoff@mandiant.com"], "scope": "basic block", "attack": [{"parts": ["Discovery", "Process Discovery"], "tactic": "Discovery", "technique": "Process Discovery", "subtechnique": "", "id": "T1057"}], "mbc": [], "references": ["https://github.com/LordNoteworthy/al-khaser/blob/bed03d2f849d9060c68f8d5905bd204d0cb3f593/al-khaser/AntiDebug/ProcessHeap_Flags.cpp#L13"], "examples": ["al-khaser_x86.exe_:0x425470"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: get process heap flags\n    namespace: host-interaction/process\n    authors:\n      - michael.hunhoff@mandiant.com\n    scope: basic block\n    att&ck:\n      - Discovery::Process Discovery [T1057]\n    references:\n      - https://github.com/LordNoteworthy/al-khaser/blob/bed03d2f849d9060c68f8d5905bd204d0cb3f593/al-khaser/AntiDebug/ProcessHeap_Flags.cpp#L13\n    examples:\n      - al-khaser_x86.exe_:0x425470\n  features:\n    - and:\n      - match: PEB access\n      - or:\n        - and:\n          - arch: i386\n          - number: 0x18 = PEB->ProcessHeap\n          - or:\n            - number: 0x40 = ProcessHeap->HeapFlags >= Vista\n            - number: 0xC = ProcessHeap->HeapFlags < Vista\n        - and:\n          - arch: amd64\n          - number: 0x30 = PEB->ProcessHeap\n          - or:\n            - number: 0x70 = ProcessHeap->HeapFlags >= Vista\n            - number: 0x14 = ProcessHeap->HeapFlags < Vista\n", "matches": [[{"type": "absolute", "value": 5368858534}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "PEB access"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "peb access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368858534}], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "fs access"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/aee9ee4a3df44121b21acb950535f6a7"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "arch", "arch": "i386"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "fs access"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "offset", "offset": 48}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368858543}], "captures": {}}, {"success": true, "node": {"statement": {"scope": "instruction", "type": "subscope"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "mnemonic", "mnemonic": "add"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368858543}], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 48}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368858543}], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 5368858543}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "arch", "arch": "amd64"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "gs access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368858534}], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "offset", "offset": 96}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/fc87da307f6f4da2b8fde64519f87688"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 5368858534}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "arch", "arch": "i386"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 24, "description": "PEB->ProcessHeap"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "number", "number": 64, "description": "ProcessHeap->HeapFlags >= Vista"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 12, "description": "ProcessHeap->HeapFlags < Vista"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "arch", "arch": "amd64"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 48, "description": "PEB->ProcessHeap"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368858543}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "number", "number": 112, "description": "ProcessHeap->HeapFlags >= Vista"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368858558}], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 20, "description": "ProcessHeap->HeapFlags < Vista"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368858568}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "PEB access"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "peb access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368858568}], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "fs access"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/aee9ee4a3df44121b21acb950535f6a7"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "arch", "arch": "i386"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "fs access"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "offset", "offset": 48}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368858577}], "captures": {}}, {"success": true, "node": {"statement": {"scope": "instruction", "type": "subscope"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "mnemonic", "mnemonic": "add"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368858577}], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 48}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368858577}], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 5368858577}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "arch", "arch": "amd64"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "gs access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368858568}], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "offset", "offset": 96}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/fc87da307f6f4da2b8fde64519f87688"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 5368858568}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "arch", "arch": "i386"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 24, "description": "PEB->ProcessHeap"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "number", "number": 64, "description": "ProcessHeap->HeapFlags >= Vista"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 12, "description": "ProcessHeap->HeapFlags < Vista"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "arch", "arch": "amd64"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 48, "description": "PEB->ProcessHeap"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368858577}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "number", "number": 112, "description": "ProcessHeap->HeapFlags >= Vista"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 20, "description": "ProcessHeap->HeapFlags < Vista"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368858592}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "acquire debug privileges": {"meta": {"name": "acquire debug privileges", "namespace": "host-interaction/process/modify", "authors": ["william.ballenthin@mandiant.com"], "scope": "basic block", "attack": [{"parts": ["Privilege Escalation", "Access Token Manipulation"], "tactic": "Privilege Escalation", "technique": "Access Token Manipulation", "subtechnique": "", "id": "T1134"}], "mbc": [], "references": [], "examples": ["Practical Malware Analysis Lab 01-04.exe_:0x401174"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: acquire debug privileges\n    namespace: host-interaction/process/modify\n    authors:\n      - william.ballenthin@mandiant.com\n    scope: basic block\n    att&ck:\n      - Privilege Escalation::Access Token Manipulation [T1134]\n    examples:\n      - Practical Malware Analysis Lab 01-04.exe_:0x401174\n  features:\n    - and:\n      - string: \"SeDebugPrivilege\"\n      - optional:\n        - match: modify access privileges\n", "matches": [[{"type": "absolute", "value": 5368985322}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "string", "string": "SeDebugPrivilege"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368985363}], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "match", "match": "modify access privileges"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "check for PEB BeingDebugged flag": {"meta": {"name": "check for PEB BeingDebugged flag", "namespace": "anti-analysis/anti-debugging/debugger-detection", "authors": ["moritz.raabe@mandiant.com"], "scope": "basic block", "attack": [], "mbc": [{"parts": ["Anti-Behavioral Analysis", "Debugger Detection", "Process Environment Block BeingDebugged"], "objective": "Anti-Behavioral Analysis", "behavior": "Debugger Detection", "method": "Process Environment Block BeingDebugged", "id": "B0001.035"}], "references": ["Practical Malware Analysis, Chapter 16, p. 353"], "examples": ["Practical Malware Analysis Lab 16-01.exe_:0x403530"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: check for PEB BeingDebugged flag\n    namespace: anti-analysis/anti-debugging/debugger-detection\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: basic block\n    mbc:\n      - Anti-Behavioral Analysis::Debugger Detection::Process Environment Block BeingDebugged [B0001.035]\n    references:\n      - Practical Malware Analysis, Chapter 16, p. 353\n    examples:\n      - Practical Malware Analysis Lab 16-01.exe_:0x403530\n  features:\n    - and:\n      - match: PEB access\n      - offset: 2 = PEB.BeingDebugged\n", "matches": [[{"type": "absolute", "value": 5368837568}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "PEB access"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "peb access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368837610}], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "fs access"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/aee9ee4a3df44121b21acb950535f6a7"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "arch", "arch": "i386"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "fs access"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "offset", "offset": 48}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/b86186bb56c74ecaa2b476462ebf83f3"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "arch", "arch": "amd64"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "gs access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368837610}], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "offset", "offset": 96}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/fc87da307f6f4da2b8fde64519f87688"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 5368837568}], "captures": {}}, {"success": true, "node": {"feature": {"type": "offset", "offset": 2, "description": "PEB.BeingDebugged"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368837627}], "captures": {}}], "locations": [], "captures": {}}]]}, "contain loop": {"meta": {"name": "contain loop", "authors": ["moritz.raabe@mandiant.com"], "scope": "function", "attack": [], "mbc": [], "references": [], "examples": ["08AC667C65D36D6542917655571E61C8:0x406EAA"], "description": "", "lib": true, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: contain loop\n    authors:\n      - moritz.raabe@mandiant.com\n    lib: true\n    scope: function\n    examples:\n      - 08AC667C65D36D6542917655571E61C8:0x406EAA\n  features:\n    - or:\n      - characteristic: loop\n      - characteristic: tight loop\n      - characteristic: recursive call\n", "matches": [[{"type": "absolute", "value": 5368811525}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368811525}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368811540}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5369005249}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368811565}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368811565}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368811670}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368811670}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368811675}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368811675}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368811695}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368811695}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368811765}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368811765}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368811770}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368811770}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368811805}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368811805}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368811810}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368811810}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368811875}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368811875}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368811990}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368811990}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368812020}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368812020}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368812035}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368812035}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368812100}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368812100}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368812120}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368812120}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368812140}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368812140}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368812150}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368812150}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368812230}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368812230}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368812285}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368812285}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368812340}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368812340}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368812360}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368812360}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368812395}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368812395}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368812480}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368812480}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368812590}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368812590}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368812670}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368812670}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368812845}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368812845}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368812875}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368812875}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368812935}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368812935}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368812990}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368812990}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368813035}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368813035}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368813155}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368813155}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368813175}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368813175}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368813195}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368813195}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368813200}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368813200}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368813235}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368813235}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368813275}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368813275}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368813285}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368813285}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368813315}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368813315}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368813335}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368813335}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368813355}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368813355}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368813395}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368813395}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368813420}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368813420}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368813445}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368813445}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368813465}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368813465}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368813590}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368813590}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368813600}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368813600}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368813665}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368813665}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368813670}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368813670}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368813680}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368813680}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368813700}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368813700}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368813705}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368813705}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368813710}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368813710}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368813770}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368813770}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368813840}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368813840}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368813895}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368813895}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368813990}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368813990}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368814035}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368814035}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368814135}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368814135}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368814180}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368814180}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368814230}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368814230}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368814240}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368814240}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368814300}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368814300}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368814315}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368814315}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368814455}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368814455}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368814555}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368814555}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368814590}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368814590}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368814640}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368814640}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368814735}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368814735}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368814800}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368814800}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368814820}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368814820}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368814865}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368814865}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368814895}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368814895}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368814935}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368814935}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368815005}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368815005}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368815040}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368815040}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368815090}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368815090}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368815170}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368815170}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368815190}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368815190}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368815210}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368815210}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368815230}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368815230}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368815315}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368815315}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368815340}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368815340}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368815350}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368815350}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368815435}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368815435}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368815440}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368815440}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368815480}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368815480}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368815655}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368815655}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368815675}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368815675}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368815690}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368815690}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368815715}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368815715}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368815890}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368815890}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368815960}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368815960}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368815970}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368815970}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368816010}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368816010}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368816060}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368816060}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368816100}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368816100}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368816105}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368816105}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368816165}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368816165}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368816215}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368816215}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368816230}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368816230}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368816320}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368816320}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368816445}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368816445}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368816500}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368816500}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368882832}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368882832}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368891376}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368891376}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368891792}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368891792}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368960864}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368960864}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368986896}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368986896}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368987312}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368987312}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "link function at runtime on Windows": {"meta": {"name": "link function at runtime on Windows", "namespace": "linking/runtime-linking", "authors": ["moritz.raabe@mandiant.com", "michael.hunhoff@mandiant.com"], "scope": "function", "attack": [{"parts": ["Execution", "Shared Modules"], "tactic": "Execution", "technique": "Shared Modules", "subtechnique": "", "id": "T1129"}], "mbc": [], "references": [], "examples": ["9324D1A8AE37A36AE560C37448C9705A:0x404130", "Practical Malware Analysis Lab 01-04.exe_:0x401350"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: link function at runtime on Windows\n    namespace: linking/runtime-linking\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scope: function\n    att&ck:\n      - Execution::Shared Modules [T1129]\n    examples:\n      - 9324D1A8AE37A36AE560C37448C9705A:0x404130\n      - Practical Malware Analysis Lab 01-04.exe_:0x401350\n  features:\n    - and:\n      - os: windows\n      - or:\n        - api: kernel32.GetProcAddress\n        - api: ntdll.LdrGetProcedureAddress\n      - optional:\n        - characteristic: indirect call\n        - api: kernel32.LoadLibrary\n        - api: kernel32.GetModuleHandle\n        - api: kernel32.GetModuleHandleEx\n        - api: ntdll.LdrLoadDll\n", "matches": [[{"type": "absolute", "value": 5368811525}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetProcAddress"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368840106}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.LdrGetProcedureAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "indirect call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.LoadLibrary"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetModuleHandle"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetModuleHandleEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.LdrLoadDll"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368811715}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetProcAddress"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368952128}, {"type": "absolute", "value": 5368952218}, {"type": "absolute", "value": 5368952092}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.LdrGetProcedureAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "indirect call"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368952738}, {"type": "absolute", "value": 5368952701}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.LoadLibrary"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetModuleHandle"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368952036}, {"type": "absolute", "value": 5368951990}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetModuleHandleEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.LdrLoadDll"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368812020}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetProcAddress"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5369019487}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.LdrGetProcedureAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "indirect call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.LoadLibrary"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetModuleHandle"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetModuleHandleEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.LdrLoadDll"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368812360}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetProcAddress"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368953850}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.LdrGetProcedureAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "indirect call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.LoadLibrary"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetModuleHandle"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368953782}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetModuleHandleEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.LdrLoadDll"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368813155}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetProcAddress"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368958816}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.LdrGetProcedureAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "indirect call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.LoadLibrary"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368958750}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetModuleHandle"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetModuleHandleEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.LdrLoadDll"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368813180}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetProcAddress"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368949789}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.LdrGetProcedureAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "indirect call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.LoadLibrary"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetModuleHandle"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368949745}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetModuleHandleEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.LdrLoadDll"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368813750}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetProcAddress"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368950923}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.LdrGetProcedureAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "indirect call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.LoadLibrary"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetModuleHandle"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368950861}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetModuleHandleEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.LdrLoadDll"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368816245}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetProcAddress"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368955221}, {"type": "absolute", "value": 5368955133}, {"type": "absolute", "value": 5368955311}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.LdrGetProcedureAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "indirect call"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368955723}, {"type": "absolute", "value": 5368955686}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.LoadLibrary"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetModuleHandle"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368955153}, {"type": "absolute", "value": 5368955083}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetModuleHandleEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.LdrLoadDll"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368816460}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetProcAddress"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368956489}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.LdrGetProcedureAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "indirect call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.LoadLibrary"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368956421}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetModuleHandle"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetModuleHandleEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.LdrLoadDll"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "check for unmoving mouse cursor": {"meta": {"name": "check for unmoving mouse cursor", "namespace": "anti-analysis/anti-vm/vm-detection", "authors": ["BitsOfBinary"], "scope": "function", "attack": [{"parts": ["Defense Evasion", "Virtualization/Sandbox Evasion", "User Activity Based Checks"], "tactic": "Defense Evasion", "technique": "Virtualization/Sandbox Evasion", "subtechnique": "User Activity Based Checks", "id": "T1497.002"}], "mbc": [{"parts": ["Anti-Behavioral Analysis", "Virtual Machine Detection", "Human User Check"], "objective": "Anti-Behavioral Analysis", "behavior": "Virtual Machine Detection", "method": "Human User Check", "id": "B0009.012"}], "references": ["https://www.joesecurity.org/blog/5852460122427342172"], "examples": ["d7ff81ff775d4ab50d31ac1e962c8c4dea7ff9f280aa2b42ddd06760a5665002:0x401118"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: check for unmoving mouse cursor\n    namespace: anti-analysis/anti-vm/vm-detection\n    authors:\n      - BitsOfBinary\n    scope: function\n    att&ck:\n      - Defense Evasion::Virtualization/Sandbox Evasion::User Activity Based Checks [T1497.002]\n    mbc:\n      - Anti-Behavioral Analysis::Virtual Machine Detection::Human User Check [B0009.012]\n    references:\n      - https://www.joesecurity.org/blog/5852460122427342172\n    examples:\n      - d7ff81ff775d4ab50d31ac1e962c8c4dea7ff9f280aa2b42ddd06760a5665002:0x401118\n  features:\n    - and:\n      - count(api(user32.GetCursorPos)): 2 or more\n", "matches": [[{"type": "absolute", "value": 5368811655}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"min": 2, "max": 9223372036854775808, "child": {"type": "api", "api": "user32.GetCursorPos"}, "type": "range"}, "type": "statement"}, "children": [], "locations": [{"type": "absolute", "value": 5368924564}, {"type": "absolute", "value": 5368924543}], "captures": {}}], "locations": [], "captures": {}}]]}, "reference WMI statements": {"meta": {"name": "reference WMI statements", "namespace": "collection/database/wmi", "authors": ["michael.hunhoff@mandiant.com"], "scope": "function", "attack": [{"parts": ["Collection", "Data from Information Repositories"], "tactic": "Collection", "technique": "Data from Information Repositories", "subtechnique": "", "id": "T1213"}], "mbc": [], "references": [], "examples": ["al-khaser_x86.exe_:0x433490"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: reference WMI statements\n    namespace: collection/database/wmi\n    authors:\n      - michael.hunhoff@mandiant.com\n    scope: function\n    att&ck:\n      - Collection::Data from Information Repositories [T1213]\n    examples:\n      - al-khaser_x86.exe_:0x433490\n  features:\n    - or:\n      - string: /SELECT\\s+\\*\\s+FROM\\s+CIM_./\n      - string: /SELECT\\s+\\*\\s+FROM\\s+Win32_./\n      - string: /SELECT\\s+\\*\\s+FROM\\s+MSAcpi_./\n", "matches": [[{"type": "absolute", "value": 5368811695}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+CIM_./"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+Win32_./"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368941125}], "captures": {"SELECT * FROM Win32_PnPEntity": [{"type": "absolute", "value": 5368941125}]}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+MSAcpi_./"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368811755}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+CIM_./"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368915850}], "captures": {"SELECT * FROM CIM_Sensor": [{"type": "absolute", "value": 5368915850}]}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+Win32_./"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+MSAcpi_./"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368811810}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+CIM_./"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+Win32_./"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368939285}], "captures": {"SELECT * FROM Win32_NetworkAdapterConfiguration": [{"type": "absolute", "value": 5368939285}]}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+MSAcpi_./"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368811875}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+CIM_./"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+Win32_./"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368922549}], "captures": {"SELECT * FROM Win32_ComputerSystem": [{"type": "absolute", "value": 5368922549}]}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+MSAcpi_./"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368812110}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+CIM_./"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+Win32_./"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368925402}], "captures": {"SELECT * FROM Win32_PerfFormattedData_Counters_ThermalZoneInformation": [{"type": "absolute", "value": 5368925402}]}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+MSAcpi_./"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368812120}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+CIM_./"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+Win32_./"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368936139}], "captures": {"SELECT * FROM Win32_NTEventlogFile": [{"type": "absolute", "value": 5368936139}]}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+MSAcpi_./"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368812330}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+CIM_./"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368915738}], "captures": {"SELECT * FROM CIM_PhysicalConnector": [{"type": "absolute", "value": 5368915738}]}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+Win32_./"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+MSAcpi_./"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368812485}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+CIM_./"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+Win32_./"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368925626}], "captures": {"SELECT * FROM Win32_PortConnector": [{"type": "absolute", "value": 5368925626}]}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+MSAcpi_./"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368812615}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+CIM_./"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+Win32_./"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368928522}], "captures": {"SELECT * FROM Win32_SMBIOSMemory": [{"type": "absolute", "value": 5368928522}]}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+MSAcpi_./"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368812670}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+CIM_./"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+Win32_./"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368926085}], "captures": {"SELECT * FROM Win32_Processor": [{"type": "absolute", "value": 5368926085}]}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+MSAcpi_./"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368812785}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+CIM_./"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368915626}], "captures": {"SELECT * FROM CIM_NumericSensor": [{"type": "absolute", "value": 5368915626}]}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+Win32_./"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+MSAcpi_./"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368813040}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+CIM_./"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+Win32_./"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368914666}], "captures": {"SELECT * FROM Win32_CacheMemory": [{"type": "absolute", "value": 5368914666}]}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+MSAcpi_./"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368813195}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+CIM_./"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+Win32_./"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368940229}], "captures": {"SELECT * FROM Win32_PnPEntity": [{"type": "absolute", "value": 5368940229}]}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+MSAcpi_./"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368813395}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+CIM_./"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+Win32_./"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368941797}], "captures": {"SELECT * FROM Win32_PnPDevice": [{"type": "absolute", "value": 5368941797}]}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+MSAcpi_./"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368813445}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+CIM_./"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+Win32_./"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368923813}], "captures": {"SELECT * FROM Win32_ComputerSystem": [{"type": "absolute", "value": 5368923813}]}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+MSAcpi_./"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368813505}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+CIM_./"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368915514}], "captures": {"SELECT * FROM CIM_Memory": [{"type": "absolute", "value": 5368915514}]}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+Win32_./"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+MSAcpi_./"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368813695}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+CIM_./"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+Win32_./"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368923610}], "captures": {"SELECT * FROM Win32_MemoryDevice": [{"type": "absolute", "value": 5368923610}]}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+MSAcpi_./"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368813705}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+CIM_./"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+Win32_./"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368927061}], "captures": {"SELECT * FROM Win32_BIOS": [{"type": "absolute", "value": 5368927061}]}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+MSAcpi_./"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368813820}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+CIM_./"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+Win32_./"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368925514}], "captures": {"SELECT * FROM Win32_PhysicalMemory": [{"type": "absolute", "value": 5368925514}]}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+MSAcpi_./"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368814240}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+CIM_./"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+Win32_./"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368918694}], "captures": {"SELECT * FROM Win32_LogicalDisk": [{"type": "absolute", "value": 5368918694}]}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+MSAcpi_./"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368814435}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+CIM_./"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+Win32_./"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368923498}], "captures": {"SELECT * FROM Win32_MemoryArray": [{"type": "absolute", "value": 5368923498}]}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+MSAcpi_./"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368814455}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+CIM_./"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+Win32_./"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368916399}], "captures": {"SELECT * FROM Win32_Fan": [{"type": "absolute", "value": 5368916399}]}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+MSAcpi_./"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368814970}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+CIM_./"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368915962}], "captures": {"SELECT * FROM CIM_Slot": [{"type": "absolute", "value": 5368915962}]}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+Win32_./"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+MSAcpi_./"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368815090}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+CIM_./"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+Win32_./"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368934293}], "captures": {"SELECT * FROM Win32_Bus": [{"type": "absolute", "value": 5368934293}]}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+MSAcpi_./"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368815340}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+CIM_./"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+Win32_./"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368924837}], "captures": {"SELECT * FROM Win32_Processor": [{"type": "absolute", "value": 5368924837}]}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+MSAcpi_./"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368815870}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+CIM_./"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368916186}], "captures": {"SELECT * FROM CIM_VoltageSensor": [{"type": "absolute", "value": 5368916186}]}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+Win32_./"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+MSAcpi_./"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368816215}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+CIM_./"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+Win32_./"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368933334}], "captures": {"SELECT * FROM Win32_BaseBoard": [{"type": "absolute", "value": 5368933334}]}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+MSAcpi_./"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368816225}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+CIM_./"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+Win32_./"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368928810}], "captures": {"SELECT * FROM Win32_VoltageProbe": [{"type": "absolute", "value": 5368928810}]}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+MSAcpi_./"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368816500}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+CIM_./"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+Win32_./"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+MSAcpi_./"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368917781}], "captures": {"SELECT * FROM MSAcpi_ThermalZoneTemperature": [{"type": "absolute", "value": 5368917781}]}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368816515}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+CIM_./"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368916074}], "captures": {"SELECT * FROM CIM_TemperatureSensor": [{"type": "absolute", "value": 5368916074}]}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+Win32_./"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+MSAcpi_./"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "write process memory": {"meta": {"name": "write process memory", "authors": ["moritz.raabe@mandiant.com"], "scope": "function", "attack": [{"parts": ["Defense Evasion", "Process Injection"], "tactic": "Defense Evasion", "technique": "Process Injection", "subtechnique": "", "id": "T1055"}], "mbc": [], "references": [], "examples": ["2D3EDC218A90F03089CC01715A9F047F:0x4027CF"], "description": "", "lib": true, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: write process memory\n    authors:\n      - moritz.raabe@mandiant.com\n    lib: true\n    scope: function\n    att&ck:\n      - Defense Evasion::Process Injection [T1055]\n    examples:\n      - 2D3EDC218A90F03089CC01715A9F047F:0x4027CF\n  features:\n    - or:\n      - api: kernel32.WriteProcessMemory\n      - api: ntdll.NtWriteVirtualMemory\n      - api: ntdll.ZwWriteVirtualMemory\n      - api: NtWow64WriteVirtualMemory64\n", "matches": [[{"type": "absolute", "value": 5368811715}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.WriteProcessMemory"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368952486}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtWriteVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.ZwWriteVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtWow64WriteVirtualMemory64"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368812360}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.WriteProcessMemory"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368954178}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtWriteVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.ZwWriteVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtWow64WriteVirtualMemory64"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368813750}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.WriteProcessMemory"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368951194}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtWriteVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.ZwWriteVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtWow64WriteVirtualMemory64"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368816245}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.WriteProcessMemory"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368955579}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtWriteVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.ZwWriteVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtWow64WriteVirtualMemory64"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "get common file path": {"meta": {"name": "get common file path", "namespace": "host-interaction/file-system", "authors": ["moritz.raabe@mandiant.com", "michael.hunhoff@mandiant.com", "anushka.virgaonkar@mandiant.com"], "scope": "function", "attack": [{"parts": ["Discovery", "File and Directory Discovery"], "tactic": "Discovery", "technique": "File and Directory Discovery", "subtechnique": "", "id": "T1083"}], "mbc": [{"parts": ["Discovery", "File and Directory Discovery"], "objective": "Discovery", "behavior": "File and Directory Discovery", "method": "", "id": "E1083"}], "references": [], "examples": ["Practical Malware Analysis Lab 03-02.dll_:0x10003415", "972B219F18379907A045431303F4DA7D:0x404887"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: get common file path\n    namespace: host-interaction/file-system\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scope: function\n    att&ck:\n      - Discovery::File and Directory Discovery [T1083]\n    mbc:\n      - Discovery::File and Directory Discovery [E1083]\n    examples:\n      - Practical Malware Analysis Lab 03-02.dll_:0x10003415\n      - 972B219F18379907A045431303F4DA7D:0x404887\n  features:\n    - or:\n      - api: kernel32.GetTempPath\n      - api: kernel32.GetTempFileName\n      - api: kernel32.GetSystemDirectory\n      - api: kernel32.GetWindowsDirectory\n      - api: kernel32.GetSystemWow64Directory\n      - api: GetAllUsersProfileDirectory\n      - api: GetAppContainerFolderPath\n      - api: GetCurrentDirectory\n      - api: GetDefaultUserProfileDirectory\n      - api: GetProfilesDirectory\n      - api: GetUserProfileDirectory\n      - api: SHGetFolderPathAndSubDir\n      - api: shell32.SHGetFolderPath\n      - api: shell32.SHGetFolderLocation\n      - api: shell32.SHGetSpecialFolderPath\n      - api: shell32.SHGetSpecialFolderLocation\n      - api: System.IO.Directory::GetCurrentDirectory\n      - api: System.Environment::GetFolderPath\n      - property/read: System.Environment::SystemDirectory\n      - property/read: System.Environment::CurrentDirectory\n", "matches": [[{"type": "absolute", "value": 5368811740}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetTempPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetTempFileName"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetSystemDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetWindowsDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetSystemWow64Directory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetAllUsersProfileDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetAppContainerFolderPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetCurrentDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetDefaultUserProfileDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetProfilesDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetUserProfileDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHGetFolderPathAndSubDir"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetFolderPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetFolderLocation"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "shell32.SHGetSpecialFolderPath"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368935788}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetSpecialFolderLocation"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.Directory::GetCurrentDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Environment::GetFolderPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.Environment::SystemDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.Environment::CurrentDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368812140}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetTempPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetTempFileName"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetSystemDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetWindowsDirectory"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368937556}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetSystemWow64Directory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetAllUsersProfileDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetAppContainerFolderPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetCurrentDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetDefaultUserProfileDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetProfilesDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetUserProfileDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHGetFolderPathAndSubDir"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetFolderPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetFolderLocation"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetSpecialFolderPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetSpecialFolderLocation"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.Directory::GetCurrentDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Environment::GetFolderPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.Environment::SystemDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.Environment::CurrentDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368815050}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetTempPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetTempFileName"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetSystemDirectory"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368881771}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetWindowsDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetSystemWow64Directory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetAllUsersProfileDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetAppContainerFolderPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetCurrentDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetDefaultUserProfileDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetProfilesDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetUserProfileDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHGetFolderPathAndSubDir"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetFolderPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetFolderLocation"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetSpecialFolderPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetSpecialFolderLocation"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.Directory::GetCurrentDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Environment::GetFolderPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.Environment::SystemDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.Environment::CurrentDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368816230}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetTempPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetTempFileName"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetSystemDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetWindowsDirectory"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368946447}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetSystemWow64Directory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetAllUsersProfileDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetAppContainerFolderPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetCurrentDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetDefaultUserProfileDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetProfilesDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetUserProfileDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHGetFolderPathAndSubDir"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetFolderPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetFolderLocation"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetSpecialFolderPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetSpecialFolderLocation"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.Directory::GetCurrentDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Environment::GetFolderPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.Environment::SystemDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.Environment::CurrentDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368816310}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetTempPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetTempFileName"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetSystemDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetWindowsDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetSystemWow64Directory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetAllUsersProfileDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetAppContainerFolderPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetCurrentDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetDefaultUserProfileDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetProfilesDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetUserProfileDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHGetFolderPathAndSubDir"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetFolderPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetFolderLocation"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "shell32.SHGetSpecialFolderPath"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368945980}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetSpecialFolderLocation"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.Directory::GetCurrentDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Environment::GetFolderPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.Environment::SystemDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.Environment::CurrentDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "query environment variable": {"meta": {"name": "query environment variable", "namespace": "host-interaction/environment-variable", "authors": ["michael.hunhoff@mandiant.com", "@_re_fox"], "scope": "function", "attack": [{"parts": ["Discovery", "System Information Discovery"], "tactic": "Discovery", "technique": "System Information Discovery", "subtechnique": "", "id": "T1082"}], "mbc": [{"parts": ["Discovery", "System Information Discovery"], "objective": "Discovery", "behavior": "System Information Discovery", "method": "", "id": "E1082"}], "references": [], "examples": ["Practical Malware Analysis Lab 14-02.exe_:0x401880", "0761142efbda6c4b1e801223de723578:0x65483490"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: query environment variable\n    namespace: host-interaction/environment-variable\n    authors:\n      - michael.hunhoff@mandiant.com\n      - \"@_re_fox\"\n    scope: function\n    att&ck:\n      - Discovery::System Information Discovery [T1082]\n    mbc:\n      - Discovery::System Information Discovery [E1082]\n    examples:\n      - Practical Malware Analysis Lab 14-02.exe_:0x401880\n      - 0761142efbda6c4b1e801223de723578:0x65483490\n  features:\n    - or:\n      - api: kernel32.GetEnvironmentVariable\n      - api: kernel32.GetEnvironmentStrings\n      - api: kernel32.ExpandEnvironmentStrings\n      - api: msvcr90.getenv\n      - api: msvcrt.getenv\n      - api: System.Environment::GetEnvironmentVariable\n      - api: System.Environment::GetEnvironmentVariables\n      - api: System.Environment::ExpandEnvironmentVariables\n", "matches": [[{"type": "absolute", "value": 5368811740}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetEnvironmentVariable"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetEnvironmentStrings"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.ExpandEnvironmentStrings"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368935765}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "msvcr90.getenv"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "msvcrt.getenv"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Environment::GetEnvironmentVariable"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Environment::GetEnvironmentVariables"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Environment::ExpandEnvironmentVariables"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368814500}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetEnvironmentVariable"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368909873}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetEnvironmentStrings"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.ExpandEnvironmentStrings"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "msvcr90.getenv"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "msvcrt.getenv"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Environment::GetEnvironmentVariable"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Environment::GetEnvironmentVariables"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Environment::ExpandEnvironmentVariables"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368815050}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetEnvironmentVariable"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368881871}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetEnvironmentStrings"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.ExpandEnvironmentStrings"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "msvcr90.getenv"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "msvcrt.getenv"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Environment::GetEnvironmentVariable"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Environment::GetEnvironmentVariables"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Environment::ExpandEnvironmentVariables"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368816310}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetEnvironmentVariable"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetEnvironmentStrings"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.ExpandEnvironmentStrings"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368945957}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "msvcr90.getenv"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "msvcrt.getenv"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Environment::GetEnvironmentVariable"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Environment::GetEnvironmentVariables"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Environment::ExpandEnvironmentVariables"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "print debug messages": {"meta": {"name": "print debug messages", "namespace": "host-interaction/log/debug/write-event", "authors": ["michael.hunhoff@mandiant.com"], "scope": "function", "attack": [], "mbc": [], "references": [], "examples": ["493167E85E45363D09495D0841C30648:0x401000"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: print debug messages\n    namespace: host-interaction/log/debug/write-event\n    authors:\n      - michael.hunhoff@mandiant.com\n    scope: function\n    examples:\n      - 493167E85E45363D09495D0841C30648:0x401000\n  features:\n    - or:\n      - api: DbgPrint\n      - api: kernel32.OutputDebugString\n", "matches": [[{"type": "absolute", "value": 5368811805}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "DbgPrint"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.OutputDebugString"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368851717}, {"type": "absolute", "value": 5368851655}, {"type": "absolute", "value": 5368851977}, {"type": "absolute", "value": 5368851692}, {"type": "absolute", "value": 5368851437}, {"type": "absolute", "value": 5368851533}, {"type": "absolute", "value": 5368852050}, {"type": "absolute", "value": 5368851955}, {"type": "absolute", "value": 5368851606}, {"type": "absolute", "value": 5368851511}, {"type": "absolute", "value": 5368851735}, {"type": "absolute", "value": 5368851901}], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368812430}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "DbgPrint"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.OutputDebugString"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368844884}], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368812840}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "DbgPrint"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.OutputDebugString"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368908061}], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368814640}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "DbgPrint"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.OutputDebugString"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368908349}, {"type": "absolute", "value": 5368908277}, {"type": "absolute", "value": 5368908316}, {"type": "absolute", "value": 5368908301}, {"type": "absolute", "value": 5368908364}, {"type": "absolute", "value": 5368908221}], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368814935}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "DbgPrint"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.OutputDebugString"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368908610}, {"type": "absolute", "value": 5368908771}, {"type": "absolute", "value": 5368908756}, {"type": "absolute", "value": 5368908676}, {"type": "absolute", "value": 5368908804}, {"type": "absolute", "value": 5368908819}, {"type": "absolute", "value": 5368908732}], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368814990}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "DbgPrint"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.OutputDebugString"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368907858}, {"type": "absolute", "value": 5368907903}], "captures": {}}], "locations": [], "captures": {}}]]}, "get system information on Windows": {"meta": {"name": "get system information on Windows", "namespace": "host-interaction/os/info", "authors": ["moritz.raabe@mandiant.com", "joakim@intezer.com"], "scope": "function", "attack": [{"parts": ["Discovery", "System Information Discovery"], "tactic": "Discovery", "technique": "System Information Discovery", "subtechnique": "", "id": "T1082"}], "mbc": [], "references": [], "examples": ["563653399B82CD443F120ECEFF836EA3678D4CF11D9B351BB737573C2D856299:0x140002280"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: get system information on Windows\n    namespace: host-interaction/os/info\n    authors:\n      - moritz.raabe@mandiant.com\n      - joakim@intezer.com\n    scope: function\n    att&ck:\n      - Discovery::System Information Discovery [T1082]\n    examples:\n      - 563653399B82CD443F120ECEFF836EA3678D4CF11D9B351BB737573C2D856299:0x140002280\n  features:\n    - and:\n      - os: windows\n      - or:\n        - api: kernel32.GetSystemInfo\n        - api: kernel32.GetNativeSystemInfo\n        - api: NtQuerySystemInformation\n        - api: NtQuerySystemInformationEx\n        - api: ntdll.RtlGetNativeSystemInformation\n        - api: ZwQuerySystemInformation\n        - api: ZwQuerySystemInformationEx\n", "matches": [[{"type": "absolute", "value": 5368811805}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetSystemInfo"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368851199}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetNativeSystemInfo"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtQuerySystemInformation"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtQuerySystemInformationEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.RtlGetNativeSystemInformation"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwQuerySystemInformation"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwQuerySystemInformationEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368812035}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetSystemInfo"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368852431}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetNativeSystemInfo"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtQuerySystemInformation"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtQuerySystemInformationEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.RtlGetNativeSystemInformation"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwQuerySystemInformation"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwQuerySystemInformationEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368813635}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetSystemInfo"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368839289}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetNativeSystemInfo"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtQuerySystemInformation"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtQuerySystemInformationEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.RtlGetNativeSystemInformation"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwQuerySystemInformation"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwQuerySystemInformationEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368816160}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetSystemInfo"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368978878}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetNativeSystemInfo"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtQuerySystemInformation"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtQuerySystemInformationEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.RtlGetNativeSystemInformation"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwQuerySystemInformation"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwQuerySystemInformationEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "parse PE header": {"meta": {"name": "parse PE header", "namespace": "load-code/pe", "authors": ["moritz.raabe@mandiant.com"], "scope": "function", "attack": [{"parts": ["Execution", "Shared Modules"], "tactic": "Execution", "technique": "Shared Modules", "subtechnique": "", "id": "T1129"}], "mbc": [], "references": [], "examples": ["9324D1A8AE37A36AE560C37448C9705A:0x403DD0"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: parse PE header\n    namespace: load-code/pe\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: function\n    att&ck:\n      - Execution::Shared Modules [T1129]\n    examples:\n      - 9324D1A8AE37A36AE560C37448C9705A:0x403DD0\n  features:\n    - and:\n      - os: windows\n      - and:\n        - mnemonic: cmp\n        - or:\n          - number: 0x4550 = IMAGE_NT_SIGNATURE (PE)\n          - and:\n            - number: 0x50\n            - number: 0x45\n        - or:\n          - number: 0x5A4D = IMAGE_DOS_SIGNATURE (MZ)\n          - and:\n            - number: 0x4D\n            - number: 0x5A\n        - optional:\n          - and:\n            - operand[1].offset: 0x3C = IMAGE_DOS_HEADER.e_lfanew\n            - or:\n              - and:\n                - arch: i386\n                - operand[1].offset: 0x50 = IMAGE_NT_HEADERS.OptionalHeader.SizeOfImage\n                - operand[1].offset: 0x34 = IMAGE_NT_HEADERS.OptionalHeader.ImageBase\n              - and:\n                - arch: amd64\n                - operand[1].offset: 0x50 = IMAGE_NT_HEADERS64.OptionalHeader.SizeOfImage\n                - operand[1].offset: 0x30 = IMAGE_NT_HEADERS64.OptionalHeader.ImageBase\n          - basic block:\n            - and:\n              - operand[1].offset: 0x3C = IMAGE_DOS_HEADER.e_lfanew\n              - 3 or more:\n                - operand[1].offset: 0x4 = IMAGE_NT_HEADERS.FileHeader.Machine\n                - operand[1].offset: 0x6 = IMAGE_NT_HEADERS.FileHeader.NumberOfSections\n                - operand[1].offset: 0x14 = IMAGE_NT_HEADERS.FileHeader.SizeOfOptionalHeader\n                - operand[1].offset: 0x16 = IMAGE_NT_HEADERS.FileHeader.Characteristics\n                - operand[1].offset: 0x28 = IMAGE_NT_HEADERS.OptionalHeader.AddressOfEntryPoint  # for 32 and 64 bit\n                - or:\n                  - and:\n                    - arch: i386\n                    - operand[1].offset: 0x34 = IMAGE_NT_HEADERS.OptionalHeader.ImageBase\n                    - operand[1].offset: 0x50 = IMAGE_NT_HEADERS.OptionalHeader.SizeOfImage\n                  - and:\n                    - arch: amd64\n                    - operand[1].offset: 0x30 = IMAGE_NT_HEADERS.OptionalHeader.ImageBase\n                    - operand[1].offset: 0x50 = IMAGE_NT_HEADERS64.OptionalHeader.SizeOfImage\n", "matches": [[{"type": "absolute", "value": 5368812020}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "mnemonic", "mnemonic": "cmp"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5369019394}, {"type": "absolute", "value": 5369019331}, {"type": "absolute", "value": 5369019427}, {"type": "absolute", "value": 5369019386}, {"type": "absolute", "value": 5369019813}, {"type": "absolute", "value": 5369019972}, {"type": "absolute", "value": 5369019966}, {"type": "absolute", "value": 5369019402}, {"type": "absolute", "value": 5369019307}, {"type": "absolute", "value": 5369019820}, {"type": "absolute", "value": 5369019979}, {"type": "absolute", "value": 5369019407}, {"type": "absolute", "value": 5369019952}, {"type": "absolute", "value": 5369019572}, {"type": "absolute", "value": 5369019418}, {"type": "absolute", "value": 5369019806}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "number", "number": 17744, "description": "IMAGE_NT_SIGNATURE (PE)"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5369019331}], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "number", "number": 80}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 69}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "number", "number": 23117, "description": "IMAGE_DOS_SIGNATURE (MZ)"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5369019302}], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "number", "number": 77}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 90}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "operand offset", "index": 1, "operand_offset": 60, "description": "IMAGE_DOS_HEADER.e_lfanew"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5369019316}], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "arch", "arch": "i386"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "operand offset", "index": 1, "operand_offset": 80, "description": "IMAGE_NT_HEADERS.OptionalHeader.SizeOfImage"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "operand offset", "index": 1, "operand_offset": 52, "description": "IMAGE_NT_HEADERS.OptionalHeader.ImageBase"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "arch", "arch": "amd64"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": false, "node": {"feature": {"type": "operand offset", "index": 1, "operand_offset": 80, "description": "IMAGE_NT_HEADERS64.OptionalHeader.SizeOfImage"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "operand offset", "index": 1, "operand_offset": 48, "description": "IMAGE_NT_HEADERS64.OptionalHeader.ImageBase"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5369019254}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "parse PE header/d47c7b4623414997ab7476659b369ae1"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368815575}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "mnemonic", "mnemonic": "cmp"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5369016033}, {"type": "absolute", "value": 5369016097}, {"type": "absolute", "value": 5369016161}, {"type": "absolute", "value": 5369016118}, {"type": "absolute", "value": 5369016134}, {"type": "absolute", "value": 5369016056}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "number", "number": 17744, "description": "IMAGE_NT_SIGNATURE (PE)"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5369016097}], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "number", "number": 80}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 69}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "number", "number": 23117, "description": "IMAGE_DOS_SIGNATURE (MZ)"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5369016056}], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "number", "number": 77}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 90}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "operand offset", "index": 1, "operand_offset": 60, "description": "IMAGE_DOS_HEADER.e_lfanew"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5369016072}], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "arch", "arch": "i386"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "operand offset", "index": 1, "operand_offset": 80, "description": "IMAGE_NT_HEADERS.OptionalHeader.SizeOfImage"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "operand offset", "index": 1, "operand_offset": 52, "description": "IMAGE_NT_HEADERS.OptionalHeader.ImageBase"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "arch", "arch": "amd64"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": false, "node": {"feature": {"type": "operand offset", "index": 1, "operand_offset": 80, "description": "IMAGE_NT_HEADERS64.OptionalHeader.SizeOfImage"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "operand offset", "index": 1, "operand_offset": 48, "description": "IMAGE_NT_HEADERS64.OptionalHeader.ImageBase"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "parse PE header/d47c7b4623414997ab7476659b369ae1"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "check for debugger via API": {"meta": {"name": "check for debugger via API", "namespace": "anti-analysis/anti-debugging/debugger-detection", "authors": ["michael.hunhoff@mandiant.com", "anushka.virgaonkar@mandiant.com"], "scope": "function", "attack": [], "mbc": [{"parts": ["Anti-Behavioral Analysis", "Debugger Detection", "CheckRemoteDebuggerPresent"], "objective": "Anti-Behavioral Analysis", "behavior": "Debugger Detection", "method": "CheckRemoteDebuggerPresent", "id": "B0001.002"}, {"parts": ["Anti-Behavioral Analysis", "Debugger Detection", "WudfIsAnyDebuggerPresent"], "objective": "Anti-Behavioral Analysis", "behavior": "Debugger Detection", "method": "WudfIsAnyDebuggerPresent", "id": "B0001.031"}], "references": ["https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiDebug/CheckRemoteDebuggerPresent.cpp"], "examples": ["al-khaser_x86.exe_:0x420000"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: check for debugger via API\n    namespace: anti-analysis/anti-debugging/debugger-detection\n    authors:\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scope: function\n    mbc:\n      - Anti-Behavioral Analysis::Debugger Detection::CheckRemoteDebuggerPresent [B0001.002]\n      - Anti-Behavioral Analysis::Debugger Detection::WudfIsAnyDebuggerPresent [B0001.031]\n    references:\n      - https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiDebug/CheckRemoteDebuggerPresent.cpp\n    examples:\n      - al-khaser_x86.exe_:0x420000\n  features:\n    - or:\n      # We're not including kernel32.IsDebuggerPresent here because some exception handlers and other compiler-inserted\n      # code may add calls to it, especially in debug builds. So, likely even with pretty good library code detection\n      # this feature could result in many false positives.\n      - api: kernel32.CheckRemoteDebuggerPresent\n      - api: WUDFPlatform.WudfIsAnyDebuggerPresent\n      - api: WUDFPlatform.WudfIsKernelDebuggerPresent\n      - api: WUDFPlatform.WudfIsUserDebuggerPresent\n      - property/read: System.Diagnostics.Debugger::IsAttached\n", "matches": [[{"type": "absolute", "value": 5368812145}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.CheckRemoteDebuggerPresent"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368837791}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "WUDFPlatform.WudfIsAnyDebuggerPresent"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "WUDFPlatform.WudfIsKernelDebuggerPresent"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "WUDFPlatform.WudfIsUserDebuggerPresent"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.Diagnostics.Debugger::IsAttached"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "check process job object": {"meta": {"name": "check process job object", "namespace": "anti-analysis/anti-debugging/debugger-detection", "authors": ["michael.hunhoff@mandiant.com"], "scope": "function", "attack": [], "mbc": [{"parts": ["Anti-Behavioral Analysis", "Debugger Detection"], "objective": "Anti-Behavioral Analysis", "behavior": "Debugger Detection", "method": "", "id": "B0001"}], "references": ["https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiDebug/ProcessJob.cpp"], "examples": ["al-khaser_x86.exe_:0x426730"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: check process job object\n    namespace: anti-analysis/anti-debugging/debugger-detection\n    authors:\n      - michael.hunhoff@mandiant.com\n    scope: function\n    mbc:\n      - Anti-Behavioral Analysis::Debugger Detection [B0001]\n    references:\n      - https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiDebug/ProcessJob.cpp\n    examples:\n      - al-khaser_x86.exe_:0x426730\n  features:\n    - and:\n      - match: contain loop\n      - basic block:\n        - and:\n          - api: kernel32.QueryInformationJobObject\n          - number: 0x3 = JobObjectBasicProcessIdList\n      - basic block:\n        - and:\n          - api: kernel32.OpenProcess\n          - number: 0x400 = PROCESS_QUERY_INFORMATION\n", "matches": [[{"type": "absolute", "value": 5368812150}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "contain loop"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368812150}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 5368812150}], "captures": {}}, {"success": true, "node": {"statement": {"scope": "basic block", "type": "subscope"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.QueryInformationJobObject"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368863567}], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 3, "description": "JobObjectBasicProcessIdList"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368863560}], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 5368863518}], "captures": {}}, {"success": true, "node": {"statement": {"scope": "basic block", "type": "subscope"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.OpenProcess"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368863698}], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 1024, "description": "PROCESS_QUERY_INFORMATION"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368863693}], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 5368863684}], "captures": {}}], "locations": [], "captures": {}}]]}, "execute anti-debugging instructions": {"meta": {"name": "execute anti-debugging instructions", "namespace": "anti-analysis/anti-debugging/debugger-detection", "authors": ["moritz.raabe@mandiant.com"], "scope": "function", "attack": [], "mbc": [{"parts": ["Anti-Behavioral Analysis", "Debugger Detection", "Anti-debugging Instructions"], "objective": "Anti-Behavioral Analysis", "behavior": "Debugger Detection", "method": "Anti-debugging Instructions", "id": "B0001.034"}], "references": [], "examples": ["Practical Malware Analysis Lab 16-03.exe_:0x401300"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: execute anti-debugging instructions\n    namespace: anti-analysis/anti-debugging/debugger-detection\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: function\n    mbc:\n      - Anti-Behavioral Analysis::Debugger Detection::Anti-debugging Instructions [B0001.034]\n    examples:\n      - Practical Malware Analysis Lab 16-03.exe_:0x401300\n  features:\n    - or:\n      - count(mnemonic(rdtsc)): 2 or more\n      - mnemonic: icebp\n", "matches": [[{"type": "absolute", "value": 5368812230}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "mnemonic", "mnemonic": "icebp"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"min": 2, "max": 9223372036854775808, "child": {"type": "mnemonic", "mnemonic": "rdtsc"}, "type": "range"}, "type": "statement"}, "children": [], "locations": [{"type": "absolute", "value": 5368999657}, {"type": "absolute", "value": 5368999623}], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368815890}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "mnemonic", "mnemonic": "icebp"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"min": 2, "max": 9223372036854775808, "child": {"type": "mnemonic", "mnemonic": "rdtsc"}, "type": "range"}, "type": "statement"}, "children": [], "locations": [{"type": "absolute", "value": 5368999336}, {"type": "absolute", "value": 5368999355}, {"type": "absolute", "value": 5368999376}], "captures": {}}], "locations": [], "captures": {}}]]}, "terminate process": {"meta": {"name": "terminate process", "namespace": "host-interaction/process/terminate", "authors": ["moritz.raabe@mandiant.com", "michael.hunhoff@mandiant.com", "anushka.virgaonkar@mandiant.com"], "scope": "function", "attack": [], "mbc": [{"parts": ["Process", "Terminate Process"], "objective": "Process", "behavior": "Terminate Process", "method": "", "id": "C0018"}], "references": [], "examples": ["C91887D861D9BD4A5872249B641BC9F9:0x401A77", "9B7CCAA2AE6A5B96E3110EBCBC4311F6:0x10010307"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: terminate process\n    namespace: host-interaction/process/terminate\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scope: function\n    mbc:\n      - Process::Terminate Process [C0018]\n    examples:\n      - C91887D861D9BD4A5872249B641BC9F9:0x401A77\n      - 9B7CCAA2AE6A5B96E3110EBCBC4311F6:0x10010307\n  features:\n    - or:\n      - api: System.Diagnostics.Process::Kill\n      - api: System.Diagnostics.Process::WaitForExit\n      - api: System.Diagnostics.Process::WaitForExitAsync\n      - api: System.Environment::Exit\n      - api: System.Windows.Forms.Application::Exit\n      - and:\n        - optional:\n          - match: open process\n        - or:\n          - api: kernel32.TerminateProcess\n          - api: ntdll.NtTerminateProcess\n          - api: kernel32.ExitProcess\n", "matches": [[{"type": "absolute", "value": 5368812350}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "System.Diagnostics.Process::Kill"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Diagnostics.Process::WaitForExit"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Diagnostics.Process::WaitForExitAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Environment::Exit"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Windows.Forms.Application::Exit"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "match", "match": "open process"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.TerminateProcess"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5369007930}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtTerminateProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.ExitProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "inject APC": {"meta": {"name": "inject APC", "namespace": "host-interaction/process/inject", "authors": ["william.ballenthin@mandiant.com"], "scope": "function", "attack": [{"parts": ["Defense Evasion", "Process Injection", "Asynchronous Procedure Call"], "tactic": "Defense Evasion", "technique": "Process Injection", "subtechnique": "Asynchronous Procedure Call", "id": "T1055.004"}], "mbc": [], "references": [], "examples": ["al-khaser_x64.exe_:0x140019348"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: inject APC\n    namespace: host-interaction/process/inject\n    authors:\n      - william.ballenthin@mandiant.com\n    scope: function\n    att&ck:\n      - Defense Evasion::Process Injection::Asynchronous Procedure Call [T1055.004]\n    examples:\n      - al-khaser_x64.exe_:0x140019348\n  features:\n    - and:\n      - or:\n        - match: write process memory\n        - match: create or open section object\n        - api: kernel32.MapViewOfFile\n      - or:\n        - api: kernel32.QueueUserAPC\n        - api: ntdll.NtQueueApcThread\n      - optional:\n        - or:\n          - number: 0x1fffff = THREAD_ALL_ACCESS\n          - api: kernel32.CreateProcess\n          - api: kernel32.OpenProcess\n", "matches": [[{"type": "absolute", "value": 5368812360}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.QueueUserAPC"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368954348}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtQueueApcThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "write process memory"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.WriteProcessMemory"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368954178}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtWriteVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.ZwWriteVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtWow64WriteVirtualMemory64"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 5368812360}], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "create or open section object"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.MapViewOfFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "number", "number": 2097151, "description": "THREAD_ALL_ACCESS"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368953938}, {"type": "absolute", "value": 5368954299}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.CreateProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.OpenProcess"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368953943}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "enumerate threads": {"meta": {"name": "enumerate threads", "namespace": "host-interaction/thread/list", "authors": ["moritz.raabe@mandiant.com"], "scope": "function", "attack": [{"parts": ["Discovery", "Process Discovery"], "tactic": "Discovery", "technique": "Process Discovery", "subtechnique": "", "id": "T1057"}], "mbc": [{"parts": ["Process", "Enumerate Threads"], "objective": "Process", "behavior": "Enumerate Threads", "method": "", "id": "C0064"}], "references": [], "examples": ["Practical Malware Analysis Lab 05-01.dll_:0x10006BD5"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: enumerate threads\n    namespace: host-interaction/thread/list\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: function\n    att&ck:\n      - Discovery::Process Discovery [T1057]\n    mbc:\n      - Process::Enumerate Threads [C0064]\n    examples:\n      - Practical Malware Analysis Lab 05-01.dll_:0x10006BD5\n  features:\n    - and:\n      - api: kernel32.Thread32First\n      - api: kernel32.Thread32Next\n      - optional:\n        - basic block:\n          - and:\n            - or:\n              - number: 0x4 = TH32CS_SNAPTHREAD\n              # TH32CS_SNAPTHREAD includes all threads in the system in the snapshot\n            - api: kernel32.CreateToolhelp32Snapshot\n", "matches": [[{"type": "absolute", "value": 5368812360}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.Thread32First"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368954263}], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.Thread32Next"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368954437}], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"scope": "basic block", "type": "subscope"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.CreateToolhelp32Snapshot"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368954212}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "number", "number": 4, "description": "TH32CS_SNAPTHREAD"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368954207}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 5368954205}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368813035}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.Thread32First"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368978399}], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.Thread32Next"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368978503}], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"scope": "basic block", "type": "subscope"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.CreateToolhelp32Snapshot"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368978364}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "number", "number": 4, "description": "TH32CS_SNAPTHREAD"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368978359}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 5368978288}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "send ICMP echo request": {"meta": {"name": "send ICMP echo request", "namespace": "communication/icmp", "authors": ["michael.hunhoff@mandiant.com"], "scope": "function", "attack": [], "mbc": [{"parts": ["Communication", "ICMP Communication", "Echo Request"], "objective": "Communication", "behavior": "ICMP Communication", "method": "Echo Request", "id": "C0014.002"}], "references": ["https://docs.microsoft.com/en-us/windows/win32/api/icmpapi/"], "examples": ["al-khaser_x86.exe_:0x449510"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: send ICMP echo request\n    namespace: communication/icmp\n    authors:\n      - michael.hunhoff@mandiant.com\n    scope: function\n    mbc:\n      - Communication::ICMP Communication::Echo Request [C0014.002]\n    references:\n      - https://docs.microsoft.com/en-us/windows/win32/api/icmpapi/\n    examples:\n      - al-khaser_x86.exe_:0x449510\n  features:\n    - and:\n      - or:\n        - api: IcmpSendEcho\n        - api: IcmpSendEcho2\n        - api: IcmpSendEcho2Ex\n        - api: Icmp6SendEcho2\n      - optional:\n        - or:\n          - api: IcmpCreateFile\n          - api: Icmp6CreateFile\n        - api: IcmpCloseHandle\n", "matches": [[{"type": "absolute", "value": 5368812530}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "IcmpSendEcho"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5369001023}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "IcmpSendEcho2"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "IcmpSendEcho2Ex"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Icmp6SendEcho2"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "IcmpCreateFile"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5369000837}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Icmp6CreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "IcmpCloseHandle"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5369001033}, {"type": "absolute", "value": 5369000941}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "get number of processors": {"meta": {"name": "get number of processors", "namespace": "host-interaction/hardware/cpu", "authors": ["michael.hunhoff@mandiant.com", "anushka.virgaonkar@mandiant.com"], "scope": "function", "attack": [{"parts": ["Discovery", "System Information Discovery"], "tactic": "Discovery", "technique": "System Information Discovery", "subtechnique": "", "id": "T1082"}], "mbc": [], "references": ["https://github.com/LordNoteworthy/al-khaser/blob/bed03d2f849d9060c68f8d5905bd204d0cb3f593/al-khaser/AntiVM/Generic.cpp#L361"], "examples": ["al-khaser_x86.exe_:0x432CB0"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: get number of processors\n    namespace: host-interaction/hardware/cpu\n    authors:\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scope: function\n    att&ck:\n      - Discovery::System Information Discovery [T1082]\n    references:\n      - https://github.com/LordNoteworthy/al-khaser/blob/bed03d2f849d9060c68f8d5905bd204d0cb3f593/al-khaser/AntiVM/Generic.cpp#L361\n    examples:\n      - al-khaser_x86.exe_:0x432CB0\n  features:\n    - or:\n      - and:\n        - match: PEB access\n        - or:\n          - and:\n            - arch: i386\n            - number: 0x64 = PEB->NumberOfProcessors\n          - and:\n            - arch: amd64\n            - number: 0xB8 = PEB->NumberOfProcessors\n      - property/read: System.Environment::ProcessorCount\n", "matches": [[{"type": "absolute", "value": 5368812675}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.Environment::ProcessorCount"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "PEB access"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "peb access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368914346}], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "fs access"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/aee9ee4a3df44121b21acb950535f6a7"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "arch", "arch": "i386"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "fs access"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "offset", "offset": 48}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/b86186bb56c74ecaa2b476462ebf83f3"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "arch", "arch": "amd64"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "gs access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368914346}], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "offset", "offset": 96}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/fc87da307f6f4da2b8fde64519f87688"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 5368914304}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "arch", "arch": "i386"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 100, "description": "PEB->NumberOfProcessors"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "arch", "arch": "amd64"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 184, "description": "PEB->NumberOfProcessors"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368914355}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "check if file exists": {"meta": {"name": "check if file exists", "namespace": "host-interaction/file-system/exists", "authors": ["moritz.raabe@mandiant.com", "michael.hunhoff@mandiant.com"], "scope": "function", "attack": [{"parts": ["Discovery", "File and Directory Discovery"], "tactic": "Discovery", "technique": "File and Directory Discovery", "subtechnique": "", "id": "T1083"}], "mbc": [{"parts": ["Discovery", "File and Directory Discovery"], "objective": "Discovery", "behavior": "File and Directory Discovery", "method": "", "id": "E1083"}], "references": [], "examples": ["31600AD0D1A7EA615690DF111AE36C73:0x401284"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: check if file exists\n    namespace: host-interaction/file-system/exists\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scope: function\n    att&ck:\n      - Discovery::File and Directory Discovery [T1083]\n    mbc:\n      - Discovery::File and Directory Discovery [E1083]\n    examples:\n      - 31600AD0D1A7EA615690DF111AE36C73:0x401284\n  features:\n    - or:\n      - basic block:\n        - and:\n          - api: kernel32.GetFileAttributes\n          - instruction:\n            - mnemonic: cmp\n            - number: 0xFFFFFFFF = INVALID_FILE_ATTRIBUTES\n      - basic block:\n        - and:\n          - api: kernel32.GetLastError\n          - instruction:\n            - mnemonic: cmp\n            - number: 2 = ERROR_FILE_NOT_FOUND\n      - api: shlwapi.PathFileExists\n      - api: System.IO.File::Exists\n      - property/read: System.IO.FileSystemInfo::Exists\n", "matches": [[{"type": "absolute", "value": 5368812680}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"scope": "basic block", "type": "subscope"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetFileAttributes"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368997837}], "captures": {}}, {"success": true, "node": {"statement": {"scope": "instruction", "type": "subscope"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "mnemonic", "mnemonic": "cmp"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368997846}], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 4294967295, "description": "INVALID_FILE_ATTRIBUTES"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368997846}], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 5368997846}], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 5368997776}], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "check if file exists/365eac8ed9a7465fa523bb7b444ec341"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shlwapi.PathFileExists"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::Exists"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.IO.FileSystemInfo::Exists"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368816025}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"scope": "basic block", "type": "subscope"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetFileAttributes"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368997997}], "captures": {}}, {"success": true, "node": {"statement": {"scope": "instruction", "type": "subscope"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "mnemonic", "mnemonic": "cmp"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368998006}], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 4294967295, "description": "INVALID_FILE_ATTRIBUTES"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368998006}], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 5368998006}], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 5368997936}], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "check if file exists/365eac8ed9a7465fa523bb7b444ec341"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shlwapi.PathFileExists"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::Exists"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.IO.FileSystemInfo::Exists"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "connect to WMI namespace via WbemLocator": {"meta": {"name": "connect to WMI namespace via WbemLocator", "namespace": "host-interaction/wmi", "authors": ["michael.hunhoff@mandiant.com"], "scope": "function", "attack": [{"parts": ["Execution", "Windows Management Instrumentation"], "tactic": "Execution", "technique": "Windows Management Instrumentation", "subtechnique": "", "id": "T1047"}], "mbc": [], "references": [], "examples": ["al-khaser_x64.exe_:0x14001956e", "al-khaser_x86.exe_:0x00445270"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "# generated using capa explorer for IDA Pro\nrule:\n  meta:\n    name: connect to WMI namespace via WbemLocator\n    namespace: host-interaction/wmi\n    authors:\n      - michael.hunhoff@mandiant.com\n    scope: function\n    att&ck:\n      - Execution::Windows Management Instrumentation [T1047]\n    examples:\n      - al-khaser_x64.exe_:0x14001956e\n      - al-khaser_x86.exe_:0x00445270\n  features:\n    - and:\n      - basic block:\n        - and:\n          - api: ole32.CoCreateInstance\n          - bytes: 11 F8 90 45 3A 1D D0 11 89 1F 00 AA 00 4B 2E 24 = CLSID_WbemLocator\n          - bytes: 87 A6 12 DC 7F 73 CF 11 88 4D 00 AA 00 4B 2E 24 = IID_IWbemLocator\n      - or:\n        - and:\n          - arch: i386\n          - offset: 0xC = ppv->ConnectServer\n        - and:\n          - arch: amd64\n          - offset: 0x18 = ppv->ConnectServer\n      - optional:\n        - string: /ROOT\\\\CIMV2/i\n        - string: /ROOT\\\\DEFAULT/i\n", "matches": [[{"type": "absolute", "value": 5368812910}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"scope": "basic block", "type": "subscope"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "ole32.CoCreateInstance"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368983484}], "captures": {}}, {"success": true, "node": {"feature": {"type": "bytes", "bytes": "11f890453a1dd011891f00aa004b2e24", "description": "CLSID_WbemLocator"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368983477}], "captures": {}}, {"success": true, "node": {"feature": {"type": "bytes", "bytes": "87a612dc7f73cf11884d00aa004b2e24", "description": "IID_IWbemLocator"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368983462}], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 5368983445}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "arch", "arch": "i386"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "offset", "offset": 12, "description": "ppv->ConnectServer"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "arch", "arch": "amd64"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"feature": {"type": "offset", "offset": 24, "description": "ppv->ConnectServer"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368983248}, {"type": "absolute", "value": 5368983632}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "regex", "regex": "/ROOT\\\\CIMV2/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/ROOT\\\\DEFAULT/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "check if process is running under wine": {"meta": {"name": "check if process is running under wine", "namespace": "anti-analysis/anti-emulation/wine", "authors": ["@_re_fox"], "scope": "function", "attack": [{"parts": ["Defense Evasion", "Virtualization/Sandbox Evasion", "System Checks"], "tactic": "Defense Evasion", "technique": "Virtualization/Sandbox Evasion", "subtechnique": "System Checks", "id": "T1497.001"}], "mbc": [{"parts": ["Anti-Behavioral Analysis", "Emulator Detection"], "objective": "Anti-Behavioral Analysis", "behavior": "Emulator Detection", "method": "", "id": "B0004"}], "references": ["https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiVM/Wine.cpp"], "examples": ["ccbf7cba35bab56563c0fbe4237fdc41:0x40d750"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: check if process is running under wine\n    namespace: anti-analysis/anti-emulation/wine\n    authors:\n      - \"@_re_fox\"\n    scope: function\n    att&ck:\n      - Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001]\n    mbc:\n      - Anti-Behavioral Analysis::Emulator Detection [B0004]\n    references:\n      - https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiVM/Wine.cpp\n    examples:\n      - ccbf7cba35bab56563c0fbe4237fdc41:0x40d750\n  features:\n    - or:\n      - string: /SOFTWARE\\\\Wine/i\n      - and:\n        - api: GetModuleHandle\n        - api: GetProcAddress\n        - string: \"wine_get_unix_file_name\"\n        - or:\n          - string: \"kernel32.dll\"\n          - string: \"ntdll.dll\"\n", "matches": [[{"type": "absolute", "value": 5368813180}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "regex", "regex": "/SOFTWARE\\\\Wine/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "GetModuleHandle"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368949745}], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "GetProcAddress"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368949789}], "captures": {}}, {"success": true, "node": {"feature": {"type": "string", "string": "wine_get_unix_file_name"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368949778}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "string", "string": "kernel32.dll"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368949738}], "captures": {}}, {"success": false, "node": {"feature": {"type": "string", "string": "ntdll.dll"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368815440}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "regex", "regex": "/SOFTWARE\\\\Wine/i"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368949915}], "captures": {"SOFTWARE\\Wine": [{"type": "absolute", "value": 5368949915}]}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "GetModuleHandle"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetProcAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "string", "string": "wine_get_unix_file_name"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "string", "string": "kernel32.dll"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "string", "string": "ntdll.dll"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "enumerate processes": {"meta": {"name": "enumerate processes", "namespace": "host-interaction/process/list", "authors": ["moritz.raabe@mandiant.com", "michael.hunhoff@mandiant.com"], "scope": "function", "attack": [{"parts": ["Discovery", "Process Discovery"], "tactic": "Discovery", "technique": "Process Discovery", "subtechnique": "", "id": "T1057"}, {"parts": ["Discovery", "Software Discovery"], "tactic": "Discovery", "technique": "Software Discovery", "subtechnique": "", "id": "T1518"}], "mbc": [], "references": [], "examples": ["2D3EDC218A90F03089CC01715A9F047F:0x403DAB", "35d04ecd797041eee796f4ddaa96cae8:0x10004F34"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: enumerate processes\n    namespace: host-interaction/process/list\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scope: function\n    att&ck:\n      - Discovery::Process Discovery [T1057]\n      - Discovery::Software Discovery [T1518]\n    examples:\n      - 2D3EDC218A90F03089CC01715A9F047F:0x403DAB\n      - 35d04ecd797041eee796f4ddaa96cae8:0x10004F34\n  features:\n    - or:\n      - api: System.Diagnostics.Process::GetProcesses\n      - and:\n        - api: kernel32.Process32First\n        - api: kernel32.Process32Next\n        - optional:\n          - basic block:\n            - and:\n              - or:\n                - number: 0xF = TH32CS_SNAPALL\n                - number: 0x2 = TH32CS_SNAPPROCESS\n              - api: kernel32.CreateToolhelp32Snapshot\n", "matches": [[{"type": "absolute", "value": 5368813355}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "System.Diagnostics.Process::GetProcesses"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.Process32First"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368982946}], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.Process32Next"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368983034}], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"scope": "basic block", "type": "subscope"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.CreateToolhelp32Snapshot"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368982887}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "number", "number": 15, "description": "TH32CS_SNAPALL"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 2, "description": "TH32CS_SNAPPROCESS"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368982882}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 5368982784}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "get OS version": {"meta": {"name": "get OS version", "authors": ["@mr-tz"], "scope": "function", "attack": [], "mbc": [], "references": [], "examples": ["493167E85E45363D09495D0841C30648:0x401000", "5f66b82558ca92e54e77f216ef4c066c:0x44580A"], "description": "", "lib": true, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: get OS version\n    authors:\n      - \"@mr-tz\"\n    lib: true\n    scope: function\n    examples:\n      - 493167E85E45363D09495D0841C30648:0x401000\n      - 5f66b82558ca92e54e77f216ef4c066c:0x44580A\n  features:\n    - or:\n      - api: RtlGetVersion\n      - api: ntoskrnl.PsGetVersion\n      - api: GetVersion\n      - api: GetVersionEx\n      - api: VerifyVersionInfo\n      - api: VerSetConditionMask\n      - api: RtlGetNtVersionNumbers\n", "matches": [[{"type": "absolute", "value": 5368813515}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "RtlGetVersion"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntoskrnl.PsGetVersion"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetVersion"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetVersionEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "VerifyVersionInfo"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368844532}], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "VerSetConditionMask"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368844452}, {"type": "absolute", "value": 5368844469}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "RtlGetNtVersionNumbers"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368815925}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "RtlGetVersion"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntoskrnl.PsGetVersion"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetVersion"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetVersionEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "VerifyVersionInfo"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368843269}], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "VerSetConditionMask"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368843172}, {"type": "absolute", "value": 5368843189}, {"type": "absolute", "value": 5368843206}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "RtlGetNtVersionNumbers"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "check for time delay via GetTickCount": {"meta": {"name": "check for time delay via GetTickCount", "namespace": "anti-analysis/anti-debugging/debugger-detection", "authors": ["michael.hunhoff@mandiant.com"], "scope": "function", "attack": [], "mbc": [{"parts": ["Anti-Behavioral Analysis", "Debugger Detection", "Timing/Delay Check GetTickCount"], "objective": "Anti-Behavioral Analysis", "behavior": "Debugger Detection", "method": "Timing/Delay Check GetTickCount", "id": "B0001.032"}], "references": [], "examples": ["Practical Malware Analysis Lab 16-03.exe_:0x4013d0"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: check for time delay via GetTickCount\n    namespace: anti-analysis/anti-debugging/debugger-detection\n    authors:\n      - michael.hunhoff@mandiant.com\n    scope: function\n    mbc:\n      - Anti-Behavioral Analysis::Debugger Detection::Timing/Delay Check GetTickCount [B0001.032]\n    examples:\n      - Practical Malware Analysis Lab 16-03.exe_:0x4013d0\n  features:\n    - and:\n      - count(api(kernel32.GetTickCount)): 2 or more\n      - basic block:\n        - and:\n          - mnemonic: sub\n          - mnemonic: cmp\n", "matches": [[{"type": "absolute", "value": 5368813565}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"scope": "basic block", "type": "subscope"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "mnemonic", "mnemonic": "sub"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368914545}, {"type": "absolute", "value": 5368914435}, {"type": "absolute", "value": 5368914535}], "captures": {}}, {"success": true, "node": {"feature": {"type": "mnemonic", "mnemonic": "cmp"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368914550}], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 5368914432}], "captures": {}}, {"success": true, "node": {"statement": {"min": 2, "max": 9223372036854775808, "child": {"type": "api", "api": "kernel32.GetTickCount"}, "type": "range"}, "type": "statement"}, "children": [], "locations": [{"type": "absolute", "value": 5368914520}, {"type": "absolute", "value": 5368914502}], "captures": {}}], "locations": [], "captures": {}}]]}, "inject dll": {"meta": {"name": "inject dll", "namespace": "host-interaction/process/inject", "authors": ["0x534a@mailbox.org"], "scope": "function", "attack": [{"parts": ["Defense Evasion", "Process Injection", "Dynamic-link Library Injection"], "tactic": "Defense Evasion", "technique": "Process Injection", "subtechnique": "Dynamic-link Library Injection", "id": "T1055.001"}], "mbc": [], "references": ["Practical Malware Analysis, p. 676", "https://www.researchgate.net/publication/279155742_A_Novel_Approach_to_Detect_Malware_Based_on_API_Call_Sequence_Analysis", "https://www.welivesecurity.com/wp-content/uploads/2016/10/eset-sednit-part3.pdf", "https://www.accenture.com/t20180127T003755Z_w_/us-en/_acnmedia/PDF-46/Accenture-Security-Dragonfish-Threat-Analysis.pdf", "https://unit42.paloaltonetworks.com/unit42-kazuar-multiplatform-espionage-backdoor-api-access/", "https://www.welivesecurity.com/wp-content/uploads/2018/10/ESET_GreyEnergy.pdf", "https://www.welivesecurity.com/2019/05/29/turla-powershell-usage/"], "examples": ["Practical Malware Analysis Lab 17-02.dll_:0x1000D10D"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: inject dll\n    namespace: host-interaction/process/inject\n    authors:\n      - 0x534a@mailbox.org\n    scope: function\n    att&ck:\n      - Defense Evasion::Process Injection::Dynamic-link Library Injection [T1055.001]\n    references:\n      - Practical Malware Analysis, p. 676\n      - https://www.researchgate.net/publication/279155742_A_Novel_Approach_to_Detect_Malware_Based_on_API_Call_Sequence_Analysis\n      - https://www.welivesecurity.com/wp-content/uploads/2016/10/eset-sednit-part3.pdf\n      - https://www.accenture.com/t20180127T003755Z_w_/us-en/_acnmedia/PDF-46/Accenture-Security-Dragonfish-Threat-Analysis.pdf\n      - https://unit42.paloaltonetworks.com/unit42-kazuar-multiplatform-espionage-backdoor-api-access/\n      - https://www.welivesecurity.com/wp-content/uploads/2018/10/ESET_GreyEnergy.pdf\n      - https://www.welivesecurity.com/2019/05/29/turla-powershell-usage/\n    examples:\n      - Practical Malware Analysis Lab 17-02.dll_:0x1000D10D\n  features:\n    - and:\n      - optional:\n        - or:\n          - match: open process\n          - match: host-interaction/process/create\n      - match: allocate RW memory\n      - match: write process memory\n      - and:\n        - or:\n          - api: kernel32.GetModuleHandle\n          - api: kernel32.GetModuleHandleEx\n        - string: \"/LoadLibrary[AW]/\"\n      - match: create thread\n", "matches": [[{"type": "absolute", "value": 5368813750}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "allocate RW memory"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "allocate memory"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAlloc"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocEx"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368951096}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocExNuma"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtect"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 5368950968}], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 4, "description": "PAGE_READWRITE"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368951069}], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 5368950968}], "captures": {}}, {"success": true, "node": {"feature": {"type": "match", "match": "write process memory"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.WriteProcessMemory"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368951194}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtWriteVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.ZwWriteVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtWow64WriteVirtualMemory64"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 5368813750}], "captures": {}}, {"success": true, "node": {"feature": {"type": "match", "match": "create thread"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "os", "os": "linux"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "pthread_create"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "System.Threading.Thread::Start"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "System.Threading.Thread::ctor"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.CreateThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "_beginthread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "_beginthreadex"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "PsCreateSystemThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHCreateThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHCreateThreadWithHandle"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.CreateRemoteThread"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368951265}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.CreateRemoteThreadEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "RtlCreateUserThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtCreateThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtCreateThreadEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.ZwCreateThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.ZwCreateThreadEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 5368951220}], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "open process"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.OpenProcess"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368950815}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtOpenProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 5368950804}], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "host-interaction/process/create"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetModuleHandle"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368950861}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetModuleHandleEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/LoadLibrary[AW]/"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368950912}], "captures": {"LoadLibraryW": [{"type": "absolute", "value": 5368950912}]}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "inject thread": {"meta": {"name": "inject thread", "namespace": "host-interaction/process/inject", "authors": ["anamaria.martinezgom@mandiant.com", "0x534a@mailbox.org"], "scope": "function", "attack": [{"parts": ["Defense Evasion", "Process Injection", "Thread Execution Hijacking"], "tactic": "Defense Evasion", "technique": "Process Injection", "subtechnique": "Thread Execution Hijacking", "id": "T1055.003"}, {"parts": ["Defense Evasion", "Reflective Code Loading"], "tactic": "Defense Evasion", "technique": "Reflective Code Loading", "subtechnique": "", "id": "T1620"}], "mbc": [], "references": [], "examples": ["Practical Malware Analysis Lab 12-01.exe_:0x4010D0", "2D3EDC218A90F03089CC01715A9F047F:0x4027CF"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: inject thread\n    namespace: host-interaction/process/inject\n    authors:\n      - anamaria.martinezgom@mandiant.com\n      - 0x534a@mailbox.org\n    scope: function\n    att&ck:\n      - Defense Evasion::Process Injection::Thread Execution Hijacking [T1055.003]\n      - Defense Evasion::Reflective Code Loading [T1620]\n    examples:\n      - Practical Malware Analysis Lab 12-01.exe_:0x4010D0\n      - 2D3EDC218A90F03089CC01715A9F047F:0x4027CF\n  features:\n    - and:\n      - or:\n        - match: allocate RWX memory\n        - match: allocate RW memory\n      - match: write process memory\n      - match: create thread\n      - optional:\n        - or:\n          - match: host-interaction/process/create\n          - match: open process\n          - number: 0x3000 = MEM_COMMIT or MEM_RESERVE\n", "matches": [[{"type": "absolute", "value": 5368813750}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "write process memory"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.WriteProcessMemory"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368951194}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtWriteVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.ZwWriteVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtWow64WriteVirtualMemory64"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 5368813750}], "captures": {}}, {"success": true, "node": {"feature": {"type": "match", "match": "create thread"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "os", "os": "linux"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "pthread_create"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "System.Threading.Thread::Start"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "System.Threading.Thread::ctor"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.CreateThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "_beginthread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "_beginthreadex"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "PsCreateSystemThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHCreateThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHCreateThreadWithHandle"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.CreateRemoteThread"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368951265}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.CreateRemoteThreadEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "RtlCreateUserThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtCreateThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtCreateThreadEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.ZwCreateThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.ZwCreateThreadEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 5368951220}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "match", "match": "allocate RWX memory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "match", "match": "allocate RW memory"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "allocate memory"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAlloc"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocEx"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368951096}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocExNuma"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtect"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 5368950968}], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 4, "description": "PAGE_READWRITE"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368951069}], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 5368950968}], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "match", "match": "host-interaction/process/create"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "match", "match": "open process"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.OpenProcess"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368950815}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtOpenProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 5368950804}], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 12288, "description": "MEM_COMMIT or MEM_RESERVE"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368951077}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "get memory capacity": {"meta": {"name": "get memory capacity", "namespace": "host-interaction/hardware/memory", "authors": ["moritz.raabe@mandiant.com"], "scope": "function", "attack": [{"parts": ["Discovery", "System Information Discovery"], "tactic": "Discovery", "technique": "System Information Discovery", "subtechnique": "", "id": "T1082"}], "mbc": [], "references": [], "examples": ["9324D1A8AE37A36AE560C37448C9705A:0x4052A0"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: get memory capacity\n    namespace: host-interaction/hardware/memory\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: function\n    att&ck:\n      - Discovery::System Information Discovery [T1082]\n    examples:\n      - 9324D1A8AE37A36AE560C37448C9705A:0x4052A0\n  features:\n    - or:\n      - api: kernel32.GlobalMemoryStatus\n      - api: kernel32.GlobalMemoryStatusEx\n        # TODO kernel32.GetSystemInfo with offset\n", "matches": [[{"type": "absolute", "value": 5368813815}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GlobalMemoryStatus"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GlobalMemoryStatusEx"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368923310}], "captures": {}}], "locations": [], "captures": {}}]]}, "enumerate process modules": {"meta": {"name": "enumerate process modules", "namespace": "host-interaction/process/modules/list", "authors": ["michael.hunhoff@mandiant.com", "anushka.virgaonkar@mandiant.com"], "scope": "function", "attack": [{"parts": ["Discovery", "Process Discovery"], "tactic": "Discovery", "technique": "Process Discovery", "subtechnique": "", "id": "T1057"}], "mbc": [], "references": [], "examples": ["6F99A2C8944CB02FF28C6F9CED59B161:0x419FF8", "9B2FD471274C41626B75DDBB5C897877:0x100046B0"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: enumerate process modules\n    namespace: host-interaction/process/modules/list\n    authors:\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scope: function\n    att&ck:\n      - Discovery::Process Discovery [T1057]\n    examples:\n      - 6F99A2C8944CB02FF28C6F9CED59B161:0x419FF8\n      - 9B2FD471274C41626B75DDBB5C897877:0x100046B0\n  features:\n    - or:\n      - and:\n        - optional:\n          - or:\n            - api: kernel32.OpenProcess\n            - api: kernel32.CloseHandle\n        - or:\n          - api: kernel32.K32EnumProcessModules\n          - api: kernel32.K32EnumProcessModulesEx\n          - api: kernel32.K32EnumProcesses\n          # depending on OS version in kernel32 or psapi\n          - api: EnumProcessModules\n          - api: EnumProcessModulesEx\n          - api: EnumProcesses\n      - and:\n        - api: kernel32.Module32First\n        - api: kernel32.Module32Next\n        - optional:\n          - basic block:\n            - and:\n              - or:\n                - number: 0x8 = TH32CS_SNAPMODULE\n                - number: 0x10 = TH32CS_SNAPMODULE32\n                - number: 0x18 = TH32CS_SNAPMODULE | TH32CS_SNAPMODULE32\n              - api: kernel32.CreateToolhelp32Snapshot\n      - and:\n        - property/read: System.Diagnostics.Process::Modules\n        - property/read: System.Diagnostics.ProcessModuleCollection::Item\n", "matches": [[{"type": "absolute", "value": 5368813990}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.Diagnostics.Process::Modules"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.Diagnostics.ProcessModuleCollection::Item"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.Module32First"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368890180}], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.Module32Next"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368890266}], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"scope": "basic block", "type": "subscope"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.CreateToolhelp32Snapshot"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368890108}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "number", "number": 8, "description": "TH32CS_SNAPMODULE"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 16, "description": "TH32CS_SNAPMODULE32"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 24, "description": "TH32CS_SNAPMODULE | TH32CS_SNAPMODULE32"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368890103}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 5368890032}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.OpenProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.CloseHandle"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368890301}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.K32EnumProcessModules"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.K32EnumProcessModulesEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.K32EnumProcesses"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "EnumProcessModules"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "EnumProcessModulesEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "EnumProcesses"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368815960}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.Diagnostics.Process::Modules"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.Diagnostics.ProcessModuleCollection::Item"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.Module32First"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368953371}], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.Module32Next"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368953421}], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"scope": "basic block", "type": "subscope"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.CreateToolhelp32Snapshot"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368953340}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "number", "number": 8, "description": "TH32CS_SNAPMODULE"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368953335}], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 16, "description": "TH32CS_SNAPMODULE32"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 24, "description": "TH32CS_SNAPMODULE | TH32CS_SNAPMODULE32"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 5368953248}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.OpenProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.CloseHandle"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368953434}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.K32EnumProcessModules"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.K32EnumProcessModulesEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.K32EnumProcesses"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "EnumProcessModules"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "EnumProcessModulesEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "EnumProcesses"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "check for software breakpoints": {"meta": {"name": "check for software breakpoints", "namespace": "anti-analysis/anti-debugging/debugger-detection", "authors": ["michael.hunhoff@mandiant.com"], "scope": "function", "attack": [], "mbc": [{"parts": ["Anti-Behavioral Analysis", "Debugger Detection", "Software Breakpoints"], "objective": "Anti-Behavioral Analysis", "behavior": "Debugger Detection", "method": "Software Breakpoints", "id": "B0001.025"}], "references": ["https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiDebug/SoftwareBreakpoints.cpp", "https://anti-debug.checkpoint.com/techniques/assembly.html"], "examples": ["al-khaser_x86.exe_:0x431020"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: check for software breakpoints\n    namespace: anti-analysis/anti-debugging/debugger-detection\n    authors:\n      - michael.hunhoff@mandiant.com\n    scope: function\n    mbc:\n      - Anti-Behavioral Analysis::Debugger Detection::Software Breakpoints [B0001.025]\n    references:\n      - https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiDebug/SoftwareBreakpoints.cpp\n      - https://anti-debug.checkpoint.com/techniques/assembly.html\n    examples:\n      - al-khaser_x86.exe_:0x431020\n  features:\n    - and:\n      - or:\n        - instruction:\n          - mnemonic: cmp\n          - number: 0xCC = INT3\n        - and:\n          - description: INT3 (long form)\n          - instruction:\n            - mnemonic: cmp\n            - number: 0xCD = INT3 (long form byte 1)\n          - instruction:\n            - mnemonic: cmp\n            - number: 0x03 = INT3 (long form byte 2)\n      - match: contain loop\n", "matches": [[{"type": "absolute", "value": 5368814035}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "contain loop"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368814035}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 5368814035}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"scope": "instruction", "type": "subscope"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "mnemonic", "mnemonic": "cmp"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368907642}], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 204, "description": "INT3"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368907642}], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 5368907642}], "captures": {}}, {"success": false, "node": {"statement": {"type": "and", "description": "INT3 (long form)"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "match", "match": "check for software breakpoints/cfd5f3d415eb4d8daef9fa59fc9ec6f9"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "check for software breakpoints/0fecce3caef14ab0a72ef9313822a924"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "set console window title": {"meta": {"name": "set console window title", "namespace": "host-interaction/gui/console", "authors": ["michael.hunhoff@mandiant.com"], "scope": "function", "attack": [], "mbc": [{"parts": ["Operating System", "Console"], "objective": "Operating System", "behavior": "Console", "method": "", "id": "C0033"}], "references": [], "examples": ["mimikatz.exe_:0x44570F"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: set console window title\n    namespace: host-interaction/gui/console\n    authors:\n      - michael.hunhoff@mandiant.com\n    scope: function\n    mbc:\n      - Operating System::Console [C0033]\n    examples:\n      - mimikatz.exe_:0x44570F\n  features:\n    - or:\n      - api: kernel32.SetConsoleTitle\n", "matches": [[{"type": "absolute", "value": 5368814050}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.SetConsoleTitle"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368969441}], "captures": {}}], "locations": [], "captures": {}}]]}, "interact with driver via control codes": {"meta": {"name": "interact with driver via control codes", "namespace": "host-interaction/driver", "authors": ["moritz.raabe@mandiant.com"], "scope": "function", "attack": [{"parts": ["Execution", "System Services", "Service Execution"], "tactic": "Execution", "technique": "System Services", "subtechnique": "Service Execution", "id": "T1569.002"}], "mbc": [], "references": [], "examples": ["Practical Malware Analysis Lab 10-03.exe_:0x401000", "9412A66BC81F51A1FA916AC47C77E02AC1A7C9DFF543233ED70AA265EF6A1E76:0x10002DE0"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: interact with driver via control codes\n    namespace: host-interaction/driver\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: function\n    att&ck:\n      - Execution::System Services::Service Execution [T1569.002]\n    examples:\n      - Practical Malware Analysis Lab 10-03.exe_:0x401000\n      - 9412A66BC81F51A1FA916AC47C77E02AC1A7C9DFF543233ED70AA265EF6A1E76:0x10002DE0\n  features:\n    - or:\n      - api: DeviceIoControl\n      - api: NtUnloadDriver\n      - api: ZwUnloadDriver\n      - and:\n        - number: 38 = SystemLoadAndCallImage\n        - api: ZwSetSystemInformation\n", "matches": [[{"type": "absolute", "value": 5368814865}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "DeviceIoControl"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368919808}, {"type": "absolute", "value": 5368920064}, {"type": "absolute", "value": 5368920318}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtUnloadDriver"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwUnloadDriver"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "number", "number": 38, "description": "SystemLoadAndCallImage"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwSetSystemInformation"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "get disk size": {"meta": {"name": "get disk size", "namespace": "host-interaction/hardware/storage", "authors": ["michael.hunhoff@mandiant.com", "anushka.virgaonkar@mandiant.com"], "scope": "function", "attack": [{"parts": ["Discovery", "System Information Discovery"], "tactic": "Discovery", "technique": "System Information Discovery", "subtechnique": "", "id": "T1082"}], "mbc": [{"parts": ["Discovery", "System Information Discovery"], "objective": "Discovery", "behavior": "System Information Discovery", "method": "", "id": "E1082"}], "references": ["https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiVM/Generic.cpp#L347"], "examples": ["al-khaser_x86.exe_:0x4343D0", "al-khaser_x86.exe_:0x434010"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: get disk size\n    namespace: host-interaction/hardware/storage\n    authors:\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scope: function\n    att&ck:\n      - Discovery::System Information Discovery [T1082]\n    mbc:\n      - Discovery::System Information Discovery [E1082]\n    references:\n      - https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiVM/Generic.cpp#L347\n    examples:\n      - al-khaser_x86.exe_:0x4343D0\n      - al-khaser_x86.exe_:0x434010\n  features:\n    - or:\n      - api: kernel32.GetDiskFreeSpace\n      - api: kernel32.GetDiskFreeSpaceEx\n      - property/read: System.IO.DriveInfo::TotalSize\n      - property/read: System.IO.DriveInfo::TotalFreeSpace\n      - property/read: System.IO.DriveInfo::AvailableFreeSpace\n      - basic block:\n        - and:\n          - api: DeviceIoControl\n          - number: 0x7405C = IOCTL_DISK_GET_LENGTH_INFO\n      - and:\n        - or:\n          - string: /SELECT\\s+\\*\\s+FROM\\s+Win32_LogicalDisk/i\n          - string: /SELECT\\s+\\*\\s+FROM\\s+Win32_DiskDrive\\s+WHERE\\s+\\(SerialNumber\\s+IS\\s+NOT\\s+NULL\\)\\s+AND\\s+\\(MediaType\\s+LIKE\\s+\\'Fixed\\s+hard\\s+disk\\%\\'\\)/i\n        - string: \"Size\"\n", "matches": [[{"type": "absolute", "value": 5368814865}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetDiskFreeSpace"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetDiskFreeSpaceEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.IO.DriveInfo::TotalSize"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.IO.DriveInfo::TotalFreeSpace"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.IO.DriveInfo::AvailableFreeSpace"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"scope": "basic block", "type": "subscope"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "DeviceIoControl"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368920318}], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 475228, "description": "IOCTL_DISK_GET_LENGTH_INFO"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368920309}], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "DeviceIoControl"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368920064}], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 475228, "description": "IOCTL_DISK_GET_LENGTH_INFO"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368920055}], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 5368920268}, {"type": "absolute", "value": 5368920014}], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+Win32_LogicalDisk/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+Win32_DiskDrive\\s+WHERE\\s+\\(SerialNumber\\s+IS\\s+NOT\\s+NULL\\)\\s+AND\\s+\\(MediaType\\s+LIKE\\s+\\'Fixed\\s+hard\\s+disk\\%\\'\\)/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "string", "string": "Size"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368815525}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetDiskFreeSpace"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetDiskFreeSpaceEx"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368918405}], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.IO.DriveInfo::TotalSize"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.IO.DriveInfo::TotalFreeSpace"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.IO.DriveInfo::AvailableFreeSpace"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "get disk size/a2fa980c77bd430298966f83129843f2"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+Win32_LogicalDisk/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+Win32_DiskDrive\\s+WHERE\\s+\\(SerialNumber\\s+IS\\s+NOT\\s+NULL\\)\\s+AND\\s+\\(MediaType\\s+LIKE\\s+\\'Fixed\\s+hard\\s+disk\\%\\'\\)/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "string", "string": "Size"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "enumerate services": {"meta": {"name": "enumerate services", "namespace": "host-interaction/service/list", "authors": ["moritz.raabe@mandiant.com", "michael.hunhoff@mandiant.com"], "scope": "function", "attack": [{"parts": ["Discovery", "System Service Discovery"], "tactic": "Discovery", "technique": "System Service Discovery", "subtechnique": "", "id": "T1007"}], "mbc": [], "references": [], "examples": ["Practical Malware Analysis Lab 05-01.dll_:0x1000B823"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: enumerate services\n    namespace: host-interaction/service/list\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scope: function\n    att&ck:\n      - Discovery::System Service Discovery [T1007]\n    examples:\n      - Practical Malware Analysis Lab 05-01.dll_:0x1000B823\n  features:\n    - or:\n      - api: advapi32.EnumServicesStatus\n      - api: advapi32.EnumServicesStatusEx\n      - api: advapi32.EnumDependentServices\n", "matches": [[{"type": "absolute", "value": 5368814905}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "advapi32.EnumServicesStatus"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "advapi32.EnumServicesStatusEx"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368932939}, {"type": "absolute", "value": 5368932726}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.EnumDependentServices"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "enumerate disk properties": {"meta": {"name": "enumerate disk properties", "namespace": "host-interaction/hardware/storage", "authors": ["michael.hunhoff@mandiant.com"], "scope": "function", "attack": [{"parts": ["Discovery", "System Information Discovery"], "tactic": "Discovery", "technique": "System Information Discovery", "subtechnique": "", "id": "T1082"}], "mbc": [], "references": ["https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiVM/Generic.cpp#L518"], "examples": ["al-khaser_x86.exe_:0x4369B0"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: enumerate disk properties\n    namespace: host-interaction/hardware/storage\n    authors:\n      - michael.hunhoff@mandiant.com\n    scope: function\n    att&ck:\n      - Discovery::System Information Discovery [T1082]\n    references:\n      - https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiVM/Generic.cpp#L518\n    examples:\n      - al-khaser_x86.exe_:0x4369B0\n  features:\n    - and:\n      - basic block:\n        - and:\n          - api: setupapi.SetupDiGetClassDevs\n          - bytes: 67 E9 36 4D 25 E3 CE 11 BF C1 08 00 2B E1 03 18 = GUID_DEVCLASS_DISKDRIVE\n      - api: setupapi.SetupDiEnumDeviceInfo\n      - api: setupapi.SetupDiGetDeviceRegistryProperty\n      - optional:\n        - api: setupapi.SetupDiDestroyDeviceInfoList\n", "matches": [[{"type": "absolute", "value": 5368815040}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"scope": "basic block", "type": "subscope"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "setupapi.SetupDiGetClassDevs"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368927847}], "captures": {}}, {"success": true, "node": {"feature": {"type": "bytes", "bytes": "67e9364d25e3ce11bfc108002be10318", "description": "GUID_DEVCLASS_DISKDRIVE"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368927840}], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 5368927760}], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "setupapi.SetupDiEnumDeviceInfo"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368927927}], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "setupapi.SetupDiGetDeviceRegistryProperty"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368927996}], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "setupapi.SetupDiDestroyDeviceInfoList"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368928245}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "get disk information": {"meta": {"name": "get disk information", "namespace": "host-interaction/hardware/storage", "authors": ["moritz.raabe@mandiant.com", "anushka.virgaonkar@mandiant.com"], "scope": "function", "attack": [{"parts": ["Discovery", "System Information Discovery"], "tactic": "Discovery", "technique": "System Information Discovery", "subtechnique": "", "id": "T1082"}], "mbc": [{"parts": ["Discovery", "System Information Discovery"], "objective": "Discovery", "behavior": "System Information Discovery", "method": "", "id": "E1082"}], "references": [], "examples": ["9324D1A8AE37A36AE560C37448C9705A:0x4052A0", "972B219F18379907A045431303F4DA7D:0x41064E"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: get disk information\n    namespace: host-interaction/hardware/storage\n    authors:\n      - moritz.raabe@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scope: function\n    att&ck:\n      - Discovery::System Information Discovery [T1082]\n    mbc:\n      - Discovery::System Information Discovery [E1082]\n    examples:\n      - 9324D1A8AE37A36AE560C37448C9705A:0x4052A0\n      - 972B219F18379907A045431303F4DA7D:0x41064E\n  features:\n    - or:\n      - api: kernel32.GetDriveType\n      - api: kernel32.GetLogicalDrives\n      - api: kernel32.GetVolumeInformation\n      - api: kernel32.GetVolumeNameForVolumeMountPoint\n      - api: kernel32.GetVolumePathNamesForVolumeName\n      - api: kernel32.GetLogicalDriveStrings\n      - api: kernel32.QueryDosDevice\n      - property/read: System.IO.DriveInfo::VolumeLabel\n      - property/read: System.IO.DriveInfo::DriveType\n      - property/read: System.IO.DriveInfo::DriveFormat\n      - property/read: System.IO.DriveInfo::Name\n", "matches": [[{"type": "absolute", "value": 5368815050}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetDriveType"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetLogicalDrives"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetVolumeInformation"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetVolumeNameForVolumeMountPoint"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetVolumePathNamesForVolumeName"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetLogicalDriveStrings"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.QueryDosDevice"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368881902}], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.IO.DriveInfo::VolumeLabel"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.IO.DriveInfo::DriveType"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.IO.DriveInfo::DriveFormat"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.IO.DriveInfo::Name"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 5368882832}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetDriveType"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetLogicalDrives"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetVolumeInformation"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetVolumeNameForVolumeMountPoint"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetVolumePathNamesForVolumeName"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetLogicalDriveStrings"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.QueryDosDevice"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368883201}], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.IO.DriveInfo::VolumeLabel"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.IO.DriveInfo::DriveType"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.IO.DriveInfo::DriveFormat"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.IO.DriveInfo::Name"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "check for PEB NtGlobalFlag flag": {"meta": {"name": "check for PEB NtGlobalFlag flag", "namespace": "anti-analysis/anti-debugging/debugger-detection", "authors": ["moritz.raabe@mandiant.com"], "scope": "function", "attack": [], "mbc": [{"parts": ["Anti-Behavioral Analysis", "Debugger Detection", "Process Environment Block NtGlobalFlag"], "objective": "Anti-Behavioral Analysis", "behavior": "Debugger Detection", "method": "Process Environment Block NtGlobalFlag", "id": "B0001.036"}], "references": ["Practical Malware Analysis, Chapter 16, p. 355", "https://www.geoffchappell.com/studies/windows/win32/ntdll/structs/peb/index.htm"], "examples": ["Practical Malware Analysis Lab 16-01.exe_:0x403530"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: check for PEB NtGlobalFlag flag\n    namespace: anti-analysis/anti-debugging/debugger-detection\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: function\n    mbc:\n      - Anti-Behavioral Analysis::Debugger Detection::Process Environment Block NtGlobalFlag [B0001.036]\n    references:\n      - Practical Malware Analysis, Chapter 16, p. 355\n      - https://www.geoffchappell.com/studies/windows/win32/ntdll/structs/peb/index.htm\n    examples:\n      - Practical Malware Analysis Lab 16-01.exe_:0x403530\n  features:\n    - and:\n      - basic block:\n        - and:\n          - match: PEB access\n          - or:\n            - and:\n              - arch: i386\n              - offset: 0x68 = PEB.NtGlobalFlag\n            - and:\n              - arch: amd64\n              - offset: 0xBC = PEB.NtGlobalFlag\n            - instruction:\n              - arch: i386\n              - mnemonic: add\n              - offset: 0x68 = PEB.NtGlobalFlag\n            - instruction:\n              - arch: amd64\n              - mnemonic: add\n              - offset: 0xBC = PEB.NtGlobalFlag\n      - number: 0x70 = (FLG_HEAP_ENABLE_TAIL_CHECK | FLG_HEAP_ENABLE_FREE_CHECK | FLG_HEAP_VALIDATE_PARAMETERS)\n", "matches": [[{"type": "absolute", "value": 5368815115}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"scope": "basic block", "type": "subscope"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "PEB access"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "peb access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368840394}], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "fs access"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/aee9ee4a3df44121b21acb950535f6a7"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "arch", "arch": "i386"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "fs access"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "offset", "offset": 48}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/b86186bb56c74ecaa2b476462ebf83f3"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "arch", "arch": "amd64"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "gs access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368840394}], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "offset", "offset": 96}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/fc87da307f6f4da2b8fde64519f87688"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 5368840336}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "arch", "arch": "i386"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "offset", "offset": 104, "description": "PEB.NtGlobalFlag"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "arch", "arch": "amd64"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"feature": {"type": "offset", "offset": 188, "description": "PEB.NtGlobalFlag"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368840403}], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "check for PEB NtGlobalFlag flag/ea03bc77e4e64ed092d4761d882e15f8/f8cce3d31cc74d64971f9eb7bcd6f9be"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"scope": "instruction", "type": "subscope"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "arch", "arch": "amd64"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"feature": {"type": "mnemonic", "mnemonic": "add"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368840403}], "captures": {}}, {"success": true, "node": {"feature": {"type": "offset", "offset": 188, "description": "PEB.NtGlobalFlag"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368840403}], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 5368840403}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 5368840336}], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 112, "description": "(FLG_HEAP_ENABLE_TAIL_CHECK | FLG_HEAP_ENABLE_FREE_CHECK | FLG_HEAP_VALIDATE_PARAMETERS)"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368840426}, {"type": "absolute", "value": 5368840477}], "captures": {}}], "locations": [], "captures": {}}]]}, "query or enumerate registry value": {"meta": {"name": "query or enumerate registry value", "namespace": "host-interaction/registry", "authors": ["william.ballenthin@mandiant.com", "michael.hunhoff@mandiant.com", "anushka.virgaonkar@mandiant.com"], "scope": "function", "attack": [{"parts": ["Discovery", "Query Registry"], "tactic": "Discovery", "technique": "Query Registry", "subtechnique": "", "id": "T1012"}], "mbc": [{"parts": ["Operating System", "Registry", "Query Registry Value"], "objective": "Operating System", "behavior": "Registry", "method": "Query Registry Value", "id": "C0036.006"}], "references": [], "examples": ["BFB9B5391A13D0AFD787E87AB90F14F5:0x13145B5A", "Practical Malware Analysis Lab 03-02.dll_:0x100047AD"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: query or enumerate registry value\n    namespace: host-interaction/registry\n    authors:\n      - william.ballenthin@mandiant.com\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scope: function\n    att&ck:\n      - Discovery::Query Registry [T1012]\n    mbc:\n      - Operating System::Registry::Query Registry Value [C0036.006]\n    examples:\n      - BFB9B5391A13D0AFD787E87AB90F14F5:0x13145B5A\n      - Practical Malware Analysis Lab 03-02.dll_:0x100047AD\n  features:\n    - and:\n      - optional:\n        - match: create or open registry key\n      - or:\n        - api: advapi32.RegGetValue\n        - api: advapi32.RegEnumValue\n        - api: advapi32.RegQueryValue\n        - api: advapi32.RegQueryValueEx\n        - api: advapi32.RegQueryMultipleValues\n        - api: ZwQueryValueKey\n        - api: ZwEnumerateValueKey\n        - api: NtQueryValueKey\n        - api: NtEnumerateValueKey\n        - api: RtlQueryRegistryValues\n        - api: SHGetValue\n        - api: SHEnumValue\n        - api: SHRegGetInt\n        - api: SHRegGetPath\n        - api: SHRegGetValue\n        - api: SHQueryValueEx\n        - api: SHRegGetUSValue\n        - api: SHOpenRegStream\n        - api: SHRegEnumUSValue\n        - api: SHOpenRegStream2\n        - api: SHRegQueryUSValue\n        - api: SHRegGetBoolUSValue\n        - api: SHRegGetValueFromHKCUHKLM\n        - api: SHRegGetBoolValueFromHKCUHKLM\n        - api: Microsoft.Win32.RegistryKey::GetValue\n        - api: Microsoft.Win32.RegistryKey::GetValueKind\n        - api: Microsoft.Win32.RegistryKey::GetValueNames\n        - api: Microsoft.Win32.Registry::GetValue\n", "matches": [[{"type": "absolute", "value": 5368815165}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "create or open registry key"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenKeyEx"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368984936}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegCreateKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegCreateKeyEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenCurrentUser"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenUserClassesRoot"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegCreateKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKeyEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKeyTransactedEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtOpenKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtCreateKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegOpenUSKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegCreateUSKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "RtlCreateRegistryKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::OpenSubKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::OpenBaseKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::OpenRemoteBaseKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::CreateSubKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 5368984784}], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegGetValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegEnumValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegQueryValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "advapi32.RegQueryValueEx"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368984984}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegQueryMultipleValues"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwQueryValueKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwEnumerateValueKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtQueryValueKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtEnumerateValueKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "RtlQueryRegistryValues"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHGetValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHEnumValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegGetInt"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegGetPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegGetValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHQueryValueEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegGetUSValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHOpenRegStream"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegEnumUSValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHOpenRegStream2"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegQueryUSValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegGetBoolUSValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegGetValueFromHKCUHKLM"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegGetBoolValueFromHKCUHKLM"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::GetValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::GetValueKind"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::GetValueNames"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.Registry::GetValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "modify access privileges": {"meta": {"name": "modify access privileges", "namespace": "host-interaction/process/modify", "authors": ["moritz.raabe@mandiant.com"], "scope": "function", "attack": [{"parts": ["Privilege Escalation", "Access Token Manipulation"], "tactic": "Privilege Escalation", "technique": "Access Token Manipulation", "subtechnique": "", "id": "T1134"}], "mbc": [], "references": [], "examples": ["9324D1A8AE37A36AE560C37448C9705A:0x403BE0"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: modify access privileges\n    namespace: host-interaction/process/modify\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: function\n    att&ck:\n      - Privilege Escalation::Access Token Manipulation [T1134]\n    examples:\n      - 9324D1A8AE37A36AE560C37448C9705A:0x403BE0\n  features:\n    - and:\n      - api: advapi32.AdjustTokenPrivileges\n      - optional:\n        - or:\n          - api: advapi32.LookupPrivilegeValue\n", "matches": [[{"type": "absolute", "value": 5368815200}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "advapi32.AdjustTokenPrivileges"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368985413}], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "advapi32.LookupPrivilegeValue"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368985372}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "find graphical window": {"meta": {"name": "find graphical window", "namespace": "host-interaction/gui/window/find", "authors": ["moritz.raabe@mandiant.com"], "scope": "function", "attack": [{"parts": ["Discovery", "Application Window Discovery"], "tactic": "Discovery", "technique": "Application Window Discovery", "subtechnique": "", "id": "T1010"}], "mbc": [], "references": [], "examples": ["7C843E75D4F02087B932FE280DF9C90C:0x41B180"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: find graphical window\n    namespace: host-interaction/gui/window/find\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: function\n    att&ck:\n      - Discovery::Application Window Discovery [T1010]\n    examples:\n      - 7C843E75D4F02087B932FE280DF9C90C:0x41B180\n  features:\n    - or:\n      - api: user32.FindWindow\n      - api: user32.FindWindowEx\n", "matches": [[{"type": "absolute", "value": 5368815245}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "user32.FindWindow"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368944355}, {"type": "absolute", "value": 5368944374}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.FindWindowEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "get number of processor cores": {"meta": {"name": "get number of processor cores", "namespace": "host-interaction/hardware/cpu", "authors": ["michael.hunhoff@mandiant.com"], "scope": "function", "attack": [{"parts": ["Discovery", "System Information Discovery"], "tactic": "Discovery", "technique": "System Information Discovery", "subtechnique": "", "id": "T1082"}], "mbc": [], "references": ["https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiVM/Generic.cpp#L207"], "examples": ["al-khaser_x86.exe_:0x435BA0"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: get number of processor cores\n    namespace: host-interaction/hardware/cpu\n    authors:\n      - michael.hunhoff@mandiant.com\n    scope: function\n    att&ck:\n      - Discovery::System Information Discovery [T1082]\n    references:\n      - https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiVM/Generic.cpp#L207\n    examples:\n      - al-khaser_x86.exe_:0x435BA0\n  features:\n    - and:\n      - string: /SELECT\\s+\\*\\s+FROM\\s+Win32_Processor/\n      - string: \"NumberOfCores\"\n", "matches": [[{"type": "absolute", "value": 5368815340}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "string", "string": "NumberOfCores"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368925008}], "captures": {}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+Win32_Processor/"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368924837}], "captures": {"SELECT * FROM Win32_Processor": [{"type": "absolute", "value": 5368924837}]}}], "locations": [], "captures": {}}]]}, "create mutex": {"meta": {"name": "create mutex", "namespace": "host-interaction/mutex", "authors": ["moritz.raabe@mandiant.com", "michael.hunhoff@mandiant.com"], "scope": "function", "attack": [], "mbc": [{"parts": ["Process", "Create Mutex"], "objective": "Process", "behavior": "Create Mutex", "method": "", "id": "C0042"}], "references": [], "examples": ["Practical Malware Analysis Lab 01-01.dll_:0x10001010"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: create mutex\n    namespace: host-interaction/mutex\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scope: function\n    mbc:\n      - Process::Create Mutex [C0042]\n    examples:\n      - Practical Malware Analysis Lab 01-01.dll_:0x10001010\n  features:\n    - or:\n      - api: kernel32.CreateMutex\n      - api: kernel32.CreateMutexEx\n      - api: System.Threading.Mutex::ctor\n", "matches": [[{"type": "absolute", "value": 5368815500}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.CreateMutex"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368906981}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.CreateMutexEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Threading.Mutex::ctor"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "check for protected handle exception": {"meta": {"name": "check for protected handle exception", "namespace": "anti-analysis/anti-debugging/debugger-detection", "authors": ["michael.hunhoff@mandiant.com"], "scope": "function", "attack": [], "mbc": [{"parts": ["Anti-Behavioral Analysis", "Debugger Detection", "SetHandleInformation"], "objective": "Anti-Behavioral Analysis", "behavior": "Debugger Detection", "method": "SetHandleInformation", "id": "B0001.024"}], "references": ["https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiDebug/SetHandleInformation_API.cpp"], "examples": ["al-khaser_x86.exe_:0x430D20"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: check for protected handle exception\n    namespace: anti-analysis/anti-debugging/debugger-detection\n    authors:\n      - michael.hunhoff@mandiant.com\n    scope: function\n    mbc:\n      - Anti-Behavioral Analysis::Debugger Detection::SetHandleInformation [B0001.024]\n    references:\n      - https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiDebug/SetHandleInformation_API.cpp\n    examples:\n      - al-khaser_x86.exe_:0x430D20\n  features:\n    - and:\n      - basic block:\n        - and:\n          - count(number(2)): 2 or more\n          - api: SetHandleInformation\n      - api: CloseHandle\n", "matches": [[{"type": "absolute", "value": 5368815500}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"scope": "basic block", "type": "subscope"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "SetHandleInformation"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368907013}], "captures": {}}, {"success": true, "node": {"statement": {"min": 2, "max": 9223372036854775808, "child": {"type": "number", "number": 2}, "type": "range"}, "type": "statement"}, "children": [], "locations": [{"type": "absolute", "value": 5368907004}, {"type": "absolute", "value": 5368906998}], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 5368906998}], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "CloseHandle"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368907024}], "captures": {}}], "locations": [], "captures": {}}]]}, "get MAC address on Windows": {"meta": {"name": "get MAC address on Windows", "namespace": "collection/network", "authors": ["moritz.raabe@mandiant.com", "michael.hunhoff@mandiant.com"], "scope": "function", "attack": [{"parts": ["Discovery", "System Information Discovery"], "tactic": "Discovery", "technique": "System Information Discovery", "subtechnique": "", "id": "T1082"}], "mbc": [], "references": [], "examples": ["al-khaser_x64.exe_:0x14001A1BC"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: get MAC address on Windows\n    namespace: collection/network\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scope: function\n    att&ck:\n      - Discovery::System Information Discovery [T1082]\n    examples:\n      - al-khaser_x64.exe_:0x14001A1BC\n  features:\n    - or:\n      - api: System.Net.NetworkInformation.NetworkInterface::GetPhysicalAddress\n      - and:\n        - os: windows\n        - api: iphlpapi.GetAdaptersInfo\n        - or:\n          - offset: 0x194 = IP_ADAPTER_INFO.Address\n          - offset: 0x195 = IP_ADAPTER_INFO.Address+1\n          - offset: 0x196 = IP_ADAPTER_INFO.Address+2\n          - offset: 0x197 = IP_ADAPTER_INFO.Address+3\n          - offset: 0x198 = IP_ADAPTER_INFO.Address+4\n          - offset: 0x199 = IP_ADAPTER_INFO.Address+5\n        - optional:\n          - string: \"%02X-%02X-%02X-%02X-%02X-%02X\"\n", "matches": [[{"type": "absolute", "value": 5368816060}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "System.Net.NetworkInformation.NetworkInterface::GetPhysicalAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "iphlpapi.GetAdaptersInfo"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368994669}, {"type": "absolute", "value": 5368994549}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "offset", "offset": 404, "description": "IP_ADAPTER_INFO.Address"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368994782}], "captures": {}}, {"success": false, "node": {"feature": {"type": "offset", "offset": 405, "description": "IP_ADAPTER_INFO.Address+1"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "offset", "offset": 406, "description": "IP_ADAPTER_INFO.Address+2"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "offset", "offset": 407, "description": "IP_ADAPTER_INFO.Address+3"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "offset", "offset": 408, "description": "IP_ADAPTER_INFO.Address+4"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368994795}], "captures": {}}, {"success": false, "node": {"feature": {"type": "offset", "offset": 409, "description": "IP_ADAPTER_INFO.Address+5"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "string", "string": "%02X-%02X-%02X-%02X-%02X-%02X"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "set application hook": {"meta": {"name": "set application hook", "namespace": "host-interaction/gui", "authors": ["michael.hunhoff@mandiant.com"], "scope": "function", "attack": [], "mbc": [], "references": [], "examples": ["Practical Malware Analysis Lab 12-03.exe_:0x401000"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: set application hook\n    namespace: host-interaction/gui\n    authors:\n      - michael.hunhoff@mandiant.com\n    scope: function\n    examples:\n      - Practical Malware Analysis Lab 12-03.exe_:0x401000\n  features:\n    - and:\n      - or:\n        - api: user32.SetWindowsHookEx\n        - api: user32.UnhookWindowsHookEx\n", "matches": [[{"type": "absolute", "value": 5368816460}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "user32.SetWindowsHookEx"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368956573}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.UnhookWindowsHookEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "log keystrokes via application hook": {"meta": {"name": "log keystrokes via application hook", "namespace": "collection/keylog", "authors": ["michael.hunhoff@mandiant.com"], "scope": "function", "attack": [{"parts": ["Collection", "Input Capture", "Keylogging"], "tactic": "Collection", "technique": "Input Capture", "subtechnique": "Keylogging", "id": "T1056.001"}], "mbc": [{"parts": ["Collection", "Keylogging", "Application Hook"], "objective": "Collection", "behavior": "Keylogging", "method": "Application Hook", "id": "F0002.001"}], "references": [], "examples": ["Practical Malware Analysis Lab 12-03.exe_:0x401000"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: log keystrokes via application hook\n    namespace: collection/keylog\n    authors:\n      - michael.hunhoff@mandiant.com\n    scope: function\n    att&ck:\n      - Collection::Input Capture::Keylogging [T1056.001]\n    mbc:\n      - Collection::Keylogging::Application Hook [F0002.001]\n    examples:\n      - Practical Malware Analysis Lab 12-03.exe_:0x401000\n  features:\n    - and:\n      - match: set application hook\n      - or:\n        - number: 13 = WH_KEYBOARD_LL\n        - number: 2  = WH_KEYBOARD\n", "matches": [[{"type": "absolute", "value": 5368816460}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "set application hook"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "user32.SetWindowsHookEx"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368956573}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.UnhookWindowsHookEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 5368816460}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "number", "number": 13, "description": "WH_KEYBOARD_LL"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 2, "description": "WH_KEYBOARD"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5368956568}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "contain a thread local storage (.tls) section": {"meta": {"name": "contain a thread local storage (.tls) section", "namespace": "executable/pe/section/tls", "authors": ["michael.hunhoff@mandiant.com"], "scope": "file", "attack": [], "mbc": [], "references": [], "examples": ["Practical Malware Analysis Lab 16-02.exe_"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: contain a thread local storage (.tls) section\n    namespace: executable/pe/section/tls\n    authors:\n      - michael.hunhoff@mandiant.com\n    scope: file\n    examples:\n      - Practical Malware Analysis Lab 16-02.exe_\n  features:\n    - section: .tls\n", "matches": [[{"type": "no address"}, {"success": true, "node": {"feature": {"type": "section", "section": ".tls"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5369344000}], "captures": {}}]]}, "contain a resource (.rsrc) section": {"meta": {"name": "contain a resource (.rsrc) section", "namespace": "executable/pe/section/rsrc", "authors": ["moritz.raabe@mandiant.com"], "scope": "file", "attack": [], "mbc": [], "references": [], "examples": ["A933A1A402775CFA94B6BEE0963F4B46:0x41fd25"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: contain a resource (.rsrc) section\n    namespace: executable/pe/section/rsrc\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: file\n    examples:\n      - A933A1A402775CFA94B6BEE0963F4B46:0x41fd25\n  features:\n    - section: .rsrc\n", "matches": [[{"type": "no address"}, {"success": true, "node": {"feature": {"type": "section", "section": ".rsrc"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 5369352192}], "captures": {}}]]}, "read raw disk data": {"meta": {"name": "read raw disk data", "namespace": "host-interaction/file-system", "authors": ["william.ballenthin@mandiant.com"], "scope": "file", "attack": [], "mbc": [], "references": [], "examples": [], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: read raw disk data\n    namespace: host-interaction/file-system\n    authors:\n      - william.ballenthin@mandiant.com\n    scope: file\n  features:\n    - or:\n      - string: \"\\\\\\\\.\\\\PhysicalDrive0\"\n      - string: \"\\\\\\\\.\\\\C:\"\n", "matches": [[{"type": "no address"}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "string", "string": "\\\\.\\PhysicalDrive0"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 281800}], "captures": {}}, {"success": false, "node": {"feature": {"type": "string", "string": "\\\\.\\C:"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "reference anti-VM strings": {"meta": {"name": "reference anti-VM strings", "namespace": "anti-analysis/anti-vm/vm-detection", "authors": ["moritz.raabe@mandiant.com"], "scope": "file", "attack": [{"parts": ["Defense Evasion", "Virtualization/Sandbox Evasion", "System Checks"], "tactic": "Defense Evasion", "technique": "Virtualization/Sandbox Evasion", "subtechnique": "System Checks", "id": "T1497.001"}], "mbc": [{"parts": ["Anti-Behavioral Analysis", "Virtual Machine Detection"], "objective": "Anti-Behavioral Analysis", "behavior": "Virtual Machine Detection", "method": "", "id": "B0009"}], "references": ["https://github.com/ctxis/CAPE/blob/master/modules/signatures/antivm_*", "https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiVM/Generic.cpp"], "examples": ["Practical Malware Analysis Lab 17-02.dll_"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: reference anti-VM strings\n    namespace: anti-analysis/anti-vm/vm-detection\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: file\n    att&ck:\n      - Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001]\n    mbc:\n      - Anti-Behavioral Analysis::Virtual Machine Detection [B0009]\n    references:\n      - https://github.com/ctxis/CAPE/blob/master/modules/signatures/antivm_*\n      - https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiVM/Generic.cpp\n    examples:\n      - Practical Malware Analysis Lab 17-02.dll_\n  features:\n    - or:\n      - string: /HARDWARE\\\\ACPI\\\\(DSDT|FADT|RSDT)\\\\BOCHS/i\n      - string: /HARDWARE\\\\DESCRIPTION\\\\System\\\\(SystemBiosVersion|VideoBiosVersion)/i\n      - string: /HARDWARE\\\\DESCRIPTION\\\\System\\\\CentralProcessor/i\n      - string: /HARDWARE\\\\DEVICEMAP\\\\Scsi\\\\Scsi Port 0\\\\Scsi Bus 0\\\\Target Id 0\\\\Logical Unit Id 0/i\n      - string: /SYSTEM\\\\(CurrentControlSet|ControlSet001)\\\\Enum\\\\IDE/i\n      - string: /SYSTEM\\\\(CurrentControlSet|ControlSet001)\\\\Services\\\\Disk\\\\Enum\\\\/i\n      - string: /SYSTEM\\\\(CurrentControlSet|ControlSet001)\\\\Control\\\\SystemInformation\\\\SystemManufacturer/i\n      - string: /A M I/i\n      - string: /Hyper-V/i\n      - string: /Kernel-VMDetection-Private/i\n      # https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiVM/Generic.cpp#L699\n      - string: /KVMKVMKVM/i\n        description: KVM\n      - string: /Microsoft Hv/i\n        description: Microsoft Hyper-V or Windows Virtual PC\n      # https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiVM/Generic.cpp#L8\n      - string: /avghookx.dll/i\n        description: AVG\n      - string: /avghooka.dll/i\n        description: AVG\n      - string: /snxhk.dll/i\n        description: Avast\n      - string: /pstorec.dll/i\n        description: SunBelt Sandbox\n      - string: /vmcheck.dll/i\n        description: Virtual PC\n      - string: /wpespy.dll/i\n        description: WPE Pro\n      - string: /cmdvrt64.dll/i\n        description: Comodo Container\n      - string: /cmdvrt32.dll/i\n        description: Comodo Container\n      # https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiVM/Generic.cpp#L46\n      - string: /sample.exe/i\n      - string: /bot.exe/i\n      - string: /sandbox.exe/i\n      - string: /malware.exe/i\n      - string: /test.exe/i\n      - string: /klavme.exe/i\n      - string: /myapp.exe/i\n      - string: /testapp.exe/i\n", "matches": [[{"type": "no address"}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "regex", "regex": "/HARDWARE\\\\ACPI\\\\(DSDT|FADT|RSDT)\\\\BOCHS/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/HARDWARE\\\\DESCRIPTION\\\\System\\\\(SystemBiosVersion|VideoBiosVersion)/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/HARDWARE\\\\DESCRIPTION\\\\System\\\\CentralProcessor/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/HARDWARE\\\\DEVICEMAP\\\\Scsi\\\\Scsi Port 0\\\\Scsi Bus 0\\\\Target Id 0\\\\Logical Unit Id 0/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 285328}], "captures": {"HARDWARE\\DEVICEMAP\\Scsi\\Scsi Port 0\\Scsi Bus 0\\Target Id 0\\Logical Unit Id 0": [{"type": "file", "value": 285328}]}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/SYSTEM\\\\(CurrentControlSet|ControlSet001)\\\\Enum\\\\IDE/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/SYSTEM\\\\(CurrentControlSet|ControlSet001)\\\\Services\\\\Disk\\\\Enum\\\\/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/SYSTEM\\\\(CurrentControlSet|ControlSet001)\\\\Control\\\\SystemInformation\\\\SystemManufacturer/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/A M I/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 282272}], "captures": {"A M I": [{"type": "file", "value": 282272}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/Hyper-V/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 282928}], "captures": {"Hyper-V": [{"type": "file", "value": 282928}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/Kernel-VMDetection-Private/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 242672}, {"type": "file", "value": 282952}], "captures": {"Checking NtQueryLicenseValue with Kernel-VMDetection-Private ": [{"type": "file", "value": 242672}], "Kernel-VMDetection-Private": [{"type": "file", "value": 282952}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/KVMKVMKVM/i", "description": "KVM"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 281920}], "captures": {"KVMKVMKVM": [{"type": "file", "value": 281920}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/Microsoft Hv/i", "description": "Microsoft Hyper-V or Windows Virtual PC"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 281952}], "captures": {"Microsoft Hv": [{"type": "file", "value": 281952}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/avghookx.dll/i", "description": "AVG"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 280496}], "captures": {"avghookx.dll": [{"type": "file", "value": 280496}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/avghooka.dll/i", "description": "AVG"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 280528}], "captures": {"avghooka.dll": [{"type": "file", "value": 280528}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/snxhk.dll/i", "description": "Avast"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 280560}], "captures": {"snxhk.dll": [{"type": "file", "value": 280560}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/pstorec.dll/i", "description": "SunBelt Sandbox"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 280720}], "captures": {"pstorec.dll": [{"type": "file", "value": 280720}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/vmcheck.dll/i", "description": "Virtual PC"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 280752}], "captures": {"vmcheck.dll": [{"type": "file", "value": 280752}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/wpespy.dll/i", "description": "WPE Pro"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 280784}], "captures": {"wpespy.dll": [{"type": "file", "value": 280784}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/cmdvrt64.dll/i", "description": "Comodo Container"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 280816}], "captures": {"cmdvrt64.dll": [{"type": "file", "value": 280816}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/cmdvrt32.dll/i", "description": "Comodo Container"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 280848}], "captures": {"cmdvrt32.dll": [{"type": "file", "value": 280848}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/sample.exe/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 281000}], "captures": {"sample.exe": [{"type": "file", "value": 281000}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/bot.exe/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 281032}], "captures": {"bot.exe": [{"type": "file", "value": 281032}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/sandbox.exe/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 281056}], "captures": {"sandbox.exe": [{"type": "file", "value": 281056}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/malware.exe/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 281088}], "captures": {"malware.exe": [{"type": "file", "value": 281088}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/test.exe/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 281120}], "captures": {"test.exe": [{"type": "file", "value": 281120}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/klavme.exe/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 281144}], "captures": {"klavme.exe": [{"type": "file", "value": 281144}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/myapp.exe/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 281176}], "captures": {"myapp.exe": [{"type": "file", "value": 281176}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/testapp.exe/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 281200}], "captures": {"testapp.exe": [{"type": "file", "value": 281200}]}}], "locations": [], "captures": {}}]]}, "reference anti-VM strings targeting VMWare": {"meta": {"name": "reference anti-VM strings targeting VMWare", "namespace": "anti-analysis/anti-vm/vm-detection", "authors": ["michael.hunhoff@mandiant.com", "@johnk3r"], "scope": "file", "attack": [{"parts": ["Defense Evasion", "Virtualization/Sandbox Evasion", "System Checks"], "tactic": "Defense Evasion", "technique": "Virtualization/Sandbox Evasion", "subtechnique": "System Checks", "id": "T1497.001"}], "mbc": [{"parts": ["Anti-Behavioral Analysis", "Virtual Machine Detection"], "objective": "Anti-Behavioral Analysis", "behavior": "Virtual Machine Detection", "method": "", "id": "B0009"}], "references": ["https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiVM/VMWare.cpp"], "examples": ["al-khaser_x86.exe_", "b83480162ede09d4aa6d4850f9faa0a4c3834152752fd04cfdb22d647aa1f825:0x17D80"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: reference anti-VM strings targeting VMWare\n    namespace: anti-analysis/anti-vm/vm-detection\n    authors:\n      - michael.hunhoff@mandiant.com\n      - \"@johnk3r\"\n    scope: file\n    att&ck:\n      - Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001]\n    mbc:\n      - Anti-Behavioral Analysis::Virtual Machine Detection [B0009]\n    references:\n      - https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiVM/VMWare.cpp\n    examples:\n      - al-khaser_x86.exe_\n      - b83480162ede09d4aa6d4850f9faa0a4c3834152752fd04cfdb22d647aa1f825:0x17D80\n  features:\n    - or:\n      - string: /VMWare/i\n      - string: /VMTools/i\n      - string: /SOFTWARE\\\\VMware, Inc\\.\\\\VMware Tools/i\n      - string: /vmnet\\.sys/i\n      - string: /vmmouse\\.sys/i\n      - string: /vmusb\\.sys/i\n      - string: /vm3dmp\\.sys/i\n      - string: /vmci\\.sys/i\n      - string: /vmhgfs\\.sys/i\n      - string: /vmmemctl\\.sys/i\n      - string: /vmx86\\.sys/i\n      - string: /vmrawdsk\\.sys/i\n      - string: /vmusbmouse\\.sys/i\n      - string: /vmkdb\\.sys/i\n      - string: /vmnetuserif\\.sys/i\n      - string: /vmnetadapter\\.sys/i\n      - string: /\\\\\\\\.\\\\HGFS/i\n      - string: /\\\\\\\\.\\\\vmci/i\n      - string: /vmtoolsd\\.exe/i\n      - string: /vmwaretray\\.exe/i\n      - string: /vmwareuser\\.exe/i\n      - string: /VGAuthService\\.exe/i\n      - string: /vmacthlp\\.exe/i\n      - string: /vmci/i\n        description: VMWare VMCI Bus Driver\n      - string: /vmhgfs/i\n        description: VMWare Host Guest Control Redirector\n      - string: /vmmouse/i\n      - string: /vmmemctl/i\n        description: VMWare Guest Memory Controller Driver\n      - string: /vmusb/i\n      - string: /vmusbmouse/i\n      - string: /vmx_svga/i\n      - string: /vmxnet/i\n      - string: /vmx86/i\n      - string: /VMwareVMware/i\n      - string: /vmGuestLib\\.dll/i\n      - string: /vmGuestLib\\.dll/i\n      - string: /Applications\\\\VMwareHostOpen\\.exe/i\n      - string: /vm3dgl\\.dll/i\n      - string: /vmdum\\.dll/i\n      - string: /vm3dver\\.dll/i\n      - string: /vmtray\\.dll/i\n      - string: /VMToolsHook\\.dll/i\n      - string: /vmmousever\\.dll/i\n      - string: /VmGuestLibJava\\.dll/i\n      - string: /vmscsi\\.sys/i\n", "matches": [[{"type": "no address"}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "regex", "regex": "/VMWare/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 245856}, {"type": "file", "value": 245952}, {"type": "file", "value": 281984}, {"type": "file", "value": 282208}, {"type": "file", "value": 300864}, {"type": "file", "value": 281864}, {"type": "file", "value": 300200}, {"type": "file", "value": 302216}, {"type": "file", "value": 302444}, {"type": "file", "value": 302256}, {"type": "file", "value": 301880}, {"type": "file", "value": 302452}, {"type": "file", "value": 245816}], "captures": {"VMware": [{"type": "file", "value": 302444}], "VMWARE": [{"type": "file", "value": 300200}, {"type": "file", "value": 302452}], "VMWare Detection": [{"type": "file", "value": 245816}], "Checking VMWare network adapter name ": [{"type": "file", "value": 245856}], "Checking VMWare directory ": [{"type": "file", "value": 245952}], "vmware": [{"type": "file", "value": 281864}], "VMwareVMware": [{"type": "file", "value": 281984}], "VMWare": [{"type": "file", "value": 282208}], "SOFTWARE\\VMware, Inc.\\VMware Tools": [{"type": "file", "value": 300864}], "VMWare\\": [{"type": "file", "value": 301880}], "vmwaretray.exe": [{"type": "file", "value": 302216}], "vmwareuser.exe": [{"type": "file", "value": 302256}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/VMTools/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 302184}], "captures": {"vmtoolsd.exe": [{"type": "file", "value": 302184}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/SOFTWARE\\\\VMware, Inc\\.\\\\VMware Tools/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 300864}], "captures": {"SOFTWARE\\VMware, Inc.\\VMware Tools": [{"type": "file", "value": 300864}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/vmnet\\.sys/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 300952}], "captures": {"System32\\drivers\\vmnet.sys": [{"type": "file", "value": 300952}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/vmmouse\\.sys/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 301016}], "captures": {"System32\\drivers\\vmmouse.sys": [{"type": "file", "value": 301016}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/vmusb\\.sys/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 301088}], "captures": {"System32\\drivers\\vmusb.sys": [{"type": "file", "value": 301088}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/vm3dmp\\.sys/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 301152}], "captures": {"System32\\drivers\\vm3dmp.sys": [{"type": "file", "value": 301152}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/vmci\\.sys/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 301224}], "captures": {"System32\\drivers\\vmci.sys": [{"type": "file", "value": 301224}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/vmhgfs\\.sys/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 301288}], "captures": {"System32\\drivers\\vmhgfs.sys": [{"type": "file", "value": 301288}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/vmmemctl\\.sys/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 301360}], "captures": {"System32\\drivers\\vmmemctl.sys": [{"type": "file", "value": 301360}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/vmx86\\.sys/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 301432}], "captures": {"System32\\drivers\\vmx86.sys": [{"type": "file", "value": 301432}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/vmrawdsk\\.sys/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 301496}], "captures": {"System32\\drivers\\vmrawdsk.sys": [{"type": "file", "value": 301496}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/vmusbmouse\\.sys/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 301568}], "captures": {"System32\\drivers\\vmusbmouse.sys": [{"type": "file", "value": 301568}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/vmkdb\\.sys/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 301648}], "captures": {"System32\\drivers\\vmkdb.sys": [{"type": "file", "value": 301648}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/vmnetuserif\\.sys/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 301712}], "captures": {"System32\\drivers\\vmnetuserif.sys": [{"type": "file", "value": 301712}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/vmnetadapter\\.sys/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 301792}], "captures": {"System32\\drivers\\vmnetadapter.sys": [{"type": "file", "value": 301792}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/\\\\\\\\.\\\\HGFS/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 302136}], "captures": {"\\\\.\\HGFS": [{"type": "file", "value": 302136}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/\\\\\\\\.\\\\vmci/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 302160}], "captures": {"\\\\.\\vmci": [{"type": "file", "value": 302160}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/vmtoolsd\\.exe/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 302184}], "captures": {"vmtoolsd.exe": [{"type": "file", "value": 302184}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/vmwaretray\\.exe/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 302216}], "captures": {"vmwaretray.exe": [{"type": "file", "value": 302216}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/vmwareuser\\.exe/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 302256}], "captures": {"vmwareuser.exe": [{"type": "file", "value": 302256}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/VGAuthService\\.exe/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 302296}], "captures": {"VGAuthService.exe": [{"type": "file", "value": 302296}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/vmacthlp\\.exe/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 302344}], "captures": {"vmacthlp.exe": [{"type": "file", "value": 302344}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/vmci/i", "description": "VMWare VMCI Bus Driver"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 286496}, {"type": "file", "value": 302160}, {"type": "file", "value": 301224}], "captures": {"vmci": [{"type": "file", "value": 286496}], "System32\\drivers\\vmci.sys": [{"type": "file", "value": 301224}], "\\\\.\\vmci": [{"type": "file", "value": 302160}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/vmhgfs/i", "description": "VMWare Host Guest Control Redirector"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 286512}, {"type": "file", "value": 301288}], "captures": {"vmhgfs": [{"type": "file", "value": 286512}], "System32\\drivers\\vmhgfs.sys": [{"type": "file", "value": 301288}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/vmmouse/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 286528}, {"type": "file", "value": 301016}], "captures": {"vmmouse": [{"type": "file", "value": 286528}], "System32\\drivers\\vmmouse.sys": [{"type": "file", "value": 301016}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/vmmemctl/i", "description": "VMWare Guest Memory Controller Driver"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 286552}, {"type": "file", "value": 301360}], "captures": {"vmmemctl": [{"type": "file", "value": 286552}], "System32\\drivers\\vmmemctl.sys": [{"type": "file", "value": 301360}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/vmusb/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 286576}, {"type": "file", "value": 301568}, {"type": "file", "value": 301088}, {"type": "file", "value": 286592}], "captures": {"vmusb": [{"type": "file", "value": 286576}], "vmusbmouse": [{"type": "file", "value": 286592}], "System32\\drivers\\vmusb.sys": [{"type": "file", "value": 301088}], "System32\\drivers\\vmusbmouse.sys": [{"type": "file", "value": 301568}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/vmusbmouse/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 286592}, {"type": "file", "value": 301568}], "captures": {"vmusbmouse": [{"type": "file", "value": 286592}], "System32\\drivers\\vmusbmouse.sys": [{"type": "file", "value": 301568}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/vmx_svga/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 286624}], "captures": {"vmx_svga": [{"type": "file", "value": 286624}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/vmxnet/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 286648}], "captures": {"vmxnet": [{"type": "file", "value": 286648}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/vmx86/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 286664}, {"type": "file", "value": 301432}], "captures": {"vmx86": [{"type": "file", "value": 286664}], "System32\\drivers\\vmx86.sys": [{"type": "file", "value": 301432}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/VMwareVMware/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 281984}], "captures": {"VMwareVMware": [{"type": "file", "value": 281984}]}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/vmGuestLib\\.dll/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/vmGuestLib\\.dll/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/Applications\\\\VMwareHostOpen\\.exe/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/vm3dgl\\.dll/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/vmdum\\.dll/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/vm3dver\\.dll/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/vmtray\\.dll/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/VMToolsHook\\.dll/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/vmmousever\\.dll/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/VmGuestLibJava\\.dll/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/vmscsi\\.sys/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "reference analysis tools strings": {"meta": {"name": "reference analysis tools strings", "namespace": "anti-analysis", "authors": ["michael.hunhoff@mandiant.com"], "scope": "file", "attack": [], "mbc": [{"parts": ["Discovery", "Analysis Tool Discovery", "Process detection"], "objective": "Discovery", "behavior": "Analysis Tool Discovery", "method": "Process detection", "id": "B0013.001"}], "references": ["https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiAnalysis/process.cpp"], "examples": ["al-khaser_x86.exe_"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: reference analysis tools strings\n    namespace: anti-analysis\n    authors:\n      - michael.hunhoff@mandiant.com\n    scope: file\n    mbc:\n      - Discovery::Analysis Tool Discovery::Process detection [B0013.001]\n    references:\n      - https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiAnalysis/process.cpp\n    examples:\n      - al-khaser_x86.exe_\n  features:\n    - or:\n      - string: /ollydbg\\.exe/i\n      - string: /ProcessHacker\\.exe/i\n      - string: /tcpview\\.exe/i\n      - string: /autoruns\\.exe/i\n      - string: /autorunsc\\.exe/i\n      - string: /filemon\\.exe/i\n      - string: /procmon\\.exe/i\n      - string: /regmon\\.exe/i\n      - string: /procexp\\.exe/i\n      - string: /idaq\\.exe/i\n      - string: /idaq64\\.exe/i\n      - string: /ImmunityDebugger\\.exe/i\n      - string: /Wireshark\\.exe/i\n      - string: /dumpcap\\.exe/i\n      - string: /HookExplorer\\.exe/i\n      - string: /ImportREC\\.exe/i\n      - string: /PETools\\.exe/i\n      - string: /LordPE\\.exe/i\n      - string: /SysInspector\\.exe/i\n      - string: /proc_analyzer\\.exe/i\n      - string: /sysAnalyzer\\.exe/i\n      - string: /sniff_hit\\.exe/i\n      - string: /windbg\\.exe/i\n      - string: /joeboxcontrol\\.exe/i\n      - string: /joeboxserver\\.exe/i\n      - string: /ResourceHacker\\.exe/i\n      - string: /x32dbg\\.exe/i\n      - string: /x64dbg\\.exe/i\n      - string: /Fiddler\\.exe/i\n      - string: /httpdebugger\\.exe/i\n      - string: /fakenet\\.exe/i\n      - string: /netmon\\.exe/i\n      - string: /WPE PRO\\.exe/i\n      - string: /decompile\\.exe/i\n", "matches": [[{"type": "no address"}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "regex", "regex": "/ollydbg\\.exe/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 248760}], "captures": {"ollydbg.exe": [{"type": "file", "value": 248760}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/ProcessHacker\\.exe/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 248792}], "captures": {"ProcessHacker.exe": [{"type": "file", "value": 248792}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/tcpview\\.exe/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 248840}], "captures": {"tcpview.exe": [{"type": "file", "value": 248840}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/autoruns\\.exe/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 248872}], "captures": {"autoruns.exe": [{"type": "file", "value": 248872}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/autorunsc\\.exe/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 248904}], "captures": {"autorunsc.exe": [{"type": "file", "value": 248904}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/filemon\\.exe/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 248944}], "captures": {"filemon.exe": [{"type": "file", "value": 248944}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/procmon\\.exe/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 248976}], "captures": {"procmon.exe": [{"type": "file", "value": 248976}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/regmon\\.exe/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 249008}], "captures": {"regmon.exe": [{"type": "file", "value": 249008}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/procexp\\.exe/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 249040}], "captures": {"procexp.exe": [{"type": "file", "value": 249040}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/idaq\\.exe/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 249072}], "captures": {"idaq.exe": [{"type": "file", "value": 249072}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/idaq64\\.exe/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 249096}], "captures": {"idaq64.exe": [{"type": "file", "value": 249096}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/ImmunityDebugger\\.exe/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 249128}], "captures": {"ImmunityDebugger.exe": [{"type": "file", "value": 249128}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/Wireshark\\.exe/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 249184}], "captures": {"Wireshark.exe": [{"type": "file", "value": 249184}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/dumpcap\\.exe/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 249224}], "captures": {"dumpcap.exe": [{"type": "file", "value": 249224}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/HookExplorer\\.exe/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 249256}], "captures": {"HookExplorer.exe": [{"type": "file", "value": 249256}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/ImportREC\\.exe/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 249296}], "captures": {"ImportREC.exe": [{"type": "file", "value": 249296}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/PETools\\.exe/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 249336}], "captures": {"PETools.exe": [{"type": "file", "value": 249336}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/LordPE\\.exe/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 249368}], "captures": {"LordPE.exe": [{"type": "file", "value": 249368}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/SysInspector\\.exe/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 249400}], "captures": {"SysInspector.exe": [{"type": "file", "value": 249400}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/proc_analyzer\\.exe/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 249440}], "captures": {"proc_analyzer.exe": [{"type": "file", "value": 249440}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/sysAnalyzer\\.exe/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 249488}], "captures": {"sysAnalyzer.exe": [{"type": "file", "value": 249488}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/sniff_hit\\.exe/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 249528}], "captures": {"sniff_hit.exe": [{"type": "file", "value": 249528}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/windbg\\.exe/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 249568}], "captures": {"windbg.exe": [{"type": "file", "value": 249568}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/joeboxcontrol\\.exe/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 249600}], "captures": {"joeboxcontrol.exe": [{"type": "file", "value": 249600}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/joeboxserver\\.exe/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 249648}], "captures": {"joeboxserver.exe": [{"type": "file", "value": 249648}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/ResourceHacker\\.exe/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 249688}], "captures": {"ResourceHacker.exe": [{"type": "file", "value": 249688}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/x32dbg\\.exe/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 249736}], "captures": {"x32dbg.exe": [{"type": "file", "value": 249736}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/x64dbg\\.exe/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 249768}], "captures": {"x64dbg.exe": [{"type": "file", "value": 249768}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/Fiddler\\.exe/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 249800}], "captures": {"Fiddler.exe": [{"type": "file", "value": 249800}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/httpdebugger\\.exe/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 249832}], "captures": {"httpdebugger.exe": [{"type": "file", "value": 249832}]}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/fakenet\\.exe/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/netmon\\.exe/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/WPE PRO\\.exe/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/decompile\\.exe/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "reference anti-VM strings targeting VirtualPC": {"meta": {"name": "reference anti-VM strings targeting VirtualPC", "namespace": "anti-analysis/anti-vm/vm-detection", "authors": ["michael.hunhoff@mandiant.com"], "scope": "file", "attack": [{"parts": ["Defense Evasion", "Virtualization/Sandbox Evasion", "System Checks"], "tactic": "Defense Evasion", "technique": "Virtualization/Sandbox Evasion", "subtechnique": "System Checks", "id": "T1497.001"}], "mbc": [{"parts": ["Anti-Behavioral Analysis", "Virtual Machine Detection"], "objective": "Anti-Behavioral Analysis", "behavior": "Virtual Machine Detection", "method": "", "id": "B0009"}], "references": ["https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiVM/VirtualPC.cpp"], "examples": ["al-khaser_x86.exe_"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: reference anti-VM strings targeting VirtualPC\n    namespace: anti-analysis/anti-vm/vm-detection\n    authors:\n      - michael.hunhoff@mandiant.com\n    scope: file\n    att&ck:\n      - Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001]\n    mbc:\n      - Anti-Behavioral Analysis::Virtual Machine Detection [B0009]\n    references:\n      - https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiVM/VirtualPC.cpp\n    examples:\n      - al-khaser_x86.exe_\n  features:\n    - or:\n      - string: /VirtualPC/i\n      - string: /VMSrvc.exe/i\n      - string: /VMUSrvc.exe/i\n      - string: /SOFTWARE\\\\Microsoft\\\\Virtual Machine\\\\Guest\\\\Parameters/i\n", "matches": [[{"type": "no address"}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "regex", "regex": "/VirtualPC/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/VMSrvc.exe/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 297920}], "captures": {"VMSrvc.exe": [{"type": "file", "value": 297920}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/VMUSrvc.exe/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 297952}], "captures": {"VMUSrvc.exe": [{"type": "file", "value": 297952}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/SOFTWARE\\\\Microsoft\\\\Virtual Machine\\\\Guest\\\\Parameters/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 298080}], "captures": {"SOFTWARE\\Microsoft\\Virtual Machine\\Guest\\Parameters": [{"type": "file", "value": 298080}]}}], "locations": [], "captures": {}}]]}, "reference anti-VM strings targeting Xen": {"meta": {"name": "reference anti-VM strings targeting Xen", "namespace": "anti-analysis/anti-vm/vm-detection", "authors": ["michael.hunhoff@mandiant.com"], "scope": "file", "attack": [{"parts": ["Defense Evasion", "Virtualization/Sandbox Evasion", "System Checks"], "tactic": "Defense Evasion", "technique": "Virtualization/Sandbox Evasion", "subtechnique": "System Checks", "id": "T1497.001"}], "mbc": [{"parts": ["Anti-Behavioral Analysis", "Virtual Machine Detection"], "objective": "Anti-Behavioral Analysis", "behavior": "Virtual Machine Detection", "method": "", "id": "B0009"}], "references": ["https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiVM/Xen.cpp"], "examples": ["al-khaser_x86.exe_"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: reference anti-VM strings targeting Xen\n    namespace: anti-analysis/anti-vm/vm-detection\n    authors:\n      - michael.hunhoff@mandiant.com\n    scope: file\n    att&ck:\n      - Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001]\n    mbc:\n      - Anti-Behavioral Analysis::Virtual Machine Detection [B0009]\n    references:\n      - https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiVM/Xen.cpp\n    examples:\n      - al-khaser_x86.exe_\n  features:\n    - or:\n      - string: /^Xen/i\n      - string: /XenVMMXenVMM/i\n      - string: /xenservice.exe/i\n      - string: /XenVMMXenVMM/i\n      - string: /HVM domU/i\n", "matches": [[{"type": "no address"}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "regex", "regex": "/^Xen/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 246112}, {"type": "file", "value": 302960}, {"type": "file", "value": 282016}], "captures": {"Xen Detection": [{"type": "file", "value": 246112}], "XenVMMXenVMM": [{"type": "file", "value": 282016}], "xenservice.exe": [{"type": "file", "value": 302960}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/XenVMMXenVMM/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 282016}], "captures": {"XenVMMXenVMM": [{"type": "file", "value": 282016}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/xenservice.exe/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 302960}], "captures": {"xenservice.exe": [{"type": "file", "value": 302960}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/XenVMMXenVMM/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 282016}], "captures": {"XenVMMXenVMM": [{"type": "file", "value": 282016}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/HVM domU/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 282424}], "captures": {"HVM domU": [{"type": "file", "value": 282424}]}}], "locations": [], "captures": {}}]]}, "reference anti-VM strings targeting VirtualBox": {"meta": {"name": "reference anti-VM strings targeting VirtualBox", "namespace": "anti-analysis/anti-vm/vm-detection", "authors": ["michael.hunhoff@mandiant.com"], "scope": "file", "attack": [{"parts": ["Defense Evasion", "Virtualization/Sandbox Evasion", "System Checks"], "tactic": "Defense Evasion", "technique": "Virtualization/Sandbox Evasion", "subtechnique": "System Checks", "id": "T1497.001"}], "mbc": [{"parts": ["Anti-Behavioral Analysis", "Virtual Machine Detection"], "objective": "Anti-Behavioral Analysis", "behavior": "Virtual Machine Detection", "method": "", "id": "B0009"}], "references": ["https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiVM/VirtualBox.cpp"], "examples": ["al-khaser_x86.exe_"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: reference anti-VM strings targeting VirtualBox\n    namespace: anti-analysis/anti-vm/vm-detection\n    authors:\n      - michael.hunhoff@mandiant.com\n    scope: file\n    att&ck:\n      - Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001]\n    mbc:\n      - Anti-Behavioral Analysis::Virtual Machine Detection [B0009]\n    references:\n      - https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiVM/VirtualBox.cpp\n    examples:\n      - al-khaser_x86.exe_\n  features:\n    - or:\n      - string: /VBOX/i\n      - string: /VEN_VBOX/i\n      - string: /VirtualBox/i\n      - string: /06/23/99/i\n      - string: /HARDWARE\\\\ACPI\\\\DSDT\\\\VBOX__/i\n      - string: /HARDWARE\\\\ACPI\\\\FADT\\\\VBOX__/i\n      - string: /HARDWARE\\\\ACPI\\\\RSDT\\\\VBOX__/i\n      - string: /SOFTWARE\\\\Oracle\\\\VirtualBox Guest Additions/i\n      - string: /SYSTEM\\\\ControlSet001\\\\Services\\\\VBoxGuest/i\n      - string: /SYSTEM\\\\ControlSet001\\\\Services\\\\VBoxMouse/i\n      - string: /SYSTEM\\\\ControlSet001\\\\Services\\\\VBoxService/i\n      - string: /SYSTEM\\\\ControlSet001\\\\Services\\\\VBoxSF/i\n      - string: /SYSTEM\\\\ControlSet001\\\\Services\\\\VBoxVideo/i\n      - string: /VBoxMouse\\.sys/i\n      - string: /VBoxGuest\\.sys/i\n      - string: /VBoxSF\\.sys/i\n      - string: /VBoxVideo\\.sys/i\n      - string: /vboxdisp\\.dll/i\n      - string: /vboxhook\\.dll/i\n      - string: /vboxmrxnp\\.dll/i\n      - string: /vboxogl\\.dll/i\n      - string: /vboxoglarrayspu\\.dll/i\n      - string: /vboxoglcrutil\\.dll/i\n      - string: /vboxoglerrorspu\\.dll/i\n      - string: /vboxoglfeedbackspu\\.dll/i\n      - string: /vboxoglpackspu\\.dll/i\n      - string: /vboxoglpassthroughspu\\.dll/i\n      - string: /vboxservice\\.exe/i\n      - string: /vboxtray\\.exe/i\n      - string: /VBoxControl\\.exe/i\n      - string: /oracle\\\\virtualbox guest additions\\\\/i\n      - string: /\\\\\\\\.\\\\VBoxMiniRdrDN/i\n      - string: /\\\\\\\\.\\\\VBoxGuest/i\n      - string: /\\\\\\\\.\\\\pipe\\\\VBoxMiniRdDN/i\n      - string: /\\\\\\\\.\\\\VBoxTrayIPC/i\n      - string: /\\\\\\\\.\\\\pipe\\\\VBoxTrayIPC/i\n      - string: /VBoxTrayToolWndClass/i\n      - string: /VBoxTrayToolWnd/i\n      - string: /vboxservice\\.exe/i\n      - string: /vboxtray.exe/i\n      - string: /vboxvideo/i\n      - string: /VBoxVideoW8/i\n      - string: /VBoxWddm/i\n      - string: /PCI\\\\VEN_80EE&DEV_CAFE/i\n      - string: /82801FB/i\n      - string: /82441FX/i\n      - string: /82371SB/i\n      - string: /OpenHCD/i\n      - string: /ACPIBus_BUS_0/i\n      - string: /PCI_BUS_0/i\n      - string: /PNP_BUS_0/i\n      - string: /Oracle Corporation/i\n      - string: /VBoxWdd/i\n      - string: /VBoxS/i\n        description: VirtualBox Shared Folders\n      - string: /VBoxMouse/i\n        description: VirtualBox Guest Mouse\n      - string: /VBoxGuest/i\n        description: VirtualBox Guest Driver\n      - string: /VBoxVBoxVBox/i\n      - string: /innotek GmbH/i\n      - string: /drivers\\\\vboxdrv/i\n", "matches": [[{"type": "no address"}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "regex", "regex": "/VBOX/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 296832}, {"type": "file", "value": 245248}, {"type": "file", "value": 294912}, {"type": "file", "value": 295040}, {"type": "file", "value": 295552}, {"type": "file", "value": 295808}, {"type": "file", "value": 286472}, {"type": "file", "value": 294664}, {"type": "file", "value": 295432}, {"type": "file", "value": 294032}, {"type": "file", "value": 294800}, {"type": "file", "value": 295184}, {"type": "file", "value": 295952}, {"type": "file", "value": 296824}, {"type": "file", "value": 296592}, {"type": "file", "value": 289184}, {"type": "file", "value": 294432}, {"type": "file", "value": 296096}, {"type": "file", "value": 297504}, {"type": "file", "value": 296616}, {"type": "file", "value": 244656}, {"type": "file", "value": 244912}, {"type": "file", "value": 293624}, {"type": "file", "value": 293936}, {"type": "file", "value": 293752}, {"type": "file", "value": 295344}, {"type": "file", "value": 295856}, {"type": "file", "value": 294968}, {"type": "file", "value": 293688}, {"type": "file", "value": 295992}, {"type": "file", "value": 293312}, {"type": "file", "value": 294336}, {"type": "file", "value": 294592}, {"type": "file", "value": 295104}, {"type": "file", "value": 296256}, {"type": "file", "value": 286408}, {"type": "file", "value": 294856}, {"type": "file", "value": 295496}, {"type": "file", "value": 245072}, {"type": "file", "value": 294744}, {"type": "file", "value": 295896}, {"type": "file", "value": 296152}, {"type": "file", "value": 282080}, {"type": "file", "value": 286432}, {"type": "file", "value": 294240}, {"type": "file", "value": 295264}, {"type": "file", "value": 296296}, {"type": "file", "value": 286448}, {"type": "file", "value": 294128}, {"type": "file", "value": 294512}, {"type": "file", "value": 281848}], "captures": {"szVBoxSources": [{"type": "file", "value": 289184}], "vbox": [{"type": "file", "value": 296824}, {"type": "file", "value": 281848}], "VBOX": [{"type": "file", "value": 296832}, {"type": "file", "value": 293312}], "Checking VBoxTrayToolWndClass / VBoxTrayToolWnd ": [{"type": "file", "value": 244656}], "Checking Win32_PnPDevice DeviceId from WMI for VBox PCI device ": [{"type": "file", "value": 244912}], "Checking Win32_PnPDevice Name from WMI for VBox controller hardware ": [{"type": "file", "value": 245072}], "Checking Win32_PnPDevice Name from WMI for VBOX names ": [{"type": "file", "value": 245248}], "VBoxVBoxVBox": [{"type": "file", "value": 282080}], "VBoxWddm": [{"type": "file", "value": 286408}], "VBoxSF": [{"type": "file", "value": 286432}], "VBoxMouse": [{"type": "file", "value": 286448}], "VBoxGuest": [{"type": "file", "value": 286472}], "HARDWARE\\ACPI\\DSDT\\VBOX__": [{"type": "file", "value": 293624}], "HARDWARE\\ACPI\\FADT\\VBOX__": [{"type": "file", "value": 293688}], "HARDWARE\\ACPI\\RSDT\\VBOX__": [{"type": "file", "value": 293752}], "SYSTEM\\ControlSet001\\Services\\VBoxGuest": [{"type": "file", "value": 293936}], "SYSTEM\\ControlSet001\\Services\\VBoxMouse": [{"type": "file", "value": 294032}], "SYSTEM\\ControlSet001\\Services\\VBoxService": [{"type": "file", "value": 294128}], "SYSTEM\\ControlSet001\\Services\\VBoxSF": [{"type": "file", "value": 294240}], "SYSTEM\\ControlSet001\\Services\\VBoxVideo": [{"type": "file", "value": 294336}], "System32\\drivers\\VBoxMouse.sys": [{"type": "file", "value": 294432}], "System32\\drivers\\VBoxGuest.sys": [{"type": "file", "value": 294512}], "System32\\drivers\\VBoxSF.sys": [{"type": "file", "value": 294592}], "System32\\drivers\\VBoxVideo.sys": [{"type": "file", "value": 294664}], "System32\\vboxdisp.dll": [{"type": "file", "value": 294744}], "System32\\vboxhook.dll": [{"type": "file", "value": 294800}], "System32\\vboxmrxnp.dll": [{"type": "file", "value": 294856}], "System32\\vboxogl.dll": [{"type": "file", "value": 294912}], "System32\\vboxoglarrayspu.dll": [{"type": "file", "value": 294968}], "System32\\vboxoglcrutil.dll": [{"type": "file", "value": 295040}], "System32\\vboxoglerrorspu.dll": [{"type": "file", "value": 295104}], "System32\\vboxoglfeedbackspu.dll": [{"type": "file", "value": 295184}], "System32\\vboxoglpackspu.dll": [{"type": "file", "value": 295264}], "System32\\vboxoglpassthroughspu.dll": [{"type": "file", "value": 295344}], "System32\\vboxservice.exe": [{"type": "file", "value": 295432}], "System32\\vboxtray.exe": [{"type": "file", "value": 295496}], "System32\\VBoxControl.exe": [{"type": "file", "value": 295552}], "\\\\.\\VBoxMiniRdrDN": [{"type": "file", "value": 295808}], "\\\\.\\VBoxGuest": [{"type": "file", "value": 295856}], "\\\\.\\pipe\\VBoxMiniRdDN": [{"type": "file", "value": 295896}], "\\\\.\\VBoxTrayIPC": [{"type": "file", "value": 295952}], "\\\\.\\pipe\\VBoxTrayIPC": [{"type": "file", "value": 295992}], "VBoxTrayToolWndClass": [{"type": "file", "value": 296096}], "VBoxTrayToolWnd": [{"type": "file", "value": 296152}], "vboxservice.exe": [{"type": "file", "value": 296256}], "vboxtray.exe": [{"type": "file", "value": 296296}], "vboxvideo": [{"type": "file", "value": 296592}], "VBoxVideoW8": [{"type": "file", "value": 296616}], "VEN_VBOX": [{"type": "file", "value": 297504}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/VEN_VBOX/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 297504}], "captures": {"VEN_VBOX": [{"type": "file", "value": 297504}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/VirtualBox/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 293824}, {"type": "file", "value": 296192}, {"type": "file", "value": 293368}, {"type": "file", "value": 296808}, {"type": "file", "value": 244272}, {"type": "file", "value": 244336}, {"type": "file", "value": 244784}, {"type": "file", "value": 295664}, {"type": "file", "value": 296336}, {"type": "file", "value": 282392}], "captures": {"VirtualBox": [{"type": "file", "value": 296808}, {"type": "file", "value": 282392}], "VirtualBox Detection": [{"type": "file", "value": 244272}], "Checking VirtualBox Guest Additions directory ": [{"type": "file", "value": 244336}], "Checking VirtualBox Shared Folders network provider ": [{"type": "file", "value": 244784}], "VIRTUALBOX": [{"type": "file", "value": 293368}], "SOFTWARE\\Oracle\\VirtualBox Guest Additions": [{"type": "file", "value": 293824}], "oracle\\virtualbox guest additions\\": [{"type": "file", "value": 295664}], "VirtualBox Shared Folders": [{"type": "file", "value": 296192}], "Checking VirtualBox process %s ": [{"type": "file", "value": 296336}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/06/23/99/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 293440}], "captures": {"06/23/99": [{"type": "file", "value": 293440}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/HARDWARE\\\\ACPI\\\\DSDT\\\\VBOX__/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 293624}], "captures": {"HARDWARE\\ACPI\\DSDT\\VBOX__": [{"type": "file", "value": 293624}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/HARDWARE\\\\ACPI\\\\FADT\\\\VBOX__/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 293688}], "captures": {"HARDWARE\\ACPI\\FADT\\VBOX__": [{"type": "file", "value": 293688}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/HARDWARE\\\\ACPI\\\\RSDT\\\\VBOX__/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 293752}], "captures": {"HARDWARE\\ACPI\\RSDT\\VBOX__": [{"type": "file", "value": 293752}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/SOFTWARE\\\\Oracle\\\\VirtualBox Guest Additions/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 293824}], "captures": {"SOFTWARE\\Oracle\\VirtualBox Guest Additions": [{"type": "file", "value": 293824}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/SYSTEM\\\\ControlSet001\\\\Services\\\\VBoxGuest/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 293936}], "captures": {"SYSTEM\\ControlSet001\\Services\\VBoxGuest": [{"type": "file", "value": 293936}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/SYSTEM\\\\ControlSet001\\\\Services\\\\VBoxMouse/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 294032}], "captures": {"SYSTEM\\ControlSet001\\Services\\VBoxMouse": [{"type": "file", "value": 294032}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/SYSTEM\\\\ControlSet001\\\\Services\\\\VBoxService/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 294128}], "captures": {"SYSTEM\\ControlSet001\\Services\\VBoxService": [{"type": "file", "value": 294128}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/SYSTEM\\\\ControlSet001\\\\Services\\\\VBoxSF/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 294240}], "captures": {"SYSTEM\\ControlSet001\\Services\\VBoxSF": [{"type": "file", "value": 294240}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/SYSTEM\\\\ControlSet001\\\\Services\\\\VBoxVideo/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 294336}], "captures": {"SYSTEM\\ControlSet001\\Services\\VBoxVideo": [{"type": "file", "value": 294336}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/VBoxMouse\\.sys/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 294432}], "captures": {"System32\\drivers\\VBoxMouse.sys": [{"type": "file", "value": 294432}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/VBoxGuest\\.sys/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 294512}], "captures": {"System32\\drivers\\VBoxGuest.sys": [{"type": "file", "value": 294512}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/VBoxSF\\.sys/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 294592}], "captures": {"System32\\drivers\\VBoxSF.sys": [{"type": "file", "value": 294592}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/VBoxVideo\\.sys/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 294664}], "captures": {"System32\\drivers\\VBoxVideo.sys": [{"type": "file", "value": 294664}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/vboxdisp\\.dll/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 294744}], "captures": {"System32\\vboxdisp.dll": [{"type": "file", "value": 294744}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/vboxhook\\.dll/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 294800}], "captures": {"System32\\vboxhook.dll": [{"type": "file", "value": 294800}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/vboxmrxnp\\.dll/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 294856}], "captures": {"System32\\vboxmrxnp.dll": [{"type": "file", "value": 294856}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/vboxogl\\.dll/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 294912}], "captures": {"System32\\vboxogl.dll": [{"type": "file", "value": 294912}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/vboxoglarrayspu\\.dll/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 294968}], "captures": {"System32\\vboxoglarrayspu.dll": [{"type": "file", "value": 294968}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/vboxoglcrutil\\.dll/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 295040}], "captures": {"System32\\vboxoglcrutil.dll": [{"type": "file", "value": 295040}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/vboxoglerrorspu\\.dll/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 295104}], "captures": {"System32\\vboxoglerrorspu.dll": [{"type": "file", "value": 295104}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/vboxoglfeedbackspu\\.dll/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 295184}], "captures": {"System32\\vboxoglfeedbackspu.dll": [{"type": "file", "value": 295184}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/vboxoglpackspu\\.dll/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 295264}], "captures": {"System32\\vboxoglpackspu.dll": [{"type": "file", "value": 295264}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/vboxoglpassthroughspu\\.dll/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 295344}], "captures": {"System32\\vboxoglpassthroughspu.dll": [{"type": "file", "value": 295344}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/vboxservice\\.exe/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 295432}, {"type": "file", "value": 296256}], "captures": {"System32\\vboxservice.exe": [{"type": "file", "value": 295432}], "vboxservice.exe": [{"type": "file", "value": 296256}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/vboxtray\\.exe/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 295496}, {"type": "file", "value": 296296}], "captures": {"System32\\vboxtray.exe": [{"type": "file", "value": 295496}], "vboxtray.exe": [{"type": "file", "value": 296296}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/VBoxControl\\.exe/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 295552}], "captures": {"System32\\VBoxControl.exe": [{"type": "file", "value": 295552}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/oracle\\\\virtualbox guest additions\\\\/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 295664}], "captures": {"oracle\\virtualbox guest additions\\": [{"type": "file", "value": 295664}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/\\\\\\\\.\\\\VBoxMiniRdrDN/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 295808}], "captures": {"\\\\.\\VBoxMiniRdrDN": [{"type": "file", "value": 295808}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/\\\\\\\\.\\\\VBoxGuest/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 295856}], "captures": {"\\\\.\\VBoxGuest": [{"type": "file", "value": 295856}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/\\\\\\\\.\\\\pipe\\\\VBoxMiniRdDN/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 295896}], "captures": {"\\\\.\\pipe\\VBoxMiniRdDN": [{"type": "file", "value": 295896}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/\\\\\\\\.\\\\VBoxTrayIPC/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 295952}], "captures": {"\\\\.\\VBoxTrayIPC": [{"type": "file", "value": 295952}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/\\\\\\\\.\\\\pipe\\\\VBoxTrayIPC/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 295992}], "captures": {"\\\\.\\pipe\\VBoxTrayIPC": [{"type": "file", "value": 295992}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/VBoxTrayToolWndClass/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 244656}, {"type": "file", "value": 296096}], "captures": {"Checking VBoxTrayToolWndClass / VBoxTrayToolWnd ": [{"type": "file", "value": 244656}], "VBoxTrayToolWndClass": [{"type": "file", "value": 296096}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/VBoxTrayToolWnd/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 244656}, {"type": "file", "value": 296096}, {"type": "file", "value": 296152}], "captures": {"Checking VBoxTrayToolWndClass / VBoxTrayToolWnd ": [{"type": "file", "value": 244656}], "VBoxTrayToolWndClass": [{"type": "file", "value": 296096}], "VBoxTrayToolWnd": [{"type": "file", "value": 296152}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/vboxservice\\.exe/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 295432}, {"type": "file", "value": 296256}], "captures": {"System32\\vboxservice.exe": [{"type": "file", "value": 295432}], "vboxservice.exe": [{"type": "file", "value": 296256}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/vboxtray.exe/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 295496}, {"type": "file", "value": 296296}], "captures": {"System32\\vboxtray.exe": [{"type": "file", "value": 295496}], "vboxtray.exe": [{"type": "file", "value": 296296}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/vboxvideo/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 294336}, {"type": "file", "value": 294664}, {"type": "file", "value": 296592}, {"type": "file", "value": 296616}], "captures": {"SYSTEM\\ControlSet001\\Services\\VBoxVideo": [{"type": "file", "value": 294336}], "System32\\drivers\\VBoxVideo.sys": [{"type": "file", "value": 294664}], "vboxvideo": [{"type": "file", "value": 296592}], "VBoxVideoW8": [{"type": "file", "value": 296616}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/VBoxVideoW8/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 296616}], "captures": {"VBoxVideoW8": [{"type": "file", "value": 296616}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/VBoxWddm/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 286408}], "captures": {"VBoxWddm": [{"type": "file", "value": 286408}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/PCI\\\\VEN_80EE&DEV_CAFE/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 296936}], "captures": {"PCI\\VEN_80EE&DEV_CAFE": [{"type": "file", "value": 296936}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/82801FB/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 297008}], "captures": {"82801FB": [{"type": "file", "value": 297008}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/82441FX/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 297032}], "captures": {"82441FX": [{"type": "file", "value": 297032}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/82371SB/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 297056}], "captures": {"82371SB": [{"type": "file", "value": 297056}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/OpenHCD/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 297080}], "captures": {"OpenHCD": [{"type": "file", "value": 297080}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/ACPIBus_BUS_0/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 297168}], "captures": {"ACPIBus_BUS_0": [{"type": "file", "value": 297168}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/PCI_BUS_0/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 297208}], "captures": {"PCI_BUS_0": [{"type": "file", "value": 297208}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/PNP_BUS_0/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 297232}], "captures": {"PNP_BUS_0": [{"type": "file", "value": 297232}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/Oracle Corporation/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 297352}], "captures": {"Oracle Corporation": [{"type": "file", "value": 297352}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/VBoxWdd/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 286408}], "captures": {"VBoxWddm": [{"type": "file", "value": 286408}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/VBoxS/i", "description": "VirtualBox Shared Folders"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 289184}, {"type": "file", "value": 286432}, {"type": "file", "value": 294240}, {"type": "file", "value": 294128}, {"type": "file", "value": 294592}, {"type": "file", "value": 296256}, {"type": "file", "value": 295432}], "captures": {"szVBoxSources": [{"type": "file", "value": 289184}], "VBoxSF": [{"type": "file", "value": 286432}], "SYSTEM\\ControlSet001\\Services\\VBoxService": [{"type": "file", "value": 294128}], "SYSTEM\\ControlSet001\\Services\\VBoxSF": [{"type": "file", "value": 294240}], "System32\\drivers\\VBoxSF.sys": [{"type": "file", "value": 294592}], "System32\\vboxservice.exe": [{"type": "file", "value": 295432}], "vboxservice.exe": [{"type": "file", "value": 296256}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/VBoxMouse/i", "description": "VirtualBox Guest Mouse"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 286448}, {"type": "file", "value": 294432}, {"type": "file", "value": 294032}], "captures": {"VBoxMouse": [{"type": "file", "value": 286448}], "SYSTEM\\ControlSet001\\Services\\VBoxMouse": [{"type": "file", "value": 294032}], "System32\\drivers\\VBoxMouse.sys": [{"type": "file", "value": 294432}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/VBoxGuest/i", "description": "VirtualBox Guest Driver"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 286472}, {"type": "file", "value": 293936}, {"type": "file", "value": 294512}, {"type": "file", "value": 295856}], "captures": {"VBoxGuest": [{"type": "file", "value": 286472}], "SYSTEM\\ControlSet001\\Services\\VBoxGuest": [{"type": "file", "value": 293936}], "System32\\drivers\\VBoxGuest.sys": [{"type": "file", "value": 294512}], "\\\\.\\VBoxGuest": [{"type": "file", "value": 295856}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/VBoxVBoxVBox/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 282080}], "captures": {"VBoxVBoxVBox": [{"type": "file", "value": 282080}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/innotek GmbH/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 282480}], "captures": {"innotek GmbH": [{"type": "file", "value": 282480}]}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/drivers\\\\vboxdrv/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "reference anti-VM strings targeting Parallels": {"meta": {"name": "reference anti-VM strings targeting Parallels", "namespace": "anti-analysis/anti-vm/vm-detection", "authors": ["michael.hunhoff@mandiant.com"], "scope": "file", "attack": [{"parts": ["Defense Evasion", "Virtualization/Sandbox Evasion", "System Checks"], "tactic": "Defense Evasion", "technique": "Virtualization/Sandbox Evasion", "subtechnique": "System Checks", "id": "T1497.001"}], "mbc": [{"parts": ["Anti-Behavioral Analysis", "Virtual Machine Detection"], "objective": "Anti-Behavioral Analysis", "behavior": "Virtual Machine Detection", "method": "", "id": "B0009"}], "references": ["https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiVM/Parallels.cpp"], "examples": ["al-khaser_x86.exe_"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: reference anti-VM strings targeting Parallels\n    namespace: anti-analysis/anti-vm/vm-detection\n    authors:\n      - michael.hunhoff@mandiant.com\n    scope: file\n    att&ck:\n      - Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001]\n    mbc:\n      - Anti-Behavioral Analysis::Virtual Machine Detection [B0009]\n    references:\n      - https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiVM/Parallels.cpp\n    examples:\n      - al-khaser_x86.exe_\n  features:\n    - or:\n      - string: /Parallels/i\n      - string: /prl_cc.exe/i\n      - string: /prl_tools.exe/i\n      - string: /prl hyperv/i\n", "matches": [[{"type": "no address"}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "regex", "regex": "/Parallels/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 284592}], "captures": {"Checking Parallels processes: %s": [{"type": "file", "value": 284592}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/prl_cc.exe/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 284512}], "captures": {"prl_cc.exe": [{"type": "file", "value": 284512}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/prl_tools.exe/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 284544}], "captures": {"prl_tools.exe": [{"type": "file", "value": 284544}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/prl hyperv/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 282048}], "captures": {"prl hyperv  ": [{"type": "file", "value": 282048}]}}], "locations": [], "captures": {}}]]}, "contains PDB path": {"meta": {"name": "contains PDB path", "namespace": "executable/pe/pdb", "authors": ["moritz.raabe@mandiant.com"], "scope": "file", "attack": [], "mbc": [], "references": [], "examples": ["464EF2CA59782CE697BC329713698CCC"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: contains PDB path\n    namespace: executable/pe/pdb\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: file\n    examples:\n      - 464EF2CA59782CE697BC329713698CCC  # level32.exe\n  features:\n    - string: /:\\\\.*\\.pdb/\n", "matches": [[{"type": "no address"}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/:\\\\.*\\.pdb/"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 335856}], "captures": {"C:\\Users\\spring\\Desktop\\al-khaser-master\\x64\\Debug\\al-khaser.pdb": [{"type": "file", "value": 335856}]}}]]}, "reference anti-VM strings targeting Qemu": {"meta": {"name": "reference anti-VM strings targeting Qemu", "namespace": "anti-analysis/anti-vm/vm-detection", "authors": ["michael.hunhoff@mandiant.com"], "scope": "file", "attack": [{"parts": ["Defense Evasion", "Virtualization/Sandbox Evasion", "System Checks"], "tactic": "Defense Evasion", "technique": "Virtualization/Sandbox Evasion", "subtechnique": "System Checks", "id": "T1497.001"}], "mbc": [{"parts": ["Anti-Behavioral Analysis", "Virtual Machine Detection"], "objective": "Anti-Behavioral Analysis", "behavior": "Virtual Machine Detection", "method": "", "id": "B0009"}], "references": ["https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiVM/Qemu.cpp"], "examples": ["al-khaser_x86.exe_"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: reference anti-VM strings targeting Qemu\n    namespace: anti-analysis/anti-vm/vm-detection\n    authors:\n      - michael.hunhoff@mandiant.com\n    scope: file\n    att&ck:\n      - Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001]\n    mbc:\n      - Anti-Behavioral Analysis::Virtual Machine Detection [B0009]\n    references:\n      - https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiVM/Qemu.cpp\n    examples:\n      - al-khaser_x86.exe_\n  features:\n    - or:\n      - string: /Qemu/i\n      - string: /qemu-ga.exe/i\n      - string: /BOCHS/i\n      - string: /^BXPC/i\n", "matches": [[{"type": "no address"}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "regex", "regex": "/Qemu/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 282512}, {"type": "file", "value": 246072}, {"type": "file", "value": 285828}, {"type": "file", "value": 281880}, {"type": "file", "value": 285720}, {"type": "file", "value": 285752}, {"type": "file", "value": 285820}], "captures": {"qemu": [{"type": "file", "value": 281880}, {"type": "file", "value": 285820}], "QEMU": [{"type": "file", "value": 282512}, {"type": "file", "value": 285828}], "QEMU Detection": [{"type": "file", "value": 246072}], "qemu-ga.exe": [{"type": "file", "value": 285720}], "Checking qemu processes %s ": [{"type": "file", "value": 285752}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/qemu-ga.exe/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 285720}], "captures": {"qemu-ga.exe": [{"type": "file", "value": 285720}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/BOCHS/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 285836}], "captures": {"BOCHS": [{"type": "file", "value": 285836}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/^BXPC/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 285844}], "captures": {"BXPC": [{"type": "file", "value": 285844}]}}], "locations": [], "captures": {}}]]}}}
