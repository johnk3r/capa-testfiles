{"meta": {"timestamp": "2023-03-22T10:24:50.666579", "version": "5.0.0", "argv": ["tests/data/al-khaser_x86.exe_", "--json"], "sample": {"md5": "db648cd247281954344f1d810c6fd590", "sha1": "a457931874ba395917da2ab060c02159f2c418ec", "sha256": "faf351db4072395ca1e2855a379b120cdbccdb09131c48463e30dccf4245f4bb", "path": "tests/data/al-khaser_x86.exe_"}, "analysis": {"format": "pe", "arch": "i386", "os": "windows", "extractor": "VivisectFeatureExtractor", "rules": ["/home/user/code-personal/capa/rules"], "base_address": {"type": "absolute", "value": 4194304}, "layout": {"functions": [{"address": {"type": "absolute", "value": 4300810}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4300815}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4337168}}]}, {"address": {"type": "absolute", "value": 4300820}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4483968}}]}, {"address": {"type": "absolute", "value": 4300825}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4335440}}]}, {"address": {"type": "absolute", "value": 4300835}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4344432}}]}, {"address": {"type": "absolute", "value": 4300840}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4454624}}, {"address": {"type": "absolute", "value": 4454700}}, {"address": {"type": "absolute", "value": 4454776}}, {"address": {"type": "absolute", "value": 4454793}}, {"address": {"type": "absolute", "value": 4454883}}, {"address": {"type": "absolute", "value": 4454986}}, {"address": {"type": "absolute", "value": 4455003}}, {"address": {"type": "absolute", "value": 4455048}}]}, {"address": {"type": "absolute", "value": 4300850}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4360720}}, {"address": {"type": "absolute", "value": 4360883}}, {"address": {"type": "absolute", "value": 4361222}}]}, {"address": {"type": "absolute", "value": 4300855}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4390032}}]}, {"address": {"type": "absolute", "value": 4300865}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4478304}}, {"address": {"type": "absolute", "value": 4478482}}]}, {"address": {"type": "absolute", "value": 4300870}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4358080}}]}, {"address": {"type": "absolute", "value": 4300875}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4348000}}, {"address": {"type": "absolute", "value": 4348102}}]}, {"address": {"type": "absolute", "value": 4300880}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4467136}}]}, {"address": {"type": "absolute", "value": 4300885}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4389600}}]}, {"address": {"type": "absolute", "value": 4300890}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4325600}}, {"address": {"type": "absolute", "value": 4325779}}]}, {"address": {"type": "absolute", "value": 4300895}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4380400}}, {"address": {"type": "absolute", "value": 4380517}}, {"address": {"type": "absolute", "value": 4380558}}, {"address": {"type": "absolute", "value": 4380571}}, {"address": {"type": "absolute", "value": 4380632}}, {"address": {"type": "absolute", "value": 4380677}}, {"address": {"type": "absolute", "value": 4380748}}, {"address": {"type": "absolute", "value": 4380879}}]}, {"address": {"type": "absolute", "value": 4300900}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4342752}}]}, {"address": {"type": "absolute", "value": 4300905}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4506683}}, {"address": {"type": "absolute", "value": 4507003}}, {"address": {"type": "absolute", "value": 4507056}}, {"address": {"type": "absolute", "value": 4507263}}]}, {"address": {"type": "absolute", "value": 4300910}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4333856}}]}, {"address": {"type": "absolute", "value": 4300915}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4461504}}, {"address": {"type": "absolute", "value": 4461599}}, {"address": {"type": "absolute", "value": 4461623}}]}, {"address": {"type": "absolute", "value": 4300925}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4345920}}]}, {"address": {"type": "absolute", "value": 4300930}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4300935}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4300945}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4486000}}]}, {"address": {"type": "absolute", "value": 4300950}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4335136}}]}, {"address": {"type": "absolute", "value": 4300955}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4300960}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4414048}}, {"address": {"type": "absolute", "value": 4414199}}]}, {"address": {"type": "absolute", "value": 4300965}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4300975}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4434658}}, {"address": {"type": "absolute", "value": 4434680}}, {"address": {"type": "absolute", "value": 4434768}}, {"address": {"type": "absolute", "value": 4434787}}, {"address": {"type": "absolute", "value": 4434809}}]}, {"address": {"type": "absolute", "value": 4300980}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4422014}}, {"address": {"type": "absolute", "value": 4422036}}, {"address": {"type": "absolute", "value": 4422192}}, {"address": {"type": "absolute", "value": 4422211}}, {"address": {"type": "absolute", "value": 4422233}}]}, {"address": {"type": "absolute", "value": 4300985}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4390832}}]}, {"address": {"type": "absolute", "value": 4300990}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4469680}}]}, {"address": {"type": "absolute", "value": 4300995}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4301000}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4301005}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4432688}}, {"address": {"type": "absolute", "value": 4432807}}, {"address": {"type": "absolute", "value": 4432974}}, {"address": {"type": "absolute", "value": 4433141}}]}, {"address": {"type": "absolute", "value": 4301010}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4344832}}]}, {"address": {"type": "absolute", "value": 4301020}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4301025}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4446336}}, {"address": {"type": "absolute", "value": 4446487}}, {"address": {"type": "absolute", "value": 4446539}}, {"address": {"type": "absolute", "value": 4446591}}, {"address": {"type": "absolute", "value": 4446649}}, {"address": {"type": "absolute", "value": 4446672}}, {"address": {"type": "absolute", "value": 4446754}}, {"address": {"type": "absolute", "value": 4446777}}, {"address": {"type": "absolute", "value": 4446852}}, {"address": {"type": "absolute", "value": 4446875}}, {"address": {"type": "absolute", "value": 4447044}}, {"address": {"type": "absolute", "value": 4447067}}, {"address": {"type": "absolute", "value": 4447133}}, {"address": {"type": "absolute", "value": 4447156}}, {"address": {"type": "absolute", "value": 4447388}}, {"address": {"type": "absolute", "value": 4447403}}, {"address": {"type": "absolute", "value": 4447545}}]}, {"address": {"type": "absolute", "value": 4301035}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4506064}}]}, {"address": {"type": "absolute", "value": 4301050}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4363728}}]}, {"address": {"type": "absolute", "value": 4301055}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4470192}}]}, {"address": {"type": "absolute", "value": 4301060}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4426480}}, {"address": {"type": "absolute", "value": 4426650}}, {"address": {"type": "absolute", "value": 4426678}}]}, {"address": {"type": "absolute", "value": 4301070}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4371024}}]}, {"address": {"type": "absolute", "value": 4301075}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4499898}}, {"address": {"type": "absolute", "value": 4499919}}]}, {"address": {"type": "absolute", "value": 4301080}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4390320}}]}, {"address": {"type": "absolute", "value": 4301085}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4404112}}, {"address": {"type": "absolute", "value": 4404183}}]}, {"address": {"type": "absolute", "value": 4301090}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4485552}}]}, {"address": {"type": "absolute", "value": 4301095}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4342352}}, {"address": {"type": "absolute", "value": 4342501}}]}, {"address": {"type": "absolute", "value": 4301100}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4301110}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4442779}}, {"address": {"type": "absolute", "value": 4442801}}, {"address": {"type": "absolute", "value": 4442889}}, {"address": {"type": "absolute", "value": 4442908}}, {"address": {"type": "absolute", "value": 4442930}}]}, {"address": {"type": "absolute", "value": 4301115}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4383824}}]}, {"address": {"type": "absolute", "value": 4301120}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4448064}}, {"address": {"type": "absolute", "value": 4448249}}]}, {"address": {"type": "absolute", "value": 4301125}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4369232}}, {"address": {"type": "absolute", "value": 4369312}}, {"address": {"type": "absolute", "value": 4369433}}, {"address": {"type": "absolute", "value": 4370126}}]}, {"address": {"type": "absolute", "value": 4301130}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4301135}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4349120}}]}, {"address": {"type": "absolute", "value": 4301140}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4339648}}, {"address": {"type": "absolute", "value": 4339840}}, {"address": {"type": "absolute", "value": 4339870}}, {"address": {"type": "absolute", "value": 4340285}}, {"address": {"type": "absolute", "value": 4340318}}, {"address": {"type": "absolute", "value": 4340564}}]}, {"address": {"type": "absolute", "value": 4301150}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4430528}}, {"address": {"type": "absolute", "value": 4430647}}, {"address": {"type": "absolute", "value": 4430823}}, {"address": {"type": "absolute", "value": 4430990}}]}, {"address": {"type": "absolute", "value": 4301155}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4356416}}]}, {"address": {"type": "absolute", "value": 4301160}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4405952}}, {"address": {"type": "absolute", "value": 4406073}}]}, {"address": {"type": "absolute", "value": 4301165}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4323856}}]}, {"address": {"type": "absolute", "value": 4301170}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4301175}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4301180}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4301190}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4470320}}]}, {"address": {"type": "absolute", "value": 4301195}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4391104}}]}, {"address": {"type": "absolute", "value": 4301200}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4460272}}, {"address": {"type": "absolute", "value": 4460360}}, {"address": {"type": "absolute", "value": 4460389}}, {"address": {"type": "absolute", "value": 4460412}}, {"address": {"type": "absolute", "value": 4460460}}, {"address": {"type": "absolute", "value": 4460528}}]}, {"address": {"type": "absolute", "value": 4301205}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4381680}}, {"address": {"type": "absolute", "value": 4381761}}, {"address": {"type": "absolute", "value": 4381788}}]}, {"address": {"type": "absolute", "value": 4301210}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4465728}}, {"address": {"type": "absolute", "value": 4465885}}, {"address": {"type": "absolute", "value": 4465915}}, {"address": {"type": "absolute", "value": 4465955}}, {"address": {"type": "absolute", "value": 4465985}}, {"address": {"type": "absolute", "value": 4466033}}, {"address": {"type": "absolute", "value": 4466106}}, {"address": {"type": "absolute", "value": 4466151}}]}, {"address": {"type": "absolute", "value": 4301215}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4384688}}]}, {"address": {"type": "absolute", "value": 4301220}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4365024}}, {"address": {"type": "absolute", "value": 4365097}}, {"address": {"type": "absolute", "value": 4365120}}, {"address": {"type": "absolute", "value": 4365150}}]}, {"address": {"type": "absolute", "value": 4301230}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4368947}}, {"address": {"type": "absolute", "value": 4368961}}]}, {"address": {"type": "absolute", "value": 4301240}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4386512}}, {"address": {"type": "absolute", "value": 4386719}}]}, {"address": {"type": "absolute", "value": 4301245}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4391888}}]}, {"address": {"type": "absolute", "value": 4301255}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4471120}}]}, {"address": {"type": "absolute", "value": 4301265}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4489136}}, {"address": {"type": "absolute", "value": 4489289}}, {"address": {"type": "absolute", "value": 4489406}}, {"address": {"type": "absolute", "value": 4489435}}]}, {"address": {"type": "absolute", "value": 4301270}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4347472}}, {"address": {"type": "absolute", "value": 4347546}}]}, {"address": {"type": "absolute", "value": 4301275}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4484400}}, {"address": {"type": "absolute", "value": 4484521}}, {"address": {"type": "absolute", "value": 4484560}}]}, {"address": {"type": "absolute", "value": 4301280}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4411616}}, {"address": {"type": "absolute", "value": 4411735}}, {"address": {"type": "absolute", "value": 4412204}}]}, {"address": {"type": "absolute", "value": 4301290}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4301295}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4301300}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4365648}}]}, {"address": {"type": "absolute", "value": 4301305}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4461216}}, {"address": {"type": "absolute", "value": 4461284}}]}, {"address": {"type": "absolute", "value": 4301310}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4365792}}]}, {"address": {"type": "absolute", "value": 4301315}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4387728}}]}, {"address": {"type": "absolute", "value": 4301320}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4334640}}]}, {"address": {"type": "absolute", "value": 4301330}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4301335}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4385408}}]}, {"address": {"type": "absolute", "value": 4301345}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4301350}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4301355}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4464976}}, {"address": {"type": "absolute", "value": 4465042}}, {"address": {"type": "absolute", "value": 4465079}}, {"address": {"type": "absolute", "value": 4465145}}, {"address": {"type": "absolute", "value": 4465202}}, {"address": {"type": "absolute", "value": 4465236}}, {"address": {"type": "absolute", "value": 4465270}}, {"address": {"type": "absolute", "value": 4465311}}, {"address": {"type": "absolute", "value": 4465355}}, {"address": {"type": "absolute", "value": 4465399}}, {"address": {"type": "absolute", "value": 4465433}}, {"address": {"type": "absolute", "value": 4465499}}]}, {"address": {"type": "absolute", "value": 4301370}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4483136}}, {"address": {"type": "absolute", "value": 4483285}}]}, {"address": {"type": "absolute", "value": 4301375}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4301380}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4468800}}, {"address": {"type": "absolute", "value": 4468963}}, {"address": {"type": "absolute", "value": 4469302}}]}, {"address": {"type": "absolute", "value": 4301385}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4344304}}]}, {"address": {"type": "absolute", "value": 4301390}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4365360}}]}, {"address": {"type": "absolute", "value": 4301395}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4475968}}, {"address": {"type": "absolute", "value": 4476043}}, {"address": {"type": "absolute", "value": 4476131}}]}, {"address": {"type": "absolute", "value": 4301405}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4357104}}]}, {"address": {"type": "absolute", "value": 4301410}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4470448}}, {"address": {"type": "absolute", "value": 4470521}}, {"address": {"type": "absolute", "value": 4470544}}, {"address": {"type": "absolute", "value": 4470574}}]}, {"address": {"type": "absolute", "value": 4301415}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4301420}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4332752}}, {"address": {"type": "absolute", "value": 4332821}}, {"address": {"type": "absolute", "value": 4332836}}, {"address": {"type": "absolute", "value": 4332872}}, {"address": {"type": "absolute", "value": 4332900}}]}, {"address": {"type": "absolute", "value": 4301425}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4366224}}]}, {"address": {"type": "absolute", "value": 4301435}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4469520}}]}, {"address": {"type": "absolute", "value": 4301440}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4327968}}, {"address": {"type": "absolute", "value": 4328049}}, {"address": {"type": "absolute", "value": 4328090}}, {"address": {"type": "absolute", "value": 4328192}}]}, {"address": {"type": "absolute", "value": 4301445}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4383152}}]}, {"address": {"type": "absolute", "value": 4301455}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4350336}}]}, {"address": {"type": "absolute", "value": 4301460}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4341008}}, {"address": {"type": "absolute", "value": 4341200}}, {"address": {"type": "absolute", "value": 4341226}}, {"address": {"type": "absolute", "value": 4341299}}, {"address": {"type": "absolute", "value": 4341339}}]}, {"address": {"type": "absolute", "value": 4301470}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4301475}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4301480}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4392320}}]}, {"address": {"type": "absolute", "value": 4301485}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4390944}}]}, {"address": {"type": "absolute", "value": 4301505}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4503584}}, {"address": {"type": "absolute", "value": 4503636}}, {"address": {"type": "absolute", "value": 4503669}}]}, {"address": {"type": "absolute", "value": 4301510}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4415136}}, {"address": {"type": "absolute", "value": 4415207}}]}, {"address": {"type": "absolute", "value": 4301515}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4430096}}, {"address": {"type": "absolute", "value": 4430192}}, {"address": {"type": "absolute", "value": 4430262}}, {"address": {"type": "absolute", "value": 4430290}}, {"address": {"type": "absolute", "value": 4430325}}, {"address": {"type": "absolute", "value": 4430347}}]}, {"address": {"type": "absolute", "value": 4301520}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4426944}}, {"address": {"type": "absolute", "value": 4427093}}, {"address": {"type": "absolute", "value": 4427461}}, {"address": {"type": "absolute", "value": 4427556}}, {"address": {"type": "absolute", "value": 4427637}}, {"address": {"type": "absolute", "value": 4427664}}, {"address": {"type": "absolute", "value": 4427884}}]}, {"address": {"type": "absolute", "value": 4301525}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4483680}}]}, {"address": {"type": "absolute", "value": 4301530}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4301535}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4360048}}]}, {"address": {"type": "absolute", "value": 4301545}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4428512}}, {"address": {"type": "absolute", "value": 4428840}}, {"address": {"type": "absolute", "value": 4428871}}, {"address": {"type": "absolute", "value": 4428997}}, {"address": {"type": "absolute", "value": 4429016}}, {"address": {"type": "absolute", "value": 4429069}}]}, {"address": {"type": "absolute", "value": 4301550}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4325376}}]}, {"address": {"type": "absolute", "value": 4301555}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4351792}}, {"address": {"type": "absolute", "value": 4351915}}, {"address": {"type": "absolute", "value": 4351994}}, {"address": {"type": "absolute", "value": 4352050}}, {"address": {"type": "absolute", "value": 4352064}}, {"address": {"type": "absolute", "value": 4352103}}, {"address": {"type": "absolute", "value": 4352146}}, {"address": {"type": "absolute", "value": 4352314}}, {"address": {"type": "absolute", "value": 4352341}}, {"address": {"type": "absolute", "value": 4352428}}, {"address": {"type": "absolute", "value": 4352450}}]}, {"address": {"type": "absolute", "value": 4301565}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4301570}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4332192}}, {"address": {"type": "absolute", "value": 4332556}}]}, {"address": {"type": "absolute", "value": 4301575}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4339200}}]}, {"address": {"type": "absolute", "value": 4301580}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4505984}}]}, {"address": {"type": "absolute", "value": 4301585}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4409840}}, {"address": {"type": "absolute", "value": 4409912}}]}, {"address": {"type": "absolute", "value": 4301590}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4346064}}]}, {"address": {"type": "absolute", "value": 4301595}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4466416}}]}, {"address": {"type": "absolute", "value": 4301600}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4463168}}, {"address": {"type": "absolute", "value": 4463284}}, {"address": {"type": "absolute", "value": 4463357}}, {"address": {"type": "absolute", "value": 4463458}}]}, {"address": {"type": "absolute", "value": 4301605}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4389168}}]}, {"address": {"type": "absolute", "value": 4301615}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4379152}}, {"address": {"type": "absolute", "value": 4379270}}]}, {"address": {"type": "absolute", "value": 4301620}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4301625}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4493425}}, {"address": {"type": "absolute", "value": 4493440}}, {"address": {"type": "absolute", "value": 4493576}}]}, {"address": {"type": "absolute", "value": 4301630}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4351632}}]}, {"address": {"type": "absolute", "value": 4301635}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4485040}}]}, {"address": {"type": "absolute", "value": 4301640}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4301650}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4351488}}]}, {"address": {"type": "absolute", "value": 4301655}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4350720}}]}, {"address": {"type": "absolute", "value": 4301665}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4363552}}]}, {"address": {"type": "absolute", "value": 4301675}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4301690}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4436256}}]}, {"address": {"type": "absolute", "value": 4301695}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4353232}}]}, {"address": {"type": "absolute", "value": 4301700}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4301710}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4385120}}]}, {"address": {"type": "absolute", "value": 4301715}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4301725}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4482512}}, {"address": {"type": "absolute", "value": 4482593}}, {"address": {"type": "absolute", "value": 4482620}}]}, {"address": {"type": "absolute", "value": 4301730}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4452864}}]}, {"address": {"type": "absolute", "value": 4301735}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4301740}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4403984}}, {"address": {"type": "absolute", "value": 4404055}}]}, {"address": {"type": "absolute", "value": 4301750}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4301755}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4470640}}, {"address": {"type": "absolute", "value": 4470713}}, {"address": {"type": "absolute", "value": 4470736}}, {"address": {"type": "absolute", "value": 4470766}}]}, {"address": {"type": "absolute", "value": 4301760}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4476992}}, {"address": {"type": "absolute", "value": 4477096}}, {"address": {"type": "absolute", "value": 4477149}}, {"address": {"type": "absolute", "value": 4477360}}]}, {"address": {"type": "absolute", "value": 4301765}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4363152}}]}, {"address": {"type": "absolute", "value": 4301770}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4500896}}]}, {"address": {"type": "absolute", "value": 4301780}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4301785}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4448400}}, {"address": {"type": "absolute", "value": 4448564}}, {"address": {"type": "absolute", "value": 4448592}}, {"address": {"type": "absolute", "value": 4448647}}, {"address": {"type": "absolute", "value": 4448667}}, {"address": {"type": "absolute", "value": 4448722}}, {"address": {"type": "absolute", "value": 4448742}}, {"address": {"type": "absolute", "value": 4448826}}, {"address": {"type": "absolute", "value": 4448846}}, {"address": {"type": "absolute", "value": 4448998}}, {"address": {"type": "absolute", "value": 4449016}}, {"address": {"type": "absolute", "value": 4449085}}, {"address": {"type": "absolute", "value": 4449103}}, {"address": {"type": "absolute", "value": 4449187}}, {"address": {"type": "absolute", "value": 4449271}}, {"address": {"type": "absolute", "value": 4449335}}, {"address": {"type": "absolute", "value": 4449489}}]}, {"address": {"type": "absolute", "value": 4301790}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4344560}}]}, {"address": {"type": "absolute", "value": 4301795}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4301800}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4301810}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4388240}}]}, {"address": {"type": "absolute", "value": 4301815}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4346384}}]}, {"address": {"type": "absolute", "value": 4301820}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4342080}}]}, {"address": {"type": "absolute", "value": 4301825}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4367360}}]}, {"address": {"type": "absolute", "value": 4301835}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4399152}}, {"address": {"type": "absolute", "value": 4399247}}, {"address": {"type": "absolute", "value": 4399284}}, {"address": {"type": "absolute", "value": 4399322}}, {"address": {"type": "absolute", "value": 4399385}}, {"address": {"type": "absolute", "value": 4399452}}, {"address": {"type": "absolute", "value": 4399467}}, {"address": {"type": "absolute", "value": 4399508}}, {"address": {"type": "absolute", "value": 4399631}}, {"address": {"type": "absolute", "value": 4399680}}, {"address": {"type": "absolute", "value": 4399810}}]}, {"address": {"type": "absolute", "value": 4301860}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4333602}}, {"address": {"type": "absolute", "value": 4333668}}]}, {"address": {"type": "absolute", "value": 4301865}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4345072}}]}, {"address": {"type": "absolute", "value": 4301870}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4319424}}, {"address": {"type": "absolute", "value": 4319504}}, {"address": {"type": "absolute", "value": 4319520}}]}, {"address": {"type": "absolute", "value": 4301875}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4358416}}]}, {"address": {"type": "absolute", "value": 4301880}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4394944}}]}, {"address": {"type": "absolute", "value": 4301885}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4353952}}]}, {"address": {"type": "absolute", "value": 4301895}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4452576}}]}, {"address": {"type": "absolute", "value": 4301900}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4339504}}]}, {"address": {"type": "absolute", "value": 4301905}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4411256}}, {"address": {"type": "absolute", "value": 4411278}}, {"address": {"type": "absolute", "value": 4411378}}, {"address": {"type": "absolute", "value": 4411397}}, {"address": {"type": "absolute", "value": 4411419}}]}, {"address": {"type": "absolute", "value": 4301910}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4415392}}, {"address": {"type": "absolute", "value": 4415463}}]}, {"address": {"type": "absolute", "value": 4301915}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4444272}}, {"address": {"type": "absolute", "value": 4444419}}, {"address": {"type": "absolute", "value": 4444470}}, {"address": {"type": "absolute", "value": 4444488}}, {"address": {"type": "absolute", "value": 4444542}}, {"address": {"type": "absolute", "value": 4444605}}, {"address": {"type": "absolute", "value": 4444623}}, {"address": {"type": "absolute", "value": 4444724}}, {"address": {"type": "absolute", "value": 4444827}}, {"address": {"type": "absolute", "value": 4444850}}, {"address": {"type": "absolute", "value": 4444950}}, {"address": {"type": "absolute", "value": 4445082}}, {"address": {"type": "absolute", "value": 4445146}}, {"address": {"type": "absolute", "value": 4445229}}, {"address": {"type": "absolute", "value": 4445262}}, {"address": {"type": "absolute", "value": 4445368}}, {"address": {"type": "absolute", "value": 4445726}}]}, {"address": {"type": "absolute", "value": 4301925}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4492560}}]}, {"address": {"type": "absolute", "value": 4301935}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4301940}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4423184}}, {"address": {"type": "absolute", "value": 4423291}}, {"address": {"type": "absolute", "value": 4423423}}, {"address": {"type": "absolute", "value": 4423467}}, {"address": {"type": "absolute", "value": 4423557}}, {"address": {"type": "absolute", "value": 4423574}}, {"address": {"type": "absolute", "value": 4423598}}]}, {"address": {"type": "absolute", "value": 4301950}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4324016}}]}, {"address": {"type": "absolute", "value": 4301955}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4301960}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4494608}}, {"address": {"type": "absolute", "value": 4494774}}, {"address": {"type": "absolute", "value": 4494826}}, {"address": {"type": "absolute", "value": 4494864}}, {"address": {"type": "absolute", "value": 4494903}}, {"address": {"type": "absolute", "value": 4494989}}]}, {"address": {"type": "absolute", "value": 4301965}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4301970}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4353808}}]}, {"address": {"type": "absolute", "value": 4301985}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4338000}}]}, {"address": {"type": "absolute", "value": 4301995}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4391440}}]}, {"address": {"type": "absolute", "value": 4302000}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4393840}}]}, {"address": {"type": "absolute", "value": 4302015}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4394112}}, {"address": {"type": "absolute", "value": 4394169}}, {"address": {"type": "absolute", "value": 4394198}}, {"address": {"type": "absolute", "value": 4394211}}]}, {"address": {"type": "absolute", "value": 4302020}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4437312}}, {"address": {"type": "absolute", "value": 4437394}}, {"address": {"type": "absolute", "value": 4437416}}, {"address": {"type": "absolute", "value": 4437534}}, {"address": {"type": "absolute", "value": 4437572}}, {"address": {"type": "absolute", "value": 4437594}}]}, {"address": {"type": "absolute", "value": 4302035}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4418816}}, {"address": {"type": "absolute", "value": 4418887}}]}, {"address": {"type": "absolute", "value": 4302040}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4382480}}, {"address": {"type": "absolute", "value": 4382629}}]}, {"address": {"type": "absolute", "value": 4302045}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4302050}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4302060}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4338432}}]}, {"address": {"type": "absolute", "value": 4302065}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4302070}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4496742}}]}, {"address": {"type": "absolute", "value": 4302075}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4326576}}]}, {"address": {"type": "absolute", "value": 4302080}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4302085}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4415792}}, {"address": {"type": "absolute", "value": 4415911}}, {"address": {"type": "absolute", "value": 4416218}}]}, {"address": {"type": "absolute", "value": 4302100}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4402352}}, {"address": {"type": "absolute", "value": 4402423}}]}, {"address": {"type": "absolute", "value": 4302105}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4431328}}, {"address": {"type": "absolute", "value": 4431497}}]}, {"address": {"type": "absolute", "value": 4302110}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4419312}}, {"address": {"type": "absolute", "value": 4419431}}, {"address": {"type": "absolute", "value": 4419534}}, {"address": {"type": "absolute", "value": 4419725}}]}, {"address": {"type": "absolute", "value": 4302115}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4456336}}]}, {"address": {"type": "absolute", "value": 4302120}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4371984}}]}, {"address": {"type": "absolute", "value": 4302125}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4382752}}, {"address": {"type": "absolute", "value": 4382906}}]}, {"address": {"type": "absolute", "value": 4302130}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4456976}}]}, {"address": {"type": "absolute", "value": 4302135}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4302140}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4384256}}]}, {"address": {"type": "absolute", "value": 4302150}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4345168}}]}, {"address": {"type": "absolute", "value": 4302155}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4345664}}]}, {"address": {"type": "absolute", "value": 4302160}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4357658}}, {"address": {"type": "absolute", "value": 4357682}}, {"address": {"type": "absolute", "value": 4357705}}]}, {"address": {"type": "absolute", "value": 4302165}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4334320}}, {"address": {"type": "absolute", "value": 4334384}}, {"address": {"type": "absolute", "value": 4334407}}, {"address": {"type": "absolute", "value": 4334452}}, {"address": {"type": "absolute", "value": 4334497}}]}, {"address": {"type": "absolute", "value": 4302170}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4477552}}, {"address": {"type": "absolute", "value": 4477620}}, {"address": {"type": "absolute", "value": 4477682}}, {"address": {"type": "absolute", "value": 4477717}}, {"address": {"type": "absolute", "value": 4477768}}, {"address": {"type": "absolute", "value": 4477894}}, {"address": {"type": "absolute", "value": 4478038}}, {"address": {"type": "absolute", "value": 4478129}}]}, {"address": {"type": "absolute", "value": 4302175}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4403856}}, {"address": {"type": "absolute", "value": 4403927}}]}, {"address": {"type": "absolute", "value": 4302180}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4455424}}]}, {"address": {"type": "absolute", "value": 4302190}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4453585}}, {"address": {"type": "absolute", "value": 4453660}}, {"address": {"type": "absolute", "value": 4453700}}]}, {"address": {"type": "absolute", "value": 4302200}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4471264}}]}, {"address": {"type": "absolute", "value": 4302205}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4512199}}]}, {"address": {"type": "absolute", "value": 4302210}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4302215}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4496208}}, {"address": {"type": "absolute", "value": 4496475}}]}, {"address": {"type": "absolute", "value": 4302225}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4488864}}]}, {"address": {"type": "absolute", "value": 4302230}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4384400}}]}, {"address": {"type": "absolute", "value": 4302235}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4344000}}, {"address": {"type": "absolute", "value": 4344207}}]}, {"address": {"type": "absolute", "value": 4302240}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4302245}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4394816}}]}, {"address": {"type": "absolute", "value": 4302250}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4363392}}]}, {"address": {"type": "absolute", "value": 4302255}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4389024}}]}, {"address": {"type": "absolute", "value": 4302260}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4348800}}, {"address": {"type": "absolute", "value": 4348879}}, {"address": {"type": "absolute", "value": 4348936}}, {"address": {"type": "absolute", "value": 4348945}}, {"address": {"type": "absolute", "value": 4348984}}, {"address": {"type": "absolute", "value": 4349020}}]}, {"address": {"type": "absolute", "value": 4302265}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4302270}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4425888}}]}, {"address": {"type": "absolute", "value": 4302275}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4400848}}, {"address": {"type": "absolute", "value": 4400905}}, {"address": {"type": "absolute", "value": 4400968}}]}, {"address": {"type": "absolute", "value": 4302280}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4492912}}]}, {"address": {"type": "absolute", "value": 4302285}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4495504}}, {"address": {"type": "absolute", "value": 4495725}}]}, {"address": {"type": "absolute", "value": 4302290}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4358672}}]}, {"address": {"type": "absolute", "value": 4302295}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4369059}}, {"address": {"type": "absolute", "value": 4369073}}]}, {"address": {"type": "absolute", "value": 4302300}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4491536}}, {"address": {"type": "absolute", "value": 4491634}}]}, {"address": {"type": "absolute", "value": 4302305}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4472528}}, {"address": {"type": "absolute", "value": 4472638}}, {"address": {"type": "absolute", "value": 4472673}}, {"address": {"type": "absolute", "value": 4472767}}, {"address": {"type": "absolute", "value": 4472782}}]}, {"address": {"type": "absolute", "value": 4302320}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4402704}}, {"address": {"type": "absolute", "value": 4402775}}]}, {"address": {"type": "absolute", "value": 4302325}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4452288}}]}, {"address": {"type": "absolute", "value": 4302335}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4364560}}]}, {"address": {"type": "absolute", "value": 4302340}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4388496}}]}, {"address": {"type": "absolute", "value": 4302345}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4506592}}]}, {"address": {"type": "absolute", "value": 4302350}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4467216}}]}, {"address": {"type": "absolute", "value": 4302355}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4357802}}, {"address": {"type": "absolute", "value": 4357835}}, {"address": {"type": "absolute", "value": 4357851}}, {"address": {"type": "absolute", "value": 4357901}}]}, {"address": {"type": "absolute", "value": 4302360}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4396672}}]}, {"address": {"type": "absolute", "value": 4302365}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4355984}}]}, {"address": {"type": "absolute", "value": 4302370}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4356800}}]}, {"address": {"type": "absolute", "value": 4302375}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4502106}}, {"address": {"type": "absolute", "value": 4502130}}, {"address": {"type": "absolute", "value": 4502156}}]}, {"address": {"type": "absolute", "value": 4302380}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4333440}}]}, {"address": {"type": "absolute", "value": 4302395}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4372080}}]}, {"address": {"type": "absolute", "value": 4302400}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4302405}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4302410}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4364832}}, {"address": {"type": "absolute", "value": 4364905}}, {"address": {"type": "absolute", "value": 4364928}}, {"address": {"type": "absolute", "value": 4364958}}]}, {"address": {"type": "absolute", "value": 4302415}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4302420}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4453825}}, {"address": {"type": "absolute", "value": 4453844}}, {"address": {"type": "absolute", "value": 4454055}}]}, {"address": {"type": "absolute", "value": 4302425}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4326500}}, {"address": {"type": "absolute", "value": 4326526}}]}, {"address": {"type": "absolute", "value": 4302430}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4499793}}]}, {"address": {"type": "absolute", "value": 4302435}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4363904}}]}, {"address": {"type": "absolute", "value": 4302440}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4363472}}]}, {"address": {"type": "absolute", "value": 4302445}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4338576}}]}, {"address": {"type": "absolute", "value": 4302450}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4454209}}, {"address": {"type": "absolute", "value": 4454261}}, {"address": {"type": "absolute", "value": 4454301}}]}, {"address": {"type": "absolute", "value": 4302460}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4389312}}]}, {"address": {"type": "absolute", "value": 4302465}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4442000}}, {"address": {"type": "absolute", "value": 4442069}}, {"address": {"type": "absolute", "value": 4442125}}]}, {"address": {"type": "absolute", "value": 4302470}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4386816}}, {"address": {"type": "absolute", "value": 4387023}}]}, {"address": {"type": "absolute", "value": 4302475}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4459424}}, {"address": {"type": "absolute", "value": 4459650}}]}, {"address": {"type": "absolute", "value": 4302480}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4431680}}, {"address": {"type": "absolute", "value": 4431799}}, {"address": {"type": "absolute", "value": 4432007}}, {"address": {"type": "absolute", "value": 4432028}}, {"address": {"type": "absolute", "value": 4432045}}, {"address": {"type": "absolute", "value": 4432066}}, {"address": {"type": "absolute", "value": 4432083}}, {"address": {"type": "absolute", "value": 4432104}}, {"address": {"type": "absolute", "value": 4432121}}, {"address": {"type": "absolute", "value": 4432142}}, {"address": {"type": "absolute", "value": 4432304}}]}, {"address": {"type": "absolute", "value": 4302495}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4439168}}, {"address": {"type": "absolute", "value": 4439264}}, {"address": {"type": "absolute", "value": 4439361}}, {"address": {"type": "absolute", "value": 4439378}}, {"address": {"type": "absolute", "value": 4439421}}, {"address": {"type": "absolute", "value": 4439470}}, {"address": {"type": "absolute", "value": 4439497}}, {"address": {"type": "absolute", "value": 4439522}}]}, {"address": {"type": "absolute", "value": 4302510}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4366368}}]}, {"address": {"type": "absolute", "value": 4302525}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4485296}}]}, {"address": {"type": "absolute", "value": 4302530}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4485168}}]}, {"address": {"type": "absolute", "value": 4302535}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4436843}}, {"address": {"type": "absolute", "value": 4436865}}, {"address": {"type": "absolute", "value": 4436958}}, {"address": {"type": "absolute", "value": 4436977}}, {"address": {"type": "absolute", "value": 4436999}}]}, {"address": {"type": "absolute", "value": 4302550}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4302555}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4302560}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4359104}}]}, {"address": {"type": "absolute", "value": 4302565}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4346608}}, {"address": {"type": "absolute", "value": 4346748}}]}, {"address": {"type": "absolute", "value": 4302570}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4367568}}]}, {"address": {"type": "absolute", "value": 4302585}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4347856}}]}, {"address": {"type": "absolute", "value": 4302590}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4302595}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4352928}}, {"address": {"type": "absolute", "value": 4353024}}, {"address": {"type": "absolute", "value": 4353044}}, {"address": {"type": "absolute", "value": 4353079}}]}, {"address": {"type": "absolute", "value": 4302600}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4302605}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4302610}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4481104}}, {"address": {"type": "absolute", "value": 4481214}}]}, {"address": {"type": "absolute", "value": 4302615}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4335664}}, {"address": {"type": "absolute", "value": 4335827}}, {"address": {"type": "absolute", "value": 4336166}}]}, {"address": {"type": "absolute", "value": 4302620}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4462496}}]}, {"address": {"type": "absolute", "value": 4302635}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4435144}}, {"address": {"type": "absolute", "value": 4435166}}, {"address": {"type": "absolute", "value": 4435341}}, {"address": {"type": "absolute", "value": 4435360}}, {"address": {"type": "absolute", "value": 4435382}}]}, {"address": {"type": "absolute", "value": 4302640}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4346272}}]}, {"address": {"type": "absolute", "value": 4302645}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4350192}}]}, {"address": {"type": "absolute", "value": 4302655}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4478944}}, {"address": {"type": "absolute", "value": 4479099}}]}, {"address": {"type": "absolute", "value": 4302665}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4487024}}]}, {"address": {"type": "absolute", "value": 4302670}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4349200}}]}, {"address": {"type": "absolute", "value": 4302675}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4509392}}]}, {"address": {"type": "absolute", "value": 4302685}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4433488}}, {"address": {"type": "absolute", "value": 4433607}}, {"address": {"type": "absolute", "value": 4433783}}, {"address": {"type": "absolute", "value": 4433895}}, {"address": {"type": "absolute", "value": 4434007}}, {"address": {"type": "absolute", "value": 4434174}}]}, {"address": {"type": "absolute", "value": 4302690}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4389456}}]}, {"address": {"type": "absolute", "value": 4302695}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4302700}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4329360}}, {"address": {"type": "absolute", "value": 4329614}}]}, {"address": {"type": "absolute", "value": 4302705}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4413120}}, {"address": {"type": "absolute", "value": 4413239}}, {"address": {"type": "absolute", "value": 4413680}}]}, {"address": {"type": "absolute", "value": 4302710}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4462128}}]}, {"address": {"type": "absolute", "value": 4302715}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4420210}}, {"address": {"type": "absolute", "value": 4420232}}, {"address": {"type": "absolute", "value": 4420320}}, {"address": {"type": "absolute", "value": 4420339}}, {"address": {"type": "absolute", "value": 4420361}}]}, {"address": {"type": "absolute", "value": 4302725}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4302730}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4302740}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4457584}}, {"address": {"type": "absolute", "value": 4457747}}]}, {"address": {"type": "absolute", "value": 4302745}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4403728}}, {"address": {"type": "absolute", "value": 4403799}}]}, {"address": {"type": "absolute", "value": 4302750}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4385872}}, {"address": {"type": "absolute", "value": 4385993}}, {"address": {"type": "absolute", "value": 4386032}}]}, {"address": {"type": "absolute", "value": 4302755}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4302765}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4302770}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4466880}}]}, {"address": {"type": "absolute", "value": 4302775}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4460736}}]}, {"address": {"type": "absolute", "value": 4302780}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4384544}}]}, {"address": {"type": "absolute", "value": 4302785}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4332976}}, {"address": {"type": "absolute", "value": 4333263}}]}, {"address": {"type": "absolute", "value": 4302790}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4368835}}, {"address": {"type": "absolute", "value": 4368849}}]}, {"address": {"type": "absolute", "value": 4302795}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4368176}}]}, {"address": {"type": "absolute", "value": 4302800}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4302810}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4385552}}, {"address": {"type": "absolute", "value": 4385673}}, {"address": {"type": "absolute", "value": 4385712}}]}, {"address": {"type": "absolute", "value": 4302815}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4483824}}]}, {"address": {"type": "absolute", "value": 4302825}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4302830}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4488144}}, {"address": {"type": "absolute", "value": 4488255}}, {"address": {"type": "absolute", "value": 4488395}}, {"address": {"type": "absolute", "value": 4488459}}, {"address": {"type": "absolute", "value": 4488516}}, {"address": {"type": "absolute", "value": 4488602}}]}, {"address": {"type": "absolute", "value": 4302835}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4505408}}]}, {"address": {"type": "absolute", "value": 4302840}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4383680}}]}, {"address": {"type": "absolute", "value": 4302845}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4484112}}]}, {"address": {"type": "absolute", "value": 4302860}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4457152}}]}, {"address": {"type": "absolute", "value": 4302865}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4346880}}, {"address": {"type": "absolute", "value": 4346949}}]}, {"address": {"type": "absolute", "value": 4302870}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4345552}}]}, {"address": {"type": "absolute", "value": 4302875}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4402480}}, {"address": {"type": "absolute", "value": 4402636}}]}, {"address": {"type": "absolute", "value": 4302880}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4383536}}]}, {"address": {"type": "absolute", "value": 4302885}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4506263}}]}, {"address": {"type": "absolute", "value": 4302890}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4390416}}]}, {"address": {"type": "absolute", "value": 4302895}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4410992}}, {"address": {"type": "absolute", "value": 4411060}}]}, {"address": {"type": "absolute", "value": 4302900}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4355024}}]}, {"address": {"type": "absolute", "value": 4302910}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4389888}}]}, {"address": {"type": "absolute", "value": 4302915}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4327280}}, {"address": {"type": "absolute", "value": 4327478}}, {"address": {"type": "absolute", "value": 4327714}}]}, {"address": {"type": "absolute", "value": 4302920}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4379344}}, {"address": {"type": "absolute", "value": 4379465}}, {"address": {"type": "absolute", "value": 4379486}}]}, {"address": {"type": "absolute", "value": 4302925}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4382208}}, {"address": {"type": "absolute", "value": 4382357}}]}, {"address": {"type": "absolute", "value": 4302930}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4319600}}]}, {"address": {"type": "absolute", "value": 4302935}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4486608}}, {"address": {"type": "absolute", "value": 4486823}}, {"address": {"type": "absolute", "value": 4486854}}]}, {"address": {"type": "absolute", "value": 4302940}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4332096}}]}, {"address": {"type": "absolute", "value": 4302950}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4436434}}, {"address": {"type": "absolute", "value": 4436456}}, {"address": {"type": "absolute", "value": 4436544}}, {"address": {"type": "absolute", "value": 4436563}}, {"address": {"type": "absolute", "value": 4436585}}]}, {"address": {"type": "absolute", "value": 4302955}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4391776}}]}, {"address": {"type": "absolute", "value": 4302960}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4412992}}, {"address": {"type": "absolute", "value": 4413063}}]}, {"address": {"type": "absolute", "value": 4302965}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4496112}}, {"address": {"type": "absolute", "value": 4496130}}, {"address": {"type": "absolute", "value": 4496151}}]}, {"address": {"type": "absolute", "value": 4302970}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4416960}}, {"address": {"type": "absolute", "value": 4417079}}, {"address": {"type": "absolute", "value": 4417282}}, {"address": {"type": "absolute", "value": 4417579}}]}, {"address": {"type": "absolute", "value": 4302975}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4441659}}, {"address": {"type": "absolute", "value": 4441681}}, {"address": {"type": "absolute", "value": 4441774}}, {"address": {"type": "absolute", "value": 4441793}}, {"address": {"type": "absolute", "value": 4441815}}]}, {"address": {"type": "absolute", "value": 4302980}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4484256}}]}, {"address": {"type": "absolute", "value": 4302995}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4443120}}, {"address": {"type": "absolute", "value": 4443245}}, {"address": {"type": "absolute", "value": 4443309}}, {"address": {"type": "absolute", "value": 4443344}}, {"address": {"type": "absolute", "value": 4443396}}, {"address": {"type": "absolute", "value": 4443419}}, {"address": {"type": "absolute", "value": 4443465}}, {"address": {"type": "absolute", "value": 4443488}}, {"address": {"type": "absolute", "value": 4443648}}, {"address": {"type": "absolute", "value": 4443671}}, {"address": {"type": "absolute", "value": 4443731}}, {"address": {"type": "absolute", "value": 4443748}}, {"address": {"type": "absolute", "value": 4443792}}, {"address": {"type": "absolute", "value": 4443807}}, {"address": {"type": "absolute", "value": 4443937}}]}, {"address": {"type": "absolute", "value": 4303000}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4468080}}, {"address": {"type": "absolute", "value": 4468243}}, {"address": {"type": "absolute", "value": 4468582}}]}, {"address": {"type": "absolute", "value": 4303015}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4336560}}, {"address": {"type": "absolute", "value": 4336663}}]}, {"address": {"type": "absolute", "value": 4303020}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4381856}}, {"address": {"type": "absolute", "value": 4381937}}, {"address": {"type": "absolute", "value": 4381964}}]}, {"address": {"type": "absolute", "value": 4303025}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4398480}}, {"address": {"type": "absolute", "value": 4398575}}, {"address": {"type": "absolute", "value": 4398612}}, {"address": {"type": "absolute", "value": 4398650}}, {"address": {"type": "absolute", "value": 4398713}}, {"address": {"type": "absolute", "value": 4398780}}, {"address": {"type": "absolute", "value": 4398910}}]}, {"address": {"type": "absolute", "value": 4303030}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4460640}}]}, {"address": {"type": "absolute", "value": 4303035}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4498528}}]}, {"address": {"type": "absolute", "value": 4303040}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4491856}}]}, {"address": {"type": "absolute", "value": 4303050}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4338144}}]}, {"address": {"type": "absolute", "value": 4303055}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4412576}}, {"address": {"type": "absolute", "value": 4412722}}]}, {"address": {"type": "absolute", "value": 4303060}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4415264}}, {"address": {"type": "absolute", "value": 4415335}}]}, {"address": {"type": "absolute", "value": 4303065}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4353664}}]}, {"address": {"type": "absolute", "value": 4303075}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4367152}}]}, {"address": {"type": "absolute", "value": 4303080}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4303085}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4303090}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4303095}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4503984}}, {"address": {"type": "absolute", "value": 4504028}}, {"address": {"type": "absolute", "value": 4504047}}, {"address": {"type": "absolute", "value": 4504125}}]}, {"address": {"type": "absolute", "value": 4303100}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4338928}}]}, {"address": {"type": "absolute", "value": 4303105}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4362896}}, {"address": {"type": "absolute", "value": 4362997}}]}, {"address": {"type": "absolute", "value": 4303110}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4342896}}]}, {"address": {"type": "absolute", "value": 4303115}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4470016}}]}, {"address": {"type": "absolute", "value": 4303130}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4429408}}, {"address": {"type": "absolute", "value": 4429504}}, {"address": {"type": "absolute", "value": 4429601}}, {"address": {"type": "absolute", "value": 4429622}}, {"address": {"type": "absolute", "value": 4429669}}, {"address": {"type": "absolute", "value": 4429748}}, {"address": {"type": "absolute", "value": 4429779}}, {"address": {"type": "absolute", "value": 4429820}}, {"address": {"type": "absolute", "value": 4429847}}, {"address": {"type": "absolute", "value": 4429872}}]}, {"address": {"type": "absolute", "value": 4303140}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4303145}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4303155}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4339024}}]}, {"address": {"type": "absolute", "value": 4303160}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4347051}}, {"address": {"type": "absolute", "value": 4347076}}, {"address": {"type": "absolute", "value": 4347099}}]}, {"address": {"type": "absolute", "value": 4303165}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4467856}}]}, {"address": {"type": "absolute", "value": 4303170}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4506391}}]}, {"address": {"type": "absolute", "value": 4303175}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4370864}}, {"address": {"type": "absolute", "value": 4370959}}]}, {"address": {"type": "absolute", "value": 4303180}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4349696}}]}, {"address": {"type": "absolute", "value": 4303190}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4303195}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4354512}}]}, {"address": {"type": "absolute", "value": 4303200}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4319696}}]}, {"address": {"type": "absolute", "value": 4303205}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4354224}}, {"address": {"type": "absolute", "value": 4354293}}, {"address": {"type": "absolute", "value": 4354311}}]}, {"address": {"type": "absolute", "value": 4303210}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4416544}}, {"address": {"type": "absolute", "value": 4416739}}]}, {"address": {"type": "absolute", "value": 4303220}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4392528}}]}, {"address": {"type": "absolute", "value": 4303225}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4337088}}]}, {"address": {"type": "absolute", "value": 4303230}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4365936}}]}, {"address": {"type": "absolute", "value": 4303235}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4492000}}]}, {"address": {"type": "absolute", "value": 4303245}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4303265}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4345392}}]}, {"address": {"type": "absolute", "value": 4303270}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4378352}}, {"address": {"type": "absolute", "value": 4378438}}, {"address": {"type": "absolute", "value": 4378472}}, {"address": {"type": "absolute", "value": 4378524}}, {"address": {"type": "absolute", "value": 4378558}}, {"address": {"type": "absolute", "value": 4378578}}, {"address": {"type": "absolute", "value": 4378616}}, {"address": {"type": "absolute", "value": 4378694}}]}, {"address": {"type": "absolute", "value": 4303275}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4365504}}]}, {"address": {"type": "absolute", "value": 4303280}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4469600}}]}, {"address": {"type": "absolute", "value": 4303285}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4303290}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4471696}}]}, {"address": {"type": "absolute", "value": 4303295}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4486416}}, {"address": {"type": "absolute", "value": 4486532}}]}, {"address": {"type": "absolute", "value": 4303305}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4439712}}, {"address": {"type": "absolute", "value": 4439811}}, {"address": {"type": "absolute", "value": 4439860}}, {"address": {"type": "absolute", "value": 4439882}}]}, {"address": {"type": "absolute", "value": 4303310}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4363312}}]}, {"address": {"type": "absolute", "value": 4303320}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4395109}}, {"address": {"type": "absolute", "value": 4395126}}, {"address": {"type": "absolute", "value": 4395154}}]}, {"address": {"type": "absolute", "value": 4303325}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4455520}}]}, {"address": {"type": "absolute", "value": 4303330}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4500112}}, {"address": {"type": "absolute", "value": 4500221}}]}, {"address": {"type": "absolute", "value": 4303335}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4464336}}]}, {"address": {"type": "absolute", "value": 4303340}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4478688}}, {"address": {"type": "absolute", "value": 4478762}}, {"address": {"type": "absolute", "value": 4478807}}]}, {"address": {"type": "absolute", "value": 4303350}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4303355}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4392944}}, {"address": {"type": "absolute", "value": 4393019}}, {"address": {"type": "absolute", "value": 4393067}}, {"address": {"type": "absolute", "value": 4393115}}]}, {"address": {"type": "absolute", "value": 4303365}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4466768}}]}, {"address": {"type": "absolute", "value": 4303375}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4303380}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4466992}}]}, {"address": {"type": "absolute", "value": 4303385}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4355728}}, {"address": {"type": "absolute", "value": 4355795}}, {"address": {"type": "absolute", "value": 4355906}}]}, {"address": {"type": "absolute", "value": 4303400}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4471408}}]}, {"address": {"type": "absolute", "value": 4303410}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4508112}}, {"address": {"type": "absolute", "value": 4508157}}]}, {"address": {"type": "absolute", "value": 4303415}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4326128}}, {"address": {"type": "absolute", "value": 4326217}}, {"address": {"type": "absolute", "value": 4326351}}]}, {"address": {"type": "absolute", "value": 4303420}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4502041}}]}, {"address": {"type": "absolute", "value": 4303425}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4350816}}]}, {"address": {"type": "absolute", "value": 4303430}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4425984}}, {"address": {"type": "absolute", "value": 4426087}}, {"address": {"type": "absolute", "value": 4426109}}, {"address": {"type": "absolute", "value": 4426227}}, {"address": {"type": "absolute", "value": 4426265}}, {"address": {"type": "absolute", "value": 4426287}}]}, {"address": {"type": "absolute", "value": 4303450}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4469840}}]}, {"address": {"type": "absolute", "value": 4303455}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4360496}}]}, {"address": {"type": "absolute", "value": 4303460}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4460912}}, {"address": {"type": "absolute", "value": 4460960}}, {"address": {"type": "absolute", "value": 4461024}}, {"address": {"type": "absolute", "value": 4461072}}, {"address": {"type": "absolute", "value": 4461120}}]}, {"address": {"type": "absolute", "value": 4303465}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4303470}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4454424}}, {"address": {"type": "absolute", "value": 4454473}}, {"address": {"type": "absolute", "value": 4454529}}, {"address": {"type": "absolute", "value": 4454542}}]}, {"address": {"type": "absolute", "value": 4303475}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4354368}}, {"address": {"type": "absolute", "value": 4354437}}, {"address": {"type": "absolute", "value": 4354455}}]}, {"address": {"type": "absolute", "value": 4303480}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4455664}}]}, {"address": {"type": "absolute", "value": 4303485}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4334976}}]}, {"address": {"type": "absolute", "value": 4303490}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4493744}}, {"address": {"type": "absolute", "value": 4493940}}, {"address": {"type": "absolute", "value": 4494023}}]}, {"address": {"type": "absolute", "value": 4303495}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4495216}}, {"address": {"type": "absolute", "value": 4495325}}, {"address": {"type": "absolute", "value": 4495358}}]}, {"address": {"type": "absolute", "value": 4303505}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4372176}}, {"address": {"type": "absolute", "value": 4372261}}, {"address": {"type": "absolute", "value": 4372285}}, {"address": {"type": "absolute", "value": 4372302}}, {"address": {"type": "absolute", "value": 4372317}}, {"address": {"type": "absolute", "value": 4372330}}, {"address": {"type": "absolute", "value": 4372432}}, {"address": {"type": "absolute", "value": 4372570}}, {"address": {"type": "absolute", "value": 4372661}}, {"address": {"type": "absolute", "value": 4372700}}, {"address": {"type": "absolute", "value": 4372720}}, {"address": {"type": "absolute", "value": 4372741}}, {"address": {"type": "absolute", "value": 4372799}}]}, {"address": {"type": "absolute", "value": 4303510}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4407312}}, {"address": {"type": "absolute", "value": 4407445}}, {"address": {"type": "absolute", "value": 4407626}}, {"address": {"type": "absolute", "value": 4407894}}]}, {"address": {"type": "absolute", "value": 4303520}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4355344}}]}, {"address": {"type": "absolute", "value": 4303525}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4471904}}]}, {"address": {"type": "absolute", "value": 4303530}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4388880}}]}, {"address": {"type": "absolute", "value": 4303535}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4392736}}]}, {"address": {"type": "absolute", "value": 4303540}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4394740}}]}, {"address": {"type": "absolute", "value": 4303550}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4303555}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4435731}}, {"address": {"type": "absolute", "value": 4435753}}, {"address": {"type": "absolute", "value": 4435846}}, {"address": {"type": "absolute", "value": 4435865}}, {"address": {"type": "absolute", "value": 4435887}}]}, {"address": {"type": "absolute", "value": 4303575}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4490480}}]}, {"address": {"type": "absolute", "value": 4303580}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4343184}}]}, {"address": {"type": "absolute", "value": 4303585}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4452768}}]}, {"address": {"type": "absolute", "value": 4303595}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4342176}}, {"address": {"type": "absolute", "value": 4342257}}, {"address": {"type": "absolute", "value": 4342284}}]}, {"address": {"type": "absolute", "value": 4303605}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4303615}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4388752}}]}, {"address": {"type": "absolute", "value": 4303620}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4347355}}, {"address": {"type": "absolute", "value": 4347380}}, {"address": {"type": "absolute", "value": 4347403}}]}, {"address": {"type": "absolute", "value": 4303625}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4303630}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4303635}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4384976}}]}, {"address": {"type": "absolute", "value": 4303640}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4335312}}]}, {"address": {"type": "absolute", "value": 4303645}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4437184}}, {"address": {"type": "absolute", "value": 4437258}}]}, {"address": {"type": "absolute", "value": 4303650}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4303655}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4388368}}]}, {"address": {"type": "absolute", "value": 4303660}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4364080}}]}, {"address": {"type": "absolute", "value": 4303665}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4483536}}]}, {"address": {"type": "absolute", "value": 4303675}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4456672}}]}, {"address": {"type": "absolute", "value": 4303680}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4336736}}]}, {"address": {"type": "absolute", "value": 4303690}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4349840}}]}, {"address": {"type": "absolute", "value": 4303700}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4378880}}, {"address": {"type": "absolute", "value": 4379005}}]}, {"address": {"type": "absolute", "value": 4303710}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4494208}}, {"address": {"type": "absolute", "value": 4494371}}, {"address": {"type": "absolute", "value": 4494444}}]}, {"address": {"type": "absolute", "value": 4303715}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4303720}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4412864}}, {"address": {"type": "absolute", "value": 4412935}}]}, {"address": {"type": "absolute", "value": 4303725}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4452176}}]}, {"address": {"type": "absolute", "value": 4303735}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4330784}}, {"address": {"type": "absolute", "value": 4331085}}]}, {"address": {"type": "absolute", "value": 4303745}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4404624}}, {"address": {"type": "absolute", "value": 4404750}}, {"address": {"type": "absolute", "value": 4404856}}, {"address": {"type": "absolute", "value": 4404987}}]}, {"address": {"type": "absolute", "value": 4303755}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4469760}}]}, {"address": {"type": "absolute", "value": 4303765}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4343040}}]}, {"address": {"type": "absolute", "value": 4303770}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4350896}}, {"address": {"type": "absolute", "value": 4350980}}, {"address": {"type": "absolute", "value": 4351001}}]}, {"address": {"type": "absolute", "value": 4303775}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4415520}}, {"address": {"type": "absolute", "value": 4415594}}, {"address": {"type": "absolute", "value": 4415657}}]}, {"address": {"type": "absolute", "value": 4303780}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4397280}}, {"address": {"type": "absolute", "value": 4397382}}, {"address": {"type": "absolute", "value": 4397419}}, {"address": {"type": "absolute", "value": 4397457}}, {"address": {"type": "absolute", "value": 4397547}}, {"address": {"type": "absolute", "value": 4397607}}, {"address": {"type": "absolute", "value": 4397662}}, {"address": {"type": "absolute", "value": 4397723}}, {"address": {"type": "absolute", "value": 4397787}}, {"address": {"type": "absolute", "value": 4397839}}, {"address": {"type": "absolute", "value": 4397866}}, {"address": {"type": "absolute", "value": 4397902}}, {"address": {"type": "absolute", "value": 4397935}}, {"address": {"type": "absolute", "value": 4397984}}, {"address": {"type": "absolute", "value": 4398061}}, {"address": {"type": "absolute", "value": 4398129}}]}, {"address": {"type": "absolute", "value": 4303790}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4470976}}]}, {"address": {"type": "absolute", "value": 4303795}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4382032}}, {"address": {"type": "absolute", "value": 4382113}}, {"address": {"type": "absolute", "value": 4382140}}]}, {"address": {"type": "absolute", "value": 4303800}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4453344}}]}, {"address": {"type": "absolute", "value": 4303805}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4345280}}]}, {"address": {"type": "absolute", "value": 4303815}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4338720}}]}, {"address": {"type": "absolute", "value": 4303820}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4358528}}]}, {"address": {"type": "absolute", "value": 4303825}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4331328}}, {"address": {"type": "absolute", "value": 4331454}}]}, {"address": {"type": "absolute", "value": 4303830}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4500928}}]}, {"address": {"type": "absolute", "value": 4303835}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4319840}}]}, {"address": {"type": "absolute", "value": 4303840}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4355456}}]}, {"address": {"type": "absolute", "value": 4303845}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4498832}}]}, {"address": {"type": "absolute", "value": 4303855}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4303860}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4359248}}]}, {"address": {"type": "absolute", "value": 4303865}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4487296}}]}, {"address": {"type": "absolute", "value": 4303870}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4303875}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4496693}}]}, {"address": {"type": "absolute", "value": 4303880}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4422432}}, {"address": {"type": "absolute", "value": 4422617}}, {"address": {"type": "absolute", "value": 4422677}}, {"address": {"type": "absolute", "value": 4422715}}, {"address": {"type": "absolute", "value": 4422793}}, {"address": {"type": "absolute", "value": 4422848}}, {"address": {"type": "absolute", "value": 4422882}}, {"address": {"type": "absolute", "value": 4422900}}]}, {"address": {"type": "absolute", "value": 4303890}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4490832}}]}, {"address": {"type": "absolute", "value": 4303895}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4389744}}]}, {"address": {"type": "absolute", "value": 4303905}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4500832}}]}, {"address": {"type": "absolute", "value": 4303910}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4368480}}]}, {"address": {"type": "absolute", "value": 4303915}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4456784}}]}, {"address": {"type": "absolute", "value": 4303920}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4343328}}, {"address": {"type": "absolute", "value": 4343415}}, {"address": {"type": "absolute", "value": 4343512}}]}, {"address": {"type": "absolute", "value": 4303925}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4395711}}, {"address": {"type": "absolute", "value": 4395785}}, {"address": {"type": "absolute", "value": 4396000}}]}, {"address": {"type": "absolute", "value": 4303930}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4324896}}, {"address": {"type": "absolute", "value": 4325016}}]}, {"address": {"type": "absolute", "value": 4303935}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4363232}}]}, {"address": {"type": "absolute", "value": 4303940}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4303945}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4303950}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4341616}}, {"address": {"type": "absolute", "value": 4341716}}, {"address": {"type": "absolute", "value": 4341768}}, {"address": {"type": "absolute", "value": 4341852}}, {"address": {"type": "absolute", "value": 4341904}}, {"address": {"type": "absolute", "value": 4341956}}]}, {"address": {"type": "absolute", "value": 4303955}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4369171}}, {"address": {"type": "absolute", "value": 4369185}}]}, {"address": {"type": "absolute", "value": 4303960}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4387856}}]}, {"address": {"type": "absolute", "value": 4303965}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4385264}}]}, {"address": {"type": "absolute", "value": 4303970}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4353520}}]}, {"address": {"type": "absolute", "value": 4303985}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4347712}}]}, {"address": {"type": "absolute", "value": 4303990}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4362160}}, {"address": {"type": "absolute", "value": 4362335}}, {"address": {"type": "absolute", "value": 4362672}}]}, {"address": {"type": "absolute", "value": 4304000}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4452480}}]}, {"address": {"type": "absolute", "value": 4304015}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4304020}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4455280}}]}, {"address": {"type": "absolute", "value": 4304025}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4304030}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4500624}}, {"address": {"type": "absolute", "value": 4500644}}, {"address": {"type": "absolute", "value": 4500682}}]}, {"address": {"type": "absolute", "value": 4304040}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4304045}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4393728}}]}, {"address": {"type": "absolute", "value": 4304060}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4359920}}]}, {"address": {"type": "absolute", "value": 4304065}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4304070}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4498240}}, {"address": {"type": "absolute", "value": 4498261}}, {"address": {"type": "absolute", "value": 4498290}}, {"address": {"type": "absolute", "value": 4498308}}, {"address": {"type": "absolute", "value": 4498324}}]}, {"address": {"type": "absolute", "value": 4304075}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4366656}}]}, {"address": {"type": "absolute", "value": 4304080}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4390128}}]}, {"address": {"type": "absolute", "value": 4304085}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4420032}}]}, {"address": {"type": "absolute", "value": 4304090}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4420544}}, {"address": {"type": "absolute", "value": 4420637}}, {"address": {"type": "absolute", "value": 4420734}}, {"address": {"type": "absolute", "value": 4420755}}, {"address": {"type": "absolute", "value": 4420798}}, {"address": {"type": "absolute", "value": 4420847}}, {"address": {"type": "absolute", "value": 4420882}}, {"address": {"type": "absolute", "value": 4420909}}, {"address": {"type": "absolute", "value": 4420934}}]}, {"address": {"type": "absolute", "value": 4304095}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4440156}}, {"address": {"type": "absolute", "value": 4440178}}, {"address": {"type": "absolute", "value": 4440288}}, {"address": {"type": "absolute", "value": 4440307}}, {"address": {"type": "absolute", "value": 4440329}}]}, {"address": {"type": "absolute", "value": 4304100}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4384832}}]}, {"address": {"type": "absolute", "value": 4304105}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4408405}}, {"address": {"type": "absolute", "value": 4408516}}, {"address": {"type": "absolute", "value": 4408813}}, {"address": {"type": "absolute", "value": 4408848}}, {"address": {"type": "absolute", "value": 4408909}}, {"address": {"type": "absolute", "value": 4408955}}, {"address": {"type": "absolute", "value": 4409004}}, {"address": {"type": "absolute", "value": 4409132}}, {"address": {"type": "absolute", "value": 4409176}}, {"address": {"type": "absolute", "value": 4409288}}]}, {"address": {"type": "absolute", "value": 4304110}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4329792}}, {"address": {"type": "absolute", "value": 4329942}}]}, {"address": {"type": "absolute", "value": 4304115}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4356144}}]}, {"address": {"type": "absolute", "value": 4304120}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4455184}}]}, {"address": {"type": "absolute", "value": 4304125}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4456448}}]}, {"address": {"type": "absolute", "value": 4304130}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4387120}}, {"address": {"type": "absolute", "value": 4387327}}]}, {"address": {"type": "absolute", "value": 4304135}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4442608}}]}, {"address": {"type": "absolute", "value": 4304140}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4334176}}, {"address": {"type": "absolute", "value": 4334225}}, {"address": {"type": "absolute", "value": 4334245}}, {"address": {"type": "absolute", "value": 4334261}}]}, {"address": {"type": "absolute", "value": 4304145}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4396128}}, {"address": {"type": "absolute", "value": 4396245}}, {"address": {"type": "absolute", "value": 4396319}}, {"address": {"type": "absolute", "value": 4396534}}]}, {"address": {"type": "absolute", "value": 4304150}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4390512}}]}, {"address": {"type": "absolute", "value": 4304155}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4461680}}, {"address": {"type": "absolute", "value": 4461793}}, {"address": {"type": "absolute", "value": 4461845}}]}, {"address": {"type": "absolute", "value": 4304160}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4387424}}, {"address": {"type": "absolute", "value": 4387636}}]}, {"address": {"type": "absolute", "value": 4304165}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4404240}}, {"address": {"type": "absolute", "value": 4404311}}]}, {"address": {"type": "absolute", "value": 4304175}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4366512}}]}, {"address": {"type": "absolute", "value": 4304185}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4359536}}]}, {"address": {"type": "absolute", "value": 4304190}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4383024}}]}, {"address": {"type": "absolute", "value": 4304195}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4388112}}]}, {"address": {"type": "absolute", "value": 4304205}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4500570}}]}, {"address": {"type": "absolute", "value": 4304215}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4358960}}]}, {"address": {"type": "absolute", "value": 4304220}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4304225}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4417968}}, {"address": {"type": "absolute", "value": 4418097}}, {"address": {"type": "absolute", "value": 4418231}}, {"address": {"type": "absolute", "value": 4418498}}]}, {"address": {"type": "absolute", "value": 4304235}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4467504}}]}, {"address": {"type": "absolute", "value": 4304240}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4354096}}, {"address": {"type": "absolute", "value": 4354172}}]}, {"address": {"type": "absolute", "value": 4304245}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4304250}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4492144}}]}, {"address": {"type": "absolute", "value": 4304255}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4304260}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4304265}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4463632}}]}, {"address": {"type": "absolute", "value": 4304270}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4509104}}]}, {"address": {"type": "absolute", "value": 4304275}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4482864}}, {"address": {"type": "absolute", "value": 4483013}}]}, {"address": {"type": "absolute", "value": 4304280}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4458224}}, {"address": {"type": "absolute", "value": 4458607}}]}, {"address": {"type": "absolute", "value": 4304295}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4304300}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4491696}}, {"address": {"type": "absolute", "value": 4491794}}]}, {"address": {"type": "absolute", "value": 4304305}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4304310}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4359664}}]}, {"address": {"type": "absolute", "value": 4304315}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4424896}}, {"address": {"type": "absolute", "value": 4425015}}, {"address": {"type": "absolute", "value": 4425156}}, {"address": {"type": "absolute", "value": 4425244}}, {"address": {"type": "absolute", "value": 4425265}}, {"address": {"type": "absolute", "value": 4425282}}, {"address": {"type": "absolute", "value": 4425303}}, {"address": {"type": "absolute", "value": 4425320}}, {"address": {"type": "absolute", "value": 4425341}}, {"address": {"type": "absolute", "value": 4425512}}]}, {"address": {"type": "absolute", "value": 4304325}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4481280}}, {"address": {"type": "absolute", "value": 4481385}}]}, {"address": {"type": "absolute", "value": 4304330}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4359392}}]}, {"address": {"type": "absolute", "value": 4304335}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4349344}}]}, {"address": {"type": "absolute", "value": 4304340}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4328736}}, {"address": {"type": "absolute", "value": 4328826}}, {"address": {"type": "absolute", "value": 4328983}}]}, {"address": {"type": "absolute", "value": 4304350}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4506327}}]}, {"address": {"type": "absolute", "value": 4304355}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4304360}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4512768}}]}, {"address": {"type": "absolute", "value": 4304365}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4364640}}, {"address": {"type": "absolute", "value": 4364713}}, {"address": {"type": "absolute", "value": 4364736}}, {"address": {"type": "absolute", "value": 4364766}}]}, {"address": {"type": "absolute", "value": 4304370}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4304370}}, {"address": {"type": "absolute", "value": 4496937}}]}, {"address": {"type": "absolute", "value": 4304375}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4503360}}]}, {"address": {"type": "absolute", "value": 4304380}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4492672}}]}, {"address": {"type": "absolute", "value": 4304385}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4483408}}]}, {"address": {"type": "absolute", "value": 4304390}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4337344}}]}, {"address": {"type": "absolute", "value": 4304395}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4366800}}]}, {"address": {"type": "absolute", "value": 4304400}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4351072}}]}, {"address": {"type": "absolute", "value": 4304405}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4393616}}]}, {"address": {"type": "absolute", "value": 4304410}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4402144}}]}, {"address": {"type": "absolute", "value": 4304415}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4304430}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4391264}}]}, {"address": {"type": "absolute", "value": 4304440}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4441149}}, {"address": {"type": "absolute", "value": 4441171}}, {"address": {"type": "absolute", "value": 4441327}}, {"address": {"type": "absolute", "value": 4441346}}, {"address": {"type": "absolute", "value": 4441368}}]}, {"address": {"type": "absolute", "value": 4304445}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4337008}}]}, {"address": {"type": "absolute", "value": 4304460}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4505472}}]}, {"address": {"type": "absolute", "value": 4304465}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4479728}}, {"address": {"type": "absolute", "value": 4479847}}, {"address": {"type": "absolute", "value": 4479868}}, {"address": {"type": "absolute", "value": 4479970}}, {"address": {"type": "absolute", "value": 4479985}}, {"address": {"type": "absolute", "value": 4480020}}]}, {"address": {"type": "absolute", "value": 4304470}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4304475}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4395536}}]}, {"address": {"type": "absolute", "value": 4304480}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4304490}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4472112}}, {"address": {"type": "absolute", "value": 4472276}}, {"address": {"type": "absolute", "value": 4472415}}]}, {"address": {"type": "absolute", "value": 4304495}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4304500}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4352736}}]}, {"address": {"type": "absolute", "value": 4304505}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4356304}}]}, {"address": {"type": "absolute", "value": 4304510}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4304515}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4304520}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4410192}}, {"address": {"type": "absolute", "value": 4410324}}, {"address": {"type": "absolute", "value": 4410411}}, {"address": {"type": "absolute", "value": 4410441}}, {"address": {"type": "absolute", "value": 4410511}}, {"address": {"type": "absolute", "value": 4410530}}, {"address": {"type": "absolute", "value": 4410552}}, {"address": {"type": "absolute", "value": 4410627}}, {"address": {"type": "absolute", "value": 4410654}}, {"address": {"type": "absolute", "value": 4410681}}, {"address": {"type": "absolute", "value": 4410697}}, {"address": {"type": "absolute", "value": 4410716}}, {"address": {"type": "absolute", "value": 4410733}}]}, {"address": {"type": "absolute", "value": 4304535}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4509456}}]}, {"address": {"type": "absolute", "value": 4304540}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4319984}}, {"address": {"type": "absolute", "value": 4320206}}, {"address": {"type": "absolute", "value": 4320236}}, {"address": {"type": "absolute", "value": 4320295}}, {"address": {"type": "absolute", "value": 4320984}}, {"address": {"type": "absolute", "value": 4321151}}, {"address": {"type": "absolute", "value": 4321886}}, {"address": {"type": "absolute", "value": 4322182}}, {"address": {"type": "absolute", "value": 4322298}}, {"address": {"type": "absolute", "value": 4322327}}, {"address": {"type": "absolute", "value": 4322392}}, {"address": {"type": "absolute", "value": 4322434}}, {"address": {"type": "absolute", "value": 4322476}}, {"address": {"type": "absolute", "value": 4322564}}, {"address": {"type": "absolute", "value": 4322877}}, {"address": {"type": "absolute", "value": 4322904}}, {"address": {"type": "absolute", "value": 4323003}}, {"address": {"type": "absolute", "value": 4323026}}]}, {"address": {"type": "absolute", "value": 4304545}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4327184}}]}, {"address": {"type": "absolute", "value": 4304550}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4436080}}, {"address": {"type": "absolute", "value": 4436193}}]}, {"address": {"type": "absolute", "value": 4304560}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4304570}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4462352}}, {"address": {"type": "absolute", "value": 4462425}}, {"address": {"type": "absolute", "value": 4462441}}]}, {"address": {"type": "absolute", "value": 4304580}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4304595}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4397104}}]}, {"address": {"type": "absolute", "value": 4304605}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4373088}}, {"address": {"type": "absolute", "value": 4373245}}, {"address": {"type": "absolute", "value": 4373296}}, {"address": {"type": "absolute", "value": 4373371}}, {"address": {"type": "absolute", "value": 4373404}}, {"address": {"type": "absolute", "value": 4373464}}, {"address": {"type": "absolute", "value": 4373487}}, {"address": {"type": "absolute", "value": 4373645}}, {"address": {"type": "absolute", "value": 4373688}}, {"address": {"type": "absolute", "value": 4373730}}, {"address": {"type": "absolute", "value": 4373799}}, {"address": {"type": "absolute", "value": 4373832}}, {"address": {"type": "absolute", "value": 4373981}}, {"address": {"type": "absolute", "value": 4374024}}, {"address": {"type": "absolute", "value": 4374044}}, {"address": {"type": "absolute", "value": 4374062}}, {"address": {"type": "absolute", "value": 4374089}}, {"address": {"type": "absolute", "value": 4374159}}, {"address": {"type": "absolute", "value": 4374321}}]}, {"address": {"type": "absolute", "value": 4304610}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4462832}}]}, {"address": {"type": "absolute", "value": 4304620}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4325232}}, {"address": {"type": "absolute", "value": 4325315}}]}, {"address": {"type": "absolute", "value": 4304625}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4401024}}, {"address": {"type": "absolute", "value": 4401081}}, {"address": {"type": "absolute", "value": 4401144}}]}, {"address": {"type": "absolute", "value": 4304630}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4457904}}, {"address": {"type": "absolute", "value": 4457997}}]}, {"address": {"type": "absolute", "value": 4304635}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4414368}}, {"address": {"type": "absolute", "value": 4414487}}, {"address": {"type": "absolute", "value": 4414803}}]}, {"address": {"type": "absolute", "value": 4304645}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4405280}}, {"address": {"type": "absolute", "value": 4405496}}, {"address": {"type": "absolute", "value": 4405530}}, {"address": {"type": "absolute", "value": 4405551}}, {"address": {"type": "absolute", "value": 4405613}}, {"address": {"type": "absolute", "value": 4405664}}]}, {"address": {"type": "absolute", "value": 4304650}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4304660}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4453056}}]}, {"address": {"type": "absolute", "value": 4304665}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4487136}}]}, {"address": {"type": "absolute", "value": 4304670}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4498473}}]}, {"address": {"type": "absolute", "value": 4304675}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4304680}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4304685}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4393952}}, {"address": {"type": "absolute", "value": 4394059}}]}, {"address": {"type": "absolute", "value": 4304690}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4397008}}]}, {"address": {"type": "absolute", "value": 4304705}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4338288}}]}, {"address": {"type": "absolute", "value": 4304710}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4304715}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4337616}}]}, {"address": {"type": "absolute", "value": 4304725}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4498740}}, {"address": {"type": "absolute", "value": 4498766}}]}, {"address": {"type": "absolute", "value": 4304730}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4304735}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4324470}}, {"address": {"type": "absolute", "value": 4324504}}, {"address": {"type": "absolute", "value": 4324604}}, {"address": {"type": "absolute", "value": 4324623}}, {"address": {"type": "absolute", "value": 4324645}}]}, {"address": {"type": "absolute", "value": 4304740}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4442267}}, {"address": {"type": "absolute", "value": 4442289}}, {"address": {"type": "absolute", "value": 4442382}}, {"address": {"type": "absolute", "value": 4442401}}, {"address": {"type": "absolute", "value": 4442423}}]}, {"address": {"type": "absolute", "value": 4304745}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4452384}}]}, {"address": {"type": "absolute", "value": 4304750}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4344976}}]}, {"address": {"type": "absolute", "value": 4304755}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4304770}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4507625}}, {"address": {"type": "absolute", "value": 4507895}}]}, {"address": {"type": "absolute", "value": 4304775}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4325872}}, {"address": {"type": "absolute", "value": 4326043}}]}, {"address": {"type": "absolute", "value": 4304780}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4467632}}]}, {"address": {"type": "absolute", "value": 4304785}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4394272}}, {"address": {"type": "absolute", "value": 4394387}}, {"address": {"type": "absolute", "value": 4394488}}]}, {"address": {"type": "absolute", "value": 4304790}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4350048}}]}, {"address": {"type": "absolute", "value": 4304795}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4357968}}]}, {"address": {"type": "absolute", "value": 4304800}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4304805}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4407024}}, {"address": {"type": "absolute", "value": 4407165}}]}, {"address": {"type": "absolute", "value": 4304810}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4453152}}]}, {"address": {"type": "absolute", "value": 4304815}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4304820}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4304830}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4333744}}]}, {"address": {"type": "absolute", "value": 4304835}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4383280}}]}, {"address": {"type": "absolute", "value": 4304845}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4487456}}, {"address": {"type": "absolute", "value": 4487567}}, {"address": {"type": "absolute", "value": 4487707}}, {"address": {"type": "absolute", "value": 4487774}}, {"address": {"type": "absolute", "value": 4487834}}, {"address": {"type": "absolute", "value": 4487914}}]}, {"address": {"type": "absolute", "value": 4304850}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4357456}}]}, {"address": {"type": "absolute", "value": 4304860}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4334784}}, {"address": {"type": "absolute", "value": 4334864}}, {"address": {"type": "absolute", "value": 4334880}}]}, {"address": {"type": "absolute", "value": 4304870}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4495872}}, {"address": {"type": "absolute", "value": 4495944}}, {"address": {"type": "absolute", "value": 4495964}}, {"address": {"type": "absolute", "value": 4495992}}]}, {"address": {"type": "absolute", "value": 4304875}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4360272}}]}, {"address": {"type": "absolute", "value": 4304880}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4337888}}]}, {"address": {"type": "absolute", "value": 4304890}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4401200}}, {"address": {"type": "absolute", "value": 4401257}}, {"address": {"type": "absolute", "value": 4401320}}]}, {"address": {"type": "absolute", "value": 4304895}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4508544}}]}, {"address": {"type": "absolute", "value": 4304900}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4334000}}]}, {"address": {"type": "absolute", "value": 4304910}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4366944}}]}, {"address": {"type": "absolute", "value": 4304920}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4336384}}, {"address": {"type": "absolute", "value": 4336487}}]}, {"address": {"type": "absolute", "value": 4304930}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4366080}}]}, {"address": {"type": "absolute", "value": 4304935}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4351168}}]}, {"address": {"type": "absolute", "value": 4304940}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4401472}}]}, {"address": {"type": "absolute", "value": 4304945}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4421563}}, {"address": {"type": "absolute", "value": 4421585}}, {"address": {"type": "absolute", "value": 4421673}}, {"address": {"type": "absolute", "value": 4421692}}, {"address": {"type": "absolute", "value": 4421714}}]}, {"address": {"type": "absolute", "value": 4304950}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4367872}}]}, {"address": {"type": "absolute", "value": 4304955}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4304965}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4348368}}, {"address": {"type": "absolute", "value": 4348441}}, {"address": {"type": "absolute", "value": 4348566}}, {"address": {"type": "absolute", "value": 4348599}}, {"address": {"type": "absolute", "value": 4348631}}]}, {"address": {"type": "absolute", "value": 4304970}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4364336}}]}, {"address": {"type": "absolute", "value": 4304975}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4361440}}, {"address": {"type": "absolute", "value": 4361603}}, {"address": {"type": "absolute", "value": 4361942}}]}, {"address": {"type": "absolute", "value": 4304980}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4365216}}]}, {"address": {"type": "absolute", "value": 4304995}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4330096}}, {"address": {"type": "absolute", "value": 4330314}}, {"address": {"type": "absolute", "value": 4330346}}, {"address": {"type": "absolute", "value": 4330478}}, {"address": {"type": "absolute", "value": 4330517}}, {"address": {"type": "absolute", "value": 4330565}}]}, {"address": {"type": "absolute", "value": 4305005}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4381168}}, {"address": {"type": "absolute", "value": 4381309}}, {"address": {"type": "absolute", "value": 4381359}}, {"address": {"type": "absolute", "value": 4381459}}, {"address": {"type": "absolute", "value": 4381486}}]}, {"address": {"type": "absolute", "value": 4305010}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4393280}}, {"address": {"type": "absolute", "value": 4393355}}, {"address": {"type": "absolute", "value": 4393403}}, {"address": {"type": "absolute", "value": 4393451}}]}, {"address": {"type": "absolute", "value": 4305025}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4456576}}]}, {"address": {"type": "absolute", "value": 4305030}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4305040}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4358816}}]}, {"address": {"type": "absolute", "value": 4305045}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4471552}}]}, {"address": {"type": "absolute", "value": 4305050}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4492352}}]}, {"address": {"type": "absolute", "value": 4305055}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4390608}}]}, {"address": {"type": "absolute", "value": 4305065}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4421136}}, {"address": {"type": "absolute", "value": 4421228}}, {"address": {"type": "absolute", "value": 4421277}}, {"address": {"type": "absolute", "value": 4421312}}, {"address": {"type": "absolute", "value": 4421334}}]}, {"address": {"type": "absolute", "value": 4305070}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4348176}}, {"address": {"type": "absolute", "value": 4348279}}]}, {"address": {"type": "absolute", "value": 4305075}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4364480}}]}, {"address": {"type": "absolute", "value": 4305080}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4457312}}]}, {"address": {"type": "absolute", "value": 4305085}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4343680}}, {"address": {"type": "absolute", "value": 4343801}}, {"address": {"type": "absolute", "value": 4343840}}]}, {"address": {"type": "absolute", "value": 4305090}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4345776}}]}, {"address": {"type": "absolute", "value": 4305095}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4305115}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4484720}}, {"address": {"type": "absolute", "value": 4484841}}, {"address": {"type": "absolute", "value": 4484880}}]}, {"address": {"type": "absolute", "value": 4305120}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4479264}}, {"address": {"type": "absolute", "value": 4479513}}]}, {"address": {"type": "absolute", "value": 4305125}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4371888}}]}, {"address": {"type": "absolute", "value": 4305130}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4305140}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4391664}}]}, {"address": {"type": "absolute", "value": 4305145}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4452960}}]}, {"address": {"type": "absolute", "value": 4305150}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4460080}}, {"address": {"type": "absolute", "value": 4460189}}]}, {"address": {"type": "absolute", "value": 4305155}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4486096}}]}, {"address": {"type": "absolute", "value": 4305160}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4404496}}, {"address": {"type": "absolute", "value": 4404567}}]}, {"address": {"type": "absolute", "value": 4305165}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4461920}}]}, {"address": {"type": "absolute", "value": 4305170}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4305185}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4354782}}, {"address": {"type": "absolute", "value": 4354852}}]}, {"address": {"type": "absolute", "value": 4305190}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4395444}}]}, {"address": {"type": "absolute", "value": 4305195}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4493160}}, {"address": {"type": "absolute", "value": 4493175}}, {"address": {"type": "absolute", "value": 4493263}}]}, {"address": {"type": "absolute", "value": 4305205}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4384112}}]}, {"address": {"type": "absolute", "value": 4305210}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4305220}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4329072}}, {"address": {"type": "absolute", "value": 4329213}}]}, {"address": {"type": "absolute", "value": 4305225}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4353376}}]}, {"address": {"type": "absolute", "value": 4305230}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4331600}}, {"address": {"type": "absolute", "value": 4331908}}]}, {"address": {"type": "absolute", "value": 4305235}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4401872}}]}, {"address": {"type": "absolute", "value": 4305245}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4305250}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4347600}}]}, {"address": {"type": "absolute", "value": 4305255}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4337472}}]}, {"address": {"type": "absolute", "value": 4305260}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4457232}}]}, {"address": {"type": "absolute", "value": 4305270}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4455760}}]}, {"address": {"type": "absolute", "value": 4305275}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4410064}}, {"address": {"type": "absolute", "value": 4410136}}]}, {"address": {"type": "absolute", "value": 4305280}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4305285}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4342624}}]}, {"address": {"type": "absolute", "value": 4305290}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4464672}}]}, {"address": {"type": "absolute", "value": 4305295}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4480832}}, {"address": {"type": "absolute", "value": 4480949}}]}, {"address": {"type": "absolute", "value": 4305300}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4356576}}]}, {"address": {"type": "absolute", "value": 4305310}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4305315}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4374784}}, {"address": {"type": "absolute", "value": 4374858}}, {"address": {"type": "absolute", "value": 4374979}}, {"address": {"type": "absolute", "value": 4375086}}, {"address": {"type": "absolute", "value": 4375103}}, {"address": {"type": "absolute", "value": 4375245}}]}, {"address": {"type": "absolute", "value": 4305320}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4305325}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4347168}}, {"address": {"type": "absolute", "value": 4347242}}]}, {"address": {"type": "absolute", "value": 4305330}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4459909}}, {"address": {"type": "absolute", "value": 4459957}}, {"address": {"type": "absolute", "value": 4460005}}]}, {"address": {"type": "absolute", "value": 4305335}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4349488}}]}, {"address": {"type": "absolute", "value": 4305340}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4305345}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4325088}}]}, {"address": {"type": "absolute", "value": 4305350}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4488976}}, {"address": {"type": "absolute", "value": 4489038}}, {"address": {"type": "absolute", "value": 4489075}}]}, {"address": {"type": "absolute", "value": 4305355}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4467360}}]}, {"address": {"type": "absolute", "value": 4305360}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4375622}}, {"address": {"type": "absolute", "value": 4375684}}, {"address": {"type": "absolute", "value": 4375761}}, {"address": {"type": "absolute", "value": 4375907}}, {"address": {"type": "absolute", "value": 4376003}}, {"address": {"type": "absolute", "value": 4376023}}, {"address": {"type": "absolute", "value": 4376083}}, {"address": {"type": "absolute", "value": 4376194}}, {"address": {"type": "absolute", "value": 4376216}}, {"address": {"type": "absolute", "value": 4376378}}]}, {"address": {"type": "absolute", "value": 4305365}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4355248}}]}, {"address": {"type": "absolute", "value": 4305370}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4305375}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4359792}}]}, {"address": {"type": "absolute", "value": 4305380}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4349616}}]}, {"address": {"type": "absolute", "value": 4305390}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4383408}}]}, {"address": {"type": "absolute", "value": 4305395}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4490656}}]}, {"address": {"type": "absolute", "value": 4305405}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4392176}}]}, {"address": {"type": "absolute", "value": 4305410}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4506528}}]}, {"address": {"type": "absolute", "value": 4305425}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4452672}}]}, {"address": {"type": "absolute", "value": 4305430}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4383968}}]}, {"address": {"type": "absolute", "value": 4305435}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4392032}}]}, {"address": {"type": "absolute", "value": 4305445}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4472944}}, {"address": {"type": "absolute", "value": 4473065}}, {"address": {"type": "absolute", "value": 4473126}}, {"address": {"type": "absolute", "value": 4473562}}, {"address": {"type": "absolute", "value": 4474945}}, {"address": {"type": "absolute", "value": 4475078}}]}, {"address": {"type": "absolute", "value": 4305450}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4305460}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4358304}}]}, {"address": {"type": "absolute", "value": 4305465}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4387984}}]}, {"address": {"type": "absolute", "value": 4305475}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4336816}}, {"address": {"type": "absolute", "value": 4336919}}]}, {"address": {"type": "absolute", "value": 4305480}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4356960}}]}, {"address": {"type": "absolute", "value": 4305485}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4400112}}, {"address": {"type": "absolute", "value": 4400207}}, {"address": {"type": "absolute", "value": 4400244}}, {"address": {"type": "absolute", "value": 4400282}}, {"address": {"type": "absolute", "value": 4400345}}, {"address": {"type": "absolute", "value": 4400423}}, {"address": {"type": "absolute", "value": 4400598}}]}, {"address": {"type": "absolute", "value": 4305490}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4305495}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4376930}}, {"address": {"type": "absolute", "value": 4376992}}, {"address": {"type": "absolute", "value": 4377069}}, {"address": {"type": "absolute", "value": 4377300}}, {"address": {"type": "absolute", "value": 4377329}}, {"address": {"type": "absolute", "value": 4377342}}, {"address": {"type": "absolute", "value": 4377435}}, {"address": {"type": "absolute", "value": 4377535}}, {"address": {"type": "absolute", "value": 4377613}}, {"address": {"type": "absolute", "value": 4377652}}, {"address": {"type": "absolute", "value": 4377672}}, {"address": {"type": "absolute", "value": 4377724}}, {"address": {"type": "absolute", "value": 4377746}}, {"address": {"type": "absolute", "value": 4377908}}]}, {"address": {"type": "absolute", "value": 4305500}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4390720}}]}, {"address": {"type": "absolute", "value": 4305510}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4344688}}]}, {"address": {"type": "absolute", "value": 4305515}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4498864}}]}, {"address": {"type": "absolute", "value": 4305525}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4305535}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4305550}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4423856}}, {"address": {"type": "absolute", "value": 4423975}}, {"address": {"type": "absolute", "value": 4424165}}, {"address": {"type": "absolute", "value": 4424339}}, {"address": {"type": "absolute", "value": 4424506}}]}, {"address": {"type": "absolute", "value": 4305555}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4419184}}, {"address": {"type": "absolute", "value": 4419255}}]}, {"address": {"type": "absolute", "value": 4305560}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4438304}}, {"address": {"type": "absolute", "value": 4438604}}, {"address": {"type": "absolute", "value": 4438635}}, {"address": {"type": "absolute", "value": 4438761}}, {"address": {"type": "absolute", "value": 4438780}}, {"address": {"type": "absolute", "value": 4438833}}]}, {"address": {"type": "absolute", "value": 4305565}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4485808}}]}, {"address": {"type": "absolute", "value": 4305570}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4449920}}, {"address": {"type": "absolute", "value": 4450064}}, {"address": {"type": "absolute", "value": 4450116}}, {"address": {"type": "absolute", "value": 4450165}}, {"address": {"type": "absolute", "value": 4450253}}, {"address": {"type": "absolute", "value": 4450276}}, {"address": {"type": "absolute", "value": 4450328}}, {"address": {"type": "absolute", "value": 4450351}}, {"address": {"type": "absolute", "value": 4450426}}, {"address": {"type": "absolute", "value": 4450449}}, {"address": {"type": "absolute", "value": 4450618}}, {"address": {"type": "absolute", "value": 4450641}}, {"address": {"type": "absolute", "value": 4450707}}, {"address": {"type": "absolute", "value": 4450866}}, {"address": {"type": "absolute", "value": 4450881}}, {"address": {"type": "absolute", "value": 4451017}}]}, {"address": {"type": "absolute", "value": 4305575}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4490369}}, {"address": {"type": "absolute", "value": 4490378}}, {"address": {"type": "absolute", "value": 4490389}}, {"address": {"type": "absolute", "value": 4490427}}]}, {"address": {"type": "absolute", "value": 4305580}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4358192}}]}, {"address": {"type": "absolute", "value": 4305585}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4305600}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4458816}}, {"address": {"type": "absolute", "value": 4458938}}]}, {"address": {"type": "absolute", "value": 4305610}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4493008}}]}, {"address": {"type": "absolute", "value": 4305620}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4506192}}]}, {"address": {"type": "absolute", "value": 4305630}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4485424}}]}, {"address": {"type": "absolute", "value": 4305635}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4305645}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4485680}}]}, {"address": {"type": "absolute", "value": 4305650}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4305655}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4437792}}, {"address": {"type": "absolute", "value": 4437988}}, {"address": {"type": "absolute", "value": 4438016}}]}, {"address": {"type": "absolute", "value": 4305660}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4305665}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4391552}}]}, {"address": {"type": "absolute", "value": 4305675}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4482688}}, {"address": {"type": "absolute", "value": 4482769}}, {"address": {"type": "absolute", "value": 4482796}}]}, {"address": {"type": "absolute", "value": 4305680}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4485904}}]}, {"address": {"type": "absolute", "value": 4305685}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4503296}}]}, {"address": {"type": "absolute", "value": 4305690}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4409968}}]}, {"address": {"type": "absolute", "value": 4305695}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4463968}}, {"address": {"type": "absolute", "value": 4464072}}, {"address": {"type": "absolute", "value": 4464092}}]}, {"address": {"type": "absolute", "value": 4305700}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4491040}}, {"address": {"type": "absolute", "value": 4491104}}, {"address": {"type": "absolute", "value": 4491149}}, {"address": {"type": "absolute", "value": 4491215}}, {"address": {"type": "absolute", "value": 4491269}}, {"address": {"type": "absolute", "value": 4491304}}, {"address": {"type": "absolute", "value": 4491358}}, {"address": {"type": "absolute", "value": 4491408}}]}, {"address": {"type": "absolute", "value": 4305705}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4337696}}, {"address": {"type": "absolute", "value": 4337769}}, {"address": {"type": "absolute", "value": 4337792}}, {"address": {"type": "absolute", "value": 4337822}}]}, {"address": {"type": "absolute", "value": 4305715}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4386192}}, {"address": {"type": "absolute", "value": 4386313}}, {"address": {"type": "absolute", "value": 4386352}}]}, {"address": {"type": "absolute", "value": 4305720}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4486192}}]}, {"address": {"type": "absolute", "value": 4305725}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4464224}}]}, {"address": {"type": "absolute", "value": 4305730}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4486304}}]}, {"address": {"type": "absolute", "value": 4305735}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4364208}}]}, {"address": {"type": "absolute", "value": 4305740}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4464784}}, {"address": {"type": "absolute", "value": 4464907}}]}, {"address": {"type": "absolute", "value": 4305745}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4388624}}]}, {"address": {"type": "absolute", "value": 4305750}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4305765}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4451456}}, {"address": {"type": "absolute", "value": 4451556}}, {"address": {"type": "absolute", "value": 4451613}}, {"address": {"type": "absolute", "value": 4451723}}, {"address": {"type": "absolute", "value": 4451743}}, {"address": {"type": "absolute", "value": 4451798}}, {"address": {"type": "absolute", "value": 4451815}}, {"address": {"type": "absolute", "value": 4451888}}, {"address": {"type": "absolute", "value": 4451905}}, {"address": {"type": "absolute", "value": 4451923}}]}, {"address": {"type": "absolute", "value": 4305775}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4305780}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4305785}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4305790}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4305800}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4390224}}]}, {"address": {"type": "absolute", "value": 4305805}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4355600}}]}, {"address": {"type": "absolute", "value": 4305810}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4492784}}, {"address": {"type": "absolute", "value": 4492863}}]}, {"address": {"type": "absolute", "value": 4305815}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4406309}}, {"address": {"type": "absolute", "value": 4406343}}, {"address": {"type": "absolute", "value": 4406686}}]}, {"address": {"type": "absolute", "value": 4305820}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4510963}}, {"address": {"type": "absolute", "value": 4511016}}, {"address": {"type": "absolute", "value": 4511030}}, {"address": {"type": "absolute", "value": 4511051}}, {"address": {"type": "absolute", "value": 4511063}}, {"address": {"type": "absolute", "value": 4511071}}, {"address": {"type": "absolute", "value": 4511167}}, {"address": {"type": "absolute", "value": 4511468}}, {"address": {"type": "absolute", "value": 4511703}}]}, {"address": {"type": "absolute", "value": 4305825}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4453248}}]}, {"address": {"type": "absolute", "value": 4305830}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4404368}}, {"address": {"type": "absolute", "value": 4404439}}]}, {"address": {"type": "absolute", "value": 4305840}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4305845}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4328288}}, {"address": {"type": "absolute", "value": 4328380}}, {"address": {"type": "absolute", "value": 4328505}}, {"address": {"type": "absolute", "value": 4328542}}]}, {"address": {"type": "absolute", "value": 4305850}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4470832}}]}, {"address": {"type": "absolute", "value": 4305855}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4363072}}]}, {"address": {"type": "absolute", "value": 4310928}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4310928}}]}, {"address": {"type": "absolute", "value": 4311056}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4311056}}]}, {"address": {"type": "absolute", "value": 4311408}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4311408}}]}, {"address": {"type": "absolute", "value": 4312432}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4312432}}]}, {"address": {"type": "absolute", "value": 4319584}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4325718}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4325724}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4325779}}]}, {"address": {"type": "absolute", "value": 4326000}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4326006}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4326043}}]}, {"address": {"type": "absolute", "value": 4326736}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4326736}}, {"address": {"type": "absolute", "value": 4326806}}]}, {"address": {"type": "absolute", "value": 4326864}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4326864}}]}, {"address": {"type": "absolute", "value": 4327024}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4327024}}, {"address": {"type": "absolute", "value": 4327087}}, {"address": {"type": "absolute", "value": 4327121}}]}, {"address": {"type": "absolute", "value": 4327568}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4327622}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4327714}}]}, {"address": {"type": "absolute", "value": 4336094}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4336159}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4336166}}]}, {"address": {"type": "absolute", "value": 4361150}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4361215}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4361215}}]}, {"address": {"type": "absolute", "value": 4361870}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4361935}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4361935}}]}, {"address": {"type": "absolute", "value": 4362600}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4362665}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4362665}}]}, {"address": {"type": "absolute", "value": 4371168}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4371168}}, {"address": {"type": "absolute", "value": 4371256}}, {"address": {"type": "absolute", "value": 4371299}}, {"address": {"type": "absolute", "value": 4371378}}, {"address": {"type": "absolute", "value": 4371552}}, {"address": {"type": "absolute", "value": 4371642}}]}, {"address": {"type": "absolute", "value": 4379632}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4379708}}, {"address": {"type": "absolute", "value": 4379820}}]}, {"address": {"type": "absolute", "value": 4379904}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4379973}}, {"address": {"type": "absolute", "value": 4380040}}]}, {"address": {"type": "absolute", "value": 4380112}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4380112}}, {"address": {"type": "absolute", "value": 4380209}}]}, {"address": {"type": "absolute", "value": 4380272}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4380272}}, {"address": {"type": "absolute", "value": 4380340}}]}, {"address": {"type": "absolute", "value": 4394445}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4394451}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4394488}}]}, {"address": {"type": "absolute", "value": 4396848}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4396848}}, {"address": {"type": "absolute", "value": 4396911}}, {"address": {"type": "absolute", "value": 4396945}}]}, {"address": {"type": "absolute", "value": 4401568}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4401568}}]}, {"address": {"type": "absolute", "value": 4401680}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4401680}}]}, {"address": {"type": "absolute", "value": 4401776}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4401776}}]}, {"address": {"type": "absolute", "value": 4402832}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4402832}}, {"address": {"type": "absolute", "value": 4402951}}, {"address": {"type": "absolute", "value": 4403360}}]}, {"address": {"type": "absolute", "value": 4418944}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4419050}}]}, {"address": {"type": "absolute", "value": 4440528}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4440631}}, {"address": {"type": "absolute", "value": 4440653}}, {"address": {"type": "absolute", "value": 4440741}}, {"address": {"type": "absolute", "value": 4440760}}, {"address": {"type": "absolute", "value": 4440782}}]}, {"address": {"type": "absolute", "value": 4455904}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4455904}}, {"address": {"type": "absolute", "value": 4456043}}, {"address": {"type": "absolute", "value": 4456060}}, {"address": {"type": "absolute", "value": 4456086}}]}, {"address": {"type": "absolute", "value": 4458064}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4458064}}, {"address": {"type": "absolute", "value": 4458158}}]}, {"address": {"type": "absolute", "value": 4459008}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4459008}}, {"address": {"type": "absolute", "value": 4459203}}]}, {"address": {"type": "absolute", "value": 4459296}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4459296}}, {"address": {"type": "absolute", "value": 4459364}}]}, {"address": {"type": "absolute", "value": 4464512}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4464512}}]}, {"address": {"type": "absolute", "value": 4466544}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4466544}}]}, {"address": {"type": "absolute", "value": 4466656}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4466656}}]}, {"address": {"type": "absolute", "value": 4466768}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4466768}}]}, {"address": {"type": "absolute", "value": 4466992}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4466992}}]}, {"address": {"type": "absolute", "value": 4467216}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4467216}}]}, {"address": {"type": "absolute", "value": 4467632}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4467632}}]}, {"address": {"type": "absolute", "value": 4468080}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4468080}}, {"address": {"type": "absolute", "value": 4468243}}, {"address": {"type": "absolute", "value": 4468582}}]}, {"address": {"type": "absolute", "value": 4468510}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4468575}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4468575}}]}, {"address": {"type": "absolute", "value": 4469230}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4469295}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4469295}}]}, {"address": {"type": "absolute", "value": 4470448}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4470448}}, {"address": {"type": "absolute", "value": 4470521}}, {"address": {"type": "absolute", "value": 4470544}}, {"address": {"type": "absolute", "value": 4470574}}]}, {"address": {"type": "absolute", "value": 4471696}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4471696}}]}, {"address": {"type": "absolute", "value": 4472852}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4472854}}, {"address": {"type": "absolute", "value": 4472955}}, {"address": {"type": "absolute", "value": 4473065}}, {"address": {"type": "absolute", "value": 4473126}}, {"address": {"type": "absolute", "value": 4473562}}, {"address": {"type": "absolute", "value": 4474945}}, {"address": {"type": "absolute", "value": 4475078}}]}, {"address": {"type": "absolute", "value": 4476272}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4476272}}, {"address": {"type": "absolute", "value": 4476418}}, {"address": {"type": "absolute", "value": 4476451}}, {"address": {"type": "absolute", "value": 4476628}}, {"address": {"type": "absolute", "value": 4476669}}]}, {"address": {"type": "absolute", "value": 4480208}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4480208}}, {"address": {"type": "absolute", "value": 4480471}}, {"address": {"type": "absolute", "value": 4480571}}]}, {"address": {"type": "absolute", "value": 4481456}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4481532}}, {"address": {"type": "absolute", "value": 4481644}}]}, {"address": {"type": "absolute", "value": 4481728}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4481797}}, {"address": {"type": "absolute", "value": 4481864}}]}, {"address": {"type": "absolute", "value": 4481936}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4481936}}, {"address": {"type": "absolute", "value": 4482131}}]}, {"address": {"type": "absolute", "value": 4482224}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4482224}}, {"address": {"type": "absolute", "value": 4482321}}]}, {"address": {"type": "absolute", "value": 4482384}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4482384}}, {"address": {"type": "absolute", "value": 4482452}}]}, {"address": {"type": "absolute", "value": 4486000}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4486000}}]}, {"address": {"type": "absolute", "value": 4489616}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4489675}}, {"address": {"type": "absolute", "value": 4489695}}, {"address": {"type": "absolute", "value": 4489712}}, {"address": {"type": "absolute", "value": 4489732}}, {"address": {"type": "absolute", "value": 4489868}}, {"address": {"type": "absolute", "value": 4489893}}, {"address": {"type": "absolute", "value": 4490004}}, {"address": {"type": "absolute", "value": 4490031}}, {"address": {"type": "absolute", "value": 4490072}}]}, {"address": {"type": "absolute", "value": 4497888}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4497952}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4498592}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4498896}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4499088}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4499344}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4499408}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4499456}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4499520}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4499552}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4499648}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4499712}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4500326}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4500365}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4500752}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4501648}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4502240}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4502464}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4502480}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4502512}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4502544}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4502963}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4502963}}]}, {"address": {"type": "absolute", "value": 4502990}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4503216}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4503408}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4503488}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4503872}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4504208}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4504352}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4504384}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4505024}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4505102}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4505121}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4505184}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4505552}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4505600}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4505696}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4508000}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4508512}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4508544}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4508544}}]}, {"address": {"type": "absolute", "value": 4508576}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4508640}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4509056}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4509056}}]}, {"address": {"type": "absolute", "value": 4509488}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4509888}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4510640}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4512048}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4521360}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4350816}}]}, {"address": {"type": "absolute", "value": 4521368}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4350896}}, {"address": {"type": "absolute", "value": 4350980}}, {"address": {"type": "absolute", "value": 4351001}}]}, {"address": {"type": "absolute", "value": 4521600}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4351168}}]}, {"address": {"type": "absolute", "value": 4525888}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4457232}}]}, {"address": {"type": "absolute", "value": 4525896}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4457232}}]}, {"address": {"type": "absolute", "value": 4526192}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4351168}}]}, {"address": {"type": "absolute", "value": 4526200}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4457232}}]}, {"address": {"type": "absolute", "value": 4526211}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4457232}}]}, {"address": {"type": "absolute", "value": 4532208}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4532208}}]}]}, "feature_counts": {"file": 2655, "functions": [{"address": {"type": "absolute", "value": 4300810}, "count": 29}, {"address": {"type": "absolute", "value": 4300815}, "count": 31}, {"address": {"type": "absolute", "value": 4300820}, "count": 36}, {"address": {"type": "absolute", "value": 4300825}, "count": 38}, {"address": {"type": "absolute", "value": 4300835}, "count": 29}, {"address": {"type": "absolute", "value": 4300840}, "count": 65}, {"address": {"type": "absolute", "value": 4300850}, "count": 55}, {"address": {"type": "absolute", "value": 4300855}, "count": 29}, {"address": {"type": "absolute", "value": 4300865}, "count": 51}, {"address": {"type": "absolute", "value": 4300870}, "count": 33}, {"address": {"type": "absolute", "value": 4300875}, "count": 44}, {"address": {"type": "absolute", "value": 4300880}, "count": 26}, {"address": {"type": "absolute", "value": 4300885}, "count": 37}, {"address": {"type": "absolute", "value": 4300890}, "count": 41}, {"address": {"type": "absolute", "value": 4300895}, "count": 56}, {"address": {"type": "absolute", "value": 4300900}, "count": 35}, {"address": {"type": "absolute", "value": 4300905}, "count": 107}, {"address": {"type": "absolute", "value": 4300910}, "count": 37}, {"address": {"type": "absolute", "value": 4300915}, "count": 43}, {"address": {"type": "absolute", "value": 4300925}, "count": 36}, {"address": {"type": "absolute", "value": 4300930}, "count": 9}, {"address": {"type": "absolute", "value": 4300935}, "count": 11}, {"address": {"type": "absolute", "value": 4300945}, "count": 32}, {"address": {"type": "absolute", "value": 4300950}, "count": 35}, {"address": {"type": "absolute", "value": 4300955}, "count": 10}, {"address": {"type": "absolute", "value": 4300960}, "count": 37}, {"address": {"type": "absolute", "value": 4300965}, "count": 9}, {"address": {"type": "absolute", "value": 4300975}, "count": 53}, {"address": {"type": "absolute", "value": 4300980}, "count": 70}, {"address": {"type": "absolute", "value": 4300985}, "count": 29}, {"address": {"type": "absolute", "value": 4300990}, "count": 26}, {"address": {"type": "absolute", "value": 4300995}, "count": 9}, {"address": {"type": "absolute", "value": 4301000}, "count": 13}, {"address": {"type": "absolute", "value": 4301005}, "count": 62}, {"address": {"type": "absolute", "value": 4301010}, "count": 37}, {"address": {"type": "absolute", "value": 4301020}, "count": 9}, {"address": {"type": "absolute", "value": 4301025}, "count": 127}, {"address": {"type": "absolute", "value": 4301035}, "count": 24}, {"address": {"type": "absolute", "value": 4301050}, "count": 31}, {"address": {"type": "absolute", "value": 4301055}, "count": 32}, {"address": {"type": "absolute", "value": 4301060}, "count": 60}, {"address": {"type": "absolute", "value": 4301070}, "count": 32}, {"address": {"type": "absolute", "value": 4301075}, "count": 37}, {"address": {"type": "absolute", "value": 4301080}, "count": 32}, {"address": {"type": "absolute", "value": 4301085}, "count": 37}, {"address": {"type": "absolute", "value": 4301090}, "count": 30}, {"address": {"type": "absolute", "value": 4301095}, "count": 52}, {"address": {"type": "absolute", "value": 4301100}, "count": 12}, {"address": {"type": "absolute", "value": 4301110}, "count": 50}, {"address": {"type": "absolute", "value": 4301115}, "count": 35}, {"address": {"type": "absolute", "value": 4301120}, "count": 60}, {"address": {"type": "absolute", "value": 4301125}, "count": 83}, {"address": {"type": "absolute", "value": 4301130}, "count": 8}, {"address": {"type": "absolute", "value": 4301135}, "count": 26}, {"address": {"type": "absolute", "value": 4301140}, "count": 100}, {"address": {"type": "absolute", "value": 4301150}, "count": 63}, {"address": {"type": "absolute", "value": 4301155}, "count": 38}, {"address": {"type": "absolute", "value": 4301160}, "count": 54}, {"address": {"type": "absolute", "value": 4301165}, "count": 33}, {"address": {"type": "absolute", "value": 4301170}, "count": 11}, {"address": {"type": "absolute", "value": 4301175}, "count": 11}, {"address": {"type": "absolute", "value": 4301180}, "count": 11}, {"address": {"type": "absolute", "value": 4301190}, "count": 32}, {"address": {"type": "absolute", "value": 4301195}, "count": 42}, {"address": {"type": "absolute", "value": 4301200}, "count": 68}, {"address": {"type": "absolute", "value": 4301205}, "count": 35}, {"address": {"type": "absolute", "value": 4301210}, "count": 66}, {"address": {"type": "absolute", "value": 4301215}, "count": 36}, {"address": {"type": "absolute", "value": 4301220}, "count": 37}, {"address": {"type": "absolute", "value": 4301230}, "count": 36}, {"address": {"type": "absolute", "value": 4301240}, "count": 58}, {"address": {"type": "absolute", "value": 4301245}, "count": 36}, {"address": {"type": "absolute", "value": 4301255}, "count": 35}, {"address": {"type": "absolute", "value": 4301265}, "count": 62}, {"address": {"type": "absolute", "value": 4301270}, "count": 38}, {"address": {"type": "absolute", "value": 4301275}, "count": 55}, {"address": {"type": "absolute", "value": 4301280}, "count": 70}, {"address": {"type": "absolute", "value": 4301290}, "count": 9}, {"address": {"type": "absolute", "value": 4301295}, "count": 9}, {"address": {"type": "absolute", "value": 4301300}, "count": 34}, {"address": {"type": "absolute", "value": 4301305}, "count": 47}, {"address": {"type": "absolute", "value": 4301310}, "count": 34}, {"address": {"type": "absolute", "value": 4301315}, "count": 29}, {"address": {"type": "absolute", "value": 4301320}, "count": 28}, {"address": {"type": "absolute", "value": 4301330}, "count": 11}, {"address": {"type": "absolute", "value": 4301335}, "count": 36}, {"address": {"type": "absolute", "value": 4301345}, "count": 11}, {"address": {"type": "absolute", "value": 4301350}, "count": 9}, {"address": {"type": "absolute", "value": 4301355}, "count": 79}, {"address": {"type": "absolute", "value": 4301370}, "count": 52}, {"address": {"type": "absolute", "value": 4301375}, "count": 9}, {"address": {"type": "absolute", "value": 4301380}, "count": 55}, {"address": {"type": "absolute", "value": 4301385}, "count": 29}, {"address": {"type": "absolute", "value": 4301390}, "count": 34}, {"address": {"type": "absolute", "value": 4301395}, "count": 49}, {"address": {"type": "absolute", "value": 4301405}, "count": 41}, {"address": {"type": "absolute", "value": 4301410}, "count": 37}, {"address": {"type": "absolute", "value": 4301415}, "count": 17}, {"address": {"type": "absolute", "value": 4301420}, "count": 52}, {"address": {"type": "absolute", "value": 4301425}, "count": 35}, {"address": {"type": "absolute", "value": 4301435}, "count": 26}, {"address": {"type": "absolute", "value": 4301440}, "count": 45}, {"address": {"type": "absolute", "value": 4301445}, "count": 29}, {"address": {"type": "absolute", "value": 4301455}, "count": 41}, {"address": {"type": "absolute", "value": 4301460}, "count": 65}, {"address": {"type": "absolute", "value": 4301470}, "count": 9}, {"address": {"type": "absolute", "value": 4301475}, "count": 12}, {"address": {"type": "absolute", "value": 4301480}, "count": 37}, {"address": {"type": "absolute", "value": 4301485}, "count": 42}, {"address": {"type": "absolute", "value": 4301505}, "count": 51}, {"address": {"type": "absolute", "value": 4301510}, "count": 37}, {"address": {"type": "absolute", "value": 4301515}, "count": 50}, {"address": {"type": "absolute", "value": 4301520}, "count": 91}, {"address": {"type": "absolute", "value": 4301525}, "count": 35}, {"address": {"type": "absolute", "value": 4301530}, "count": 11}, {"address": {"type": "absolute", "value": 4301535}, "count": 38}, {"address": {"type": "absolute", "value": 4301545}, "count": 85}, {"address": {"type": "absolute", "value": 4301550}, "count": 36}, {"address": {"type": "absolute", "value": 4301555}, "count": 92}, {"address": {"type": "absolute", "value": 4301565}, "count": 20}, {"address": {"type": "absolute", "value": 4301570}, "count": 53}, {"address": {"type": "absolute", "value": 4301575}, "count": 35}, {"address": {"type": "absolute", "value": 4301580}, "count": 27}, {"address": {"type": "absolute", "value": 4301585}, "count": 35}, {"address": {"type": "absolute", "value": 4301590}, "count": 37}, {"address": {"type": "absolute", "value": 4301595}, "count": 29}, {"address": {"type": "absolute", "value": 4301600}, "count": 68}, {"address": {"type": "absolute", "value": 4301605}, "count": 37}, {"address": {"type": "absolute", "value": 4301615}, "count": 49}, {"address": {"type": "absolute", "value": 4301620}, "count": 11}, {"address": {"type": "absolute", "value": 4301625}, "count": 63}, {"address": {"type": "absolute", "value": 4301630}, "count": 31}, {"address": {"type": "absolute", "value": 4301635}, "count": 29}, {"address": {"type": "absolute", "value": 4301640}, "count": 20}, {"address": {"type": "absolute", "value": 4301650}, "count": 35}, {"address": {"type": "absolute", "value": 4301655}, "count": 27}, {"address": {"type": "absolute", "value": 4301665}, "count": 31}, {"address": {"type": "absolute", "value": 4301675}, "count": 12}, {"address": {"type": "absolute", "value": 4301690}, "count": 28}, {"address": {"type": "absolute", "value": 4301695}, "count": 35}, {"address": {"type": "absolute", "value": 4301700}, "count": 9}, {"address": {"type": "absolute", "value": 4301710}, "count": 36}, {"address": {"type": "absolute", "value": 4301715}, "count": 9}, {"address": {"type": "absolute", "value": 4301725}, "count": 35}, {"address": {"type": "absolute", "value": 4301730}, "count": 31}, {"address": {"type": "absolute", "value": 4301735}, "count": 11}, {"address": {"type": "absolute", "value": 4301740}, "count": 37}, {"address": {"type": "absolute", "value": 4301750}, "count": 24}, {"address": {"type": "absolute", "value": 4301755}, "count": 37}, {"address": {"type": "absolute", "value": 4301760}, "count": 62}, {"address": {"type": "absolute", "value": 4301765}, "count": 26}, {"address": {"type": "absolute", "value": 4301770}, "count": 14}, {"address": {"type": "absolute", "value": 4301780}, "count": 9}, {"address": {"type": "absolute", "value": 4301785}, "count": 119}, {"address": {"type": "absolute", "value": 4301790}, "count": 30}, {"address": {"type": "absolute", "value": 4301795}, "count": 9}, {"address": {"type": "absolute", "value": 4301800}, "count": 12}, {"address": {"type": "absolute", "value": 4301810}, "count": 29}, {"address": {"type": "absolute", "value": 4301815}, "count": 41}, {"address": {"type": "absolute", "value": 4301820}, "count": 26}, {"address": {"type": "absolute", "value": 4301825}, "count": 36}, {"address": {"type": "absolute", "value": 4301835}, "count": 106}, {"address": {"type": "absolute", "value": 4301860}, "count": 47}, {"address": {"type": "absolute", "value": 4301865}, "count": 32}, {"address": {"type": "absolute", "value": 4301870}, "count": 35}, {"address": {"type": "absolute", "value": 4301875}, "count": 29}, {"address": {"type": "absolute", "value": 4301880}, "count": 25}, {"address": {"type": "absolute", "value": 4301885}, "count": 36}, {"address": {"type": "absolute", "value": 4301895}, "count": 31}, {"address": {"type": "absolute", "value": 4301900}, "count": 34}, {"address": {"type": "absolute", "value": 4301905}, "count": 70}, {"address": {"type": "absolute", "value": 4301910}, "count": 37}, {"address": {"type": "absolute", "value": 4301915}, "count": 183}, {"address": {"type": "absolute", "value": 4301925}, "count": 29}, {"address": {"type": "absolute", "value": 4301935}, "count": 10}, {"address": {"type": "absolute", "value": 4301940}, "count": 61}, {"address": {"type": "absolute", "value": 4301950}, "count": 33}, {"address": {"type": "absolute", "value": 4301955}, "count": 38}, {"address": {"type": "absolute", "value": 4301960}, "count": 63}, {"address": {"type": "absolute", "value": 4301965}, "count": 20}, {"address": {"type": "absolute", "value": 4301970}, "count": 36}, {"address": {"type": "absolute", "value": 4301985}, "count": 34}, {"address": {"type": "absolute", "value": 4301995}, "count": 32}, {"address": {"type": "absolute", "value": 4302000}, "count": 29}, {"address": {"type": "absolute", "value": 4302015}, "count": 33}, {"address": {"type": "absolute", "value": 4302020}, "count": 71}, {"address": {"type": "absolute", "value": 4302035}, "count": 37}, {"address": {"type": "absolute", "value": 4302040}, "count": 52}, {"address": {"type": "absolute", "value": 4302045}, "count": 9}, {"address": {"type": "absolute", "value": 4302050}, "count": 12}, {"address": {"type": "absolute", "value": 4302060}, "count": 35}, {"address": {"type": "absolute", "value": 4302065}, "count": 9}, {"address": {"type": "absolute", "value": 4302070}, "count": 19}, {"address": {"type": "absolute", "value": 4302075}, "count": 28}, {"address": {"type": "absolute", "value": 4302080}, "count": 17}, {"address": {"type": "absolute", "value": 4302085}, "count": 57}, {"address": {"type": "absolute", "value": 4302100}, "count": 46}, {"address": {"type": "absolute", "value": 4302105}, "count": 49}, {"address": {"type": "absolute", "value": 4302110}, "count": 56}, {"address": {"type": "absolute", "value": 4302115}, "count": 31}, {"address": {"type": "absolute", "value": 4302120}, "count": 27}, {"address": {"type": "absolute", "value": 4302125}, "count": 58}, {"address": {"type": "absolute", "value": 4302130}, "count": 40}, {"address": {"type": "absolute", "value": 4302135}, "count": 9}, {"address": {"type": "absolute", "value": 4302140}, "count": 35}, {"address": {"type": "absolute", "value": 4302150}, "count": 29}, {"address": {"type": "absolute", "value": 4302155}, "count": 32}, {"address": {"type": "absolute", "value": 4302160}, "count": 45}, {"address": {"type": "absolute", "value": 4302165}, "count": 76}, {"address": {"type": "absolute", "value": 4302170}, "count": 76}, {"address": {"type": "absolute", "value": 4302175}, "count": 37}, {"address": {"type": "absolute", "value": 4302180}, "count": 26}, {"address": {"type": "absolute", "value": 4302190}, "count": 63}, {"address": {"type": "absolute", "value": 4302200}, "count": 35}, {"address": {"type": "absolute", "value": 4302205}, "count": 24}, {"address": {"type": "absolute", "value": 4302210}, "count": 12}, {"address": {"type": "absolute", "value": 4302215}, "count": 51}, {"address": {"type": "absolute", "value": 4302225}, "count": 32}, {"address": {"type": "absolute", "value": 4302230}, "count": 35}, {"address": {"type": "absolute", "value": 4302235}, "count": 58}, {"address": {"type": "absolute", "value": 4302240}, "count": 9}, {"address": {"type": "absolute", "value": 4302245}, "count": 31}, {"address": {"type": "absolute", "value": 4302250}, "count": 26}, {"address": {"type": "absolute", "value": 4302255}, "count": 37}, {"address": {"type": "absolute", "value": 4302260}, "count": 55}, {"address": {"type": "absolute", "value": 4302265}, "count": 11}, {"address": {"type": "absolute", "value": 4302270}, "count": 26}, {"address": {"type": "absolute", "value": 4302275}, "count": 39}, {"address": {"type": "absolute", "value": 4302280}, "count": 29}, {"address": {"type": "absolute", "value": 4302285}, "count": 55}, {"address": {"type": "absolute", "value": 4302290}, "count": 37}, {"address": {"type": "absolute", "value": 4302295}, "count": 36}, {"address": {"type": "absolute", "value": 4302300}, "count": 49}, {"address": {"type": "absolute", "value": 4302305}, "count": 65}, {"address": {"type": "absolute", "value": 4302320}, "count": 37}, {"address": {"type": "absolute", "value": 4302325}, "count": 29}, {"address": {"type": "absolute", "value": 4302335}, "count": 26}, {"address": {"type": "absolute", "value": 4302340}, "count": 30}, {"address": {"type": "absolute", "value": 4302345}, "count": 18}, {"address": {"type": "absolute", "value": 4302350}, "count": 28}, {"address": {"type": "absolute", "value": 4302355}, "count": 48}, {"address": {"type": "absolute", "value": 4302360}, "count": 43}, {"address": {"type": "absolute", "value": 4302365}, "count": 35}, {"address": {"type": "absolute", "value": 4302370}, "count": 37}, {"address": {"type": "absolute", "value": 4302375}, "count": 42}, {"address": {"type": "absolute", "value": 4302380}, "count": 32}, {"address": {"type": "absolute", "value": 4302395}, "count": 27}, {"address": {"type": "absolute", "value": 4302400}, "count": 12}, {"address": {"type": "absolute", "value": 4302405}, "count": 9}, {"address": {"type": "absolute", "value": 4302410}, "count": 37}, {"address": {"type": "absolute", "value": 4302415}, "count": 11}, {"address": {"type": "absolute", "value": 4302420}, "count": 67}, {"address": {"type": "absolute", "value": 4302425}, "count": 40}, {"address": {"type": "absolute", "value": 4302430}, "count": 28}, {"address": {"type": "absolute", "value": 4302435}, "count": 35}, {"address": {"type": "absolute", "value": 4302440}, "count": 26}, {"address": {"type": "absolute", "value": 4302445}, "count": 35}, {"address": {"type": "absolute", "value": 4302450}, "count": 58}, {"address": {"type": "absolute", "value": 4302460}, "count": 37}, {"address": {"type": "absolute", "value": 4302465}, "count": 46}, {"address": {"type": "absolute", "value": 4302470}, "count": 58}, {"address": {"type": "absolute", "value": 4302475}, "count": 55}, {"address": {"type": "absolute", "value": 4302480}, "count": 71}, {"address": {"type": "absolute", "value": 4302495}, "count": 66}, {"address": {"type": "absolute", "value": 4302510}, "count": 35}, {"address": {"type": "absolute", "value": 4302525}, "count": 29}, {"address": {"type": "absolute", "value": 4302530}, "count": 29}, {"address": {"type": "absolute", "value": 4302535}, "count": 52}, {"address": {"type": "absolute", "value": 4302550}, "count": 11}, {"address": {"type": "absolute", "value": 4302555}, "count": 16}, {"address": {"type": "absolute", "value": 4302560}, "count": 28}, {"address": {"type": "absolute", "value": 4302565}, "count": 43}, {"address": {"type": "absolute", "value": 4302570}, "count": 35}, {"address": {"type": "absolute", "value": 4302585}, "count": 34}, {"address": {"type": "absolute", "value": 4302590}, "count": 12}, {"address": {"type": "absolute", "value": 4302595}, "count": 46}, {"address": {"type": "absolute", "value": 4302600}, "count": 9}, {"address": {"type": "absolute", "value": 4302605}, "count": 9}, {"address": {"type": "absolute", "value": 4302610}, "count": 45}, {"address": {"type": "absolute", "value": 4302615}, "count": 55}, {"address": {"type": "absolute", "value": 4302620}, "count": 42}, {"address": {"type": "absolute", "value": 4302635}, "count": 72}, {"address": {"type": "absolute", "value": 4302640}, "count": 29}, {"address": {"type": "absolute", "value": 4302645}, "count": 35}, {"address": {"type": "absolute", "value": 4302655}, "count": 50}, {"address": {"type": "absolute", "value": 4302665}, "count": 26}, {"address": {"type": "absolute", "value": 4302670}, "count": 34}, {"address": {"type": "absolute", "value": 4302675}, "count": 28}, {"address": {"type": "absolute", "value": 4302685}, "count": 67}, {"address": {"type": "absolute", "value": 4302690}, "count": 37}, {"address": {"type": "absolute", "value": 4302695}, "count": 9}, {"address": {"type": "absolute", "value": 4302700}, "count": 50}, {"address": {"type": "absolute", "value": 4302705}, "count": 68}, {"address": {"type": "absolute", "value": 4302710}, "count": 42}, {"address": {"type": "absolute", "value": 4302715}, "count": 53}, {"address": {"type": "absolute", "value": 4302725}, "count": 9}, {"address": {"type": "absolute", "value": 4302730}, "count": 9}, {"address": {"type": "absolute", "value": 4302740}, "count": 52}, {"address": {"type": "absolute", "value": 4302745}, "count": 37}, {"address": {"type": "absolute", "value": 4302750}, "count": 55}, {"address": {"type": "absolute", "value": 4302755}, "count": 14}, {"address": {"type": "absolute", "value": 4302765}, "count": 40}, {"address": {"type": "absolute", "value": 4302770}, "count": 29}, {"address": {"type": "absolute", "value": 4302775}, "count": 29}, {"address": {"type": "absolute", "value": 4302780}, "count": 36}, {"address": {"type": "absolute", "value": 4302785}, "count": 55}, {"address": {"type": "absolute", "value": 4302790}, "count": 36}, {"address": {"type": "absolute", "value": 4302795}, "count": 35}, {"address": {"type": "absolute", "value": 4302800}, "count": 8}, {"address": {"type": "absolute", "value": 4302810}, "count": 55}, {"address": {"type": "absolute", "value": 4302815}, "count": 35}, {"address": {"type": "absolute", "value": 4302825}, "count": 9}, {"address": {"type": "absolute", "value": 4302830}, "count": 82}, {"address": {"type": "absolute", "value": 4302835}, "count": 25}, {"address": {"type": "absolute", "value": 4302840}, "count": 35}, {"address": {"type": "absolute", "value": 4302845}, "count": 36}, {"address": {"type": "absolute", "value": 4302860}, "count": 26}, {"address": {"type": "absolute", "value": 4302865}, "count": 30}, {"address": {"type": "absolute", "value": 4302870}, "count": 29}, {"address": {"type": "absolute", "value": 4302875}, "count": 40}, {"address": {"type": "absolute", "value": 4302880}, "count": 35}, {"address": {"type": "absolute", "value": 4302885}, "count": 24}, {"address": {"type": "absolute", "value": 4302890}, "count": 32}, {"address": {"type": "absolute", "value": 4302895}, "count": 32}, {"address": {"type": "absolute", "value": 4302900}, "count": 48}, {"address": {"type": "absolute", "value": 4302910}, "count": 37}, {"address": {"type": "absolute", "value": 4302915}, "count": 68}, {"address": {"type": "absolute", "value": 4302920}, "count": 53}, {"address": {"type": "absolute", "value": 4302925}, "count": 52}, {"address": {"type": "absolute", "value": 4302930}, "count": 26}, {"address": {"type": "absolute", "value": 4302935}, "count": 56}, {"address": {"type": "absolute", "value": 4302940}, "count": 30}, {"address": {"type": "absolute", "value": 4302950}, "count": 53}, {"address": {"type": "absolute", "value": 4302955}, "count": 32}, {"address": {"type": "absolute", "value": 4302960}, "count": 37}, {"address": {"type": "absolute", "value": 4302965}, "count": 39}, {"address": {"type": "absolute", "value": 4302970}, "count": 72}, {"address": {"type": "absolute", "value": 4302975}, "count": 52}, {"address": {"type": "absolute", "value": 4302980}, "count": 36}, {"address": {"type": "absolute", "value": 4302995}, "count": 110}, {"address": {"type": "absolute", "value": 4303000}, "count": 55}, {"address": {"type": "absolute", "value": 4303015}, "count": 42}, {"address": {"type": "absolute", "value": 4303020}, "count": 35}, {"address": {"type": "absolute", "value": 4303025}, "count": 77}, {"address": {"type": "absolute", "value": 4303030}, "count": 31}, {"address": {"type": "absolute", "value": 4303035}, "count": 15}, {"address": {"type": "absolute", "value": 4303040}, "count": 36}, {"address": {"type": "absolute", "value": 4303050}, "count": 34}, {"address": {"type": "absolute", "value": 4303055}, "count": 44}, {"address": {"type": "absolute", "value": 4303060}, "count": 37}, {"address": {"type": "absolute", "value": 4303065}, "count": 35}, {"address": {"type": "absolute", "value": 4303075}, "count": 36}, {"address": {"type": "absolute", "value": 4303080}, "count": 9}, {"address": {"type": "absolute", "value": 4303085}, "count": 10}, {"address": {"type": "absolute", "value": 4303090}, "count": 9}, {"address": {"type": "absolute", "value": 4303095}, "count": 53}, {"address": {"type": "absolute", "value": 4303100}, "count": 31}, {"address": {"type": "absolute", "value": 4303105}, "count": 43}, {"address": {"type": "absolute", "value": 4303110}, "count": 35}, {"address": {"type": "absolute", "value": 4303115}, "count": 31}, {"address": {"type": "absolute", "value": 4303130}, "count": 68}, {"address": {"type": "absolute", "value": 4303140}, "count": 10}, {"address": {"type": "absolute", "value": 4303145}, "count": 12}, {"address": {"type": "absolute", "value": 4303155}, "count": 42}, {"address": {"type": "absolute", "value": 4303160}, "count": 56}, {"address": {"type": "absolute", "value": 4303165}, "count": 38}, {"address": {"type": "absolute", "value": 4303170}, "count": 24}, {"address": {"type": "absolute", "value": 4303175}, "count": 43}, {"address": {"type": "absolute", "value": 4303180}, "count": 34}, {"address": {"type": "absolute", "value": 4303190}, "count": 9}, {"address": {"type": "absolute", "value": 4303195}, "count": 38}, {"address": {"type": "absolute", "value": 4303200}, "count": 32}, {"address": {"type": "absolute", "value": 4303205}, "count": 32}, {"address": {"type": "absolute", "value": 4303210}, "count": 47}, {"address": {"type": "absolute", "value": 4303220}, "count": 37}, {"address": {"type": "absolute", "value": 4303225}, "count": 26}, {"address": {"type": "absolute", "value": 4303230}, "count": 34}, {"address": {"type": "absolute", "value": 4303235}, "count": 36}, {"address": {"type": "absolute", "value": 4303245}, "count": 19}, {"address": {"type": "absolute", "value": 4303265}, "count": 42}, {"address": {"type": "absolute", "value": 4303270}, "count": 70}, {"address": {"type": "absolute", "value": 4303275}, "count": 34}, {"address": {"type": "absolute", "value": 4303280}, "count": 26}, {"address": {"type": "absolute", "value": 4303285}, "count": 20}, {"address": {"type": "absolute", "value": 4303290}, "count": 37}, {"address": {"type": "absolute", "value": 4303295}, "count": 43}, {"address": {"type": "absolute", "value": 4303305}, "count": 46}, {"address": {"type": "absolute", "value": 4303310}, "count": 26}, {"address": {"type": "absolute", "value": 4303320}, "count": 42}, {"address": {"type": "absolute", "value": 4303325}, "count": 34}, {"address": {"type": "absolute", "value": 4303330}, "count": 47}, {"address": {"type": "absolute", "value": 4303335}, "count": 42}, {"address": {"type": "absolute", "value": 4303340}, "count": 37}, {"address": {"type": "absolute", "value": 4303350}, "count": 9}, {"address": {"type": "absolute", "value": 4303355}, "count": 66}, {"address": {"type": "absolute", "value": 4303365}, "count": 29}, {"address": {"type": "absolute", "value": 4303375}, "count": 13}, {"address": {"type": "absolute", "value": 4303380}, "count": 37}, {"address": {"type": "absolute", "value": 4303385}, "count": 37}, {"address": {"type": "absolute", "value": 4303400}, "count": 35}, {"address": {"type": "absolute", "value": 4303410}, "count": 58}, {"address": {"type": "absolute", "value": 4303415}, "count": 67}, {"address": {"type": "absolute", "value": 4303420}, "count": 27}, {"address": {"type": "absolute", "value": 4303425}, "count": 26}, {"address": {"type": "absolute", "value": 4303430}, "count": 74}, {"address": {"type": "absolute", "value": 4303450}, "count": 31}, {"address": {"type": "absolute", "value": 4303455}, "count": 39}, {"address": {"type": "absolute", "value": 4303460}, "count": 59}, {"address": {"type": "absolute", "value": 4303465}, "count": 14}, {"address": {"type": "absolute", "value": 4303470}, "count": 58}, {"address": {"type": "absolute", "value": 4303475}, "count": 32}, {"address": {"type": "absolute", "value": 4303480}, "count": 28}, {"address": {"type": "absolute", "value": 4303485}, "count": 37}, {"address": {"type": "absolute", "value": 4303490}, "count": 60}, {"address": {"type": "absolute", "value": 4303495}, "count": 43}, {"address": {"type": "absolute", "value": 4303505}, "count": 79}, {"address": {"type": "absolute", "value": 4303510}, "count": 72}, {"address": {"type": "absolute", "value": 4303520}, "count": 29}, {"address": {"type": "absolute", "value": 4303525}, "count": 36}, {"address": {"type": "absolute", "value": 4303530}, "count": 37}, {"address": {"type": "absolute", "value": 4303535}, "count": 37}, {"address": {"type": "absolute", "value": 4303540}, "count": 44}, {"address": {"type": "absolute", "value": 4303550}, "count": 48}, {"address": {"type": "absolute", "value": 4303555}, "count": 62}, {"address": {"type": "absolute", "value": 4303575}, "count": 37}, {"address": {"type": "absolute", "value": 4303580}, "count": 36}, {"address": {"type": "absolute", "value": 4303585}, "count": 31}, {"address": {"type": "absolute", "value": 4303595}, "count": 35}, {"address": {"type": "absolute", "value": 4303605}, "count": 9}, {"address": {"type": "absolute", "value": 4303615}, "count": 30}, {"address": {"type": "absolute", "value": 4303620}, "count": 52}, {"address": {"type": "absolute", "value": 4303625}, "count": 11}, {"address": {"type": "absolute", "value": 4303630}, "count": 12}, {"address": {"type": "absolute", "value": 4303635}, "count": 36}, {"address": {"type": "absolute", "value": 4303640}, "count": 34}, {"address": {"type": "absolute", "value": 4303645}, "count": 31}, {"address": {"type": "absolute", "value": 4303650}, "count": 20}, {"address": {"type": "absolute", "value": 4303655}, "count": 29}, {"address": {"type": "absolute", "value": 4303660}, "count": 32}, {"address": {"type": "absolute", "value": 4303665}, "count": 35}, {"address": {"type": "absolute", "value": 4303675}, "count": 29}, {"address": {"type": "absolute", "value": 4303680}, "count": 26}, {"address": {"type": "absolute", "value": 4303690}, "count": 36}, {"address": {"type": "absolute", "value": 4303700}, "count": 49}, {"address": {"type": "absolute", "value": 4303710}, "count": 57}, {"address": {"type": "absolute", "value": 4303715}, "count": 9}, {"address": {"type": "absolute", "value": 4303720}, "count": 37}, {"address": {"type": "absolute", "value": 4303725}, "count": 33}, {"address": {"type": "absolute", "value": 4303735}, "count": 58}, {"address": {"type": "absolute", "value": 4303745}, "count": 54}, {"address": {"type": "absolute", "value": 4303755}, "count": 26}, {"address": {"type": "absolute", "value": 4303765}, "count": 36}, {"address": {"type": "absolute", "value": 4303770}, "count": 46}, {"address": {"type": "absolute", "value": 4303775}, "count": 41}, {"address": {"type": "absolute", "value": 4303780}, "count": 106}, {"address": {"type": "absolute", "value": 4303790}, "count": 34}, {"address": {"type": "absolute", "value": 4303795}, "count": 35}, {"address": {"type": "absolute", "value": 4303800}, "count": 49}, {"address": {"type": "absolute", "value": 4303805}, "count": 29}, {"address": {"type": "absolute", "value": 4303815}, "count": 36}, {"address": {"type": "absolute", "value": 4303820}, "count": 37}, {"address": {"type": "absolute", "value": 4303825}, "count": 48}, {"address": {"type": "absolute", "value": 4303830}, "count": 14}, {"address": {"type": "absolute", "value": 4303835}, "count": 32}, {"address": {"type": "absolute", "value": 4303840}, "count": 38}, {"address": {"type": "absolute", "value": 4303845}, "count": 14}, {"address": {"type": "absolute", "value": 4303855}, "count": 12}, {"address": {"type": "absolute", "value": 4303860}, "count": 28}, {"address": {"type": "absolute", "value": 4303865}, "count": 42}, {"address": {"type": "absolute", "value": 4303870}, "count": 31}, {"address": {"type": "absolute", "value": 4303875}, "count": 20}, {"address": {"type": "absolute", "value": 4303880}, "count": 86}, {"address": {"type": "absolute", "value": 4303890}, "count": 37}, {"address": {"type": "absolute", "value": 4303895}, "count": 37}, {"address": {"type": "absolute", "value": 4303905}, "count": 20}, {"address": {"type": "absolute", "value": 4303910}, "count": 35}, {"address": {"type": "absolute", "value": 4303915}, "count": 42}, {"address": {"type": "absolute", "value": 4303920}, "count": 55}, {"address": {"type": "absolute", "value": 4303925}, "count": 65}, {"address": {"type": "absolute", "value": 4303930}, "count": 44}, {"address": {"type": "absolute", "value": 4303935}, "count": 26}, {"address": {"type": "absolute", "value": 4303940}, "count": 9}, {"address": {"type": "absolute", "value": 4303945}, "count": 13}, {"address": {"type": "absolute", "value": 4303950}, "count": 78}, {"address": {"type": "absolute", "value": 4303955}, "count": 36}, {"address": {"type": "absolute", "value": 4303960}, "count": 29}, {"address": {"type": "absolute", "value": 4303965}, "count": 36}, {"address": {"type": "absolute", "value": 4303970}, "count": 35}, {"address": {"type": "absolute", "value": 4303985}, "count": 37}, {"address": {"type": "absolute", "value": 4303990}, "count": 63}, {"address": {"type": "absolute", "value": 4304000}, "count": 29}, {"address": {"type": "absolute", "value": 4304015}, "count": 9}, {"address": {"type": "absolute", "value": 4304020}, "count": 34}, {"address": {"type": "absolute", "value": 4304025}, "count": 9}, {"address": {"type": "absolute", "value": 4304030}, "count": 30}, {"address": {"type": "absolute", "value": 4304040}, "count": 14}, {"address": {"type": "absolute", "value": 4304045}, "count": 29}, {"address": {"type": "absolute", "value": 4304060}, "count": 34}, {"address": {"type": "absolute", "value": 4304065}, "count": 10}, {"address": {"type": "absolute", "value": 4304070}, "count": 42}, {"address": {"type": "absolute", "value": 4304075}, "count": 35}, {"address": {"type": "absolute", "value": 4304080}, "count": 29}, {"address": {"type": "absolute", "value": 4304085}, "count": 26}, {"address": {"type": "absolute", "value": 4304090}, "count": 65}, {"address": {"type": "absolute", "value": 4304095}, "count": 64}, {"address": {"type": "absolute", "value": 4304100}, "count": 36}, {"address": {"type": "absolute", "value": 4304105}, "count": 118}, {"address": {"type": "absolute", "value": 4304110}, "count": 48}, {"address": {"type": "absolute", "value": 4304115}, "count": 35}, {"address": {"type": "absolute", "value": 4304120}, "count": 26}, {"address": {"type": "absolute", "value": 4304125}, "count": 31}, {"address": {"type": "absolute", "value": 4304130}, "count": 58}, {"address": {"type": "absolute", "value": 4304135}, "count": 26}, {"address": {"type": "absolute", "value": 4304140}, "count": 37}, {"address": {"type": "absolute", "value": 4304145}, "count": 76}, {"address": {"type": "absolute", "value": 4304150}, "count": 32}, {"address": {"type": "absolute", "value": 4304155}, "count": 42}, {"address": {"type": "absolute", "value": 4304160}, "count": 62}, {"address": {"type": "absolute", "value": 4304165}, "count": 37}, {"address": {"type": "absolute", "value": 4304175}, "count": 35}, {"address": {"type": "absolute", "value": 4304185}, "count": 34}, {"address": {"type": "absolute", "value": 4304190}, "count": 29}, {"address": {"type": "absolute", "value": 4304195}, "count": 29}, {"address": {"type": "absolute", "value": 4304205}, "count": 20}, {"address": {"type": "absolute", "value": 4304215}, "count": 37}, {"address": {"type": "absolute", "value": 4304220}, "count": 9}, {"address": {"type": "absolute", "value": 4304225}, "count": 87}, {"address": {"type": "absolute", "value": 4304235}, "count": 34}, {"address": {"type": "absolute", "value": 4304240}, "count": 38}, {"address": {"type": "absolute", "value": 4304245}, "count": 9}, {"address": {"type": "absolute", "value": 4304250}, "count": 37}, {"address": {"type": "absolute", "value": 4304255}, "count": 9}, {"address": {"type": "absolute", "value": 4304260}, "count": 9}, {"address": {"type": "absolute", "value": 4304265}, "count": 42}, {"address": {"type": "absolute", "value": 4304270}, "count": 26}, {"address": {"type": "absolute", "value": 4304275}, "count": 52}, {"address": {"type": "absolute", "value": 4304280}, "count": 44}, {"address": {"type": "absolute", "value": 4304295}, "count": 9}, {"address": {"type": "absolute", "value": 4304300}, "count": 50}, {"address": {"type": "absolute", "value": 4304305}, "count": 9}, {"address": {"type": "absolute", "value": 4304310}, "count": 34}, {"address": {"type": "absolute", "value": 4304315}, "count": 70}, {"address": {"type": "absolute", "value": 4304325}, "count": 44}, {"address": {"type": "absolute", "value": 4304330}, "count": 28}, {"address": {"type": "absolute", "value": 4304335}, "count": 34}, {"address": {"type": "absolute", "value": 4304340}, "count": 64}, {"address": {"type": "absolute", "value": 4304350}, "count": 24}, {"address": {"type": "absolute", "value": 4304355}, "count": 9}, {"address": {"type": "absolute", "value": 4304360}, "count": 77}, {"address": {"type": "absolute", "value": 4304365}, "count": 37}, {"address": {"type": "absolute", "value": 4304370}, "count": 14}, {"address": {"type": "absolute", "value": 4304375}, "count": 16}, {"address": {"type": "absolute", "value": 4304380}, "count": 29}, {"address": {"type": "absolute", "value": 4304385}, "count": 29}, {"address": {"type": "absolute", "value": 4304390}, "count": 32}, {"address": {"type": "absolute", "value": 4304395}, "count": 35}, {"address": {"type": "absolute", "value": 4304400}, "count": 30}, {"address": {"type": "absolute", "value": 4304405}, "count": 29}, {"address": {"type": "absolute", "value": 4304410}, "count": 56}, {"address": {"type": "absolute", "value": 4304415}, "count": 11}, {"address": {"type": "absolute", "value": 4304430}, "count": 46}, {"address": {"type": "absolute", "value": 4304440}, "count": 72}, {"address": {"type": "absolute", "value": 4304445}, "count": 26}, {"address": {"type": "absolute", "value": 4304460}, "count": 17}, {"address": {"type": "absolute", "value": 4304465}, "count": 72}, {"address": {"type": "absolute", "value": 4304470}, "count": 19}, {"address": {"type": "absolute", "value": 4304475}, "count": 33}, {"address": {"type": "absolute", "value": 4304480}, "count": 24}, {"address": {"type": "absolute", "value": 4304490}, "count": 54}, {"address": {"type": "absolute", "value": 4304495}, "count": 12}, {"address": {"type": "absolute", "value": 4304500}, "count": 40}, {"address": {"type": "absolute", "value": 4304505}, "count": 34}, {"address": {"type": "absolute", "value": 4304510}, "count": 9}, {"address": {"type": "absolute", "value": 4304515}, "count": 12}, {"address": {"type": "absolute", "value": 4304520}, "count": 96}, {"address": {"type": "absolute", "value": 4304535}, "count": 27}, {"address": {"type": "absolute", "value": 4304540}, "count": 301}, {"address": {"type": "absolute", "value": 4304545}, "count": 27}, {"address": {"type": "absolute", "value": 4304550}, "count": 43}, {"address": {"type": "absolute", "value": 4304560}, "count": 9}, {"address": {"type": "absolute", "value": 4304570}, "count": 35}, {"address": {"type": "absolute", "value": 4304580}, "count": 10}, {"address": {"type": "absolute", "value": 4304595}, "count": 35}, {"address": {"type": "absolute", "value": 4304605}, "count": 100}, {"address": {"type": "absolute", "value": 4304610}, "count": 42}, {"address": {"type": "absolute", "value": 4304620}, "count": 48}, {"address": {"type": "absolute", "value": 4304625}, "count": 39}, {"address": {"type": "absolute", "value": 4304630}, "count": 38}, {"address": {"type": "absolute", "value": 4304635}, "count": 62}, {"address": {"type": "absolute", "value": 4304645}, "count": 78}, {"address": {"type": "absolute", "value": 4304650}, "count": 12}, {"address": {"type": "absolute", "value": 4304660}, "count": 29}, {"address": {"type": "absolute", "value": 4304665}, "count": 42}, {"address": {"type": "absolute", "value": 4304670}, "count": 24}, {"address": {"type": "absolute", "value": 4304675}, "count": 32}, {"address": {"type": "absolute", "value": 4304680}, "count": 9}, {"address": {"type": "absolute", "value": 4304685}, "count": 44}, {"address": {"type": "absolute", "value": 4304690}, "count": 32}, {"address": {"type": "absolute", "value": 4304705}, "count": 34}, {"address": {"type": "absolute", "value": 4304710}, "count": 11}, {"address": {"type": "absolute", "value": 4304715}, "count": 26}, {"address": {"type": "absolute", "value": 4304725}, "count": 32}, {"address": {"type": "absolute", "value": 4304730}, "count": 12}, {"address": {"type": "absolute", "value": 4304735}, "count": 81}, {"address": {"type": "absolute", "value": 4304740}, "count": 52}, {"address": {"type": "absolute", "value": 4304745}, "count": 31}, {"address": {"type": "absolute", "value": 4304750}, "count": 29}, {"address": {"type": "absolute", "value": 4304755}, "count": 9}, {"address": {"type": "absolute", "value": 4304770}, "count": 60}, {"address": {"type": "absolute", "value": 4304775}, "count": 38}, {"address": {"type": "absolute", "value": 4304780}, "count": 38}, {"address": {"type": "absolute", "value": 4304785}, "count": 49}, {"address": {"type": "absolute", "value": 4304790}, "count": 37}, {"address": {"type": "absolute", "value": 4304795}, "count": 33}, {"address": {"type": "absolute", "value": 4304800}, "count": 14}, {"address": {"type": "absolute", "value": 4304805}, "count": 46}, {"address": {"type": "absolute", "value": 4304810}, "count": 31}, {"address": {"type": "absolute", "value": 4304815}, "count": 9}, {"address": {"type": "absolute", "value": 4304820}, "count": 12}, {"address": {"type": "absolute", "value": 4304830}, "count": 29}, {"address": {"type": "absolute", "value": 4304835}, "count": 29}, {"address": {"type": "absolute", "value": 4304845}, "count": 70}, {"address": {"type": "absolute", "value": 4304850}, "count": 35}, {"address": {"type": "absolute", "value": 4304860}, "count": 38}, {"address": {"type": "absolute", "value": 4304870}, "count": 45}, {"address": {"type": "absolute", "value": 4304875}, "count": 38}, {"address": {"type": "absolute", "value": 4304880}, "count": 30}, {"address": {"type": "absolute", "value": 4304890}, "count": 39}, {"address": {"type": "absolute", "value": 4304895}, "count": 14}, {"address": {"type": "absolute", "value": 4304900}, "count": 32}, {"address": {"type": "absolute", "value": 4304910}, "count": 36}, {"address": {"type": "absolute", "value": 4304920}, "count": 42}, {"address": {"type": "absolute", "value": 4304930}, "count": 35}, {"address": {"type": "absolute", "value": 4304935}, "count": 35}, {"address": {"type": "absolute", "value": 4304940}, "count": 26}, {"address": {"type": "absolute", "value": 4304945}, "count": 50}, {"address": {"type": "absolute", "value": 4304950}, "count": 35}, {"address": {"type": "absolute", "value": 4304955}, "count": 11}, {"address": {"type": "absolute", "value": 4304965}, "count": 48}, {"address": {"type": "absolute", "value": 4304970}, "count": 32}, {"address": {"type": "absolute", "value": 4304975}, "count": 55}, {"address": {"type": "absolute", "value": 4304980}, "count": 34}, {"address": {"type": "absolute", "value": 4304995}, "count": 82}, {"address": {"type": "absolute", "value": 4305005}, "count": 55}, {"address": {"type": "absolute", "value": 4305010}, "count": 66}, {"address": {"type": "absolute", "value": 4305025}, "count": 28}, {"address": {"type": "absolute", "value": 4305030}, "count": 10}, {"address": {"type": "absolute", "value": 4305040}, "count": 37}, {"address": {"type": "absolute", "value": 4305045}, "count": 35}, {"address": {"type": "absolute", "value": 4305050}, "count": 37}, {"address": {"type": "absolute", "value": 4305055}, "count": 29}, {"address": {"type": "absolute", "value": 4305065}, "count": 47}, {"address": {"type": "absolute", "value": 4305070}, "count": 41}, {"address": {"type": "absolute", "value": 4305075}, "count": 26}, {"address": {"type": "absolute", "value": 4305080}, "count": 41}, {"address": {"type": "absolute", "value": 4305085}, "count": 55}, {"address": {"type": "absolute", "value": 4305090}, "count": 36}, {"address": {"type": "absolute", "value": 4305095}, "count": 9}, {"address": {"type": "absolute", "value": 4305115}, "count": 55}, {"address": {"type": "absolute", "value": 4305120}, "count": 59}, {"address": {"type": "absolute", "value": 4305125}, "count": 27}, {"address": {"type": "absolute", "value": 4305130}, "count": 9}, {"address": {"type": "absolute", "value": 4305140}, "count": 32}, {"address": {"type": "absolute", "value": 4305145}, "count": 31}, {"address": {"type": "absolute", "value": 4305150}, "count": 46}, {"address": {"type": "absolute", "value": 4305155}, "count": 32}, {"address": {"type": "absolute", "value": 4305160}, "count": 37}, {"address": {"type": "absolute", "value": 4305165}, "count": 37}, {"address": {"type": "absolute", "value": 4305170}, "count": 9}, {"address": {"type": "absolute", "value": 4305185}, "count": 56}, {"address": {"type": "absolute", "value": 4305190}, "count": 53}, {"address": {"type": "absolute", "value": 4305195}, "count": 46}, {"address": {"type": "absolute", "value": 4305205}, "count": 35}, {"address": {"type": "absolute", "value": 4305210}, "count": 9}, {"address": {"type": "absolute", "value": 4305220}, "count": 47}, {"address": {"type": "absolute", "value": 4305225}, "count": 35}, {"address": {"type": "absolute", "value": 4305230}, "count": 57}, {"address": {"type": "absolute", "value": 4305235}, "count": 44}, {"address": {"type": "absolute", "value": 4305245}, "count": 9}, {"address": {"type": "absolute", "value": 4305250}, "count": 29}, {"address": {"type": "absolute", "value": 4305255}, "count": 31}, {"address": {"type": "absolute", "value": 4305260}, "count": 26}, {"address": {"type": "absolute", "value": 4305270}, "count": 34}, {"address": {"type": "absolute", "value": 4305275}, "count": 35}, {"address": {"type": "absolute", "value": 4305280}, "count": 12}, {"address": {"type": "absolute", "value": 4305285}, "count": 29}, {"address": {"type": "absolute", "value": 4305290}, "count": 28}, {"address": {"type": "absolute", "value": 4305295}, "count": 44}, {"address": {"type": "absolute", "value": 4305300}, "count": 40}, {"address": {"type": "absolute", "value": 4305310}, "count": 19}, {"address": {"type": "absolute", "value": 4305315}, "count": 57}, {"address": {"type": "absolute", "value": 4305320}, "count": 9}, {"address": {"type": "absolute", "value": 4305325}, "count": 39}, {"address": {"type": "absolute", "value": 4305330}, "count": 55}, {"address": {"type": "absolute", "value": 4305335}, "count": 32}, {"address": {"type": "absolute", "value": 4305340}, "count": 9}, {"address": {"type": "absolute", "value": 4305345}, "count": 29}, {"address": {"type": "absolute", "value": 4305350}, "count": 35}, {"address": {"type": "absolute", "value": 4305355}, "count": 28}, {"address": {"type": "absolute", "value": 4305360}, "count": 93}, {"address": {"type": "absolute", "value": 4305365}, "count": 29}, {"address": {"type": "absolute", "value": 4305370}, "count": 12}, {"address": {"type": "absolute", "value": 4305375}, "count": 34}, {"address": {"type": "absolute", "value": 4305380}, "count": 26}, {"address": {"type": "absolute", "value": 4305390}, "count": 29}, {"address": {"type": "absolute", "value": 4305395}, "count": 37}, {"address": {"type": "absolute", "value": 4305405}, "count": 36}, {"address": {"type": "absolute", "value": 4305410}, "count": 25}, {"address": {"type": "absolute", "value": 4305425}, "count": 31}, {"address": {"type": "absolute", "value": 4305430}, "count": 35}, {"address": {"type": "absolute", "value": 4305435}, "count": 36}, {"address": {"type": "absolute", "value": 4305445}, "count": 159}, {"address": {"type": "absolute", "value": 4305450}, "count": 19}, {"address": {"type": "absolute", "value": 4305460}, "count": 29}, {"address": {"type": "absolute", "value": 4305465}, "count": 29}, {"address": {"type": "absolute", "value": 4305475}, "count": 41}, {"address": {"type": "absolute", "value": 4305480}, "count": 36}, {"address": {"type": "absolute", "value": 4305485}, "count": 79}, {"address": {"type": "absolute", "value": 4305490}, "count": 12}, {"address": {"type": "absolute", "value": 4305495}, "count": 111}, {"address": {"type": "absolute", "value": 4305500}, "count": 29}, {"address": {"type": "absolute", "value": 4305510}, "count": 37}, {"address": {"type": "absolute", "value": 4305515}, "count": 16}, {"address": {"type": "absolute", "value": 4305525}, "count": 22}, {"address": {"type": "absolute", "value": 4305535}, "count": 9}, {"address": {"type": "absolute", "value": 4305550}, "count": 65}, {"address": {"type": "absolute", "value": 4305555}, "count": 37}, {"address": {"type": "absolute", "value": 4305560}, "count": 81}, {"address": {"type": "absolute", "value": 4305565}, "count": 29}, {"address": {"type": "absolute", "value": 4305570}, "count": 112}, {"address": {"type": "absolute", "value": 4305575}, "count": 40}, {"address": {"type": "absolute", "value": 4305580}, "count": 29}, {"address": {"type": "absolute", "value": 4305585}, "count": 15}, {"address": {"type": "absolute", "value": 4305600}, "count": 40}, {"address": {"type": "absolute", "value": 4305610}, "count": 29}, {"address": {"type": "absolute", "value": 4305620}, "count": 24}, {"address": {"type": "absolute", "value": 4305630}, "count": 29}, {"address": {"type": "absolute", "value": 4305635}, "count": 9}, {"address": {"type": "absolute", "value": 4305645}, "count": 30}, {"address": {"type": "absolute", "value": 4305650}, "count": 9}, {"address": {"type": "absolute", "value": 4305655}, "count": 58}, {"address": {"type": "absolute", "value": 4305660}, "count": 9}, {"address": {"type": "absolute", "value": 4305665}, "count": 32}, {"address": {"type": "absolute", "value": 4305675}, "count": 35}, {"address": {"type": "absolute", "value": 4305680}, "count": 29}, {"address": {"type": "absolute", "value": 4305685}, "count": 18}, {"address": {"type": "absolute", "value": 4305690}, "count": 26}, {"address": {"type": "absolute", "value": 4305695}, "count": 36}, {"address": {"type": "absolute", "value": 4305700}, "count": 52}, {"address": {"type": "absolute", "value": 4305705}, "count": 37}, {"address": {"type": "absolute", "value": 4305715}, "count": 55}, {"address": {"type": "absolute", "value": 4305720}, "count": 29}, {"address": {"type": "absolute", "value": 4305725}, "count": 26}, {"address": {"type": "absolute", "value": 4305730}, "count": 29}, {"address": {"type": "absolute", "value": 4305735}, "count": 32}, {"address": {"type": "absolute", "value": 4305740}, "count": 47}, {"address": {"type": "absolute", "value": 4305745}, "count": 30}, {"address": {"type": "absolute", "value": 4305750}, "count": 11}, {"address": {"type": "absolute", "value": 4305765}, "count": 71}, {"address": {"type": "absolute", "value": 4305775}, "count": 26}, {"address": {"type": "absolute", "value": 4305780}, "count": 13}, {"address": {"type": "absolute", "value": 4305785}, "count": 34}, {"address": {"type": "absolute", "value": 4305790}, "count": 18}, {"address": {"type": "absolute", "value": 4305800}, "count": 29}, {"address": {"type": "absolute", "value": 4305805}, "count": 29}, {"address": {"type": "absolute", "value": 4305810}, "count": 38}, {"address": {"type": "absolute", "value": 4305815}, "count": 57}, {"address": {"type": "absolute", "value": 4305820}, "count": 117}, {"address": {"type": "absolute", "value": 4305825}, "count": 31}, {"address": {"type": "absolute", "value": 4305830}, "count": 37}, {"address": {"type": "absolute", "value": 4305840}, "count": 9}, {"address": {"type": "absolute", "value": 4305845}, "count": 53}, {"address": {"type": "absolute", "value": 4305850}, "count": 34}, {"address": {"type": "absolute", "value": 4305855}, "count": 26}, {"address": {"type": "absolute", "value": 4310928}, "count": 27}, {"address": {"type": "absolute", "value": 4311056}, "count": 63}, {"address": {"type": "absolute", "value": 4311408}, "count": 109}, {"address": {"type": "absolute", "value": 4312432}, "count": 63}, {"address": {"type": "absolute", "value": 4325724}, "count": 20}, {"address": {"type": "absolute", "value": 4326006}, "count": 20}, {"address": {"type": "absolute", "value": 4326736}, "count": 39}, {"address": {"type": "absolute", "value": 4326864}, "count": 28}, {"address": {"type": "absolute", "value": 4327024}, "count": 48}, {"address": {"type": "absolute", "value": 4327568}, "count": 17}, {"address": {"type": "absolute", "value": 4327622}, "count": 26}, {"address": {"type": "absolute", "value": 4336094}, "count": 14}, {"address": {"type": "absolute", "value": 4336159}, "count": 23}, {"address": {"type": "absolute", "value": 4361150}, "count": 14}, {"address": {"type": "absolute", "value": 4361215}, "count": 23}, {"address": {"type": "absolute", "value": 4361870}, "count": 14}, {"address": {"type": "absolute", "value": 4361935}, "count": 23}, {"address": {"type": "absolute", "value": 4362600}, "count": 14}, {"address": {"type": "absolute", "value": 4362665}, "count": 23}, {"address": {"type": "absolute", "value": 4371168}, "count": 88}, {"address": {"type": "absolute", "value": 4379632}, "count": 52}, {"address": {"type": "absolute", "value": 4379904}, "count": 50}, {"address": {"type": "absolute", "value": 4380112}, "count": 38}, {"address": {"type": "absolute", "value": 4380272}, "count": 38}, {"address": {"type": "absolute", "value": 4394451}, "count": 20}, {"address": {"type": "absolute", "value": 4396848}, "count": 48}, {"address": {"type": "absolute", "value": 4401568}, "count": 27}, {"address": {"type": "absolute", "value": 4401680}, "count": 24}, {"address": {"type": "absolute", "value": 4401776}, "count": 28}, {"address": {"type": "absolute", "value": 4402832}, "count": 66}, {"address": {"type": "absolute", "value": 4418944}, "count": 42}, {"address": {"type": "absolute", "value": 4440528}, "count": 54}, {"address": {"type": "absolute", "value": 4455904}, "count": 48}, {"address": {"type": "absolute", "value": 4458064}, "count": 40}, {"address": {"type": "absolute", "value": 4459008}, "count": 46}, {"address": {"type": "absolute", "value": 4459296}, "count": 38}, {"address": {"type": "absolute", "value": 4464512}, "count": 31}, {"address": {"type": "absolute", "value": 4466544}, "count": 27}, {"address": {"type": "absolute", "value": 4466656}, "count": 27}, {"address": {"type": "absolute", "value": 4466768}, "count": 28}, {"address": {"type": "absolute", "value": 4466992}, "count": 36}, {"address": {"type": "absolute", "value": 4467216}, "count": 27}, {"address": {"type": "absolute", "value": 4467632}, "count": 37}, {"address": {"type": "absolute", "value": 4468080}, "count": 54}, {"address": {"type": "absolute", "value": 4468510}, "count": 14}, {"address": {"type": "absolute", "value": 4468575}, "count": 23}, {"address": {"type": "absolute", "value": 4469230}, "count": 14}, {"address": {"type": "absolute", "value": 4469295}, "count": 23}, {"address": {"type": "absolute", "value": 4470448}, "count": 37}, {"address": {"type": "absolute", "value": 4472852}, "count": 157}, {"address": {"type": "absolute", "value": 4476272}, "count": 77}, {"address": {"type": "absolute", "value": 4480208}, "count": 73}, {"address": {"type": "absolute", "value": 4481456}, "count": 52}, {"address": {"type": "absolute", "value": 4481728}, "count": 50}, {"address": {"type": "absolute", "value": 4481936}, "count": 45}, {"address": {"type": "absolute", "value": 4482224}, "count": 38}, {"address": {"type": "absolute", "value": 4482384}, "count": 38}, {"address": {"type": "absolute", "value": 4486000}, "count": 31}, {"address": {"type": "absolute", "value": 4489616}, "count": 66}, {"address": {"type": "absolute", "value": 4499520}, "count": 12}, {"address": {"type": "absolute", "value": 4500326}, "count": 17}, {"address": {"type": "absolute", "value": 4500365}, "count": 14}, {"address": {"type": "absolute", "value": 4502963}, "count": 15}, {"address": {"type": "absolute", "value": 4502990}, "count": 23}, {"address": {"type": "absolute", "value": 4505102}, "count": 14}, {"address": {"type": "absolute", "value": 4505121}, "count": 12}, {"address": {"type": "absolute", "value": 4505600}, "count": 10}, {"address": {"type": "absolute", "value": 4508544}, "count": 13}, {"address": {"type": "absolute", "value": 4509056}, "count": 14}, {"address": {"type": "absolute", "value": 4521360}, "count": 25}, {"address": {"type": "absolute", "value": 4521368}, "count": 45}, {"address": {"type": "absolute", "value": 4521600}, "count": 34}, {"address": {"type": "absolute", "value": 4525888}, "count": 25}, {"address": {"type": "absolute", "value": 4525896}, "count": 25}, {"address": {"type": "absolute", "value": 4526192}, "count": 34}, {"address": {"type": "absolute", "value": 4526200}, "count": 25}, {"address": {"type": "absolute", "value": 4526211}, "count": 25}, {"address": {"type": "absolute", "value": 4532208}, "count": 23}]}, "library_functions": [{"address": {"type": "absolute", "value": 4319584}, "name": "?"}, {"address": {"type": "absolute", "value": 4325718}, "name": "?"}, {"address": {"type": "absolute", "value": 4326000}, "name": "?"}, {"address": {"type": "absolute", "value": 4394445}, "name": "?"}, {"address": {"type": "absolute", "value": 4471696}, "name": "?GetPaltteMinSize@CMFCRibbonPanel@@IBE?AVCSize@@XZ"}, {"address": {"type": "absolute", "value": 4497888}, "name": "@_RTC_AllocaHelper@12"}, {"address": {"type": "absolute", "value": 4497952}, "name": "@_RTC_CheckStackVars2@12"}, {"address": {"type": "absolute", "value": 4498592}, "name": "__except_handler4"}, {"address": {"type": "absolute", "value": 4498896}, "name": "?find_pe_section@@YAPAU_IMAGE_SECTION_HEADER@@QAEI@Z"}, {"address": {"type": "absolute", "value": 4499088}, "name": "?is_potentially_valid_image_base@@YA_NQAX@Z"}, {"address": {"type": "absolute", "value": 4499344}, "name": "___scrt_dllmain_after_initialize_c"}, {"address": {"type": "absolute", "value": 4499408}, "name": "___scrt_dllmain_before_initialize_c"}, {"address": {"type": "absolute", "value": 4499456}, "name": "___scrt_dllmain_crt_thread_attach"}, {"address": {"type": "absolute", "value": 4499552}, "name": "___scrt_dllmain_exception_filter"}, {"address": {"type": "absolute", "value": 4499648}, "name": "___scrt_dllmain_uninitialize_c"}, {"address": {"type": "absolute", "value": 4499712}, "name": "___scrt_dllmain_uninitialize_critical"}, {"address": {"type": "absolute", "value": 4500752}, "name": "_at_quick_exit"}, {"address": {"type": "absolute", "value": 4501648}, "name": "___report_securityfailureEx"}, {"address": {"type": "absolute", "value": 4502240}, "name": "?pre_c_initialization@@YAHXZ"}, {"address": {"type": "absolute", "value": 4502464}, "name": "?post_pgo_initialization@@YAHXZ"}, {"address": {"type": "absolute", "value": 4502480}, "name": "?pre_cpp_initialization@@YAXXZ"}, {"address": {"type": "absolute", "value": 4502512}, "name": "?__scrt_common_main@@YAHXZ"}, {"address": {"type": "absolute", "value": 4502544}, "name": "?__scrt_common_main_seh@@YAHXZ"}, {"address": {"type": "absolute", "value": 4503216}, "name": "?invoke_main@@YAHXZ"}, {"address": {"type": "absolute", "value": 4503408}, "name": "?DebuggerProbe@@YA_NK@Z"}, {"address": {"type": "absolute", "value": 4503488}, "name": "?DebuggerRuntime@@YA_NKHPAXPB_W@Z"}, {"address": {"type": "absolute", "value": 4503872}, "name": "?_RTC_Failure@@YAXPAXH@Z"}, {"address": {"type": "absolute", "value": 4504208}, "name": "?_getMemBlockDataString@@YAXPAD0PBDI@Z"}, {"address": {"type": "absolute", "value": 4504352}, "name": "?_strlen_priv@@YAIPBD@Z"}, {"address": {"type": "absolute", "value": 4504384}, "name": "?failwithmessage@@YAXPAXHHPBD@Z"}, {"address": {"type": "absolute", "value": 4505024}, "name": "?notify_debugger@@YAXABUtagEXCEPTION_VISUALCPP_DEBUG_INFO@@@Z"}, {"address": {"type": "absolute", "value": 4505184}, "name": "__RTC_UninitUse"}, {"address": {"type": "absolute", "value": 4505552}, "name": "__RTC_GetErrDesc"}, {"address": {"type": "absolute", "value": 4505696}, "name": "__RTC_SetErrorType"}, {"address": {"type": "absolute", "value": 4508000}, "name": "___scrt_get_show_window_mode"}, {"address": {"type": "absolute", "value": 4508512}, "name": "?"}, {"address": {"type": "absolute", "value": 4508576}, "name": "__guard_icall_checks_enforced"}, {"address": {"type": "absolute", "value": 4508640}, "name": "___get_entropy"}, {"address": {"type": "absolute", "value": 4509488}, "name": "?GetPdbDll@@YAPAUHINSTANCE__@@XZ"}, {"address": {"type": "absolute", "value": 4509888}, "name": "?GetPdbDllFromInstallPath@@YAPAUHINSTANCE__@@XZ"}, {"address": {"type": "absolute", "value": 4510640}, "name": "?GetPdbDllPathFromFilePath@@YAHPB_WPA_WI@Z"}, {"address": {"type": "absolute", "value": 4512048}, "name": "__except_handler4_noexcept"}]}}, "rules": {"calculate modulo 256 via x86 assembly": {"meta": {"name": "calculate modulo 256 via x86 assembly", "authors": ["moritz.raabe@mandiant.com"], "scope": "instruction", "attack": [], "mbc": [{"parts": ["Data", "Modulo"], "objective": "Data", "behavior": "Modulo", "method": "", "id": "C0058"}], "references": [], "examples": ["9324D1A8AE37A36AE560C37448C9705A:0x4049A9"], "description": "", "lib": true, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: calculate modulo 256 via x86 assembly\n    authors:\n      - moritz.raabe@mandiant.com\n    lib: true\n    scope: instruction\n    mbc:\n      - Data::Modulo [C0058]\n    examples:\n      - 9324D1A8AE37A36AE560C37448C9705A:0x4049A9\n  features:\n    #  and ecx, 800000FFh\n    #  and ecx, 0FFh\n    - and:\n      - mnemonic: and\n      - or:\n        - number: 0x800000FF\n        - number: 0xFF\n", "matches": [[{"type": "absolute", "value": 4399475}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "mnemonic", "mnemonic": "and"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4399475}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "number", "number": 2147483903}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 255}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4399475}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "reference absolute stream path on Windows": {"meta": {"name": "reference absolute stream path on Windows", "namespace": "host-interaction/file-system", "authors": ["blas.kojusner@mandiant.com", "william.ballenthin@mandiant.com"], "scope": "basic block", "attack": [], "mbc": [], "references": ["https://learn.microsoft.com/en-us/windows/win32/fileio/file-streams"], "examples": ["51828683DC26BFABD3994494099AE97D:0x11A9"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: reference absolute stream path on Windows\n    namespace: host-interaction/file-system\n    authors:\n      - blas.kojusner@mandiant.com\n      - william.ballenthin@mandiant.com\n    scope: basic block\n    references:\n      - https://learn.microsoft.com/en-us/windows/win32/fileio/file-streams\n    examples:\n      - 51828683DC26BFABD3994494099AE97D:0x11A9\n  features:\n    - and:\n      - string: /^(..\\?\\\\)?([\\w]\\:|\\\\)(\\\\+((?![\\<\\>\\\"\\/\\|\\*\\?\\:\\\\])[\\x20-\\x5B\\x5D-\\x7E])+)+(\\:\\$?([a-zA-Z0-9_]+))?/\n        # ^(..\\?\\\\)? -> Check for path starting with \"\\\\?\\\"\n        # ([\\w]\\:|\\\\) -> Check for absolute path beginning\n        # (\\\\+((?![\\<\\>\\\"\\/\\|\\*\\?\\:\\\\])[\\x20-\\x5B\\x5D-\\x7E])+)+ -> Check for valid path and filename\n        #   \\\\+ -> Check for at least one backslash path separator\n        #   (?![\\<\\>\\\"\\/\\|\\*\\?\\:\\\\]) -> path component must not start with <, >, \", ...\n        #   [\\x20-\\x5B\\x5D-\\x7E] -> path component must be printable ASCII, except backslash path separator\n        # : -> Check for start of stream filename\n        # \\$?([a-zA-Z0-9_]+))? -> Check for valid stream filename\n        ### Example Matches:\n        ### \\\\\\\\server\\share\\\\file:stream\n        ### \\\\\\\\server\\share\\dir.ext\\\\file.ext:stream \n        ### \\\\\\\\server\\share\\dir.ext\\\\file.tar.gz:stream\n        ### \\\\\\\\server\\share\\dir.ext\\\\file:stream.tar.gz\n        ### \\\\\\\\server\\share\\dir\\\\file.ext:stream.ext\n        ### \\\\\\\\?\\C:\\dir1\\dir2\\\\file:stream\n        ### C:\\dir\\\\file:stream.ext\n        ### C:\\dir\\\\file:}{+,.';[]-=-0987654321`~!@#$%^&()_+-.ext\n", "matches": [[{"type": "absolute", "value": 4454793}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "regex", "regex": "/^(..\\?\\\\)?([\\w]\\:|\\\\)(\\\\+((?![\\<\\>\\\"\\/\\|\\*\\?\\:\\\\])[\\x20-\\x5B\\x5D-\\x7E])+)+(\\:\\$?([a-zA-Z0-9_]+))?/"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4454805}], "captures": {"C:\\Users\\spring\\Desktop\\al-khaser-master\\al-khaser\\Shared\\APIs.cpp": [{"type": "absolute", "value": 4454805}]}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4455003}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "regex", "regex": "/^(..\\?\\\\)?([\\w]\\:|\\\\)(\\\\+((?![\\<\\>\\\"\\/\\|\\*\\?\\:\\\\])[\\x20-\\x5B\\x5D-\\x7E])+)+(\\:\\$?([a-zA-Z0-9_]+))?/"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4455015}], "captures": {"C:\\Users\\spring\\Desktop\\al-khaser-master\\al-khaser\\Shared\\APIs.cpp": [{"type": "absolute", "value": 4455015}]}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4460412}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "regex", "regex": "/^(..\\?\\\\)?([\\w]\\:|\\\\)(\\\\+((?![\\<\\>\\\"\\/\\|\\*\\?\\:\\\\])[\\x20-\\x5B\\x5D-\\x7E])+)+(\\:\\$?([a-zA-Z0-9_]+))?/"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4460431}], "captures": {"C:\\Program Files (x86)\\Microsoft Visual Studio\\2019\\Professional\\VC\\Tools\\MSVC\\14.22.27905\\include\\xmemory": [{"type": "absolute", "value": 4460431}]}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4460460}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "regex", "regex": "/^(..\\?\\\\)?([\\w]\\:|\\\\)(\\\\+((?![\\<\\>\\\"\\/\\|\\*\\?\\:\\\\])[\\x20-\\x5B\\x5D-\\x7E])+)+(\\:\\$?([a-zA-Z0-9_]+))?/"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4460469}], "captures": {"C:\\Program Files (x86)\\Microsoft Visual Studio\\2019\\Professional\\VC\\Tools\\MSVC\\14.22.27905\\include\\xmemory": [{"type": "absolute", "value": 4460469}]}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4461284}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "regex", "regex": "/^(..\\?\\\\)?([\\w]\\:|\\\\)(\\\\+((?![\\<\\>\\\"\\/\\|\\*\\?\\:\\\\])[\\x20-\\x5B\\x5D-\\x7E])+)+(\\:\\$?([a-zA-Z0-9_]+))?/"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4461359}], "captures": {"C:\\Users\\spring\\Desktop\\al-khaser-master\\al-khaser\\Shared\\Common.cpp": [{"type": "absolute", "value": 4461359}]}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4444272}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "regex", "regex": "/^(..\\?\\\\)?([\\w]\\:|\\\\)(\\\\+((?![\\<\\>\\\"\\/\\|\\*\\?\\:\\\\])[\\x20-\\x5B\\x5D-\\x7E])+)+(\\:\\$?([a-zA-Z0-9_]+))?/"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4444342}, {"type": "absolute", "value": 4444327}], "captures": {"C:\\Windows\\System32\\svchost.exe": [{"type": "absolute", "value": 4444327}], "C:\\masm32\\examples\\dialogs_later\\basic\\basicdlg.exe": [{"type": "absolute", "value": 4444342}]}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4437312}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "regex", "regex": "/^(..\\?\\\\)?([\\w]\\:|\\\\)(\\\\+((?![\\<\\>\\\"\\/\\|\\*\\?\\:\\\\])[\\x20-\\x5B\\x5D-\\x7E])+)+(\\:\\$?([a-zA-Z0-9_]+))?/"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4437369}, {"type": "absolute", "value": 4437362}], "captures": {"\\\\.\\HGFS": [{"type": "absolute", "value": 4437362}], "\\\\.\\vmci": [{"type": "absolute", "value": 4437369}]}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4334407}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "regex", "regex": "/^(..\\?\\\\)?([\\w]\\:|\\\\)(\\\\+((?![\\<\\>\\\"\\/\\|\\*\\?\\:\\\\])[\\x20-\\x5B\\x5D-\\x7E])+)+(\\:\\$?([a-zA-Z0-9_]+))?/"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4334423}], "captures": {"C:\\Program Files (x86)\\Microsoft Visual Studio\\2019\\Professional\\VC\\Tools\\MSVC\\14.22.27905\\include\\xmemory": [{"type": "absolute", "value": 4334423}]}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4334452}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "regex", "regex": "/^(..\\?\\\\)?([\\w]\\:|\\\\)(\\\\+((?![\\<\\>\\\"\\/\\|\\*\\?\\:\\\\])[\\x20-\\x5B\\x5D-\\x7E])+)+(\\:\\$?([a-zA-Z0-9_]+))?/"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4334458}], "captures": {"C:\\Program Files (x86)\\Microsoft Visual Studio\\2019\\Professional\\VC\\Tools\\MSVC\\14.22.27905\\include\\xmemory": [{"type": "absolute", "value": 4334458}]}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4453660}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "regex", "regex": "/^(..\\?\\\\)?([\\w]\\:|\\\\)(\\\\+((?![\\<\\>\\\"\\/\\|\\*\\?\\:\\\\])[\\x20-\\x5B\\x5D-\\x7E])+)+(\\:\\$?([a-zA-Z0-9_]+))?/"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4453672}], "captures": {"C:\\Users\\spring\\Desktop\\al-khaser-master\\al-khaser\\Shared\\APIs.cpp": [{"type": "absolute", "value": 4453672}]}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4454261}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "regex", "regex": "/^(..\\?\\\\)?([\\w]\\:|\\\\)(\\\\+((?![\\<\\>\\\"\\/\\|\\*\\?\\:\\\\])[\\x20-\\x5B\\x5D-\\x7E])+)+(\\:\\$?([a-zA-Z0-9_]+))?/"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4454273}], "captures": {"C:\\Users\\spring\\Desktop\\al-khaser-master\\al-khaser\\Shared\\APIs.cpp": [{"type": "absolute", "value": 4454273}]}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4393019}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "regex", "regex": "/^(..\\?\\\\)?([\\w]\\:|\\\\)(\\\\+((?![\\<\\>\\\"\\/\\|\\*\\?\\:\\\\])[\\x20-\\x5B\\x5D-\\x7E])+)+(\\:\\$?([a-zA-Z0-9_]+))?/"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4393038}], "captures": {"C:\\Program Files (x86)\\Microsoft Visual Studio\\2019\\Professional\\VC\\Tools\\MSVC\\14.22.27905\\include\\vector": [{"type": "absolute", "value": 4393038}]}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4393067}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "regex", "regex": "/^(..\\?\\\\)?([\\w]\\:|\\\\)(\\\\+((?![\\<\\>\\\"\\/\\|\\*\\?\\:\\\\])[\\x20-\\x5B\\x5D-\\x7E])+)+(\\:\\$?([a-zA-Z0-9_]+))?/"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4393076}], "captures": {"C:\\Program Files (x86)\\Microsoft Visual Studio\\2019\\Professional\\VC\\Tools\\MSVC\\14.22.27905\\include\\vector": [{"type": "absolute", "value": 4393076}]}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4425984}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "regex", "regex": "/^(..\\?\\\\)?([\\w]\\:|\\\\)(\\\\+((?![\\<\\>\\\"\\/\\|\\*\\?\\:\\\\])[\\x20-\\x5B\\x5D-\\x7E])+)+(\\:\\$?([a-zA-Z0-9_]+))?/"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4426048}, {"type": "absolute", "value": 4426034}, {"type": "absolute", "value": 4426055}, {"type": "absolute", "value": 4426041}, {"type": "absolute", "value": 4426062}], "captures": {"\\\\.\\VBoxMiniRdrDN": [{"type": "absolute", "value": 4426034}], "\\\\.\\VBoxGuest": [{"type": "absolute", "value": 4426041}], "\\\\.\\pipe\\VBoxMiniRdDN": [{"type": "absolute", "value": 4426048}], "\\\\.\\VBoxTrayIPC": [{"type": "absolute", "value": 4426055}], "\\\\.\\pipe\\VBoxTrayIPC": [{"type": "absolute", "value": 4426062}]}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4460912}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "regex", "regex": "/^(..\\?\\\\)?([\\w]\\:|\\\\)(\\\\+((?![\\<\\>\\\"\\/\\|\\*\\?\\:\\\\])[\\x20-\\x5B\\x5D-\\x7E])+)+(\\:\\$?([a-zA-Z0-9_]+))?/"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4460931}], "captures": {"C:\\Program Files (x86)\\Microsoft Visual Studio\\2019\\Professional\\VC\\Tools\\MSVC\\14.22.27905\\include\\xstring": [{"type": "absolute", "value": 4460931}]}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4460960}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "regex", "regex": "/^(..\\?\\\\)?([\\w]\\:|\\\\)(\\\\+((?![\\<\\>\\\"\\/\\|\\*\\?\\:\\\\])[\\x20-\\x5B\\x5D-\\x7E])+)+(\\:\\$?([a-zA-Z0-9_]+))?/"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4460969}], "captures": {"C:\\Program Files (x86)\\Microsoft Visual Studio\\2019\\Professional\\VC\\Tools\\MSVC\\14.22.27905\\include\\xstring": [{"type": "absolute", "value": 4460969}]}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4461024}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "regex", "regex": "/^(..\\?\\\\)?([\\w]\\:|\\\\)(\\\\+((?![\\<\\>\\\"\\/\\|\\*\\?\\:\\\\])[\\x20-\\x5B\\x5D-\\x7E])+)+(\\:\\$?([a-zA-Z0-9_]+))?/"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4461043}], "captures": {"C:\\Program Files (x86)\\Microsoft Visual Studio\\2019\\Professional\\VC\\Tools\\MSVC\\14.22.27905\\include\\xstring": [{"type": "absolute", "value": 4461043}]}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4461072}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "regex", "regex": "/^(..\\?\\\\)?([\\w]\\:|\\\\)(\\\\+((?![\\<\\>\\\"\\/\\|\\*\\?\\:\\\\])[\\x20-\\x5B\\x5D-\\x7E])+)+(\\:\\$?([a-zA-Z0-9_]+))?/"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4461081}], "captures": {"C:\\Program Files (x86)\\Microsoft Visual Studio\\2019\\Professional\\VC\\Tools\\MSVC\\14.22.27905\\include\\xstring": [{"type": "absolute", "value": 4461081}]}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4341716}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "regex", "regex": "/^(..\\?\\\\)?([\\w]\\:|\\\\)(\\\\+((?![\\<\\>\\\"\\/\\|\\*\\?\\:\\\\])[\\x20-\\x5B\\x5D-\\x7E])+)+(\\:\\$?([a-zA-Z0-9_]+))?/"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4341739}], "captures": {"C:\\Program Files (x86)\\Microsoft Visual Studio\\2019\\Professional\\VC\\Tools\\MSVC\\14.22.27905\\include\\xmemory": [{"type": "absolute", "value": 4341739}]}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4341768}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "regex", "regex": "/^(..\\?\\\\)?([\\w]\\:|\\\\)(\\\\+((?![\\<\\>\\\"\\/\\|\\*\\?\\:\\\\])[\\x20-\\x5B\\x5D-\\x7E])+)+(\\:\\$?([a-zA-Z0-9_]+))?/"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4341781}], "captures": {"C:\\Program Files (x86)\\Microsoft Visual Studio\\2019\\Professional\\VC\\Tools\\MSVC\\14.22.27905\\include\\xmemory": [{"type": "absolute", "value": 4341781}]}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4341852}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "regex", "regex": "/^(..\\?\\\\)?([\\w]\\:|\\\\)(\\\\+((?![\\<\\>\\\"\\/\\|\\*\\?\\:\\\\])[\\x20-\\x5B\\x5D-\\x7E])+)+(\\:\\$?([a-zA-Z0-9_]+))?/"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4341875}], "captures": {"C:\\Program Files (x86)\\Microsoft Visual Studio\\2019\\Professional\\VC\\Tools\\MSVC\\14.22.27905\\include\\xmemory": [{"type": "absolute", "value": 4341875}]}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4341904}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "regex", "regex": "/^(..\\?\\\\)?([\\w]\\:|\\\\)(\\\\+((?![\\<\\>\\\"\\/\\|\\*\\?\\:\\\\])[\\x20-\\x5B\\x5D-\\x7E])+)+(\\:\\$?([a-zA-Z0-9_]+))?/"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4341917}], "captures": {"C:\\Program Files (x86)\\Microsoft Visual Studio\\2019\\Professional\\VC\\Tools\\MSVC\\14.22.27905\\include\\xmemory": [{"type": "absolute", "value": 4341917}]}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4408516}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "regex", "regex": "/^(..\\?\\\\)?([\\w]\\:|\\\\)(\\\\+((?![\\<\\>\\\"\\/\\|\\*\\?\\:\\\\])[\\x20-\\x5B\\x5D-\\x7E])+)+(\\:\\$?([a-zA-Z0-9_]+))?/"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4408548}], "captures": {"\\\\.\\%C:": [{"type": "absolute", "value": 4408548}]}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4408848}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "regex", "regex": "/^(..\\?\\\\)?([\\w]\\:|\\\\)(\\\\+((?![\\<\\>\\\"\\/\\|\\*\\?\\:\\\\])[\\x20-\\x5B\\x5D-\\x7E])+)+(\\:\\$?([a-zA-Z0-9_]+))?/"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4408868}], "captures": {"\\\\.\\PhysicalDrive%u": [{"type": "absolute", "value": 4408868}]}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4409132}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "regex", "regex": "/^(..\\?\\\\)?([\\w]\\:|\\\\)(\\\\+((?![\\<\\>\\\"\\/\\|\\*\\?\\:\\\\])[\\x20-\\x5B\\x5D-\\x7E])+)+(\\:\\$?([a-zA-Z0-9_]+))?/"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4409149}], "captures": {"\\\\.\\PhysicalDrive0": [{"type": "absolute", "value": 4409149}]}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4393355}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "regex", "regex": "/^(..\\?\\\\)?([\\w]\\:|\\\\)(\\\\+((?![\\<\\>\\\"\\/\\|\\*\\?\\:\\\\])[\\x20-\\x5B\\x5D-\\x7E])+)+(\\:\\$?([a-zA-Z0-9_]+))?/"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4393374}], "captures": {"C:\\Program Files (x86)\\Microsoft Visual Studio\\2019\\Professional\\VC\\Tools\\MSVC\\14.22.27905\\include\\vector": [{"type": "absolute", "value": 4393374}]}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4393403}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "regex", "regex": "/^(..\\?\\\\)?([\\w]\\:|\\\\)(\\\\+((?![\\<\\>\\\"\\/\\|\\*\\?\\:\\\\])[\\x20-\\x5B\\x5D-\\x7E])+)+(\\:\\$?([a-zA-Z0-9_]+))?/"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4393412}], "captures": {"C:\\Program Files (x86)\\Microsoft Visual Studio\\2019\\Professional\\VC\\Tools\\MSVC\\14.22.27905\\include\\vector": [{"type": "absolute", "value": 4393412}]}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4459909}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "regex", "regex": "/^(..\\?\\\\)?([\\w]\\:|\\\\)(\\\\+((?![\\<\\>\\\"\\/\\|\\*\\?\\:\\\\])[\\x20-\\x5B\\x5D-\\x7E])+)+(\\:\\$?([a-zA-Z0-9_]+))?/"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4459928}], "captures": {"C:\\Program Files (x86)\\Microsoft Visual Studio\\2019\\Professional\\VC\\Tools\\MSVC\\14.22.27905\\include\\xstring": [{"type": "absolute", "value": 4459928}]}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4459957}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "regex", "regex": "/^(..\\?\\\\)?([\\w]\\:|\\\\)(\\\\+((?![\\<\\>\\\"\\/\\|\\*\\?\\:\\\\])[\\x20-\\x5B\\x5D-\\x7E])+)+(\\:\\$?([a-zA-Z0-9_]+))?/"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4459966}], "captures": {"C:\\Program Files (x86)\\Microsoft Visual Studio\\2019\\Professional\\VC\\Tools\\MSVC\\14.22.27905\\include\\xstring": [{"type": "absolute", "value": 4459966}]}}], "locations": [], "captures": {}}]]}, "delay execution": {"meta": {"name": "delay execution", "authors": ["michael.hunhoff@mandiant.com", "@ramen0x3f"], "scope": "basic block", "attack": [], "mbc": [{"parts": ["Anti-Behavioral Analysis", "Dynamic Analysis Evasion", "Delayed Execution"], "objective": "Anti-Behavioral Analysis", "behavior": "Dynamic Analysis Evasion", "method": "Delayed Execution", "id": "B0003.003"}], "references": ["https://docs.microsoft.com/en-us/windows/win32/sync/wait-functions", "https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/TimingAttacks/timing.cpp"], "examples": ["al-khaser_x86.exe_:0x449770", "B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x402FA6"], "description": "", "lib": true, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: delay execution\n    authors:\n      - michael.hunhoff@mandiant.com\n      - \"@ramen0x3f\"\n    lib: true\n    scope: basic block\n    mbc:\n      - Anti-Behavioral Analysis::Dynamic Analysis Evasion::Delayed Execution [B0003.003]\n    references:\n      - https://docs.microsoft.com/en-us/windows/win32/sync/wait-functions\n      - https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/TimingAttacks/timing.cpp\n    examples:\n      - al-khaser_x86.exe_:0x449770\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x402FA6\n  features:\n    - or:\n      - and:\n        - os: windows\n        - or:\n          - api: kernel32.Sleep\n          - api: kernel32.SleepEx\n          - api: kernel32.WaitForSingleObject\n          - api: kernel32.SignalObjectAndWait\n          - api: kernel32.WaitForSingleObjectEx\n          - api: kernel32.WaitForMultipleObjects\n          - api: kernel32.WaitForMultipleObjectsEx\n          - api: kernel32.RegisterWaitForSingleObject\n          - api: WaitOnAddress\n          - api: user32.MsgWaitForMultipleObjects\n          - api: user32.MsgWaitForMultipleObjectsEx\n          - api: NtDelayExecution\n          - api: KeWaitForSingleObject\n          - api: KeDelayExecutionThread\n      - and:\n        - os: linux\n        - or:\n          - api: sleep\n          - api: usleep\n", "matches": [[{"type": "absolute", "value": 4414048}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "os", "os": "linux"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "sleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "usleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.Sleep"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4414140}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SleepEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SignalObjectAndWait"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObjectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.RegisterWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "WaitOnAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtDelayExecution"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeDelayExecutionThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4447403}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "os", "os": "linux"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "sleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "usleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.Sleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SleepEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4447427}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SignalObjectAndWait"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObjectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.RegisterWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "WaitOnAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtDelayExecution"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeDelayExecutionThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4332836}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "os", "os": "linux"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "sleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "usleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.Sleep"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4332840}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SleepEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SignalObjectAndWait"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObjectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.RegisterWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "WaitOnAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtDelayExecution"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeDelayExecutionThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4402480}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "os", "os": "linux"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "sleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "usleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.Sleep"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4402572}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SleepEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SignalObjectAndWait"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObjectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.RegisterWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "WaitOnAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtDelayExecution"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeDelayExecutionThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4496130}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "os", "os": "linux"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "sleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "usleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.Sleep"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4496136}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SleepEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SignalObjectAndWait"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObjectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.RegisterWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "WaitOnAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtDelayExecution"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeDelayExecutionThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4443807}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "os", "os": "linux"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "sleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "usleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.Sleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SleepEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4443828}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SignalObjectAndWait"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObjectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.RegisterWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "WaitOnAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtDelayExecution"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeDelayExecutionThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4493940}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "os", "os": "linux"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "sleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "usleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.Sleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SleepEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4493954}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SignalObjectAndWait"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObjectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.RegisterWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "WaitOnAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtDelayExecution"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeDelayExecutionThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4494371}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "os", "os": "linux"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "sleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "usleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.Sleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SleepEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4494379}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SignalObjectAndWait"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObjectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.RegisterWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "WaitOnAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtDelayExecution"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeDelayExecutionThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4395785}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "os", "os": "linux"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "sleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "usleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.Sleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SleepEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4395798}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SignalObjectAndWait"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObjectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.RegisterWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "WaitOnAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtDelayExecution"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeDelayExecutionThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4396319}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "os", "os": "linux"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "sleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "usleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.Sleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SleepEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4396332}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SignalObjectAndWait"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObjectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.RegisterWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "WaitOnAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtDelayExecution"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeDelayExecutionThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4495964}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "os", "os": "linux"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "sleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "usleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.Sleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SleepEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4495974}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SignalObjectAndWait"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObjectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.RegisterWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "WaitOnAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtDelayExecution"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeDelayExecutionThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4450881}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "os", "os": "linux"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "sleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "usleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.Sleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SleepEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4450905}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SignalObjectAndWait"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObjectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.RegisterWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "WaitOnAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtDelayExecution"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeDelayExecutionThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "open process": {"meta": {"name": "open process", "authors": ["0x534a@mailbox.org"], "scope": "basic block", "attack": [], "mbc": [{"parts": ["Process", "Open Process"], "objective": "Process", "behavior": "Open Process", "method": "", "id": "C0065"}], "references": [], "examples": ["Practical Malware Analysis Lab 17-02.dll_:0x1000D10D"], "description": "", "lib": true, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: open process\n    authors:\n      - 0x534a@mailbox.org\n    lib: true\n    scope: basic block\n    mbc:\n      - Process::Open Process [C0065]\n    examples:\n      - Practical Malware Analysis Lab 17-02.dll_:0x1000D10D\n  features:\n    - or:\n      - api: kernel32.OpenProcess\n      - api: NtOpenProcess\n      - api: ZwOpenProcess\n", "matches": [[{"type": "absolute", "value": 4446487}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.OpenProcess"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4446517}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtOpenProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4352064}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.OpenProcess"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4352077}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtOpenProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4448742}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.OpenProcess"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4448798}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtOpenProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4486608}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.OpenProcess"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4486704}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtOpenProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4443309}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.OpenProcess"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4443322}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtOpenProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4393952}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.OpenProcess"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4394007}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtOpenProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4450064}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.OpenProcess"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4450094}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtOpenProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4476451}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.OpenProcess"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4476474}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtOpenProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "allocate memory": {"meta": {"name": "allocate memory", "authors": ["0x534a@mailbox.org"], "scope": "basic block", "attack": [], "mbc": [{"parts": ["Memory", "Allocate Memory"], "objective": "Memory", "behavior": "Allocate Memory", "method": "", "id": "C0007"}], "references": [], "examples": ["Practical Malware Analysis Lab 03-03.exe_:0x4010EA", "563653399B82CD443F120ECEFF836EA3678D4CF11D9B351BB737573C2D856299:0x140001ABA"], "description": "", "lib": true, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: allocate memory\n    authors:\n      - 0x534a@mailbox.org\n    lib: true\n    scope: basic block\n    mbc:\n      - Memory::Allocate Memory [C0007]\n    examples:\n      - Practical Malware Analysis Lab 03-03.exe_:0x4010EA\n      # ntdll\n      - 563653399B82CD443F120ECEFF836EA3678D4CF11D9B351BB737573C2D856299:0x140001ABA\n  features:\n    - or:\n      - api: kernel32.VirtualAlloc\n      - api: kernel32.VirtualAllocEx\n      - api: kernel32.VirtualAllocExNuma\n      - api: kernel32.VirtualProtect\n      - api: kernel32.VirtualProtectEx\n      - api: NtAllocateVirtualMemory\n      - api: ZwAllocateVirtualMemory\n      - api: NtMapViewOfSection\n      - api: ZwMapViewOfSection\n", "matches": [[{"type": "absolute", "value": 4446875}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAlloc"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocEx"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4447016}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocExNuma"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtect"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4448846}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAlloc"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocEx"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4448970}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocExNuma"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtect"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4399152}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAlloc"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4399225}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocExNuma"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtect"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4399284}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAlloc"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4399300}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocExNuma"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtect"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4444488}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAlloc"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4444514}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocExNuma"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtect"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4445082}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAlloc"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocEx"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4445118}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocExNuma"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtect"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4327280}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAlloc"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4327449}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocExNuma"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtect"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4327478}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAlloc"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocExNuma"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtect"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4327516}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4443488}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAlloc"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocEx"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4443626}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocExNuma"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtect"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4398480}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAlloc"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4398553}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocExNuma"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtect"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4398612}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAlloc"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4398628}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocExNuma"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtect"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4326128}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAlloc"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4326191}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocExNuma"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtect"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4397280}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAlloc"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4397360}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocExNuma"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtect"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4397419}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAlloc"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4397435}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocExNuma"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtect"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4330096}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAlloc"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4330217}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocExNuma"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtect"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4401872}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAlloc"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocExNuma"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtect"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4401979}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4400112}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAlloc"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4400185}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocExNuma"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtect"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4400244}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAlloc"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4400260}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocExNuma"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtect"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4450449}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAlloc"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocEx"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4450590}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocExNuma"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtect"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "allocate RW memory": {"meta": {"name": "allocate RW memory", "authors": ["0x534a@mailbox.org"], "scope": "basic block", "attack": [], "mbc": [{"parts": ["Memory", "Allocate Memory"], "objective": "Memory", "behavior": "Allocate Memory", "method": "", "id": "C0007"}], "references": [], "examples": ["Practical Malware Analysis Lab 17-02.dll_:0x1000D10D"], "description": "", "lib": true, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: allocate RW memory\n    authors:\n      - 0x534a@mailbox.org\n    lib: true\n    scope: basic block\n    mbc:\n      - Memory::Allocate Memory [C0007]\n    examples:\n      - Practical Malware Analysis Lab 17-02.dll_:0x1000D10D\n  features:\n    - and:\n      - match: allocate memory\n      - number: 0x4 = PAGE_READWRITE\n", "matches": [[{"type": "absolute", "value": 4446875}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "allocate memory"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAlloc"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocEx"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4447016}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocExNuma"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtect"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4446875}], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 4, "description": "PAGE_READWRITE"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4446996}], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4448846}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "allocate memory"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAlloc"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocEx"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4448970}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocExNuma"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtect"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4448846}], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 4, "description": "PAGE_READWRITE"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4448947}], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4399152}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "allocate memory"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAlloc"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4399225}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocExNuma"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtect"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4399152}], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 4, "description": "PAGE_READWRITE"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4399211}], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4444488}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "allocate memory"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAlloc"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4444514}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocExNuma"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtect"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4444488}], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 4, "description": "PAGE_READWRITE"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4444500}], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4443488}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "allocate memory"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAlloc"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocEx"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4443626}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocExNuma"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtect"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4443488}], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 4, "description": "PAGE_READWRITE"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4443606}], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4398480}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "allocate memory"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAlloc"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4398553}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocExNuma"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtect"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4398480}], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 4, "description": "PAGE_READWRITE"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4398539}], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4398612}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "allocate memory"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAlloc"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4398628}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocExNuma"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtect"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4398612}], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 4, "description": "PAGE_READWRITE"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4398614}], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4326128}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "allocate memory"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAlloc"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4326191}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocExNuma"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtect"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4326128}], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 4, "description": "PAGE_READWRITE"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4326177}], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4397280}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "allocate memory"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAlloc"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4397360}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocExNuma"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtect"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4397280}], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 4, "description": "PAGE_READWRITE"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4397346}], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4397419}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "allocate memory"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAlloc"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4397435}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocExNuma"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtect"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4397419}], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 4, "description": "PAGE_READWRITE"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4397421}], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4330096}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "allocate memory"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAlloc"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4330217}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocExNuma"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtect"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4330096}], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 4, "description": "PAGE_READWRITE"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4330179}, {"type": "absolute", "value": 4330204}], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4401872}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "allocate memory"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAlloc"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocExNuma"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtect"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4401979}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4401872}], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 4, "description": "PAGE_READWRITE"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4401968}], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4400112}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "allocate memory"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAlloc"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4400185}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocExNuma"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtect"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4400112}], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 4, "description": "PAGE_READWRITE"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4400171}], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4400244}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "allocate memory"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAlloc"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4400260}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocExNuma"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtect"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4400244}], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 4, "description": "PAGE_READWRITE"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4400246}], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4450449}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "allocate memory"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAlloc"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocEx"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4450590}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocExNuma"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtect"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4450449}], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 4, "description": "PAGE_READWRITE"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4450570}], "captures": {}}], "locations": [], "captures": {}}]]}, "get Program Files directory": {"meta": {"name": "get Program Files directory", "namespace": "host-interaction/file-system", "authors": ["moritz.raabe@mandiant.com"], "scope": "basic block", "attack": [{"parts": ["Discovery", "File and Directory Discovery"], "tactic": "Discovery", "technique": "File and Directory Discovery", "subtechnique": "", "id": "T1083"}], "mbc": [], "references": [], "examples": ["BC452CC1128CCF7FA9F76D83CDA79132740414973600FED14509749FE946816E:0x407880"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: get Program Files directory\n    namespace: host-interaction/file-system\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: basic block\n    att&ck:\n      - Discovery::File and Directory Discovery [T1083]\n    examples:\n      - BC452CC1128CCF7FA9F76D83CDA79132740414973600FED14509749FE946816E:0x407880\n  features:\n    - and:\n      - or:\n        - number: 0x26 = CSIDL_PROGRAM_FILES\n        - number: 0x2A = CSIDL_PROGRAM_FILESX86\n      - or:\n        - api: shell32.SHGetFolderPath\n        - api: shell32.SHGetFolderLocation\n        - api: shell32.SHGetSpecialFolderPath\n        - api: shell32.SHGetSpecialFolderLocation\n", "matches": [[{"type": "absolute", "value": 4426650}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "number", "number": 38, "description": "CSIDL_PROGRAM_FILES"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4426654}], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 42, "description": "CSIDL_PROGRAM_FILESX86"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetFolderPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetFolderLocation"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "shell32.SHGetSpecialFolderPath"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4426665}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetSpecialFolderLocation"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4437988}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "number", "number": 38, "description": "CSIDL_PROGRAM_FILES"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4437992}], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 42, "description": "CSIDL_PROGRAM_FILESX86"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetFolderPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetFolderLocation"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "shell32.SHGetSpecialFolderPath"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4438003}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetSpecialFolderLocation"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "get process image filename": {"meta": {"name": "get process image filename", "namespace": "host-interaction/process", "authors": ["michael.hunhoff@mandiant.com"], "scope": "basic block", "attack": [], "mbc": [], "references": [], "examples": [], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "# generated using capa explorer for IDA Pro\nrule:\n  meta:\n    name: get process image filename\n    namespace: host-interaction/process\n    authors:\n      - michael.hunhoff@mandiant.com\n    scope: basic block\n  features:\n    - or:\n      - and:\n        - os: windows\n        - or:\n          - api: kernel32.K32GetProcessImageFileName\n          - api: kernel32.GetProcessImageFileName\n      - and:\n        - api: System.Diagnostics.Process::GetCurrentProcess\n        - property/read: System.Diagnostics.Process::MainModule\n        - property/read: System.Diagnostics.ProcessModule::FileName\n", "matches": [[{"type": "absolute", "value": 4369433}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.K32GetProcessImageFileName"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4369574}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetProcessImageFileName"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "System.Diagnostics.Process::GetCurrentProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.Diagnostics.Process::MainModule"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.Diagnostics.ProcessModule::FileName"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4352146}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.K32GetProcessImageFileName"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4352176}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetProcessImageFileName"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "System.Diagnostics.Process::GetCurrentProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.Diagnostics.Process::MainModule"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.Diagnostics.ProcessModule::FileName"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4304370}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.K32GetProcessImageFileName"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4304370}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetProcessImageFileName"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "System.Diagnostics.Process::GetCurrentProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.Diagnostics.Process::MainModule"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.Diagnostics.ProcessModule::FileName"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4496937}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.K32GetProcessImageFileName"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4496937}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetProcessImageFileName"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "System.Diagnostics.Process::GetCurrentProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.Diagnostics.Process::MainModule"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.Diagnostics.ProcessModule::FileName"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "open thread": {"meta": {"name": "open thread", "authors": ["0x534a@mailbox.org"], "scope": "basic block", "attack": [], "mbc": [{"parts": ["Process", "Open Thread"], "objective": "Process", "behavior": "Open Thread", "method": "", "id": "C0066"}], "references": [], "examples": ["787cbc8a6d1bc58ea169e51e1ad029a637f22560660cc129ab8a099a745bd50e:00502F4C"], "description": "", "lib": true, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: open thread\n    authors:\n      - 0x534a@mailbox.org\n    lib: true\n    scope: basic block\n    mbc:\n      - Process::Open Thread [C0066]\n    examples:\n      - 787cbc8a6d1bc58ea169e51e1ad029a637f22560660cc129ab8a099a745bd50e:00502F4C\n  features:\n    - or:\n      - api: kernel32.OpenThread\n      - api: NtOpenThread\n      - api: ZwOpenThread\n", "matches": [[{"type": "absolute", "value": 4449187}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.OpenThread"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4449203}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtOpenThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4472638}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.OpenThread"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4472651}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtOpenThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "get Explorer PID": {"meta": {"name": "get Explorer PID", "namespace": "host-interaction/process/list", "authors": ["michael.hunhoff@mandiant.com"], "scope": "basic block", "attack": [{"parts": ["Discovery", "Process Discovery"], "tactic": "Discovery", "technique": "Process Discovery", "subtechnique": "", "id": "T1057"}], "mbc": [], "references": ["https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiDebug/ParentProcess.cpp"], "examples": ["al-khaser_x86.exe_:0x425210"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: get Explorer PID\n    namespace: host-interaction/process/list\n    authors:\n      - michael.hunhoff@mandiant.com\n    scope: basic block\n    att&ck:\n      - Discovery::Process Discovery [T1057]\n    references:\n      - https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiDebug/ParentProcess.cpp\n    examples:\n      - al-khaser_x86.exe_:0x425210\n  features:\n    - and:\n      - api: GetShellWindow\n      - api: GetWindowThreadProcessId\n", "matches": [[{"type": "absolute", "value": 4346384}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "GetShellWindow"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4346449}], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "GetWindowThreadProcessId"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4346463}], "captures": {}}], "locations": [], "captures": {}}]]}, "allocate RWX memory": {"meta": {"name": "allocate RWX memory", "namespace": "host-interaction/process/inject", "authors": ["moritz.raabe@mandiant.com"], "scope": "basic block", "attack": [], "mbc": [{"parts": ["Memory", "Allocate Memory"], "objective": "Memory", "behavior": "Allocate Memory", "method": "", "id": "C0007"}], "references": [], "examples": ["Practical Malware Analysis Lab 03-03.exe_:0x4010EA", "563653399B82CD443F120ECEFF836EA3678D4CF11D9B351BB737573C2D856299:0x140001ABA"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: allocate RWX memory\n    namespace: host-interaction/process/inject\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: basic block\n    mbc:\n      - Memory::Allocate Memory [C0007]\n    examples:\n      - Practical Malware Analysis Lab 03-03.exe_:0x4010EA\n      # ntdll\n      - 563653399B82CD443F120ECEFF836EA3678D4CF11D9B351BB737573C2D856299:0x140001ABA\n  features:\n    - and:\n      - match: allocate memory\n      - number: 0x40 = PAGE_EXECUTE_READWRITE\n", "matches": [[{"type": "absolute", "value": 4399284}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "allocate memory"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAlloc"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4399300}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocExNuma"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtect"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4399284}], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 64, "description": "PAGE_EXECUTE_READWRITE"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4399286}], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4445082}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "allocate memory"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAlloc"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocEx"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4445118}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocExNuma"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtect"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4445082}], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 64, "description": "PAGE_EXECUTE_READWRITE"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4445084}], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4327280}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "allocate memory"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAlloc"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4327449}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocExNuma"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtect"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4327280}], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 64, "description": "PAGE_EXECUTE_READWRITE"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4327436}], "captures": {}}], "locations": [], "captures": {}}]]}, "check for unexpected memory writes": {"meta": {"name": "check for unexpected memory writes", "namespace": "anti-analysis/anti-debugging/debugger-detection", "authors": ["michael.hunhoff@mandiant.com"], "scope": "basic block", "attack": [], "mbc": [{"parts": ["Anti-Behavioral Analysis", "Debugger Detection", "Memory Write Watching"], "objective": "Anti-Behavioral Analysis", "behavior": "Debugger Detection", "method": "Memory Write Watching", "id": "B0001.010"}], "references": ["https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiDebug/WriteWatch.cpp"], "examples": ["al-khaser_x86.exe_:0x431EBC"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: check for unexpected memory writes\n    namespace: anti-analysis/anti-debugging/debugger-detection\n    authors:\n      - michael.hunhoff@mandiant.com\n    scope: basic block\n    mbc:\n      - Anti-Behavioral Analysis::Debugger Detection::Memory Write Watching [B0001.010]\n    references:\n      - https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiDebug/WriteWatch.cpp\n    examples:\n      - al-khaser_x86.exe_:0x431EBC\n  features:\n    - and:\n      - api: kernel32.GetWriteWatch\n      - number: 0x0\n", "matches": [[{"type": "absolute", "value": 4399631}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetWriteWatch"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4399663}], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 0}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4399661}], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4398713}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetWriteWatch"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4398763}], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 0}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4398761}, {"type": "absolute", "value": 4398718}], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4397866}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetWriteWatch"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4397885}], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 0}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4397872}, {"type": "absolute", "value": 4397874}, {"type": "absolute", "value": 4397883}, {"type": "absolute", "value": 4397876}], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4397935}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetWriteWatch"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4397967}], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 0}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4397965}], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4400345}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetWriteWatch"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4400406}], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 0}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4400404}, {"type": "absolute", "value": 4400365}], "captures": {}}], "locations": [], "captures": {}}]]}, "check for OutputDebugString error": {"meta": {"name": "check for OutputDebugString error", "namespace": "anti-analysis/anti-debugging/debugger-detection", "authors": ["michael.hunhoff@mandiant.com"], "scope": "basic block", "attack": [], "mbc": [{"parts": ["Anti-Behavioral Analysis", "Debugger Detection", "OutputDebugString"], "objective": "Anti-Behavioral Analysis", "behavior": "Debugger Detection", "method": "OutputDebugString", "id": "B0001.016"}], "references": [], "examples": ["Practical Malware Analysis Lab 16-02.exe_:0x401020"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: check for OutputDebugString error\n    namespace: anti-analysis/anti-debugging/debugger-detection\n    authors:\n      - michael.hunhoff@mandiant.com\n    scope: basic block\n    mbc:\n      - Anti-Behavioral Analysis::Debugger Detection::OutputDebugString [B0001.016]\n    examples:\n      - Practical Malware Analysis Lab 16-02.exe_:0x401020\n  features:\n    - and:\n      - api: kernel32.SetLastError\n      - api: kernel32.GetLastError\n      - api: kernel32.OutputDebugString\n", "matches": [[{"type": "absolute", "value": 4333602}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.SetLastError"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4333608}], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetLastError"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4333643}], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.OutputDebugString"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4333628}], "captures": {}}], "locations": [], "captures": {}}]]}, "create process on Windows": {"meta": {"name": "create process on Windows", "namespace": "host-interaction/process/create", "authors": ["moritz.raabe@mandiant.com"], "scope": "basic block", "attack": [], "mbc": [{"parts": ["Process", "Create Process"], "objective": "Process", "behavior": "Create Process", "method": "", "id": "C0017"}], "references": [], "examples": ["9324D1A8AE37A36AE560C37448C9705A:0x406DB0", "Practical Malware Analysis Lab 01-04.exe_:0x4011FC", "692f7fd6d198e804d6af98eb9e390d61:0x6000003"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: create process on Windows\n    namespace: host-interaction/process/create\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: basic block\n    mbc:\n      - Process::Create Process [C0017]\n    examples:\n      - 9324D1A8AE37A36AE560C37448C9705A:0x406DB0\n      - Practical Malware Analysis Lab 01-04.exe_:0x4011FC\n      - 692f7fd6d198e804d6af98eb9e390d61:0x6000003\n  features:\n    - or:\n      - api: kernel32.WinExec\n      - api: kernel32.CreateProcess\n      - api: shell32.ShellExecute\n      - api: shell32.ShellExecuteEx\n      - api: advapi32.CreateProcessAsUser\n      - api: advapi32.CreateProcessWithLogon\n      - api: advapi32.CreateProcessWithToken\n      - api: kernel32.CreateProcessInternal\n      - api: ntdll.NtCreateUserProcess\n      - api: ntdll.NtCreateProcess\n      - api: ntdll.NtCreateProcessEx\n      - api: ntdll.ZwCreateProcess\n      - api: ZwCreateProcessEx\n      - api: ntdll.ZwCreateUserProcess\n      - api: ntdll.RtlCreateUserProcess\n      - api: System.Diagnostics.Process::Start\n", "matches": [[{"type": "absolute", "value": 4444419}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WinExec"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.CreateProcess"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4444453}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.ShellExecute"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.ShellExecuteEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.CreateProcessAsUser"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.CreateProcessWithLogon"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.CreateProcessWithToken"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.CreateProcessInternal"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtCreateUserProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtCreateProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtCreateProcessEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.ZwCreateProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateProcessEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.ZwCreateUserProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.RtlCreateUserProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Diagnostics.Process::Start"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "create process suspended": {"meta": {"name": "create process suspended", "namespace": "host-interaction/process/create", "authors": ["william.ballenthin@mandiant.com"], "scope": "basic block", "attack": [], "mbc": [{"parts": ["Process", "Create Process", "Create Suspended Process"], "objective": "Process", "behavior": "Create Process", "method": "Create Suspended Process", "id": "C0017.003"}], "references": [], "examples": ["Practical Malware Analysis Lab 03-03.exe_:0x4010EA"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: create process suspended\n    namespace: host-interaction/process/create\n    authors:\n      - william.ballenthin@mandiant.com\n    scope: basic block\n    mbc:\n      - Process::Create Process::Create Suspended Process [C0017.003]\n    examples:\n      - Practical Malware Analysis Lab 03-03.exe_:0x4010EA\n  features:\n    - and:\n      - or:\n        - number: 0x08000004 = CREATE_NO_WINDOW | CREATE_SUSPENDED\n        - number: 4 = CREATE_SUSPENDED\n      - or:\n        - api: kernel32.CreateProcess\n        - api: advapi32.CreateProcessAsUser\n", "matches": [[{"type": "absolute", "value": 4444419}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "number", "number": 134217732, "description": "CREATE_NO_WINDOW | CREATE_SUSPENDED"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 4, "description": "CREATE_SUSPENDED"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4444439}], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.CreateProcess"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4444453}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.CreateProcessAsUser"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "create or open file": {"meta": {"name": "create or open file", "authors": ["michael.hunhoff@mandiant.com", "joakim@intezer.com"], "scope": "basic block", "attack": [], "mbc": [{"parts": ["File System", "Create File"], "objective": "File System", "behavior": "Create File", "method": "", "id": "C0016"}], "references": [], "examples": ["B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x401D7E"], "description": "", "lib": true, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: create or open file\n    authors:\n      - michael.hunhoff@mandiant.com\n      - joakim@intezer.com\n    lib: true\n    scope: basic block\n    mbc:\n      - File System::Create File [C0016]\n    examples:\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x401D7E\n  features:\n    - or:\n      - api: CreateFile\n      - api: CreateFileEx\n      - api: IoCreateFile\n      - api: IoCreateFileEx\n      - api: ZwOpenFile\n      - api: ZwCreateFile\n      - api: NtOpenFile\n      - api: NtCreateFile\n      - api: fopen\n      - api: fopen64\n      - api: fdopen\n      - api: freopen\n      - api: open\n      - api: openat\n", "matches": [[{"type": "absolute", "value": 4444623}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "CreateFile"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4444696}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "CreateFileEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "IoCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "IoCreateFileEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtOpenFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "fopen"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "fopen64"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "fdopen"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "freopen"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "open"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "openat"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4437416}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "CreateFile"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4437444}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "CreateFileEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "IoCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "IoCreateFileEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtOpenFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "fopen"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "fopen64"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "fdopen"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "freopen"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "open"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "openat"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4426109}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "CreateFile"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4426137}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "CreateFileEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "IoCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "IoCreateFileEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtOpenFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "fopen"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "fopen64"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "fdopen"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "freopen"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "open"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "openat"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4408516}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "CreateFile"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4408608}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "CreateFileEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "IoCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "IoCreateFileEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtOpenFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "fopen"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "fopen64"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "fdopen"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "freopen"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "open"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "openat"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4408909}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "CreateFile"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4408933}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "CreateFileEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "IoCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "IoCreateFileEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtOpenFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "fopen"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "fopen64"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "fdopen"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "freopen"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "open"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "openat"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4409132}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "CreateFile"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4409154}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "CreateFileEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "IoCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "IoCreateFileEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtOpenFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "fopen"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "fopen64"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "fdopen"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "freopen"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "open"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "openat"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "resume thread": {"meta": {"name": "resume thread", "namespace": "host-interaction/thread/resume", "authors": ["0x534a@mailbox.org", "anushka.virgaonkar@mandiant.com"], "scope": "basic block", "attack": [], "mbc": [{"parts": ["Process", "Resume Thread"], "objective": "Process", "behavior": "Resume Thread", "method": "", "id": "C0054"}], "references": [], "examples": ["Practical Malware Analysis Lab 12-02.exe_:0x4010EA", "787cbc8a6d1bc58ea169e51e1ad029a637f22560660cc129ab8a099a745bd50e:0x4044C7"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: resume thread\n    namespace: host-interaction/thread/resume\n    authors:\n      - 0x534a@mailbox.org\n      - anushka.virgaonkar@mandiant.com\n    scope: basic block\n    mbc:\n      - Process::Resume Thread [C0054]\n    examples:\n      - Practical Malware Analysis Lab 12-02.exe_:0x4010EA\n      - 787cbc8a6d1bc58ea169e51e1ad029a637f22560660cc129ab8a099a745bd50e:0x4044C7\n  features:\n    - or:\n      - api: kernel32.ResumeThread\n      - api: ntdll.NtResumeThread\n      - api: ntdll.ZwResumeThread\n      - api: System.Threading.Thread::Resume\n", "matches": [[{"type": "absolute", "value": 4445368}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.ResumeThread"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4445485}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtResumeThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.ZwResumeThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Threading.Thread::Resume"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "PEB access": {"meta": {"name": "PEB access", "authors": ["michael.hunhoff@mandiant.com"], "scope": "basic block", "attack": [], "mbc": [{"parts": ["Anti-Behavioral Analysis", "Debugger Detection", "Process Environment Block"], "objective": "Anti-Behavioral Analysis", "behavior": "Debugger Detection", "method": "Process Environment Block", "id": "B0001.019"}], "references": ["https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiDebug/NtGlobalFlag.cpp"], "examples": ["al-khaser_x86.exe_:0x420D20"], "description": "", "lib": true, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: PEB access\n    authors:\n      - michael.hunhoff@mandiant.com\n    lib: true\n    scope: basic block\n    mbc:\n      - Anti-Behavioral Analysis::Debugger Detection::Process Environment Block [B0001.019]\n    references:\n      - https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiDebug/NtGlobalFlag.cpp\n    examples:\n      - al-khaser_x86.exe_:0x420D20\n  features:\n    - or:\n      - characteristic: peb access\n      - and:\n        # https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiDebug/NtGlobalFlag.cpp#L41\n        - arch: i386\n        - characteristic: fs access\n        - or:\n          # in 0f5d5d07c6533bc6d991836ce79daaa1\n          # then we have:\n          #\n          #     xor edx, edx\n          #     mov edx, fs:[edx+30h]\n          - offset: 0x30\n          - instruction:\n            # in the case of CallObfuscator, gs:[rax]\n            - mnemonic: add\n            - number: 0x30\n      - and:\n        - arch: amd64\n        - characteristic: gs access\n        - or:\n          - offset: 0x60\n          - instruction:\n            - mnemonic: add\n            - number: 0x60\n      - and:\n        # WoW64 PEB address is fetched via the WoW64 Thread Environment Block (TEB) at FS:[0x18]-0x2000\n        # https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiDebug/NtGlobalFlag.cpp#L45\n        - characteristic: fs access\n        - instruction:\n          - mnemonic: sub\n          - number: 0x2000\n", "matches": [[{"type": "absolute", "value": 4402352}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "peb access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4402392}], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "fs access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4402392}], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/aee9ee4a3df44121b21acb950535f6a7"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "arch", "arch": "i386"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "fs access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4402392}], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "offset", "offset": 48}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/b86186bb56c74ecaa2b476462ebf83f3"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "arch", "arch": "amd64"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "gs access"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "offset", "offset": 96}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/fc87da307f6f4da2b8fde64519f87688"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4347051}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "peb access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4347051}], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "fs access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4347051}], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/aee9ee4a3df44121b21acb950535f6a7"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "arch", "arch": "i386"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "fs access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4347051}], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "offset", "offset": 48}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/b86186bb56c74ecaa2b476462ebf83f3"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "arch", "arch": "amd64"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "gs access"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "offset", "offset": 96}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/fc87da307f6f4da2b8fde64519f87688"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4347076}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "peb access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4347076}], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "fs access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4347076}], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/aee9ee4a3df44121b21acb950535f6a7"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "arch", "arch": "i386"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "fs access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4347076}], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "offset", "offset": 48}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/b86186bb56c74ecaa2b476462ebf83f3"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "arch", "arch": "amd64"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "gs access"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "offset", "offset": 96}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/fc87da307f6f4da2b8fde64519f87688"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4347355}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "peb access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4347355}], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "fs access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4347355}], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/aee9ee4a3df44121b21acb950535f6a7"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "arch", "arch": "i386"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "fs access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4347355}], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "offset", "offset": 48}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/b86186bb56c74ecaa2b476462ebf83f3"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "arch", "arch": "amd64"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "gs access"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "offset", "offset": 96}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/fc87da307f6f4da2b8fde64519f87688"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4347380}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "peb access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4347380}], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "fs access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4347380}], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/aee9ee4a3df44121b21acb950535f6a7"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "arch", "arch": "i386"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "fs access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4347380}], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "offset", "offset": 48}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/b86186bb56c74ecaa2b476462ebf83f3"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "arch", "arch": "amd64"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "gs access"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "offset", "offset": 96}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/fc87da307f6f4da2b8fde64519f87688"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4328736}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "peb access"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "fs access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4328790}], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/aee9ee4a3df44121b21acb950535f6a7"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "arch", "arch": "i386"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "fs access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4328790}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "offset", "offset": 48}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4328802}], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/b86186bb56c74ecaa2b476462ebf83f3"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "arch", "arch": "amd64"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "gs access"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "offset", "offset": 96}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/fc87da307f6f4da2b8fde64519f87688"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4328826}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "peb access"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "fs access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4328826}], "captures": {}}, {"success": true, "node": {"statement": {"scope": "instruction", "type": "subscope"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "mnemonic", "mnemonic": "sub"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4328832}], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 8192}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4328832}], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4328832}], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "arch", "arch": "i386"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "fs access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4328826}], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "offset", "offset": 48}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/b86186bb56c74ecaa2b476462ebf83f3"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "arch", "arch": "amd64"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "gs access"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "offset", "offset": 96}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4328843}], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/fc87da307f6f4da2b8fde64519f87688"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4402144}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "peb access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4402184}], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "fs access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4402184}], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/aee9ee4a3df44121b21acb950535f6a7"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "arch", "arch": "i386"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "fs access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4402184}], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "offset", "offset": 48}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/b86186bb56c74ecaa2b476462ebf83f3"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "arch", "arch": "amd64"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "gs access"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "offset", "offset": 96}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/fc87da307f6f4da2b8fde64519f87688"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4410192}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "peb access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4410298}], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "fs access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4410298}], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/aee9ee4a3df44121b21acb950535f6a7"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "arch", "arch": "i386"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "fs access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4410298}], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "offset", "offset": 48}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/b86186bb56c74ecaa2b476462ebf83f3"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "arch", "arch": "amd64"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "gs access"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "offset", "offset": 96}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/fc87da307f6f4da2b8fde64519f87688"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4325232}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "peb access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4325272}], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "fs access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4325272}], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/aee9ee4a3df44121b21acb950535f6a7"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "arch", "arch": "i386"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "fs access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4325272}], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "offset", "offset": 48}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/b86186bb56c74ecaa2b476462ebf83f3"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "arch", "arch": "amd64"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "gs access"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "offset", "offset": 96}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/fc87da307f6f4da2b8fde64519f87688"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "get file attributes": {"meta": {"name": "get file attributes", "namespace": "host-interaction/file-system/meta", "authors": ["michael.hunhoff@mandiant.com", "anushka.virgaonkar@mandiant.com"], "scope": "basic block", "attack": [], "mbc": [{"parts": ["File System", "Get File Attributes"], "objective": "File System", "behavior": "Get File Attributes", "method": "", "id": "C0049"}], "references": [], "examples": ["03B236B23B1EC37C663527C1F53AF3FE:0x180019824", "B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x4028B6", "B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x4029E0"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: get file attributes\n    namespace: host-interaction/file-system/meta\n    authors:\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scope: basic block\n    mbc:\n      - File System::Get File Attributes [C0049]\n    examples:\n      - 03B236B23B1EC37C663527C1F53AF3FE:0x180019824\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x4028B6\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x4029E0\n  features:\n    - or:\n      - api: kernel32.GetFileAttributes\n      - api: ZwQueryDirectoryFile\n      - api: ZwQueryInformationFile\n      - api: NtQueryDirectoryFile\n      - api: NtQueryInformationFile\n      - api: System.IO.File::GetAttributes\n      - api: System.IO.File::GetCreationTime\n      - api: System.IO.File::GetCreationTimeUtc\n      - api: System.IO.File::GetLastAccessTime\n      - api: System.IO.File::GetLastAccessTimeUtc\n      - api: System.IO.File::GetLastWriteTime\n      - api: System.IO.File::GetLastWriteTimeUtc\n      - property/read: System.IO.FileSystemInfo::Attributes\n", "matches": [[{"type": "absolute", "value": 4491536}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetFileAttributes"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4491582}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwQueryDirectoryFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwQueryInformationFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtQueryDirectoryFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtQueryInformationFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::GetAttributes"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::GetCreationTime"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::GetCreationTimeUtc"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::GetLastAccessTime"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::GetLastAccessTimeUtc"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::GetLastWriteTime"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::GetLastWriteTimeUtc"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.IO.FileSystemInfo::Attributes"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4491696}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetFileAttributes"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4491742}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwQueryDirectoryFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwQueryInformationFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtQueryDirectoryFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtQueryInformationFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::GetAttributes"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::GetCreationTime"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::GetCreationTimeUtc"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::GetLastAccessTime"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::GetLastAccessTimeUtc"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::GetLastWriteTime"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::GetLastWriteTimeUtc"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.IO.FileSystemInfo::Attributes"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "check for trap flag exception": {"meta": {"name": "check for trap flag exception", "namespace": "anti-analysis/anti-debugging/debugger-detection", "authors": ["michael.hunhoff@mandiant.com"], "scope": "basic block", "attack": [], "mbc": [{"parts": ["Anti-Behavioral Analysis", "Debugger Detection"], "objective": "Anti-Behavioral Analysis", "behavior": "Debugger Detection", "method": "", "id": "B0001"}], "references": ["https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiDebug/TrapFlag.cpp"], "examples": ["al-khaser_x86.exe_:0x431680", "al-khaser_x64.exe_:0x140030CB0"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: check for trap flag exception\n    namespace: anti-analysis/anti-debugging/debugger-detection\n    authors:\n      - michael.hunhoff@mandiant.com\n    scope: basic block\n    mbc:\n      - Anti-Behavioral Analysis::Debugger Detection [B0001]\n    references:\n      - https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiDebug/TrapFlag.cpp\n    examples:\n      - al-khaser_x86.exe_:0x431680\n      - al-khaser_x64.exe_:0x140030CB0\n  features:\n    - and:\n      - or:\n        - description: read/write EFLAGS register\n        - and:\n          - mnemonic: pushf\n          - mnemonic: popf\n        - and:\n          - mnemonic: pushfd\n          - mnemonic: popfd\n        - and:\n          - mnemonic: pushfq\n          - mnemonic: popfq\n      - or:\n        - description: set trap flag\n        - instruction:\n          - mnemonic: or\n          - number: 0x100\n        - instruction:\n          - mnemonic: bts\n          - number: 0x8\n", "matches": [[{"type": "absolute", "value": 4396672}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "or", "description": "set trap flag"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"scope": "instruction", "type": "subscope"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "mnemonic", "mnemonic": "or"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4396755}], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 256}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4396755}], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4396755}], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "check for trap flag exception/b7bee07271704108946cfb9175cec2c0"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or", "description": "read/write EFLAGS register"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "mnemonic", "mnemonic": "pushf"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "mnemonic", "mnemonic": "popf"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "mnemonic", "mnemonic": "pushfd"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4396747}], "captures": {}}, {"success": true, "node": {"feature": {"type": "mnemonic", "mnemonic": "popfd"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4396767}], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "mnemonic", "mnemonic": "pushfq"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "mnemonic", "mnemonic": "popfq"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "create or open registry key": {"meta": {"name": "create or open registry key", "authors": ["michael.hunhoff@mandiant.com", "anushka.virgaonkar@mandiant.com"], "scope": "basic block", "attack": [], "mbc": [{"parts": ["Operating System", "Registry", "Create Registry Key"], "objective": "Operating System", "behavior": "Registry", "method": "Create Registry Key", "id": "C0036.004"}, {"parts": ["Operating System", "Registry", "Open Registry Key"], "objective": "Operating System", "behavior": "Registry", "method": "Open Registry Key", "id": "C0036.003"}], "references": [], "examples": ["Practical Malware Analysis Lab 03-02.dll_:0x10004706", "Practical Malware Analysis Lab 11-01.exe_:0x401000", "493167E85E45363D09495D0841C30648:0x404D60", "B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x4045F2", "B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x40433E", "692f7fd6d198e804d6af98eb9e390d61:0x6000003"], "description": "", "lib": true, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: create or open registry key\n    authors:\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    lib: true\n    scope: basic block\n    mbc:\n      - Operating System::Registry::Create Registry Key [C0036.004]\n      - Operating System::Registry::Open Registry Key [C0036.003]\n    examples:\n      - Practical Malware Analysis Lab 03-02.dll_:0x10004706\n      - Practical Malware Analysis Lab 11-01.exe_:0x401000\n      - 493167E85E45363D09495D0841C30648:0x404D60\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x4045F2\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x40433E\n      - 692f7fd6d198e804d6af98eb9e390d61:0x6000003\n  features:\n    - or:\n      - api: advapi32.RegOpenKey\n      - api: advapi32.RegOpenKeyEx\n      - api: advapi32.RegCreateKey\n      - api: advapi32.RegCreateKeyEx\n      - api: advapi32.RegOpenCurrentUser\n      - api: advapi32.RegOpenKeyTransacted\n      - api: advapi32.RegOpenUserClassesRoot\n      - api: advapi32.RegCreateKeyTransacted\n      - api: ZwOpenKey\n      - api: ZwOpenKeyEx\n      - api: ZwCreateKey\n      - api: ZwOpenKeyTransacted\n      - api: ZwOpenKeyTransactedEx\n      - api: ZwCreateKeyTransacted\n      - api: NtOpenKey\n      - api: NtCreateKey\n      - api: SHRegOpenUSKey\n      - api: SHRegCreateUSKey\n      - api: RtlCreateRegistryKey\n      - api: Microsoft.Win32.RegistryKey::OpenSubKey\n      - api: Microsoft.Win32.RegistryKey::OpenBaseKey\n      - api: Microsoft.Win32.RegistryKey::OpenRemoteBaseKey\n      - api: Microsoft.Win32.RegistryKey::CreateSubKey\n", "matches": [[{"type": "absolute", "value": 4478944}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenKeyEx"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4479054}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegCreateKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegCreateKeyEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenCurrentUser"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenUserClassesRoot"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegCreateKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKeyEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKeyTransactedEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtOpenKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtCreateKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegOpenUSKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegCreateUSKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "RtlCreateRegistryKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::OpenSubKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::OpenBaseKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::OpenRemoteBaseKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::CreateSubKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4479264}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenKeyEx"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4479374}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegCreateKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegCreateKeyEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenCurrentUser"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenUserClassesRoot"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegCreateKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKeyEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKeyTransactedEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtOpenKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtCreateKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegOpenUSKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegCreateUSKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "RtlCreateRegistryKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::OpenSubKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::OpenBaseKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::OpenRemoteBaseKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::CreateSubKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "create thread": {"meta": {"name": "create thread", "namespace": "host-interaction/thread/create", "authors": ["moritz.raabe@mandiant.com", "michael.hunhoff@mandiant.com", "joakim@intezer.com", "anushka.virgaonkar@mandiant.com"], "scope": "basic block", "attack": [], "mbc": [{"parts": ["Process", "Create Thread"], "objective": "Process", "behavior": "Create Thread", "method": "", "id": "C0038"}], "references": [], "examples": ["946A99F36A46D335DEC080D9A4371940:0x10001DA0", "B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x408020"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: create thread\n    namespace: host-interaction/thread/create\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n      - joakim@intezer.com\n      - anushka.virgaonkar@mandiant.com\n    scope: basic block\n    mbc:\n      - Process::Create Thread [C0038]\n    examples:\n      - 946A99F36A46D335DEC080D9A4371940:0x10001DA0\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x408020\n  features:\n    - or:\n      - and:\n        - os: windows\n        - or:\n          - api: kernel32.CreateThread\n          - api: _beginthread\n          - api: _beginthreadex\n          - api: PsCreateSystemThread\n          - api: SHCreateThread\n          - api: SHCreateThreadWithHandle\n          - api: kernel32.CreateRemoteThread\n          - api: kernel32.CreateRemoteThreadEx\n          - api: RtlCreateUserThread\n          - api: ntdll.NtCreateThread\n          - api: ntdll.NtCreateThreadEx\n          - api: ntdll.ZwCreateThread\n          - api: ntdll.ZwCreateThreadEx\n      - and:\n        - os: linux\n        - api: pthread_create\n      - and:\n        - api: System.Threading.Thread::Start\n        - optional:\n          - api: System.Threading.Thread::ctor\n", "matches": [[{"type": "absolute", "value": 4443748}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "os", "os": "linux"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "pthread_create"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "System.Threading.Thread::Start"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "System.Threading.Thread::ctor"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.CreateThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "_beginthread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "_beginthreadex"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "PsCreateSystemThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHCreateThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHCreateThreadWithHandle"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.CreateRemoteThread"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4443770}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.CreateRemoteThreadEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "RtlCreateUserThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtCreateThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtCreateThreadEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.ZwCreateThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.ZwCreateThreadEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4396128}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "os", "os": "linux"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "pthread_create"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "System.Threading.Thread::Start"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "System.Threading.Thread::ctor"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.CreateThread"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4396192}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "_beginthread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "_beginthreadex"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "PsCreateSystemThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHCreateThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHCreateThreadWithHandle"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.CreateRemoteThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.CreateRemoteThreadEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "RtlCreateUserThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtCreateThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtCreateThreadEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.ZwCreateThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.ZwCreateThreadEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "get process heap flags": {"meta": {"name": "get process heap flags", "namespace": "host-interaction/process", "authors": ["michael.hunhoff@mandiant.com"], "scope": "basic block", "attack": [{"parts": ["Discovery", "Process Discovery"], "tactic": "Discovery", "technique": "Process Discovery", "subtechnique": "", "id": "T1057"}], "mbc": [], "references": ["https://github.com/LordNoteworthy/al-khaser/blob/bed03d2f849d9060c68f8d5905bd204d0cb3f593/al-khaser/AntiDebug/ProcessHeap_Flags.cpp#L13"], "examples": ["al-khaser_x86.exe_:0x425470"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: get process heap flags\n    namespace: host-interaction/process\n    authors:\n      - michael.hunhoff@mandiant.com\n    scope: basic block\n    att&ck:\n      - Discovery::Process Discovery [T1057]\n    references:\n      - https://github.com/LordNoteworthy/al-khaser/blob/bed03d2f849d9060c68f8d5905bd204d0cb3f593/al-khaser/AntiDebug/ProcessHeap_Flags.cpp#L13\n    examples:\n      - al-khaser_x86.exe_:0x425470\n  features:\n    - and:\n      - match: PEB access\n      - or:\n        - and:\n          - arch: i386\n          - number: 0x18 = PEB->ProcessHeap\n          - or:\n            - number: 0x40 = ProcessHeap->HeapFlags >= Vista\n            - number: 0xC = ProcessHeap->HeapFlags < Vista\n        - and:\n          - arch: amd64\n          - number: 0x30 = PEB->ProcessHeap\n          - or:\n            - number: 0x70 = ProcessHeap->HeapFlags >= Vista\n            - number: 0x14 = ProcessHeap->HeapFlags < Vista\n", "matches": [[{"type": "absolute", "value": 4347051}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "PEB access"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "peb access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4347051}], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "fs access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4347051}], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/aee9ee4a3df44121b21acb950535f6a7"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "arch", "arch": "i386"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "fs access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4347051}], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "offset", "offset": 48}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/b86186bb56c74ecaa2b476462ebf83f3"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "arch", "arch": "amd64"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "gs access"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "offset", "offset": 96}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/fc87da307f6f4da2b8fde64519f87688"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4347051}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "arch", "arch": "i386"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 24, "description": "PEB->ProcessHeap"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4347057}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "number", "number": 64, "description": "ProcessHeap->HeapFlags >= Vista"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4347068}], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 12, "description": "ProcessHeap->HeapFlags < Vista"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "arch", "arch": "amd64"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 48, "description": "PEB->ProcessHeap"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4347051}], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "number", "number": 112, "description": "ProcessHeap->HeapFlags >= Vista"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 20, "description": "ProcessHeap->HeapFlags < Vista"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4347076}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "PEB access"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "peb access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4347076}], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "fs access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4347076}], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/aee9ee4a3df44121b21acb950535f6a7"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "arch", "arch": "i386"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "fs access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4347076}], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "offset", "offset": 48}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/b86186bb56c74ecaa2b476462ebf83f3"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "arch", "arch": "amd64"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "gs access"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "offset", "offset": 96}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/fc87da307f6f4da2b8fde64519f87688"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4347076}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "arch", "arch": "i386"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 24, "description": "PEB->ProcessHeap"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4347082}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "number", "number": 64, "description": "ProcessHeap->HeapFlags >= Vista"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 12, "description": "ProcessHeap->HeapFlags < Vista"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4347093}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "arch", "arch": "amd64"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 48, "description": "PEB->ProcessHeap"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4347076}], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "number", "number": 112, "description": "ProcessHeap->HeapFlags >= Vista"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 20, "description": "ProcessHeap->HeapFlags < Vista"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "access PEB ldr_data": {"meta": {"name": "access PEB ldr_data", "namespace": "linking/runtime-linking", "authors": ["moritz.raabe@mandiant.com"], "scope": "basic block", "attack": [{"parts": ["Execution", "Shared Modules"], "tactic": "Execution", "technique": "Shared Modules", "subtechnique": "", "id": "T1129"}], "mbc": [], "references": ["https://www.geoffchappell.com/studies/windows/win32/ntdll/structs/peb_ldr_data.htm", "https://github.com/d35ha/CallObfuscator/blob/5834aff9ff4511f1408ae4ce80b79737af4ae77b/ShellCode/shell_x64.asm#L8"], "examples": ["3FDFB2D522E7DEECAAAF2F87420F7E75:0x4117B7"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: access PEB ldr_data\n    namespace: linking/runtime-linking\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: basic block\n    att&ck:\n      - Execution::Shared Modules [T1129]\n    references:\n      - https://www.geoffchappell.com/studies/windows/win32/ntdll/structs/peb_ldr_data.htm\n      - https://github.com/d35ha/CallObfuscator/blob/5834aff9ff4511f1408ae4ce80b79737af4ae77b/ShellCode/shell_x64.asm#L8\n    examples:\n      - 3FDFB2D522E7DEECAAAF2F87420F7E75:0x4117B7\n  features:\n    - or:\n      - and:\n        - arch: i386\n        - description: x32\n\n        - match: PEB access\n\n        # x86 Windows uses fs:0 to access the TIB which contains SEH information at offset 0\n        # checking for fs:0 and a (possibly unrelated) number or offset often results in false positives\n\n        - offset: 0x0C = PEB.LDR_DATA\n\n        - or:\n          - description: resolve a module list\n          - offset: 0x0C = PEB.LDR_DATA.InLoadOrderModuleList\n          - offset: 0x14 = PEB.LDR_DATA.InMemoryOrderModuleList\n          - offset: 0x1C = PEB.LDR_DATA.InInitializationOrderModuleList\n\n      - and:\n        - arch: amd64\n        - description: x64\n\n        - match: PEB access\n\n        - offset: 0x18 = PEB.LDR_DATA\n\n        - or:\n          - description: resolve a module list\n          - offset: 0x10 = PEB.LDR_DATA.InLoadOrderModuleList\n          - offset: 0x20 = PEB.LDR_DATA.InMemoryOrderModuleList\n          - offset: 0x30 = PEB.LDR_DATA.InInitializationOrderModuleList\n", "matches": [[{"type": "absolute", "value": 4347076}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and", "description": "x32"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "arch", "arch": "i386"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"feature": {"type": "match", "match": "PEB access"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "peb access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4347076}], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "fs access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4347076}], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/aee9ee4a3df44121b21acb950535f6a7"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "arch", "arch": "i386"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "fs access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4347076}], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "offset", "offset": 48}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/b86186bb56c74ecaa2b476462ebf83f3"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "arch", "arch": "amd64"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "gs access"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "offset", "offset": 96}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/fc87da307f6f4da2b8fde64519f87688"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4347076}], "captures": {}}, {"success": true, "node": {"feature": {"type": "offset", "offset": 12, "description": "PEB.LDR_DATA"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4347093}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or", "description": "resolve a module list"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "offset", "offset": 12, "description": "PEB.LDR_DATA.InLoadOrderModuleList"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4347093}], "captures": {}}, {"success": false, "node": {"feature": {"type": "offset", "offset": 20, "description": "PEB.LDR_DATA.InMemoryOrderModuleList"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "offset", "offset": 28, "description": "PEB.LDR_DATA.InInitializationOrderModuleList"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and", "description": "x64"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "arch", "arch": "amd64"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "match", "match": "PEB access"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "peb access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4347076}], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "fs access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4347076}], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/aee9ee4a3df44121b21acb950535f6a7"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "arch", "arch": "i386"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "fs access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4347076}], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "offset", "offset": 48}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/b86186bb56c74ecaa2b476462ebf83f3"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "arch", "arch": "amd64"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "gs access"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "offset", "offset": 96}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/fc87da307f6f4da2b8fde64519f87688"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4347076}], "captures": {}}, {"success": true, "node": {"feature": {"type": "offset", "offset": 24, "description": "PEB.LDR_DATA"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4347082}], "captures": {}}, {"success": false, "node": {"statement": {"type": "or", "description": "resolve a module list"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "offset", "offset": 16, "description": "PEB.LDR_DATA.InLoadOrderModuleList"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "offset", "offset": 32, "description": "PEB.LDR_DATA.InMemoryOrderModuleList"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "offset", "offset": 48, "description": "PEB.LDR_DATA.InInitializationOrderModuleList"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4402144}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and", "description": "x32"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "arch", "arch": "i386"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"feature": {"type": "match", "match": "PEB access"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "peb access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4402184}], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "fs access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4402184}], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/aee9ee4a3df44121b21acb950535f6a7"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "arch", "arch": "i386"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "fs access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4402184}], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "offset", "offset": 48}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/b86186bb56c74ecaa2b476462ebf83f3"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "arch", "arch": "amd64"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "gs access"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "offset", "offset": 96}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/fc87da307f6f4da2b8fde64519f87688"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4402144}], "captures": {}}, {"success": true, "node": {"feature": {"type": "offset", "offset": 12, "description": "PEB.LDR_DATA"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4402209}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or", "description": "resolve a module list"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "offset", "offset": 12, "description": "PEB.LDR_DATA.InLoadOrderModuleList"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4402209}], "captures": {}}, {"success": false, "node": {"feature": {"type": "offset", "offset": 20, "description": "PEB.LDR_DATA.InMemoryOrderModuleList"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "offset", "offset": 28, "description": "PEB.LDR_DATA.InInitializationOrderModuleList"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4402258}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and", "description": "x64"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "arch", "arch": "amd64"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "match", "match": "PEB access"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "peb access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4402184}], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "fs access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4402184}], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/aee9ee4a3df44121b21acb950535f6a7"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "arch", "arch": "i386"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "fs access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4402184}], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "offset", "offset": 48}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/b86186bb56c74ecaa2b476462ebf83f3"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "arch", "arch": "amd64"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "gs access"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "offset", "offset": 96}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/fc87da307f6f4da2b8fde64519f87688"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4402144}], "captures": {}}, {"success": true, "node": {"feature": {"type": "offset", "offset": 24, "description": "PEB.LDR_DATA"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4402268}], "captures": {}}, {"success": false, "node": {"statement": {"type": "or", "description": "resolve a module list"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "offset", "offset": 16, "description": "PEB.LDR_DATA.InLoadOrderModuleList"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "offset", "offset": 32, "description": "PEB.LDR_DATA.InMemoryOrderModuleList"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "offset", "offset": 48, "description": "PEB.LDR_DATA.InInitializationOrderModuleList"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "get ntdll base address": {"meta": {"name": "get ntdll base address", "namespace": "linking/runtime-linking", "authors": ["moritz.raabe@mandiant.com"], "scope": "basic block", "attack": [{"parts": ["Execution", "Shared Modules"], "tactic": "Execution", "technique": "Shared Modules", "subtechnique": "", "id": "T1129"}], "mbc": [], "references": ["https://idafchev.github.io/exploit/2017/09/26/writing_windows_shellcode.html", "https://www.geoffchappell.com/studies/windows/win32/ntdll/structs/ldr_data_table_entry.htm"], "examples": ["67f8302a2fd28d15f62d6d20d748bfe350334e5353cbdef112bd1f8231b5599d:0x40694A"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: get ntdll base address\n    namespace: linking/runtime-linking\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: basic block\n    att&ck:\n      - Execution::Shared Modules [T1129]\n    references:\n      - https://idafchev.github.io/exploit/2017/09/26/writing_windows_shellcode.html\n      - https://www.geoffchappell.com/studies/windows/win32/ntdll/structs/ldr_data_table_entry.htm\n    examples:\n      - 67f8302a2fd28d15f62d6d20d748bfe350334e5353cbdef112bd1f8231b5599d:0x40694A\n  features:\n    - and:\n      # PEB -> PEB.Ldr -> PEB_LDR_DATA.InLoadOrderModuleList.Flink\n      - match: access PEB ldr_data\n      # -> current module\n      - count(offset(0)): 1\n      # -> ntdll -> LDR_DATA_TABLE_ENTRY.DllBase\n      - or:\n        - and:\n          - arch: i386\n          - offset: 0x18 = LDR_DATA_TABLE_ENTRY.DllBase\n        - and:\n          - arch: amd64\n          - offset: 0x30 = LDR_DATA_TABLE_ENTRY.DllBase\n", "matches": [[{"type": "absolute", "value": 4347076}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "access PEB ldr_data"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and", "description": "x32"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "arch", "arch": "i386"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"feature": {"type": "match", "match": "PEB access"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "peb access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4347076}], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "fs access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4347076}], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/aee9ee4a3df44121b21acb950535f6a7"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "arch", "arch": "i386"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "fs access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4347076}], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "offset", "offset": 48}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/b86186bb56c74ecaa2b476462ebf83f3"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "arch", "arch": "amd64"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "gs access"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "offset", "offset": 96}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/fc87da307f6f4da2b8fde64519f87688"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4347076}], "captures": {}}, {"success": true, "node": {"feature": {"type": "offset", "offset": 12, "description": "PEB.LDR_DATA"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4347093}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or", "description": "resolve a module list"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "offset", "offset": 12, "description": "PEB.LDR_DATA.InLoadOrderModuleList"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4347093}], "captures": {}}, {"success": false, "node": {"feature": {"type": "offset", "offset": 20, "description": "PEB.LDR_DATA.InMemoryOrderModuleList"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "offset", "offset": 28, "description": "PEB.LDR_DATA.InInitializationOrderModuleList"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and", "description": "x64"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "arch", "arch": "amd64"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "match", "match": "PEB access"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "peb access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4347076}], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "fs access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4347076}], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/aee9ee4a3df44121b21acb950535f6a7"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "arch", "arch": "i386"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "fs access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4347076}], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "offset", "offset": 48}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/b86186bb56c74ecaa2b476462ebf83f3"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "arch", "arch": "amd64"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "gs access"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "offset", "offset": 96}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/fc87da307f6f4da2b8fde64519f87688"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4347076}], "captures": {}}, {"success": true, "node": {"feature": {"type": "offset", "offset": 24, "description": "PEB.LDR_DATA"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4347082}], "captures": {}}, {"success": false, "node": {"statement": {"type": "or", "description": "resolve a module list"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "offset", "offset": 16, "description": "PEB.LDR_DATA.InLoadOrderModuleList"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "offset", "offset": 32, "description": "PEB.LDR_DATA.InMemoryOrderModuleList"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "offset", "offset": 48, "description": "PEB.LDR_DATA.InInitializationOrderModuleList"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4347076}], "captures": {}}, {"success": true, "node": {"statement": {"min": 1, "max": 1, "child": {"type": "offset", "offset": 0}, "type": "range"}, "type": "statement"}, "children": [], "locations": [{"type": "absolute", "value": 4347091}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "arch", "arch": "i386"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"feature": {"type": "offset", "offset": 24, "description": "LDR_DATA_TABLE_ENTRY.DllBase"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4347082}], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "arch", "arch": "amd64"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "offset", "offset": 48, "description": "LDR_DATA_TABLE_ENTRY.DllBase"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4402144}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "access PEB ldr_data"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and", "description": "x32"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "arch", "arch": "i386"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"feature": {"type": "match", "match": "PEB access"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "peb access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4402184}], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "fs access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4402184}], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/aee9ee4a3df44121b21acb950535f6a7"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "arch", "arch": "i386"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "fs access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4402184}], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "offset", "offset": 48}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/b86186bb56c74ecaa2b476462ebf83f3"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "arch", "arch": "amd64"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "gs access"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "offset", "offset": 96}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/fc87da307f6f4da2b8fde64519f87688"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4402144}], "captures": {}}, {"success": true, "node": {"feature": {"type": "offset", "offset": 12, "description": "PEB.LDR_DATA"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4402209}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or", "description": "resolve a module list"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "offset", "offset": 12, "description": "PEB.LDR_DATA.InLoadOrderModuleList"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4402209}], "captures": {}}, {"success": false, "node": {"feature": {"type": "offset", "offset": 20, "description": "PEB.LDR_DATA.InMemoryOrderModuleList"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "offset", "offset": 28, "description": "PEB.LDR_DATA.InInitializationOrderModuleList"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4402258}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and", "description": "x64"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "arch", "arch": "amd64"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "match", "match": "PEB access"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "peb access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4402184}], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "fs access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4402184}], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/aee9ee4a3df44121b21acb950535f6a7"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "arch", "arch": "i386"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "fs access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4402184}], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "offset", "offset": 48}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/b86186bb56c74ecaa2b476462ebf83f3"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "arch", "arch": "amd64"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "gs access"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "offset", "offset": 96}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/fc87da307f6f4da2b8fde64519f87688"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4402144}], "captures": {}}, {"success": true, "node": {"feature": {"type": "offset", "offset": 24, "description": "PEB.LDR_DATA"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4402268}], "captures": {}}, {"success": false, "node": {"statement": {"type": "or", "description": "resolve a module list"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "offset", "offset": 16, "description": "PEB.LDR_DATA.InLoadOrderModuleList"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "offset", "offset": 32, "description": "PEB.LDR_DATA.InMemoryOrderModuleList"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "offset", "offset": 48, "description": "PEB.LDR_DATA.InInitializationOrderModuleList"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4402144}], "captures": {}}, {"success": true, "node": {"statement": {"min": 1, "max": 1, "child": {"type": "offset", "offset": 0}, "type": "range"}, "type": "statement"}, "children": [], "locations": [{"type": "absolute", "value": 4402280}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "arch", "arch": "i386"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"feature": {"type": "offset", "offset": 24, "description": "LDR_DATA_TABLE_ENTRY.DllBase"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4402268}], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "arch", "arch": "amd64"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "offset", "offset": 48, "description": "LDR_DATA_TABLE_ENTRY.DllBase"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "get process heap force flags": {"meta": {"name": "get process heap force flags", "namespace": "host-interaction/process", "authors": ["michael.hunhoff@mandiant.com"], "scope": "basic block", "attack": [{"parts": ["Discovery", "Process Discovery"], "tactic": "Discovery", "technique": "Process Discovery", "subtechnique": "", "id": "T1057"}], "mbc": [], "references": ["https://github.com/LordNoteworthy/al-khaser/blob/bed03d2f849d9060c68f8d5905bd204d0cb3f593/al-khaser/AntiDebug/ProcessHeap_ForceFlags.cpp#L14"], "examples": ["al-khaser_x86.exe_:0x425470"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: get process heap force flags\n    namespace: host-interaction/process\n    authors:\n      - michael.hunhoff@mandiant.com\n    scope: basic block\n    att&ck:\n      - Discovery::Process Discovery [T1057]\n    references:\n      - https://github.com/LordNoteworthy/al-khaser/blob/bed03d2f849d9060c68f8d5905bd204d0cb3f593/al-khaser/AntiDebug/ProcessHeap_ForceFlags.cpp#L14\n    examples:\n      - al-khaser_x86.exe_:0x425470\n  features:\n    - and:\n      - match: PEB access\n      - or:\n        - and:\n          - arch: i386\n          - number: 0x18 = PEB->ProcessHeap\n          - or:\n            - number: 0x44 = ProcessHeap->ForceFlags >= Vista\n            - number: 0x10 = ProcessHeap->ForceFlags < Vista\n        - and:\n          - arch: amd64\n          - number: 0x30 = PEB->ProcessHeap\n          - or:\n            - number: 0x74 = ProcessHeap->ForceFlags >= Vista\n            - number: 0x18 = ProcessHeap->ForceFlags < Vista\n", "matches": [[{"type": "absolute", "value": 4347355}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "PEB access"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "peb access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4347355}], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "fs access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4347355}], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/aee9ee4a3df44121b21acb950535f6a7"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "arch", "arch": "i386"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "fs access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4347355}], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "offset", "offset": 48}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/b86186bb56c74ecaa2b476462ebf83f3"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "arch", "arch": "amd64"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "gs access"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "offset", "offset": 96}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/fc87da307f6f4da2b8fde64519f87688"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4347355}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "arch", "arch": "i386"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 24, "description": "PEB->ProcessHeap"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4347361}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "number", "number": 68, "description": "ProcessHeap->ForceFlags >= Vista"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4347372}], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 16, "description": "ProcessHeap->ForceFlags < Vista"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "arch", "arch": "amd64"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 48, "description": "PEB->ProcessHeap"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4347355}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "number", "number": 116, "description": "ProcessHeap->ForceFlags >= Vista"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 24, "description": "ProcessHeap->ForceFlags < Vista"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4347361}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4347380}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "PEB access"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "peb access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4347380}], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "fs access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4347380}], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/aee9ee4a3df44121b21acb950535f6a7"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "arch", "arch": "i386"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "fs access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4347380}], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "offset", "offset": 48}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/b86186bb56c74ecaa2b476462ebf83f3"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "arch", "arch": "amd64"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "gs access"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "offset", "offset": 96}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/fc87da307f6f4da2b8fde64519f87688"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4347380}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "arch", "arch": "i386"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 24, "description": "PEB->ProcessHeap"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4347386}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "number", "number": 68, "description": "ProcessHeap->ForceFlags >= Vista"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 16, "description": "ProcessHeap->ForceFlags < Vista"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4347397}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "arch", "arch": "amd64"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 48, "description": "PEB->ProcessHeap"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4347380}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "number", "number": 116, "description": "ProcessHeap->ForceFlags >= Vista"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 24, "description": "ProcessHeap->ForceFlags < Vista"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4347386}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "acquire debug privileges": {"meta": {"name": "acquire debug privileges", "namespace": "host-interaction/process/modify", "authors": ["william.ballenthin@mandiant.com"], "scope": "basic block", "attack": [{"parts": ["Privilege Escalation", "Access Token Manipulation"], "tactic": "Privilege Escalation", "technique": "Access Token Manipulation", "subtechnique": "", "id": "T1134"}], "mbc": [], "references": [], "examples": ["Practical Malware Analysis Lab 01-04.exe_:0x401174"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: acquire debug privileges\n    namespace: host-interaction/process/modify\n    authors:\n      - william.ballenthin@mandiant.com\n    scope: basic block\n    att&ck:\n      - Privilege Escalation::Access Token Manipulation [T1134]\n    examples:\n      - Practical Malware Analysis Lab 01-04.exe_:0x401174\n  features:\n    - and:\n      - string: \"SeDebugPrivilege\"\n      - optional:\n        - match: modify access privileges\n", "matches": [[{"type": "absolute", "value": 4479868}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "string", "string": "SeDebugPrivilege"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4479906}], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "match", "match": "modify access privileges"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "check for PEB BeingDebugged flag": {"meta": {"name": "check for PEB BeingDebugged flag", "namespace": "anti-analysis/anti-debugging/debugger-detection", "authors": ["moritz.raabe@mandiant.com"], "scope": "basic block", "attack": [], "mbc": [{"parts": ["Anti-Behavioral Analysis", "Debugger Detection", "Process Environment Block BeingDebugged"], "objective": "Anti-Behavioral Analysis", "behavior": "Debugger Detection", "method": "Process Environment Block BeingDebugged", "id": "B0001.035"}], "references": ["Practical Malware Analysis, Chapter 16, p. 353"], "examples": ["Practical Malware Analysis Lab 16-01.exe_:0x403530"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: check for PEB BeingDebugged flag\n    namespace: anti-analysis/anti-debugging/debugger-detection\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: basic block\n    mbc:\n      - Anti-Behavioral Analysis::Debugger Detection::Process Environment Block BeingDebugged [B0001.035]\n    references:\n      - Practical Malware Analysis, Chapter 16, p. 353\n    examples:\n      - Practical Malware Analysis Lab 16-01.exe_:0x403530\n  features:\n    - and:\n      - match: PEB access\n      - offset: 2 = PEB.BeingDebugged\n", "matches": [[{"type": "absolute", "value": 4325232}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "PEB access"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "peb access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4325272}], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "fs access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4325272}], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/aee9ee4a3df44121b21acb950535f6a7"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "arch", "arch": "i386"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "fs access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4325272}], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "offset", "offset": 48}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/b86186bb56c74ecaa2b476462ebf83f3"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "arch", "arch": "amd64"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "gs access"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "offset", "offset": 96}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/fc87da307f6f4da2b8fde64519f87688"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4325232}], "captures": {}}, {"success": true, "node": {"feature": {"type": "offset", "offset": 2, "description": "PEB.BeingDebugged"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4325284}], "captures": {}}], "locations": [], "captures": {}}]]}, "contain loop": {"meta": {"name": "contain loop", "authors": ["moritz.raabe@mandiant.com"], "scope": "function", "attack": [], "mbc": [], "references": [], "examples": ["08AC667C65D36D6542917655571E61C8:0x406EAA"], "description": "", "lib": true, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: contain loop\n    authors:\n      - moritz.raabe@mandiant.com\n    lib: true\n    scope: function\n    examples:\n      - 08AC667C65D36D6542917655571E61C8:0x406EAA\n  features:\n    - or:\n      - characteristic: loop\n      - characteristic: tight loop\n      - characteristic: recursive call\n", "matches": [[{"type": "absolute", "value": 4300810}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4300810}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4300840}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4300840}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4300895}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4300895}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4300915}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4300915}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4300975}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4300975}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4300980}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4300980}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4301005}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4301005}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4301110}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4301110}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4301120}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4301120}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4301140}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4301140}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4301150}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4301150}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4301200}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4301200}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4301265}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4301265}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4301275}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4301275}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4301280}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4301280}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4301355}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4301355}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4301420}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4301420}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4301460}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4301460}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4301520}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4301520}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4301545}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4301545}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4301555}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4301555}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4301625}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4301625}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4301760}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4301760}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4301785}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4301785}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4301835}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4301835}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4301905}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4301905}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4301915}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4301915}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4302020}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4302020}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4302085}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4302085}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4302110}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4302110}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4302160}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4302160}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4302165}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4302165}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4302190}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4302190}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4302215}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4302215}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4302260}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4302260}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4302285}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4302285}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4302305}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4302305}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4302355}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4302355}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4302375}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4502144}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4302420}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4302420}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4302425}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4302425}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4302450}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4302450}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4302480}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4302480}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4302495}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4302495}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4302535}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4302535}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4302635}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4302635}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4302675}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4302675}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4302685}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4302685}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4302705}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4302705}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4302715}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4302715}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4302750}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4302750}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4302810}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4302810}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4302830}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4302830}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4302950}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4302950}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4302965}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4302965}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4302970}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4302970}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4302975}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4302975}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4303130}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4303130}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4303270}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4303270}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4303320}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4303320}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4303355}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4303355}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4303430}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4303430}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4303460}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4303460}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4303470}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4303470}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4303505}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4303505}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4303510}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4303510}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4303555}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4303555}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4303745}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4303745}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4303880}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4303880}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4303920}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4303920}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4303925}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4303925}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4303950}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4303950}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4304070}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4304070}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4304090}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4304090}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4304095}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4304095}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4304105}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4304105}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4304145}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4304145}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4304225}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4304225}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4304315}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4304315}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4304440}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4304440}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4304520}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4304520}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4304535}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4304535}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4304605}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4304605}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4304635}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4304635}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4304645}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4304645}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4304725}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4304725}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4304735}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4304735}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4304740}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4304740}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4304845}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4304845}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4304945}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4304945}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4304995}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4304995}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4305005}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4305005}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4305010}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4305010}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4305085}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4305085}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4305115}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4305115}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4305195}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4305195}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4305315}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4305315}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4305330}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4305330}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4305360}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4305360}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4305495}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4305495}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4305550}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4305550}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4305560}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4305560}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4305575}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4305575}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4305715}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4305715}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4305785}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4305785}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4305815}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4305815}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4305820}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4305820}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4305845}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4305845}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4371168}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4371168}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4379632}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4379632}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4379904}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4379904}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4402832}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4402832}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4440528}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4440528}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4455904}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4455904}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4476272}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4476272}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4481456}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4481456}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4481728}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4481728}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4489616}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4489616}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "check for unmoving mouse cursor": {"meta": {"name": "check for unmoving mouse cursor", "namespace": "anti-analysis/anti-vm/vm-detection", "authors": ["BitsOfBinary"], "scope": "function", "attack": [{"parts": ["Defense Evasion", "Virtualization/Sandbox Evasion", "User Activity Based Checks"], "tactic": "Defense Evasion", "technique": "Virtualization/Sandbox Evasion", "subtechnique": "User Activity Based Checks", "id": "T1497.002"}], "mbc": [{"parts": ["Anti-Behavioral Analysis", "Virtual Machine Detection", "Human User Check"], "objective": "Anti-Behavioral Analysis", "behavior": "Virtual Machine Detection", "method": "Human User Check", "id": "B0009.012"}], "references": ["https://www.joesecurity.org/blog/5852460122427342172"], "examples": ["d7ff81ff775d4ab50d31ac1e962c8c4dea7ff9f280aa2b42ddd06760a5665002:0x401118"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: check for unmoving mouse cursor\n    namespace: anti-analysis/anti-vm/vm-detection\n    authors:\n      - BitsOfBinary\n    scope: function\n    att&ck:\n      - Defense Evasion::Virtualization/Sandbox Evasion::User Activity Based Checks [T1497.002]\n    mbc:\n      - Anti-Behavioral Analysis::Virtual Machine Detection::Human User Check [B0009.012]\n    references:\n      - https://www.joesecurity.org/blog/5852460122427342172\n    examples:\n      - d7ff81ff775d4ab50d31ac1e962c8c4dea7ff9f280aa2b42ddd06760a5665002:0x401118\n  features:\n    - and:\n      - count(api(user32.GetCursorPos)): 2 or more\n", "matches": [[{"type": "absolute", "value": 4300960}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"min": 2, "max": 9223372036854775808, "child": {"type": "api", "api": "user32.GetCursorPos"}, "type": "range"}, "type": "statement"}, "children": [], "locations": [{"type": "absolute", "value": 4414120}, {"type": "absolute", "value": 4414159}], "captures": {}}], "locations": [], "captures": {}}]]}, "reference WMI statements": {"meta": {"name": "reference WMI statements", "namespace": "collection/database/wmi", "authors": ["michael.hunhoff@mandiant.com"], "scope": "function", "attack": [{"parts": ["Collection", "Data from Information Repositories"], "tactic": "Collection", "technique": "Data from Information Repositories", "subtechnique": "", "id": "T1213"}], "mbc": [], "references": [], "examples": ["al-khaser_x86.exe_:0x433490"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: reference WMI statements\n    namespace: collection/database/wmi\n    authors:\n      - michael.hunhoff@mandiant.com\n    scope: function\n    att&ck:\n      - Collection::Data from Information Repositories [T1213]\n    examples:\n      - al-khaser_x86.exe_:0x433490\n  features:\n    - or:\n      - string: /SELECT\\s+\\*\\s+FROM\\s+CIM_./\n      - string: /SELECT\\s+\\*\\s+FROM\\s+Win32_./\n      - string: /SELECT\\s+\\*\\s+FROM\\s+MSAcpi_./\n", "matches": [[{"type": "absolute", "value": 4301005}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+CIM_./"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+Win32_./"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4432807}], "captures": {"SELECT * FROM Win32_PnPEntity": [{"type": "absolute", "value": 4432807}]}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+MSAcpi_./"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4301085}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+CIM_./"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4404152}], "captures": {"SELECT * FROM CIM_Sensor": [{"type": "absolute", "value": 4404152}]}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+Win32_./"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+MSAcpi_./"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4301150}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+CIM_./"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+Win32_./"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4430647}], "captures": {"SELECT * FROM Win32_NetworkAdapterConfiguration": [{"type": "absolute", "value": 4430647}]}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+MSAcpi_./"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4301280}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+CIM_./"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+Win32_./"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4411735}], "captures": {"SELECT * FROM Win32_ComputerSystem": [{"type": "absolute", "value": 4411735}]}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+MSAcpi_./"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4301510}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+CIM_./"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+Win32_./"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4415176}], "captures": {"SELECT * FROM Win32_PerfFormattedData_Counters_ThermalZoneInformation": [{"type": "absolute", "value": 4415176}]}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+MSAcpi_./"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4301520}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+CIM_./"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+Win32_./"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4427093}], "captures": {"SELECT * FROM Win32_NTEventlogFile": [{"type": "absolute", "value": 4427093}]}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+MSAcpi_./"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4301740}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+CIM_./"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4404024}], "captures": {"SELECT * FROM CIM_PhysicalConnector": [{"type": "absolute", "value": 4404024}]}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+Win32_./"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+MSAcpi_./"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4301910}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+CIM_./"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+Win32_./"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4415432}], "captures": {"SELECT * FROM Win32_PortConnector": [{"type": "absolute", "value": 4415432}]}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+MSAcpi_./"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4302035}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+CIM_./"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+Win32_./"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4418856}], "captures": {"SELECT * FROM Win32_SMBIOSMemory": [{"type": "absolute", "value": 4418856}]}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+MSAcpi_./"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4302085}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+CIM_./"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+Win32_./"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4415911}], "captures": {"SELECT * FROM Win32_Processor": [{"type": "absolute", "value": 4415911}]}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+MSAcpi_./"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4302175}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+CIM_./"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4403896}], "captures": {"SELECT * FROM CIM_NumericSensor": [{"type": "absolute", "value": 4403896}]}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+Win32_./"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+MSAcpi_./"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4302320}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+CIM_./"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+Win32_./"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4402744}], "captures": {"SELECT * FROM Win32_CacheMemory": [{"type": "absolute", "value": 4402744}]}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+MSAcpi_./"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4302480}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+CIM_./"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+Win32_./"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4431799}], "captures": {"SELECT * FROM Win32_PnPEntity": [{"type": "absolute", "value": 4431799}]}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+MSAcpi_./"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4302685}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+CIM_./"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+Win32_./"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4433607}], "captures": {"SELECT * FROM Win32_PnPDevice": [{"type": "absolute", "value": 4433607}]}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+MSAcpi_./"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4302705}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+CIM_./"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+Win32_./"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4413239}], "captures": {"SELECT * FROM Win32_ComputerSystem": [{"type": "absolute", "value": 4413239}]}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+MSAcpi_./"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4302745}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+CIM_./"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4403768}], "captures": {"SELECT * FROM CIM_Memory": [{"type": "absolute", "value": 4403768}]}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+Win32_./"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+MSAcpi_./"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4302960}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+CIM_./"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+Win32_./"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4413032}], "captures": {"SELECT * FROM Win32_MemoryDevice": [{"type": "absolute", "value": 4413032}]}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+MSAcpi_./"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4302970}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+CIM_./"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+Win32_./"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4417079}], "captures": {"SELECT * FROM Win32_BIOS": [{"type": "absolute", "value": 4417079}]}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+MSAcpi_./"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4303060}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+CIM_./"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+Win32_./"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4415304}], "captures": {"SELECT * FROM Win32_PhysicalMemory": [{"type": "absolute", "value": 4415304}]}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+MSAcpi_./"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4303510}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+CIM_./"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+Win32_./"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4407445}], "captures": {"SELECT * FROM Win32_LogicalDisk": [{"type": "absolute", "value": 4407445}]}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+MSAcpi_./"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4303720}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+CIM_./"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+Win32_./"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4412904}], "captures": {"SELECT * FROM Win32_MemoryArray": [{"type": "absolute", "value": 4412904}]}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+MSAcpi_./"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4303745}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+CIM_./"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+Win32_./"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4404750}], "captures": {"SELECT * FROM Win32_Fan": [{"type": "absolute", "value": 4404750}]}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+MSAcpi_./"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4304165}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+CIM_./"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4404280}], "captures": {"SELECT * FROM CIM_Slot": [{"type": "absolute", "value": 4404280}]}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+Win32_./"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+MSAcpi_./"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4304315}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+CIM_./"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+Win32_./"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4425015}], "captures": {"SELECT * FROM Win32_Bus": [{"type": "absolute", "value": 4425015}]}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+MSAcpi_./"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4304635}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+CIM_./"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+Win32_./"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4414487}], "captures": {"SELECT * FROM Win32_Processor": [{"type": "absolute", "value": 4414487}]}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+MSAcpi_./"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4305160}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+CIM_./"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4404536}], "captures": {"SELECT * FROM CIM_VoltageSensor": [{"type": "absolute", "value": 4404536}]}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+Win32_./"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+MSAcpi_./"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4305550}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+CIM_./"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+Win32_./"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4423975}], "captures": {"SELECT * FROM Win32_BaseBoard": [{"type": "absolute", "value": 4423975}]}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+MSAcpi_./"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4305555}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+CIM_./"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+Win32_./"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4419224}], "captures": {"SELECT * FROM Win32_VoltageProbe": [{"type": "absolute", "value": 4419224}]}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+MSAcpi_./"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4305815}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+CIM_./"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+Win32_./"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+MSAcpi_./"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4406343}], "captures": {"SELECT * FROM MSAcpi_ThermalZoneTemperature": [{"type": "absolute", "value": 4406343}]}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4305830}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+CIM_./"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4404408}], "captures": {"SELECT * FROM CIM_TemperatureSensor": [{"type": "absolute", "value": 4404408}]}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+Win32_./"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+MSAcpi_./"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4402832}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+CIM_./"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+Win32_./"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4402951}], "captures": {"SELECT * FROM Win32_VideoController": [{"type": "absolute", "value": 4402951}]}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+MSAcpi_./"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "write process memory": {"meta": {"name": "write process memory", "authors": ["moritz.raabe@mandiant.com"], "scope": "function", "attack": [{"parts": ["Defense Evasion", "Process Injection"], "tactic": "Defense Evasion", "technique": "Process Injection", "subtechnique": "", "id": "T1055"}], "mbc": [], "references": [], "examples": ["2D3EDC218A90F03089CC01715A9F047F:0x4027CF"], "description": "", "lib": true, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: write process memory\n    authors:\n      - moritz.raabe@mandiant.com\n    lib: true\n    scope: function\n    att&ck:\n      - Defense Evasion::Process Injection [T1055]\n    examples:\n      - 2D3EDC218A90F03089CC01715A9F047F:0x4027CF\n  features:\n    - or:\n      - api: kernel32.WriteProcessMemory\n      - api: ntdll.NtWriteVirtualMemory\n      - api: ntdll.ZwWriteVirtualMemory\n      - api: NtWow64WriteVirtualMemory64\n", "matches": [[{"type": "absolute", "value": 4301025}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.WriteProcessMemory"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4447116}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtWriteVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.ZwWriteVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtWow64WriteVirtualMemory64"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4301785}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.WriteProcessMemory"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4449068}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtWriteVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.ZwWriteVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtWow64WriteVirtualMemory64"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4301915}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.WriteProcessMemory"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4445204}, {"type": "absolute", "value": 4445350}, {"type": "absolute", "value": 4445407}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtWriteVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.ZwWriteVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtWow64WriteVirtualMemory64"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4302995}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.WriteProcessMemory"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4443714}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtWriteVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.ZwWriteVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtWow64WriteVirtualMemory64"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4305570}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.WriteProcessMemory"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4450690}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtWriteVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.ZwWriteVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtWow64WriteVirtualMemory64"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "link function at runtime on Windows": {"meta": {"name": "link function at runtime on Windows", "namespace": "linking/runtime-linking", "authors": ["moritz.raabe@mandiant.com", "michael.hunhoff@mandiant.com"], "scope": "function", "attack": [{"parts": ["Execution", "Shared Modules"], "tactic": "Execution", "technique": "Shared Modules", "subtechnique": "", "id": "T1129"}], "mbc": [], "references": [], "examples": ["9324D1A8AE37A36AE560C37448C9705A:0x404130", "Practical Malware Analysis Lab 01-04.exe_:0x401350"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: link function at runtime on Windows\n    namespace: linking/runtime-linking\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scope: function\n    att&ck:\n      - Execution::Shared Modules [T1129]\n    examples:\n      - 9324D1A8AE37A36AE560C37448C9705A:0x404130\n      - Practical Malware Analysis Lab 01-04.exe_:0x401350\n  features:\n    - and:\n      - os: windows\n      - or:\n        - api: kernel32.GetProcAddress\n        - api: ntdll.LdrGetProcedureAddress\n      - optional:\n        - characteristic: indirect call\n        - api: kernel32.LoadLibrary\n        - api: kernel32.GetModuleHandle\n        - api: kernel32.GetModuleHandleEx\n        - api: ntdll.LdrLoadDll\n", "matches": [[{"type": "absolute", "value": 4301025}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetProcAddress"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4446824}, {"type": "absolute", "value": 4446683}, {"type": "absolute", "value": 4446726}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.LdrGetProcedureAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "indirect call"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4447337}, {"type": "absolute", "value": 4447291}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.LoadLibrary"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetModuleHandle"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4446569}, {"type": "absolute", "value": 4446621}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetModuleHandleEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.LdrLoadDll"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4301785}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetProcAddress"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4448694}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.LdrGetProcedureAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "indirect call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.LoadLibrary"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetModuleHandle"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4448619}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetModuleHandleEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.LdrLoadDll"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4301915}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetProcAddress"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4445034}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.LdrGetProcedureAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "indirect call"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4445069}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.LoadLibrary"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetModuleHandle"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4445020}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetModuleHandleEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.LdrLoadDll"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4302420}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetProcAddress"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4453977}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.LdrGetProcedureAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "indirect call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.LoadLibrary"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4453918}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetModuleHandle"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetModuleHandleEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.LdrLoadDll"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4302465}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetProcAddress"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4442097}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.LdrGetProcedureAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "indirect call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.LoadLibrary"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetModuleHandle"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4442047}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetModuleHandleEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.LdrLoadDll"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4302995}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetProcAddress"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4443443}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.LdrGetProcedureAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "indirect call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.LoadLibrary"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetModuleHandle"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4443374}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetModuleHandleEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.LdrLoadDll"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4305570}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetProcAddress"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4450300}, {"type": "absolute", "value": 4450398}, {"type": "absolute", "value": 4450199}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.LdrGetProcedureAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "indirect call"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4450769}, {"type": "absolute", "value": 4450815}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.LoadLibrary"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetModuleHandle"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4450225}, {"type": "absolute", "value": 4450143}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetModuleHandleEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.LdrLoadDll"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4305765}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetProcAddress"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4451770}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.LdrGetProcedureAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "indirect call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.LoadLibrary"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4451695}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetModuleHandle"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetModuleHandleEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.LdrLoadDll"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4305820}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetProcAddress"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4511151}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.LdrGetProcedureAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "indirect call"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4511233}, {"type": "absolute", "value": 4511395}, {"type": "absolute", "value": 4511580}, {"type": "absolute", "value": 4511560}, {"type": "absolute", "value": 4511690}, {"type": "absolute", "value": 4511499}, {"type": "absolute", "value": 4511275}, {"type": "absolute", "value": 4511786}, {"type": "absolute", "value": 4511600}, {"type": "absolute", "value": 4511540}, {"type": "absolute", "value": 4511317}, {"type": "absolute", "value": 4511446}, {"type": "absolute", "value": 4511196}, {"type": "absolute", "value": 4511356}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.LoadLibrary"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetModuleHandle"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetModuleHandleEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.LdrLoadDll"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4305845}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetProcAddress"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4328463}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.LdrGetProcedureAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "indirect call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.LoadLibrary"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetModuleHandle"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetModuleHandleEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.LdrLoadDll"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "query environment variable": {"meta": {"name": "query environment variable", "namespace": "host-interaction/environment-variable", "authors": ["michael.hunhoff@mandiant.com", "@_re_fox"], "scope": "function", "attack": [{"parts": ["Discovery", "System Information Discovery"], "tactic": "Discovery", "technique": "System Information Discovery", "subtechnique": "", "id": "T1082"}], "mbc": [{"parts": ["Discovery", "System Information Discovery"], "objective": "Discovery", "behavior": "System Information Discovery", "method": "", "id": "E1082"}], "references": [], "examples": ["Practical Malware Analysis Lab 14-02.exe_:0x401880", "0761142efbda6c4b1e801223de723578:0x65483490"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: query environment variable\n    namespace: host-interaction/environment-variable\n    authors:\n      - michael.hunhoff@mandiant.com\n      - \"@_re_fox\"\n    scope: function\n    att&ck:\n      - Discovery::System Information Discovery [T1082]\n    mbc:\n      - Discovery::System Information Discovery [E1082]\n    examples:\n      - Practical Malware Analysis Lab 14-02.exe_:0x401880\n      - 0761142efbda6c4b1e801223de723578:0x65483490\n  features:\n    - or:\n      - api: kernel32.GetEnvironmentVariable\n      - api: kernel32.GetEnvironmentStrings\n      - api: kernel32.ExpandEnvironmentStrings\n      - api: msvcr90.getenv\n      - api: msvcrt.getenv\n      - api: System.Environment::GetEnvironmentVariable\n      - api: System.Environment::GetEnvironmentVariables\n      - api: System.Environment::ExpandEnvironmentVariables\n", "matches": [[{"type": "absolute", "value": 4301060}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetEnvironmentVariable"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetEnvironmentStrings"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.ExpandEnvironmentStrings"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4426635}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "msvcr90.getenv"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "msvcrt.getenv"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Environment::GetEnvironmentVariable"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Environment::GetEnvironmentVariables"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Environment::ExpandEnvironmentVariables"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4301125}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetEnvironmentVariable"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4369648}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetEnvironmentStrings"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.ExpandEnvironmentStrings"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "msvcr90.getenv"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "msvcrt.getenv"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Environment::GetEnvironmentVariable"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Environment::GetEnvironmentVariables"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Environment::ExpandEnvironmentVariables"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4303780}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetEnvironmentVariable"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4397590}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetEnvironmentStrings"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.ExpandEnvironmentStrings"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "msvcr90.getenv"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "msvcrt.getenv"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Environment::GetEnvironmentVariable"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Environment::GetEnvironmentVariables"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Environment::ExpandEnvironmentVariables"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4305655}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetEnvironmentVariable"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetEnvironmentStrings"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.ExpandEnvironmentStrings"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4437973}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "msvcr90.getenv"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "msvcrt.getenv"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Environment::GetEnvironmentVariable"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Environment::GetEnvironmentVariables"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Environment::ExpandEnvironmentVariables"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "get common file path": {"meta": {"name": "get common file path", "namespace": "host-interaction/file-system", "authors": ["moritz.raabe@mandiant.com", "michael.hunhoff@mandiant.com", "anushka.virgaonkar@mandiant.com"], "scope": "function", "attack": [{"parts": ["Discovery", "File and Directory Discovery"], "tactic": "Discovery", "technique": "File and Directory Discovery", "subtechnique": "", "id": "T1083"}], "mbc": [{"parts": ["Discovery", "File and Directory Discovery"], "objective": "Discovery", "behavior": "File and Directory Discovery", "method": "", "id": "E1083"}], "references": [], "examples": ["Practical Malware Analysis Lab 03-02.dll_:0x10003415", "972B219F18379907A045431303F4DA7D:0x404887"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: get common file path\n    namespace: host-interaction/file-system\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scope: function\n    att&ck:\n      - Discovery::File and Directory Discovery [T1083]\n    mbc:\n      - Discovery::File and Directory Discovery [E1083]\n    examples:\n      - Practical Malware Analysis Lab 03-02.dll_:0x10003415\n      - 972B219F18379907A045431303F4DA7D:0x404887\n  features:\n    - or:\n      - api: kernel32.GetTempPath\n      - api: kernel32.GetTempFileName\n      - api: kernel32.GetSystemDirectory\n      - api: kernel32.GetWindowsDirectory\n      - api: kernel32.GetSystemWow64Directory\n      - api: GetAllUsersProfileDirectory\n      - api: GetAppContainerFolderPath\n      - api: GetCurrentDirectory\n      - api: GetDefaultUserProfileDirectory\n      - api: GetProfilesDirectory\n      - api: GetUserProfileDirectory\n      - api: SHGetFolderPathAndSubDir\n      - api: shell32.SHGetFolderPath\n      - api: shell32.SHGetFolderLocation\n      - api: shell32.SHGetSpecialFolderPath\n      - api: shell32.SHGetSpecialFolderLocation\n      - api: System.IO.Directory::GetCurrentDirectory\n      - api: System.Environment::GetFolderPath\n      - property/read: System.Environment::SystemDirectory\n      - property/read: System.Environment::CurrentDirectory\n", "matches": [[{"type": "absolute", "value": 4301060}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetTempPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetTempFileName"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetSystemDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetWindowsDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetSystemWow64Directory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetAllUsersProfileDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetAppContainerFolderPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetCurrentDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetDefaultUserProfileDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetProfilesDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetUserProfileDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHGetFolderPathAndSubDir"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetFolderPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetFolderLocation"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "shell32.SHGetSpecialFolderPath"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4426665}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetSpecialFolderLocation"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.Directory::GetCurrentDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Environment::GetFolderPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.Environment::SystemDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.Environment::CurrentDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4301125}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetTempPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetTempFileName"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetSystemDirectory"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4369447}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetWindowsDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetSystemWow64Directory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetAllUsersProfileDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetAppContainerFolderPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetCurrentDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetDefaultUserProfileDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetProfilesDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetUserProfileDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHGetFolderPathAndSubDir"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "shell32.SHGetFolderPath"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4369477}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetFolderLocation"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetSpecialFolderPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetSpecialFolderLocation"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.Directory::GetCurrentDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Environment::GetFolderPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.Environment::SystemDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.Environment::CurrentDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4301545}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetTempPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetTempFileName"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetSystemDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetWindowsDirectory"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4428784}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetSystemWow64Directory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetAllUsersProfileDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetAppContainerFolderPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetCurrentDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetDefaultUserProfileDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetProfilesDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetUserProfileDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHGetFolderPathAndSubDir"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetFolderPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetFolderLocation"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetSpecialFolderPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetSpecialFolderLocation"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.Directory::GetCurrentDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Environment::GetFolderPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.Environment::SystemDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.Environment::CurrentDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4305560}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetTempPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetTempFileName"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetSystemDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetWindowsDirectory"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4438548}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetSystemWow64Directory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetAllUsersProfileDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetAppContainerFolderPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetCurrentDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetDefaultUserProfileDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetProfilesDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetUserProfileDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHGetFolderPathAndSubDir"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetFolderPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetFolderLocation"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetSpecialFolderPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetSpecialFolderLocation"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.Directory::GetCurrentDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Environment::GetFolderPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.Environment::SystemDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.Environment::CurrentDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4305655}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetTempPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetTempFileName"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetSystemDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetWindowsDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetSystemWow64Directory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetAllUsersProfileDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetAppContainerFolderPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetCurrentDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetDefaultUserProfileDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetProfilesDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetUserProfileDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHGetFolderPathAndSubDir"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetFolderPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetFolderLocation"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "shell32.SHGetSpecialFolderPath"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4438003}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetSpecialFolderLocation"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.Directory::GetCurrentDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Environment::GetFolderPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.Environment::SystemDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.Environment::CurrentDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "enumerate process modules": {"meta": {"name": "enumerate process modules", "namespace": "host-interaction/process/modules/list", "authors": ["michael.hunhoff@mandiant.com", "anushka.virgaonkar@mandiant.com"], "scope": "function", "attack": [{"parts": ["Discovery", "Process Discovery"], "tactic": "Discovery", "technique": "Process Discovery", "subtechnique": "", "id": "T1057"}], "mbc": [], "references": [], "examples": ["6F99A2C8944CB02FF28C6F9CED59B161:0x419FF8", "9B2FD471274C41626B75DDBB5C897877:0x100046B0"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: enumerate process modules\n    namespace: host-interaction/process/modules/list\n    authors:\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scope: function\n    att&ck:\n      - Discovery::Process Discovery [T1057]\n    examples:\n      - 6F99A2C8944CB02FF28C6F9CED59B161:0x419FF8\n      - 9B2FD471274C41626B75DDBB5C897877:0x100046B0\n  features:\n    - or:\n      - and:\n        - optional:\n          - or:\n            - api: kernel32.OpenProcess\n            - api: kernel32.CloseHandle\n        - or:\n          - api: kernel32.K32EnumProcessModules\n          - api: kernel32.K32EnumProcessModulesEx\n          - api: kernel32.K32EnumProcesses\n          # depending on OS version in kernel32 or psapi\n          - api: EnumProcessModules\n          - api: EnumProcessModulesEx\n          - api: EnumProcesses\n      - and:\n        - api: kernel32.Module32First\n        - api: kernel32.Module32Next\n        - optional:\n          - basic block:\n            - and:\n              - or:\n                - number: 0x8 = TH32CS_SNAPMODULE\n                - number: 0x10 = TH32CS_SNAPMODULE32\n                - number: 0x18 = TH32CS_SNAPMODULE | TH32CS_SNAPMODULE32\n              - api: kernel32.CreateToolhelp32Snapshot\n      - and:\n        - property/read: System.Diagnostics.Process::Modules\n        - property/read: System.Diagnostics.ProcessModuleCollection::Item\n", "matches": [[{"type": "absolute", "value": 4301120}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.Diagnostics.Process::Modules"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.Diagnostics.ProcessModuleCollection::Item"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.Module32First"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4448162}], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.Module32Next"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4448221}], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"scope": "basic block", "type": "subscope"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.CreateToolhelp32Snapshot"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4448127}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "number", "number": 8, "description": "TH32CS_SNAPMODULE"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4448125}], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 16, "description": "TH32CS_SNAPMODULE32"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 24, "description": "TH32CS_SNAPMODULE | TH32CS_SNAPMODULE32"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4448064}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.OpenProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.CloseHandle"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4448236}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.K32EnumProcessModules"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.K32EnumProcessModulesEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.K32EnumProcesses"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "EnumProcessModules"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "EnumProcessModulesEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "EnumProcesses"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4303270}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.Diagnostics.Process::Modules"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.Diagnostics.ProcessModuleCollection::Item"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.Module32First"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4378515}], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.Module32Next"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4378605}], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"scope": "basic block", "type": "subscope"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.CreateToolhelp32Snapshot"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4378424}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "number", "number": 8, "description": "TH32CS_SNAPMODULE"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 16, "description": "TH32CS_SNAPMODULE32"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 24, "description": "TH32CS_SNAPMODULE | TH32CS_SNAPMODULE32"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4378422}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4378352}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.OpenProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.CloseHandle"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4378651}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.K32EnumProcessModules"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.K32EnumProcessModulesEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.K32EnumProcesses"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "EnumProcessModules"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "EnumProcessModulesEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "EnumProcesses"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4303940}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.Diagnostics.Process::Modules"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.Diagnostics.ProcessModuleCollection::Item"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.Module32First"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.Module32Next"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "match", "match": "enumerate process modules/5f4b12286da84beea37c4febf65617b4"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.OpenProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.CloseHandle"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.K32EnumProcessModules"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.K32EnumProcessModulesEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.K32EnumProcesses"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4497339}, {"type": "absolute", "value": 4303940}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "EnumProcessModules"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "EnumProcessModulesEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "EnumProcesses"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4305095}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.Diagnostics.Process::Modules"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.Diagnostics.ProcessModuleCollection::Item"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.Module32First"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.Module32Next"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "match", "match": "enumerate process modules/5f4b12286da84beea37c4febf65617b4"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.OpenProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.CloseHandle"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.K32EnumProcessModules"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4497345}, {"type": "absolute", "value": 4305095}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.K32EnumProcessModulesEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.K32EnumProcesses"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "EnumProcessModules"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "EnumProcessModulesEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "EnumProcesses"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4476272}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.Diagnostics.Process::Modules"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.Diagnostics.ProcessModuleCollection::Item"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.Module32First"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.Module32Next"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "match", "match": "enumerate process modules/5f4b12286da84beea37c4febf65617b4"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.OpenProcess"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4476474}], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.CloseHandle"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4476570}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.K32EnumProcessModules"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4476525}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.K32EnumProcessModulesEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.K32EnumProcesses"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4476380}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "EnumProcessModules"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "EnumProcessModulesEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "EnumProcesses"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "get disk information": {"meta": {"name": "get disk information", "namespace": "host-interaction/hardware/storage", "authors": ["moritz.raabe@mandiant.com", "anushka.virgaonkar@mandiant.com"], "scope": "function", "attack": [{"parts": ["Discovery", "System Information Discovery"], "tactic": "Discovery", "technique": "System Information Discovery", "subtechnique": "", "id": "T1082"}], "mbc": [{"parts": ["Discovery", "System Information Discovery"], "objective": "Discovery", "behavior": "System Information Discovery", "method": "", "id": "E1082"}], "references": [], "examples": ["9324D1A8AE37A36AE560C37448C9705A:0x4052A0", "972B219F18379907A045431303F4DA7D:0x41064E"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: get disk information\n    namespace: host-interaction/hardware/storage\n    authors:\n      - moritz.raabe@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scope: function\n    att&ck:\n      - Discovery::System Information Discovery [T1082]\n    mbc:\n      - Discovery::System Information Discovery [E1082]\n    examples:\n      - 9324D1A8AE37A36AE560C37448C9705A:0x4052A0\n      - 972B219F18379907A045431303F4DA7D:0x41064E\n  features:\n    - or:\n      - api: kernel32.GetDriveType\n      - api: kernel32.GetLogicalDrives\n      - api: kernel32.GetVolumeInformation\n      - api: kernel32.GetVolumeNameForVolumeMountPoint\n      - api: kernel32.GetVolumePathNamesForVolumeName\n      - api: kernel32.GetLogicalDriveStrings\n      - api: kernel32.QueryDosDevice\n      - property/read: System.IO.DriveInfo::VolumeLabel\n      - property/read: System.IO.DriveInfo::DriveType\n      - property/read: System.IO.DriveInfo::DriveFormat\n      - property/read: System.IO.DriveInfo::Name\n", "matches": [[{"type": "absolute", "value": 4301125}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetDriveType"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetLogicalDrives"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetVolumeInformation"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetVolumeNameForVolumeMountPoint"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetVolumePathNamesForVolumeName"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetLogicalDriveStrings"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.QueryDosDevice"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4369690}], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.IO.DriveInfo::VolumeLabel"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.IO.DriveInfo::DriveType"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.IO.DriveInfo::DriveFormat"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.IO.DriveInfo::Name"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4371168}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetDriveType"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetLogicalDrives"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetVolumeInformation"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetVolumeNameForVolumeMountPoint"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetVolumePathNamesForVolumeName"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetLogicalDriveStrings"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.QueryDosDevice"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4371505}], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.IO.DriveInfo::VolumeLabel"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.IO.DriveInfo::DriveType"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.IO.DriveInfo::DriveFormat"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.IO.DriveInfo::Name"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "get system information on Windows": {"meta": {"name": "get system information on Windows", "namespace": "host-interaction/os/info", "authors": ["moritz.raabe@mandiant.com", "joakim@intezer.com"], "scope": "function", "attack": [{"parts": ["Discovery", "System Information Discovery"], "tactic": "Discovery", "technique": "System Information Discovery", "subtechnique": "", "id": "T1082"}], "mbc": [], "references": [], "examples": ["563653399B82CD443F120ECEFF836EA3678D4CF11D9B351BB737573C2D856299:0x140002280"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: get system information on Windows\n    namespace: host-interaction/os/info\n    authors:\n      - moritz.raabe@mandiant.com\n      - joakim@intezer.com\n    scope: function\n    att&ck:\n      - Discovery::System Information Discovery [T1082]\n    examples:\n      - 563653399B82CD443F120ECEFF836EA3678D4CF11D9B351BB737573C2D856299:0x140002280\n  features:\n    - and:\n      - os: windows\n      - or:\n        - api: kernel32.GetSystemInfo\n        - api: kernel32.GetNativeSystemInfo\n        - api: NtQuerySystemInformation\n        - api: NtQuerySystemInformationEx\n        - api: ntdll.RtlGetNativeSystemInformation\n        - api: ZwQuerySystemInformation\n        - api: ZwQuerySystemInformationEx\n", "matches": [[{"type": "absolute", "value": 4301140}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetSystemInfo"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4339704}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetNativeSystemInfo"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtQuerySystemInformation"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtQuerySystemInformationEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.RtlGetNativeSystemInformation"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwQuerySystemInformation"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwQuerySystemInformationEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4301460}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetSystemInfo"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4341064}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetNativeSystemInfo"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtQuerySystemInformation"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtQuerySystemInformationEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.RtlGetNativeSystemInformation"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwQuerySystemInformation"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwQuerySystemInformationEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4302915}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetSystemInfo"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4327421}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetNativeSystemInfo"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtQuerySystemInformation"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtQuerySystemInformationEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.RtlGetNativeSystemInformation"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwQuerySystemInformation"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwQuerySystemInformationEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4305445}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetSystemInfo"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4473175}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetNativeSystemInfo"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtQuerySystemInformation"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtQuerySystemInformationEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.RtlGetNativeSystemInformation"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwQuerySystemInformation"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwQuerySystemInformationEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4472852}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetSystemInfo"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4473175}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetNativeSystemInfo"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtQuerySystemInformation"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtQuerySystemInformationEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.RtlGetNativeSystemInformation"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwQuerySystemInformation"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwQuerySystemInformationEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "print debug messages": {"meta": {"name": "print debug messages", "namespace": "host-interaction/log/debug/write-event", "authors": ["michael.hunhoff@mandiant.com"], "scope": "function", "attack": [], "mbc": [], "references": [], "examples": ["493167E85E45363D09495D0841C30648:0x401000"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: print debug messages\n    namespace: host-interaction/log/debug/write-event\n    authors:\n      - michael.hunhoff@mandiant.com\n    scope: function\n    examples:\n      - 493167E85E45363D09495D0841C30648:0x401000\n  features:\n    - or:\n      - api: DbgPrint\n      - api: kernel32.OutputDebugString\n", "matches": [[{"type": "absolute", "value": 4301140}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "DbgPrint"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.OutputDebugString"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4340226}, {"type": "absolute", "value": 4340131}, {"type": "absolute", "value": 4340483}, {"type": "absolute", "value": 4340037}, {"type": "absolute", "value": 4339942}, {"type": "absolute", "value": 4340169}, {"type": "absolute", "value": 4340201}, {"type": "absolute", "value": 4340011}, {"type": "absolute", "value": 4340457}, {"type": "absolute", "value": 4340398}, {"type": "absolute", "value": 4340537}, {"type": "absolute", "value": 4340091}], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4301860}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "DbgPrint"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.OutputDebugString"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4333628}], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4303925}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "DbgPrint"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.OutputDebugString"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4395762}, {"type": "absolute", "value": 4395925}, {"type": "absolute", "value": 4395864}, {"type": "absolute", "value": 4395833}, {"type": "absolute", "value": 4395947}, {"type": "absolute", "value": 4395886}], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4304145}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "DbgPrint"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.OutputDebugString"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4396296}, {"type": "absolute", "value": 4396481}, {"type": "absolute", "value": 4396420}, {"type": "absolute", "value": 4396216}, {"type": "absolute", "value": 4396459}, {"type": "absolute", "value": 4396398}, {"type": "absolute", "value": 4396367}], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4304475}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "DbgPrint"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.OutputDebugString"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4395583}], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4305190}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "DbgPrint"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.OutputDebugString"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4395400}, {"type": "absolute", "value": 4395343}], "captures": {}}], "locations": [], "captures": {}}]]}, "check for debugger via API": {"meta": {"name": "check for debugger via API", "namespace": "anti-analysis/anti-debugging/debugger-detection", "authors": ["michael.hunhoff@mandiant.com", "anushka.virgaonkar@mandiant.com"], "scope": "function", "attack": [], "mbc": [{"parts": ["Anti-Behavioral Analysis", "Debugger Detection", "CheckRemoteDebuggerPresent"], "objective": "Anti-Behavioral Analysis", "behavior": "Debugger Detection", "method": "CheckRemoteDebuggerPresent", "id": "B0001.002"}, {"parts": ["Anti-Behavioral Analysis", "Debugger Detection", "WudfIsAnyDebuggerPresent"], "objective": "Anti-Behavioral Analysis", "behavior": "Debugger Detection", "method": "WudfIsAnyDebuggerPresent", "id": "B0001.031"}], "references": ["https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiDebug/CheckRemoteDebuggerPresent.cpp"], "examples": ["al-khaser_x86.exe_:0x420000"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: check for debugger via API\n    namespace: anti-analysis/anti-debugging/debugger-detection\n    authors:\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scope: function\n    mbc:\n      - Anti-Behavioral Analysis::Debugger Detection::CheckRemoteDebuggerPresent [B0001.002]\n      - Anti-Behavioral Analysis::Debugger Detection::WudfIsAnyDebuggerPresent [B0001.031]\n    references:\n      - https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiDebug/CheckRemoteDebuggerPresent.cpp\n    examples:\n      - al-khaser_x86.exe_:0x420000\n  features:\n    - or:\n      # We're not including kernel32.IsDebuggerPresent here because some exception handlers and other compiler-inserted\n      # code may add calls to it, especially in debug builds. So, likely even with pretty good library code detection\n      # this feature could result in many false positives.\n      - api: kernel32.CheckRemoteDebuggerPresent\n      - api: WUDFPlatform.WudfIsAnyDebuggerPresent\n      - api: WUDFPlatform.WudfIsKernelDebuggerPresent\n      - api: WUDFPlatform.WudfIsUserDebuggerPresent\n      - property/read: System.Diagnostics.Debugger::IsAttached\n", "matches": [[{"type": "absolute", "value": 4301550}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.CheckRemoteDebuggerPresent"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4325455}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "WUDFPlatform.WudfIsAnyDebuggerPresent"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "WUDFPlatform.WudfIsKernelDebuggerPresent"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "WUDFPlatform.WudfIsUserDebuggerPresent"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.Diagnostics.Debugger::IsAttached"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "check process job object": {"meta": {"name": "check process job object", "namespace": "anti-analysis/anti-debugging/debugger-detection", "authors": ["michael.hunhoff@mandiant.com"], "scope": "function", "attack": [], "mbc": [{"parts": ["Anti-Behavioral Analysis", "Debugger Detection"], "objective": "Anti-Behavioral Analysis", "behavior": "Debugger Detection", "method": "", "id": "B0001"}], "references": ["https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiDebug/ProcessJob.cpp"], "examples": ["al-khaser_x86.exe_:0x426730"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: check process job object\n    namespace: anti-analysis/anti-debugging/debugger-detection\n    authors:\n      - michael.hunhoff@mandiant.com\n    scope: function\n    mbc:\n      - Anti-Behavioral Analysis::Debugger Detection [B0001]\n    references:\n      - https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiDebug/ProcessJob.cpp\n    examples:\n      - al-khaser_x86.exe_:0x426730\n  features:\n    - and:\n      - match: contain loop\n      - basic block:\n        - and:\n          - api: kernel32.QueryInformationJobObject\n          - number: 0x3 = JobObjectBasicProcessIdList\n      - basic block:\n        - and:\n          - api: kernel32.OpenProcess\n          - number: 0x400 = PROCESS_QUERY_INFORMATION\n", "matches": [[{"type": "absolute", "value": 4301555}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "contain loop"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4301555}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4301555}], "captures": {}}, {"success": true, "node": {"statement": {"scope": "basic block", "type": "subscope"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.QueryInformationJobObject"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4351957}], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 3, "description": "JobObjectBasicProcessIdList"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4351953}], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4351915}], "captures": {}}, {"success": true, "node": {"statement": {"scope": "basic block", "type": "subscope"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.OpenProcess"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4352077}], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 1024, "description": "PROCESS_QUERY_INFORMATION"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4352072}], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4352064}], "captures": {}}], "locations": [], "captures": {}}]]}, "execute anti-debugging instructions": {"meta": {"name": "execute anti-debugging instructions", "namespace": "anti-analysis/anti-debugging/debugger-detection", "authors": ["moritz.raabe@mandiant.com"], "scope": "function", "attack": [], "mbc": [{"parts": ["Anti-Behavioral Analysis", "Debugger Detection", "Anti-debugging Instructions"], "objective": "Anti-Behavioral Analysis", "behavior": "Debugger Detection", "method": "Anti-debugging Instructions", "id": "B0001.034"}], "references": [], "examples": ["Practical Malware Analysis Lab 16-03.exe_:0x401300"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: execute anti-debugging instructions\n    namespace: anti-analysis/anti-debugging/debugger-detection\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: function\n    mbc:\n      - Anti-Behavioral Analysis::Debugger Detection::Anti-debugging Instructions [B0001.034]\n    examples:\n      - Practical Malware Analysis Lab 16-03.exe_:0x401300\n  features:\n    - or:\n      - count(mnemonic(rdtsc)): 2 or more\n      - mnemonic: icebp\n", "matches": [[{"type": "absolute", "value": 4301625}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "mnemonic", "mnemonic": "icebp"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"min": 2, "max": 9223372036854775808, "child": {"type": "mnemonic", "mnemonic": "rdtsc"}, "type": "range"}, "type": "statement"}, "children": [], "locations": [{"type": "absolute", "value": 4493440}, {"type": "absolute", "value": 4493468}], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4305195}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "mnemonic", "mnemonic": "icebp"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"min": 2, "max": 9223372036854775808, "child": {"type": "mnemonic", "mnemonic": "rdtsc"}, "type": "range"}, "type": "statement"}, "children": [], "locations": [{"type": "absolute", "value": 4493223}, {"type": "absolute", "value": 4493198}, {"type": "absolute", "value": 4493175}], "captures": {}}], "locations": [], "captures": {}}]]}, "terminate process": {"meta": {"name": "terminate process", "namespace": "host-interaction/process/terminate", "authors": ["moritz.raabe@mandiant.com", "michael.hunhoff@mandiant.com", "anushka.virgaonkar@mandiant.com"], "scope": "function", "attack": [], "mbc": [{"parts": ["Process", "Terminate Process"], "objective": "Process", "behavior": "Terminate Process", "method": "", "id": "C0018"}], "references": [], "examples": ["C91887D861D9BD4A5872249B641BC9F9:0x401A77", "9B7CCAA2AE6A5B96E3110EBCBC4311F6:0x10010307"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: terminate process\n    namespace: host-interaction/process/terminate\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scope: function\n    mbc:\n      - Process::Terminate Process [C0018]\n    examples:\n      - C91887D861D9BD4A5872249B641BC9F9:0x401A77\n      - 9B7CCAA2AE6A5B96E3110EBCBC4311F6:0x10010307\n  features:\n    - or:\n      - api: System.Diagnostics.Process::Kill\n      - api: System.Diagnostics.Process::WaitForExit\n      - api: System.Diagnostics.Process::WaitForExitAsync\n      - api: System.Environment::Exit\n      - api: System.Windows.Forms.Application::Exit\n      - and:\n        - optional:\n          - match: open process\n        - or:\n          - api: kernel32.TerminateProcess\n          - api: ntdll.NtTerminateProcess\n          - api: kernel32.ExitProcess\n", "matches": [[{"type": "absolute", "value": 4301750}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "System.Diagnostics.Process::Kill"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Diagnostics.Process::WaitForExit"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Diagnostics.Process::WaitForExitAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Environment::Exit"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Windows.Forms.Application::Exit"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "match", "match": "open process"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.TerminateProcess"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4500993}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtTerminateProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.ExitProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "enumerate processes": {"meta": {"name": "enumerate processes", "namespace": "host-interaction/process/list", "authors": ["moritz.raabe@mandiant.com", "michael.hunhoff@mandiant.com"], "scope": "function", "attack": [{"parts": ["Discovery", "Process Discovery"], "tactic": "Discovery", "technique": "Process Discovery", "subtechnique": "", "id": "T1057"}, {"parts": ["Discovery", "Software Discovery"], "tactic": "Discovery", "technique": "Software Discovery", "subtechnique": "", "id": "T1518"}], "mbc": [], "references": [], "examples": ["2D3EDC218A90F03089CC01715A9F047F:0x403DAB", "35d04ecd797041eee796f4ddaa96cae8:0x10004F34"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: enumerate processes\n    namespace: host-interaction/process/list\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scope: function\n    att&ck:\n      - Discovery::Process Discovery [T1057]\n      - Discovery::Software Discovery [T1518]\n    examples:\n      - 2D3EDC218A90F03089CC01715A9F047F:0x403DAB\n      - 35d04ecd797041eee796f4ddaa96cae8:0x10004F34\n  features:\n    - or:\n      - api: System.Diagnostics.Process::GetProcesses\n      - and:\n        - api: kernel32.Process32First\n        - api: kernel32.Process32Next\n        - optional:\n          - basic block:\n            - and:\n              - or:\n                - number: 0xF = TH32CS_SNAPALL\n                - number: 0x2 = TH32CS_SNAPPROCESS\n              - api: kernel32.CreateToolhelp32Snapshot\n", "matches": [[{"type": "absolute", "value": 4301760}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "System.Diagnostics.Process::GetProcesses"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.Process32First"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4477140}], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.Process32Next"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4477265}], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"scope": "basic block", "type": "subscope"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.CreateToolhelp32Snapshot"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4477076}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "number", "number": 15, "description": "TH32CS_SNAPALL"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 2, "description": "TH32CS_SNAPPROCESS"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4477074}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4476992}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "inject APC": {"meta": {"name": "inject APC", "namespace": "host-interaction/process/inject", "authors": ["william.ballenthin@mandiant.com"], "scope": "function", "attack": [{"parts": ["Defense Evasion", "Process Injection", "Asynchronous Procedure Call"], "tactic": "Defense Evasion", "technique": "Process Injection", "subtechnique": "Asynchronous Procedure Call", "id": "T1055.004"}], "mbc": [], "references": [], "examples": ["al-khaser_x64.exe_:0x140019348"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: inject APC\n    namespace: host-interaction/process/inject\n    authors:\n      - william.ballenthin@mandiant.com\n    scope: function\n    att&ck:\n      - Defense Evasion::Process Injection::Asynchronous Procedure Call [T1055.004]\n    examples:\n      - al-khaser_x64.exe_:0x140019348\n  features:\n    - and:\n      - or:\n        - match: write process memory\n        - match: create or open section object\n        - api: kernel32.MapViewOfFile\n      - or:\n        - api: kernel32.QueueUserAPC\n        - api: ntdll.NtQueueApcThread\n      - optional:\n        - or:\n          - number: 0x1fffff = THREAD_ALL_ACCESS\n          - api: kernel32.CreateProcess\n          - api: kernel32.OpenProcess\n", "matches": [[{"type": "absolute", "value": 4301785}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.QueueUserAPC"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4449254}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtQueueApcThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "write process memory"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.WriteProcessMemory"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4449068}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtWriteVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.ZwWriteVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtWow64WriteVirtualMemory64"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4301785}], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "create or open section object"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.MapViewOfFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "number", "number": 2097151, "description": "THREAD_ALL_ACCESS"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4448793}, {"type": "absolute", "value": 4449198}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.CreateProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.OpenProcess"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4448798}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "enumerate threads": {"meta": {"name": "enumerate threads", "namespace": "host-interaction/thread/list", "authors": ["moritz.raabe@mandiant.com"], "scope": "function", "attack": [{"parts": ["Discovery", "Process Discovery"], "tactic": "Discovery", "technique": "Process Discovery", "subtechnique": "", "id": "T1057"}], "mbc": [{"parts": ["Process", "Enumerate Threads"], "objective": "Process", "behavior": "Enumerate Threads", "method": "", "id": "C0064"}], "references": [], "examples": ["Practical Malware Analysis Lab 05-01.dll_:0x10006BD5"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: enumerate threads\n    namespace: host-interaction/thread/list\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: function\n    att&ck:\n      - Discovery::Process Discovery [T1057]\n    mbc:\n      - Process::Enumerate Threads [C0064]\n    examples:\n      - Practical Malware Analysis Lab 05-01.dll_:0x10006BD5\n  features:\n    - and:\n      - api: kernel32.Thread32First\n      - api: kernel32.Thread32Next\n      - optional:\n        - basic block:\n          - and:\n            - or:\n              - number: 0x4 = TH32CS_SNAPTHREAD\n              # TH32CS_SNAPTHREAD includes all threads in the system in the snapshot\n            - api: kernel32.CreateToolhelp32Snapshot\n", "matches": [[{"type": "absolute", "value": 4301785}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.Thread32First"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4449156}], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.Thread32Next"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4449364}], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"scope": "basic block", "type": "subscope"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.CreateToolhelp32Snapshot"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4449107}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "number", "number": 4, "description": "TH32CS_SNAPTHREAD"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4449105}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4449103}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4302305}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.Thread32First"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4472615}], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.Thread32Next"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4472739}], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"scope": "basic block", "type": "subscope"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.CreateToolhelp32Snapshot"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4472582}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "number", "number": 4, "description": "TH32CS_SNAPTHREAD"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4472580}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4472528}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "get file size": {"meta": {"name": "get file size", "namespace": "host-interaction/file-system/meta", "authors": ["michael.hunhoff@mandiant.com", "anushka.virgaonkar@mandiant.com"], "scope": "function", "attack": [{"parts": ["Discovery", "File and Directory Discovery"], "tactic": "Discovery", "technique": "File and Directory Discovery", "subtechnique": "", "id": "T1083"}], "mbc": [{"parts": ["Discovery", "File and Directory Discovery"], "objective": "Discovery", "behavior": "File and Directory Discovery", "method": "", "id": "E1083"}], "references": [], "examples": ["mimikatz.exe_:0x40630D"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: get file size\n    namespace: host-interaction/file-system/meta\n    authors:\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scope: function\n    att&ck:\n      - Discovery::File and Directory Discovery [T1083]\n    mbc:\n      - Discovery::File and Directory Discovery [E1083]\n    examples:\n      - mimikatz.exe_:0x40630D\n  features:\n    - or:\n      - api: kernel32.GetFileSize\n      - api: kernel32.GetFileSizeEx\n      - property/read: System.IO.FileInfo::Length\n", "matches": [[{"type": "absolute", "value": 4301915}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetFileSize"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4444753}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetFileSizeEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.IO.FileInfo::Length"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "read file on Windows": {"meta": {"name": "read file on Windows", "namespace": "host-interaction/file-system/read", "authors": ["moritz.raabe@mandiant.com", "anushka.virgaonkar@mandiant.com"], "scope": "function", "attack": [], "mbc": [{"parts": ["File System", "Read File"], "objective": "File System", "behavior": "Read File", "method": "", "id": "C0051"}], "references": [], "examples": ["BFB9B5391A13D0AFD787E87AB90F14F5:0x1314567B"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: read file on Windows\n    namespace: host-interaction/file-system/read\n    authors:\n      - moritz.raabe@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scope: function\n    mbc:\n      - File System::Read File [C0051]\n    examples:\n      - BFB9B5391A13D0AFD787E87AB90F14F5:0x1314567B\n  features:\n    - or:\n      - and:\n        - os: windows\n        - optional:\n          - and:\n            - number: 0x80000000 = GENERIC_READ\n            - api: kernel32.CreateFile\n        - or:\n          - api: kernel32.ReadFile\n          - api: ReadFileEx\n          - api: NtReadFile\n          - api: ZwReadFile\n          - api: _read\n          - api: fread\n      - api: System.IO.File::ReadAllBytes\n      - api: System.IO.File::ReadAllBytesAsync\n      - api: System.IO.File::ReadAllLines\n      - api: System.IO.File::ReadAllLinesAsync\n      - api: System.IO.File::ReadAllText\n      - api: System.IO.File::ReadAllTextAsync\n      - api: System.IO.File::ReadLines\n", "matches": [[{"type": "absolute", "value": 4301915}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::ReadAllBytes"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::ReadAllBytesAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::ReadAllLines"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::ReadAllLinesAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::ReadAllText"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::ReadAllTextAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::ReadLines"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "number", "number": 2147483648, "description": "GENERIC_READ"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4444684}], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.CreateFile"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4444696}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.ReadFile"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4444904}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ReadFileEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtReadFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwReadFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "_read"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "fread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "use process replacement": {"meta": {"name": "use process replacement", "namespace": "host-interaction/process/inject", "authors": ["william.ballenthin@mandiant.com"], "scope": "function", "attack": [{"parts": ["Defense Evasion", "Process Injection", "Process Hollowing"], "tactic": "Defense Evasion", "technique": "Process Injection", "subtechnique": "Process Hollowing", "id": "T1055.012"}, {"parts": ["Defense Evasion", "Reflective Code Loading"], "tactic": "Defense Evasion", "technique": "Reflective Code Loading", "subtechnique": "", "id": "T1620"}], "mbc": [], "references": ["http://www.autosectools.com/process-hollowing.pdf", "https://www.andreafortuna.org/2017/10/09/understanding-process-hollowing/"], "examples": ["Practical Malware Analysis Lab 12-02.exe_:0x4010EA"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: use process replacement\n    namespace: host-interaction/process/inject\n    authors:\n      - william.ballenthin@mandiant.com\n    scope: function\n    att&ck:\n      - Defense Evasion::Process Injection::Process Hollowing [T1055.012]\n      - Defense Evasion::Reflective Code Loading [T1620]\n    references:\n      - http://www.autosectools.com/process-hollowing.pdf\n      - https://www.andreafortuna.org/2017/10/09/understanding-process-hollowing/\n    examples:\n      - Practical Malware Analysis Lab 12-02.exe_:0x4010EA\n  features:\n    - and:\n      - match: create process suspended\n      - match: write process memory\n      - match: resume thread\n", "matches": [[{"type": "absolute", "value": 4301915}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "create process suspended"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "number", "number": 134217732, "description": "CREATE_NO_WINDOW | CREATE_SUSPENDED"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 4, "description": "CREATE_SUSPENDED"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4444439}], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.CreateProcess"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4444453}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.CreateProcessAsUser"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4444419}], "captures": {}}, {"success": true, "node": {"feature": {"type": "match", "match": "write process memory"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.WriteProcessMemory"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4445204}, {"type": "absolute", "value": 4445350}, {"type": "absolute", "value": 4445407}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtWriteVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.ZwWriteVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtWow64WriteVirtualMemory64"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4301915}], "captures": {}}, {"success": true, "node": {"feature": {"type": "match", "match": "resume thread"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.ResumeThread"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4445485}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtResumeThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.ZwResumeThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Threading.Thread::Resume"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4445368}], "captures": {}}], "locations": [], "captures": {}}]]}, "enumerate PE sections": {"meta": {"name": "enumerate PE sections", "namespace": "load-code/pe", "authors": ["@Ana06"], "scope": "function", "attack": [], "mbc": [{"parts": ["Discovery", "Code Discovery", "Enumerate PE Sections"], "objective": "Discovery", "behavior": "Code Discovery", "method": "Enumerate PE Sections", "id": "B0046.001"}], "references": ["https://0x00sec.org/t/reflective-dll-injection/3080", "https://www.ired.team/offensive-security/code-injection-process-injection/reflective-dll-injection"], "examples": ["E4C33AC3638EEF68311F8AC0D72483C7:0x401510"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: enumerate PE sections\n    namespace: load-code/pe\n    authors:\n      - \"@Ana06\"\n    scope: function\n    mbc:\n      - Discovery::Code Discovery::Enumerate PE Sections [B0046.001]\n    references:\n      - https://0x00sec.org/t/reflective-dll-injection/3080\n      - https://www.ired.team/offensive-security/code-injection-process-injection/reflective-dll-injection\n    examples:\n      - E4C33AC3638EEF68311F8AC0D72483C7:0x401510\n  features:\n    - and:\n      - os: windows\n      # there should be some complexity to functions like this\n      - count(basic blocks): 3 or more\n      - optional:\n        - offset: 0x3C = IMAGE_DOS_HEADER.e_lfanew\n      - instruction:\n        - or:\n          - mnemonic: mov\n          - mnemonic: movzx\n        - operand[1].offset: 0x6 = IMAGE_NT_HEADERS.FileHeader.NumberOfSections\n      - basic block:\n        - or:\n          - and:\n            - description: IMAGE_FIRST_SECTION(nt_header)\n            - instruction:\n              - or:\n                - mnemonic: add\n                - mnemonic: mov\n                - mnemonic: movzx\n              - operand[1].offset: 0x14 = IMAGE_NT_HEADERS.FileHeader.SizeOfOptionalHeader\n            - operand[1].offset: 0x18 = FileHeader.SizeOfOptionalHeader\n          - and:\n            - description: (DWORD)dll_raw + dos_header->e_lfanew + sizeof(IMAGE_NT_HEADERS) + sizeof(IMAGE_SECTION_HEADER) * i\n            - number: 0x28 = sizeof(IMAGE_SECTION_HEADER)\n            - or:\n              - and:\n                - arch: i386\n                - operand[1].offset: 0xF8 = sizeof(IMAGE_NT_HEADERS32)\n              - and:\n                - arch: amd64\n                - operand[1].offset: 0x108 = sizeof(IMAGE_NT_HEADERS64)\n      - basic block:\n        - and:\n          - operand[1].offset: 0xC = IMAGE_SECTION_HEADER.VirtualAddress\n          - operand[1].offset: 0x14 = IMAGE_SECTION_HEADER.PointerToRawData\n          - operand[1].offset: 0x10 = IMAGE_SECTION_HEADER.SizeOfRawData\n          - not:\n            # non-zeroing XOR was observed in FPs\n            - characteristic: nzxor\n", "matches": [[{"type": "absolute", "value": 4301915}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"scope": "instruction", "type": "subscope"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "operand offset", "index": 1, "operand_offset": 6, "description": "IMAGE_NT_HEADERS.FileHeader.NumberOfSections"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4445250}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "mnemonic", "mnemonic": "mov"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "mnemonic", "mnemonic": "movzx"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4445250}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4445250}], "captures": {}}, {"success": true, "node": {"statement": {"scope": "basic block", "type": "subscope"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and", "description": "IMAGE_FIRST_SECTION(nt_header)"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"scope": "instruction", "type": "subscope"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "operand offset", "index": 1, "operand_offset": 20, "description": "IMAGE_NT_HEADERS.FileHeader.SizeOfOptionalHeader"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4445323}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "mnemonic", "mnemonic": "add"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4445323}], "captures": {}}, {"success": false, "node": {"feature": {"type": "mnemonic", "mnemonic": "mov"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "mnemonic", "mnemonic": "movzx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4445323}], "captures": {}}, {"success": false, "node": {"feature": {"type": "operand offset", "index": 1, "operand_offset": 24, "description": "FileHeader.SizeOfOptionalHeader"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and", "description": "(DWORD)dll_raw + dos_header->e_lfanew + sizeof(IMAGE_NT_HEADERS) + sizeof(IMAGE_SECTION_HEADER) * i"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "number", "number": 40, "description": "sizeof(IMAGE_SECTION_HEADER)"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4445277}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "arch", "arch": "i386"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"feature": {"type": "operand offset", "index": 1, "operand_offset": 248, "description": "sizeof(IMAGE_NT_HEADERS32)"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4445284}], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "arch", "arch": "amd64"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "operand offset", "index": 1, "operand_offset": 264, "description": "sizeof(IMAGE_NT_HEADERS64)"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4445262}], "captures": {}}, {"success": true, "node": {"statement": {"scope": "basic block", "type": "subscope"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "operand offset", "index": 1, "operand_offset": 12, "description": "IMAGE_SECTION_HEADER.VirtualAddress"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4445339}], "captures": {}}, {"success": true, "node": {"feature": {"type": "operand offset", "index": 1, "operand_offset": 20, "description": "IMAGE_SECTION_HEADER.PointerToRawData"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4445323}], "captures": {}}, {"success": true, "node": {"feature": {"type": "operand offset", "index": 1, "operand_offset": 16, "description": "IMAGE_SECTION_HEADER.SizeOfRawData"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4445307}], "captures": {}}, {"success": true, "node": {"statement": {"type": "not"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "nzxor"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4445262}], "captures": {}}, {"success": true, "node": {"statement": {"min": 3, "max": 9223372036854775808, "child": {"type": "basic block"}, "type": "range"}, "type": "statement"}, "children": [], "locations": [{"type": "absolute", "value": 4444419}, {"type": "absolute", "value": 4445635}, {"type": "absolute", "value": 4444742}, {"type": "absolute", "value": 4444488}, {"type": "absolute", "value": 4445513}, {"type": "absolute", "value": 4445704}, {"type": "absolute", "value": 4445006}, {"type": "absolute", "value": 4444623}, {"type": "absolute", "value": 4444560}, {"type": "absolute", "value": 4445262}, {"type": "absolute", "value": 4445525}, {"type": "absolute", "value": 4444950}, {"type": "absolute", "value": 4445657}, {"type": "absolute", "value": 4445146}, {"type": "absolute", "value": 4445082}, {"type": "absolute", "value": 4301915}, {"type": "absolute", "value": 4444827}, {"type": "absolute", "value": 4445595}, {"type": "absolute", "value": 4445535}, {"type": "absolute", "value": 4445726}, {"type": "absolute", "value": 4445666}, {"type": "absolute", "value": 4445604}, {"type": "absolute", "value": 4445547}, {"type": "absolute", "value": 4445695}, {"type": "absolute", "value": 4445229}, {"type": "absolute", "value": 4444272}, {"type": "absolute", "value": 4445169}, {"type": "absolute", "value": 4444850}, {"type": "absolute", "value": 4444724}, {"type": "absolute", "value": 4444470}, {"type": "absolute", "value": 4445368}, {"type": "absolute", "value": 4445626}, {"type": "absolute", "value": 4445244}, {"type": "absolute", "value": 4444989}, {"type": "absolute", "value": 4444542}, {"type": "absolute", "value": 4444605}], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "offset", "offset": 60, "description": "IMAGE_DOS_HEADER.e_lfanew"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4444962}, {"type": "absolute", "value": 4445274}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "parse PE header": {"meta": {"name": "parse PE header", "namespace": "load-code/pe", "authors": ["moritz.raabe@mandiant.com"], "scope": "function", "attack": [{"parts": ["Execution", "Shared Modules"], "tactic": "Execution", "technique": "Shared Modules", "subtechnique": "", "id": "T1129"}], "mbc": [], "references": [], "examples": ["9324D1A8AE37A36AE560C37448C9705A:0x403DD0"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: parse PE header\n    namespace: load-code/pe\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: function\n    att&ck:\n      - Execution::Shared Modules [T1129]\n    examples:\n      - 9324D1A8AE37A36AE560C37448C9705A:0x403DD0\n  features:\n    - and:\n      - os: windows\n      - and:\n        - mnemonic: cmp\n        - or:\n          - number: 0x4550 = IMAGE_NT_SIGNATURE (PE)\n          - and:\n            - number: 0x50\n            - number: 0x45\n        - or:\n          - number: 0x5A4D = IMAGE_DOS_SIGNATURE (MZ)\n          - and:\n            - number: 0x4D\n            - number: 0x5A\n        - optional:\n          - and:\n            - operand[1].offset: 0x3C = IMAGE_DOS_HEADER.e_lfanew\n            - or:\n              - and:\n                - arch: i386\n                - operand[1].offset: 0x50 = IMAGE_NT_HEADERS.OptionalHeader.SizeOfImage\n                - operand[1].offset: 0x34 = IMAGE_NT_HEADERS.OptionalHeader.ImageBase\n              - and:\n                - arch: amd64\n                - operand[1].offset: 0x50 = IMAGE_NT_HEADERS64.OptionalHeader.SizeOfImage\n                - operand[1].offset: 0x30 = IMAGE_NT_HEADERS64.OptionalHeader.ImageBase\n          - basic block:\n            - and:\n              - operand[1].offset: 0x3C = IMAGE_DOS_HEADER.e_lfanew\n              - 3 or more:\n                - operand[1].offset: 0x4 = IMAGE_NT_HEADERS.FileHeader.Machine\n                - operand[1].offset: 0x6 = IMAGE_NT_HEADERS.FileHeader.NumberOfSections\n                - operand[1].offset: 0x14 = IMAGE_NT_HEADERS.FileHeader.SizeOfOptionalHeader\n                - operand[1].offset: 0x16 = IMAGE_NT_HEADERS.FileHeader.Characteristics\n                - operand[1].offset: 0x28 = IMAGE_NT_HEADERS.OptionalHeader.AddressOfEntryPoint  # for 32 and 64 bit\n                - or:\n                  - and:\n                    - arch: i386\n                    - operand[1].offset: 0x34 = IMAGE_NT_HEADERS.OptionalHeader.ImageBase\n                    - operand[1].offset: 0x50 = IMAGE_NT_HEADERS.OptionalHeader.SizeOfImage\n                  - and:\n                    - arch: amd64\n                    - operand[1].offset: 0x30 = IMAGE_NT_HEADERS.OptionalHeader.ImageBase\n                    - operand[1].offset: 0x50 = IMAGE_NT_HEADERS64.OptionalHeader.SizeOfImage\n", "matches": [[{"type": "absolute", "value": 4301915}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "mnemonic", "mnemonic": "cmp"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4444805}, {"type": "absolute", "value": 4444938}, {"type": "absolute", "value": 4445580}, {"type": "absolute", "value": 4444818}, {"type": "absolute", "value": 4445075}, {"type": "absolute", "value": 4445719}, {"type": "absolute", "value": 4445210}, {"type": "absolute", "value": 4445595}, {"type": "absolute", "value": 4445469}, {"type": "absolute", "value": 4444702}, {"type": "absolute", "value": 4444715}, {"type": "absolute", "value": 4444459}, {"type": "absolute", "value": 4445356}, {"type": "absolute", "value": 4444977}, {"type": "absolute", "value": 4444594}, {"type": "absolute", "value": 4445491}, {"type": "absolute", "value": 4445619}, {"type": "absolute", "value": 4445626}, {"type": "absolute", "value": 4445504}, {"type": "absolute", "value": 4445124}, {"type": "absolute", "value": 4445254}, {"type": "absolute", "value": 4445768}, {"type": "absolute", "value": 4445001}, {"type": "absolute", "value": 4445137}, {"type": "absolute", "value": 4445650}, {"type": "absolute", "value": 4444759}, {"type": "absolute", "value": 4445657}, {"type": "absolute", "value": 4445026}, {"type": "absolute", "value": 4445413}, {"type": "absolute", "value": 4444520}, {"type": "absolute", "value": 4444910}, {"type": "absolute", "value": 4445040}, {"type": "absolute", "value": 4444533}, {"type": "absolute", "value": 4444791}, {"type": "absolute", "value": 4445688}, {"type": "absolute", "value": 4444665}, {"type": "absolute", "value": 4445566}, {"type": "absolute", "value": 4445695}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "number", "number": 17744, "description": "IMAGE_NT_SIGNATURE (PE)"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4444977}], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "number", "number": 80}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 69}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "number", "number": 23117, "description": "IMAGE_DOS_SIGNATURE (MZ)"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4444938}], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "number", "number": 77}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 90}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "operand offset", "index": 1, "operand_offset": 60, "description": "IMAGE_DOS_HEADER.e_lfanew"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4444962}, {"type": "absolute", "value": 4445274}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "arch", "arch": "i386"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"feature": {"type": "operand offset", "index": 1, "operand_offset": 80, "description": "IMAGE_NT_HEADERS.OptionalHeader.SizeOfImage"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4445097}], "captures": {}}, {"success": true, "node": {"feature": {"type": "operand offset", "index": 1, "operand_offset": 52, "description": "IMAGE_NT_HEADERS.OptionalHeader.ImageBase"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4445001}, {"type": "absolute", "value": 4445107}, {"type": "absolute", "value": 4445380}], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "arch", "arch": "amd64"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "operand offset", "index": 1, "operand_offset": 80, "description": "IMAGE_NT_HEADERS64.OptionalHeader.SizeOfImage"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4445097}], "captures": {}}, {"success": false, "node": {"feature": {"type": "operand offset", "index": 1, "operand_offset": 48, "description": "IMAGE_NT_HEADERS64.OptionalHeader.ImageBase"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "parse PE header/d47c7b4623414997ab7476659b369ae1"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4303410}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "mnemonic", "mnemonic": "cmp"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4508129}, {"type": "absolute", "value": 4508145}, {"type": "absolute", "value": 4508226}, {"type": "absolute", "value": 4508172}, {"type": "absolute", "value": 4508205}, {"type": "absolute", "value": 4508191}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "number", "number": 17744, "description": "IMAGE_NT_SIGNATURE (PE)"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4508172}], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "number", "number": 80}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 69}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "number", "number": 23117, "description": "IMAGE_DOS_SIGNATURE (MZ)"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4508145}], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "number", "number": 77}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 90}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "operand offset", "index": 1, "operand_offset": 60, "description": "IMAGE_DOS_HEADER.e_lfanew"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4508163}], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "arch", "arch": "i386"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": false, "node": {"feature": {"type": "operand offset", "index": 1, "operand_offset": 80, "description": "IMAGE_NT_HEADERS.OptionalHeader.SizeOfImage"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "operand offset", "index": 1, "operand_offset": 52, "description": "IMAGE_NT_HEADERS.OptionalHeader.ImageBase"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "arch", "arch": "amd64"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "operand offset", "index": 1, "operand_offset": 80, "description": "IMAGE_NT_HEADERS64.OptionalHeader.SizeOfImage"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "operand offset", "index": 1, "operand_offset": 48, "description": "IMAGE_NT_HEADERS64.OptionalHeader.ImageBase"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "parse PE header/d47c7b4623414997ab7476659b369ae1"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4305820}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "mnemonic", "mnemonic": "cmp"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4511456}, {"type": "absolute", "value": 4511075}, {"type": "absolute", "value": 4511235}, {"type": "absolute", "value": 4511619}, {"type": "absolute", "value": 4511079}, {"type": "absolute", "value": 4511464}, {"type": "absolute", "value": 4511018}, {"type": "absolute", "value": 4511722}, {"type": "absolute", "value": 4511088}, {"type": "absolute", "value": 4511473}, {"type": "absolute", "value": 4511728}, {"type": "absolute", "value": 4511059}, {"type": "absolute", "value": 4510996}, {"type": "absolute", "value": 4511734}, {"type": "absolute", "value": 4511706}, {"type": "absolute", "value": 4511067}, {"type": "absolute", "value": 4511100}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "number", "number": 17744, "description": "IMAGE_NT_SIGNATURE (PE)"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4511018}], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "number", "number": 80}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 69}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "number", "number": 23117, "description": "IMAGE_DOS_SIGNATURE (MZ)"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4510991}], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "number", "number": 77}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 90}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "operand offset", "index": 1, "operand_offset": 60, "description": "IMAGE_DOS_HEADER.e_lfanew"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4511005}], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "arch", "arch": "i386"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": false, "node": {"feature": {"type": "operand offset", "index": 1, "operand_offset": 80, "description": "IMAGE_NT_HEADERS.OptionalHeader.SizeOfImage"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "operand offset", "index": 1, "operand_offset": 52, "description": "IMAGE_NT_HEADERS.OptionalHeader.ImageBase"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "arch", "arch": "amd64"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "operand offset", "index": 1, "operand_offset": 80, "description": "IMAGE_NT_HEADERS64.OptionalHeader.SizeOfImage"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "operand offset", "index": 1, "operand_offset": 48, "description": "IMAGE_NT_HEADERS64.OptionalHeader.ImageBase"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "parse PE header/d47c7b4623414997ab7476659b369ae1"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "enumerate services": {"meta": {"name": "enumerate services", "namespace": "host-interaction/service/list", "authors": ["moritz.raabe@mandiant.com", "michael.hunhoff@mandiant.com"], "scope": "function", "attack": [{"parts": ["Discovery", "System Service Discovery"], "tactic": "Discovery", "technique": "System Service Discovery", "subtechnique": "", "id": "T1007"}], "mbc": [], "references": [], "examples": ["Practical Malware Analysis Lab 05-01.dll_:0x1000B823"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: enumerate services\n    namespace: host-interaction/service/list\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scope: function\n    att&ck:\n      - Discovery::System Service Discovery [T1007]\n    examples:\n      - Practical Malware Analysis Lab 05-01.dll_:0x1000B823\n  features:\n    - or:\n      - api: advapi32.EnumServicesStatus\n      - api: advapi32.EnumServicesStatusEx\n      - api: advapi32.EnumDependentServices\n", "matches": [[{"type": "absolute", "value": 4301940}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "advapi32.EnumServicesStatus"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "advapi32.EnumServicesStatusEx"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4423523}, {"type": "absolute", "value": 4423357}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.EnumDependentServices"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "send ICMP echo request": {"meta": {"name": "send ICMP echo request", "namespace": "communication/icmp", "authors": ["michael.hunhoff@mandiant.com"], "scope": "function", "attack": [], "mbc": [{"parts": ["Communication", "ICMP Communication", "Echo Request"], "objective": "Communication", "behavior": "ICMP Communication", "method": "Echo Request", "id": "C0014.002"}], "references": ["https://docs.microsoft.com/en-us/windows/win32/api/icmpapi/"], "examples": ["al-khaser_x86.exe_:0x449510"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: send ICMP echo request\n    namespace: communication/icmp\n    authors:\n      - michael.hunhoff@mandiant.com\n    scope: function\n    mbc:\n      - Communication::ICMP Communication::Echo Request [C0014.002]\n    references:\n      - https://docs.microsoft.com/en-us/windows/win32/api/icmpapi/\n    examples:\n      - al-khaser_x86.exe_:0x449510\n  features:\n    - and:\n      - or:\n        - api: IcmpSendEcho\n        - api: IcmpSendEcho2\n        - api: IcmpSendEcho2Ex\n        - api: Icmp6SendEcho2\n      - optional:\n        - or:\n          - api: IcmpCreateFile\n          - api: Icmp6CreateFile\n        - api: IcmpCloseHandle\n", "matches": [[{"type": "absolute", "value": 4301960}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "IcmpSendEcho"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4494933}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "IcmpSendEcho2"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "IcmpSendEcho2Ex"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Icmp6SendEcho2"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "IcmpCreateFile"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4494752}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Icmp6CreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "IcmpCloseHandle"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4494952}, {"type": "absolute", "value": 4494870}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "get number of processors": {"meta": {"name": "get number of processors", "namespace": "host-interaction/hardware/cpu", "authors": ["michael.hunhoff@mandiant.com", "anushka.virgaonkar@mandiant.com"], "scope": "function", "attack": [{"parts": ["Discovery", "System Information Discovery"], "tactic": "Discovery", "technique": "System Information Discovery", "subtechnique": "", "id": "T1082"}], "mbc": [], "references": ["https://github.com/LordNoteworthy/al-khaser/blob/bed03d2f849d9060c68f8d5905bd204d0cb3f593/al-khaser/AntiVM/Generic.cpp#L361"], "examples": ["al-khaser_x86.exe_:0x432CB0"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: get number of processors\n    namespace: host-interaction/hardware/cpu\n    authors:\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scope: function\n    att&ck:\n      - Discovery::System Information Discovery [T1082]\n    references:\n      - https://github.com/LordNoteworthy/al-khaser/blob/bed03d2f849d9060c68f8d5905bd204d0cb3f593/al-khaser/AntiVM/Generic.cpp#L361\n    examples:\n      - al-khaser_x86.exe_:0x432CB0\n  features:\n    - or:\n      - and:\n        - match: PEB access\n        - or:\n          - and:\n            - arch: i386\n            - number: 0x64 = PEB->NumberOfProcessors\n          - and:\n            - arch: amd64\n            - number: 0xB8 = PEB->NumberOfProcessors\n      - property/read: System.Environment::ProcessorCount\n", "matches": [[{"type": "absolute", "value": 4302100}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.Environment::ProcessorCount"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "PEB access"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "peb access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4402392}], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "fs access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4402392}], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/aee9ee4a3df44121b21acb950535f6a7"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "arch", "arch": "i386"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "fs access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4402392}], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "offset", "offset": 48}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/b86186bb56c74ecaa2b476462ebf83f3"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "arch", "arch": "amd64"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "gs access"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "offset", "offset": 96}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/fc87da307f6f4da2b8fde64519f87688"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4402352}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "arch", "arch": "i386"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 100, "description": "PEB->NumberOfProcessors"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4402398}], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "arch", "arch": "amd64"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 184, "description": "PEB->NumberOfProcessors"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "connect to WMI namespace via WbemLocator": {"meta": {"name": "connect to WMI namespace via WbemLocator", "namespace": "host-interaction/wmi", "authors": ["michael.hunhoff@mandiant.com"], "scope": "function", "attack": [{"parts": ["Execution", "Windows Management Instrumentation"], "tactic": "Execution", "technique": "Windows Management Instrumentation", "subtechnique": "", "id": "T1047"}], "mbc": [], "references": [], "examples": ["al-khaser_x64.exe_:0x14001956e", "al-khaser_x86.exe_:0x00445270"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "# generated using capa explorer for IDA Pro\nrule:\n  meta:\n    name: connect to WMI namespace via WbemLocator\n    namespace: host-interaction/wmi\n    authors:\n      - michael.hunhoff@mandiant.com\n    scope: function\n    att&ck:\n      - Execution::Windows Management Instrumentation [T1047]\n    examples:\n      - al-khaser_x64.exe_:0x14001956e\n      - al-khaser_x86.exe_:0x00445270\n  features:\n    - and:\n      - basic block:\n        - and:\n          - api: ole32.CoCreateInstance\n          - bytes: 11 F8 90 45 3A 1D D0 11 89 1F 00 AA 00 4B 2E 24 = CLSID_WbemLocator\n          - bytes: 87 A6 12 DC 7F 73 CF 11 88 4D 00 AA 00 4B 2E 24 = IID_IWbemLocator\n      - or:\n        - and:\n          - arch: i386\n          - offset: 0xC = ppv->ConnectServer\n        - and:\n          - arch: amd64\n          - offset: 0x18 = ppv->ConnectServer\n      - optional:\n        - string: /ROOT\\\\CIMV2/i\n        - string: /ROOT\\\\DEFAULT/i\n", "matches": [[{"type": "absolute", "value": 4302170}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"scope": "basic block", "type": "subscope"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "ole32.CoCreateInstance"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4477746}], "captures": {}}, {"success": true, "node": {"feature": {"type": "bytes", "bytes": "11f890453a1dd011891f00aa004b2e24", "description": "CLSID_WbemLocator"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4477741}], "captures": {}}, {"success": true, "node": {"feature": {"type": "bytes", "bytes": "87a612dc7f73cf11884d00aa004b2e24", "description": "IID_IWbemLocator"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4477732}], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4477717}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "arch", "arch": "i386"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"feature": {"type": "offset", "offset": 12, "description": "ppv->ConnectServer"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4477873}], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "arch", "arch": "amd64"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "offset", "offset": 24, "description": "ppv->ConnectServer"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "regex", "regex": "/ROOT\\\\CIMV2/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/ROOT\\\\DEFAULT/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "check if file exists": {"meta": {"name": "check if file exists", "namespace": "host-interaction/file-system/exists", "authors": ["moritz.raabe@mandiant.com", "michael.hunhoff@mandiant.com"], "scope": "function", "attack": [{"parts": ["Discovery", "File and Directory Discovery"], "tactic": "Discovery", "technique": "File and Directory Discovery", "subtechnique": "", "id": "T1083"}], "mbc": [{"parts": ["Discovery", "File and Directory Discovery"], "objective": "Discovery", "behavior": "File and Directory Discovery", "method": "", "id": "E1083"}], "references": [], "examples": ["31600AD0D1A7EA615690DF111AE36C73:0x401284"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: check if file exists\n    namespace: host-interaction/file-system/exists\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scope: function\n    att&ck:\n      - Discovery::File and Directory Discovery [T1083]\n    mbc:\n      - Discovery::File and Directory Discovery [E1083]\n    examples:\n      - 31600AD0D1A7EA615690DF111AE36C73:0x401284\n  features:\n    - or:\n      - basic block:\n        - and:\n          - api: kernel32.GetFileAttributes\n          - instruction:\n            - mnemonic: cmp\n            - number: 0xFFFFFFFF = INVALID_FILE_ATTRIBUTES\n      - basic block:\n        - and:\n          - api: kernel32.GetLastError\n          - instruction:\n            - mnemonic: cmp\n            - number: 2 = ERROR_FILE_NOT_FOUND\n      - api: shlwapi.PathFileExists\n      - api: System.IO.File::Exists\n      - property/read: System.IO.FileSystemInfo::Exists\n", "matches": [[{"type": "absolute", "value": 4302300}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"scope": "basic block", "type": "subscope"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetFileAttributes"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4491582}], "captures": {}}, {"success": true, "node": {"statement": {"scope": "instruction", "type": "subscope"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "mnemonic", "mnemonic": "cmp"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4491598}], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 4294967295, "description": "INVALID_FILE_ATTRIBUTES"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4491598}], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4491598}], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4491536}], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "check if file exists/365eac8ed9a7465fa523bb7b444ec341"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shlwapi.PathFileExists"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::Exists"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.IO.FileSystemInfo::Exists"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4304300}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"scope": "basic block", "type": "subscope"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetFileAttributes"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4491742}], "captures": {}}, {"success": true, "node": {"statement": {"scope": "instruction", "type": "subscope"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "mnemonic", "mnemonic": "cmp"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4491758}], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 4294967295, "description": "INVALID_FILE_ATTRIBUTES"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4491758}], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4491758}], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4491696}], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "check if file exists/365eac8ed9a7465fa523bb7b444ec341"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shlwapi.PathFileExists"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::Exists"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.IO.FileSystemInfo::Exists"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "check if process is running under wine": {"meta": {"name": "check if process is running under wine", "namespace": "anti-analysis/anti-emulation/wine", "authors": ["@_re_fox"], "scope": "function", "attack": [{"parts": ["Defense Evasion", "Virtualization/Sandbox Evasion", "System Checks"], "tactic": "Defense Evasion", "technique": "Virtualization/Sandbox Evasion", "subtechnique": "System Checks", "id": "T1497.001"}], "mbc": [{"parts": ["Anti-Behavioral Analysis", "Emulator Detection"], "objective": "Anti-Behavioral Analysis", "behavior": "Emulator Detection", "method": "", "id": "B0004"}], "references": ["https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiVM/Wine.cpp"], "examples": ["ccbf7cba35bab56563c0fbe4237fdc41:0x40d750"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: check if process is running under wine\n    namespace: anti-analysis/anti-emulation/wine\n    authors:\n      - \"@_re_fox\"\n    scope: function\n    att&ck:\n      - Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001]\n    mbc:\n      - Anti-Behavioral Analysis::Emulator Detection [B0004]\n    references:\n      - https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiVM/Wine.cpp\n    examples:\n      - ccbf7cba35bab56563c0fbe4237fdc41:0x40d750\n  features:\n    - or:\n      - string: /SOFTWARE\\\\Wine/i\n      - and:\n        - api: GetModuleHandle\n        - api: GetProcAddress\n        - string: \"wine_get_unix_file_name\"\n        - or:\n          - string: \"kernel32.dll\"\n          - string: \"ntdll.dll\"\n", "matches": [[{"type": "absolute", "value": 4302465}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "regex", "regex": "/SOFTWARE\\\\Wine/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "GetModuleHandle"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4442047}], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "GetProcAddress"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4442097}], "captures": {}}, {"success": true, "node": {"feature": {"type": "string", "string": "wine_get_unix_file_name"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4442088}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "string", "string": "kernel32.dll"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4442042}], "captures": {}}, {"success": false, "node": {"feature": {"type": "string", "string": "ntdll.dll"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4304740}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "regex", "regex": "/SOFTWARE\\\\Wine/i"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4442242}], "captures": {"SOFTWARE\\Wine": [{"type": "absolute", "value": 4442242}]}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "GetModuleHandle"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetProcAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "string", "string": "wine_get_unix_file_name"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "string", "string": "kernel32.dll"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "string", "string": "ntdll.dll"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "get OS version": {"meta": {"name": "get OS version", "authors": ["@mr-tz"], "scope": "function", "attack": [], "mbc": [], "references": [], "examples": ["493167E85E45363D09495D0841C30648:0x401000", "5f66b82558ca92e54e77f216ef4c066c:0x44580A"], "description": "", "lib": true, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: get OS version\n    authors:\n      - \"@mr-tz\"\n    lib: true\n    scope: function\n    examples:\n      - 493167E85E45363D09495D0841C30648:0x401000\n      - 5f66b82558ca92e54e77f216ef4c066c:0x44580A\n  features:\n    - or:\n      - api: RtlGetVersion\n      - api: ntoskrnl.PsGetVersion\n      - api: GetVersion\n      - api: GetVersionEx\n      - api: VerifyVersionInfo\n      - api: VerSetConditionMask\n      - api: RtlGetNtVersionNumbers\n", "matches": [[{"type": "absolute", "value": 4302785}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "RtlGetVersion"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntoskrnl.PsGetVersion"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetVersion"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetVersionEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "VerifyVersionInfo"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4333224}], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "VerSetConditionMask"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4333146}, {"type": "absolute", "value": 4333131}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "RtlGetNtVersionNumbers"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4305230}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "RtlGetVersion"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntoskrnl.PsGetVersion"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetVersion"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetVersionEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "VerifyVersionInfo"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4331869}], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "VerSetConditionMask"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4331776}, {"type": "absolute", "value": 4331761}, {"type": "absolute", "value": 4331791}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "RtlGetNtVersionNumbers"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "get MAC address on Windows": {"meta": {"name": "get MAC address on Windows", "namespace": "collection/network", "authors": ["moritz.raabe@mandiant.com", "michael.hunhoff@mandiant.com"], "scope": "function", "attack": [{"parts": ["Discovery", "System Information Discovery"], "tactic": "Discovery", "technique": "System Information Discovery", "subtechnique": "", "id": "T1082"}], "mbc": [], "references": [], "examples": ["al-khaser_x64.exe_:0x14001A1BC"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: get MAC address on Windows\n    namespace: collection/network\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scope: function\n    att&ck:\n      - Discovery::System Information Discovery [T1082]\n    examples:\n      - al-khaser_x64.exe_:0x14001A1BC\n  features:\n    - or:\n      - api: System.Net.NetworkInformation.NetworkInterface::GetPhysicalAddress\n      - and:\n        - os: windows\n        - api: iphlpapi.GetAdaptersInfo\n        - or:\n          - offset: 0x194 = IP_ADAPTER_INFO.Address\n          - offset: 0x195 = IP_ADAPTER_INFO.Address+1\n          - offset: 0x196 = IP_ADAPTER_INFO.Address+2\n          - offset: 0x197 = IP_ADAPTER_INFO.Address+3\n          - offset: 0x198 = IP_ADAPTER_INFO.Address+4\n          - offset: 0x199 = IP_ADAPTER_INFO.Address+5\n        - optional:\n          - string: \"%02X-%02X-%02X-%02X-%02X-%02X\"\n", "matches": [[{"type": "absolute", "value": 4302830}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "System.Net.NetworkInformation.NetworkInterface::GetPhysicalAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "iphlpapi.GetAdaptersInfo"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4488428}, {"type": "absolute", "value": 4488286}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "offset", "offset": 404, "description": "IP_ADAPTER_INFO.Address"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4488521}], "captures": {}}, {"success": false, "node": {"feature": {"type": "offset", "offset": 405, "description": "IP_ADAPTER_INFO.Address+1"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "offset", "offset": 406, "description": "IP_ADAPTER_INFO.Address+2"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "offset", "offset": 407, "description": "IP_ADAPTER_INFO.Address+3"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "offset", "offset": 408, "description": "IP_ADAPTER_INFO.Address+4"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "offset", "offset": 409, "description": "IP_ADAPTER_INFO.Address+5"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "string", "string": "%02X-%02X-%02X-%02X-%02X-%02X"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "check for time delay via GetTickCount": {"meta": {"name": "check for time delay via GetTickCount", "namespace": "anti-analysis/anti-debugging/debugger-detection", "authors": ["michael.hunhoff@mandiant.com"], "scope": "function", "attack": [], "mbc": [{"parts": ["Anti-Behavioral Analysis", "Debugger Detection", "Timing/Delay Check GetTickCount"], "objective": "Anti-Behavioral Analysis", "behavior": "Debugger Detection", "method": "Timing/Delay Check GetTickCount", "id": "B0001.032"}], "references": [], "examples": ["Practical Malware Analysis Lab 16-03.exe_:0x4013d0"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: check for time delay via GetTickCount\n    namespace: anti-analysis/anti-debugging/debugger-detection\n    authors:\n      - michael.hunhoff@mandiant.com\n    scope: function\n    mbc:\n      - Anti-Behavioral Analysis::Debugger Detection::Timing/Delay Check GetTickCount [B0001.032]\n    examples:\n      - Practical Malware Analysis Lab 16-03.exe_:0x4013d0\n  features:\n    - and:\n      - count(api(kernel32.GetTickCount)): 2 or more\n      - basic block:\n        - and:\n          - mnemonic: sub\n          - mnemonic: cmp\n", "matches": [[{"type": "absolute", "value": 4302875}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"scope": "basic block", "type": "subscope"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "mnemonic", "mnemonic": "sub"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4402483}, {"type": "absolute", "value": 4402606}, {"type": "absolute", "value": 4402615}], "captures": {}}, {"success": true, "node": {"feature": {"type": "mnemonic", "mnemonic": "cmp"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4402593}, {"type": "absolute", "value": 4402578}, {"type": "absolute", "value": 4402556}, {"type": "absolute", "value": 4402620}], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4402480}], "captures": {}}, {"success": true, "node": {"statement": {"min": 2, "max": 9223372036854775808, "child": {"type": "api", "api": "kernel32.GetTickCount"}, "type": "range"}, "type": "statement"}, "children": [], "locations": [{"type": "absolute", "value": 4402587}, {"type": "absolute", "value": 4402550}], "captures": {}}], "locations": [], "captures": {}}]]}, "inject dll": {"meta": {"name": "inject dll", "namespace": "host-interaction/process/inject", "authors": ["0x534a@mailbox.org"], "scope": "function", "attack": [{"parts": ["Defense Evasion", "Process Injection", "Dynamic-link Library Injection"], "tactic": "Defense Evasion", "technique": "Process Injection", "subtechnique": "Dynamic-link Library Injection", "id": "T1055.001"}], "mbc": [], "references": ["Practical Malware Analysis, p. 676", "https://www.researchgate.net/publication/279155742_A_Novel_Approach_to_Detect_Malware_Based_on_API_Call_Sequence_Analysis", "https://www.welivesecurity.com/wp-content/uploads/2016/10/eset-sednit-part3.pdf", "https://www.accenture.com/t20180127T003755Z_w_/us-en/_acnmedia/PDF-46/Accenture-Security-Dragonfish-Threat-Analysis.pdf", "https://unit42.paloaltonetworks.com/unit42-kazuar-multiplatform-espionage-backdoor-api-access/", "https://www.welivesecurity.com/wp-content/uploads/2018/10/ESET_GreyEnergy.pdf", "https://www.welivesecurity.com/2019/05/29/turla-powershell-usage/"], "examples": ["Practical Malware Analysis Lab 17-02.dll_:0x1000D10D"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: inject dll\n    namespace: host-interaction/process/inject\n    authors:\n      - 0x534a@mailbox.org\n    scope: function\n    att&ck:\n      - Defense Evasion::Process Injection::Dynamic-link Library Injection [T1055.001]\n    references:\n      - Practical Malware Analysis, p. 676\n      - https://www.researchgate.net/publication/279155742_A_Novel_Approach_to_Detect_Malware_Based_on_API_Call_Sequence_Analysis\n      - https://www.welivesecurity.com/wp-content/uploads/2016/10/eset-sednit-part3.pdf\n      - https://www.accenture.com/t20180127T003755Z_w_/us-en/_acnmedia/PDF-46/Accenture-Security-Dragonfish-Threat-Analysis.pdf\n      - https://unit42.paloaltonetworks.com/unit42-kazuar-multiplatform-espionage-backdoor-api-access/\n      - https://www.welivesecurity.com/wp-content/uploads/2018/10/ESET_GreyEnergy.pdf\n      - https://www.welivesecurity.com/2019/05/29/turla-powershell-usage/\n    examples:\n      - Practical Malware Analysis Lab 17-02.dll_:0x1000D10D\n  features:\n    - and:\n      - optional:\n        - or:\n          - match: open process\n          - match: host-interaction/process/create\n      - match: allocate RW memory\n      - match: write process memory\n      - and:\n        - or:\n          - api: kernel32.GetModuleHandle\n          - api: kernel32.GetModuleHandleEx\n        - string: \"/LoadLibrary[AW]/\"\n      - match: create thread\n", "matches": [[{"type": "absolute", "value": 4302995}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "allocate RW memory"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "allocate memory"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAlloc"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocEx"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4443626}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocExNuma"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtect"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4443488}], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 4, "description": "PAGE_READWRITE"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4443606}], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4443488}], "captures": {}}, {"success": true, "node": {"feature": {"type": "match", "match": "write process memory"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.WriteProcessMemory"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4443714}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtWriteVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.ZwWriteVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtWow64WriteVirtualMemory64"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4302995}], "captures": {}}, {"success": true, "node": {"feature": {"type": "match", "match": "create thread"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "os", "os": "linux"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "pthread_create"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "System.Threading.Thread::Start"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "System.Threading.Thread::ctor"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.CreateThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "_beginthread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "_beginthreadex"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "PsCreateSystemThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHCreateThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHCreateThreadWithHandle"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.CreateRemoteThread"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4443770}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.CreateRemoteThreadEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "RtlCreateUserThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtCreateThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtCreateThreadEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.ZwCreateThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.ZwCreateThreadEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4443748}], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "open process"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.OpenProcess"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4443322}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtOpenProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4443309}], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "host-interaction/process/create"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetModuleHandle"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4443374}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetModuleHandleEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/LoadLibrary[AW]/"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4443434}], "captures": {"LoadLibraryW": [{"type": "absolute", "value": 4443434}]}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "inject thread": {"meta": {"name": "inject thread", "namespace": "host-interaction/process/inject", "authors": ["anamaria.martinezgom@mandiant.com", "0x534a@mailbox.org"], "scope": "function", "attack": [{"parts": ["Defense Evasion", "Process Injection", "Thread Execution Hijacking"], "tactic": "Defense Evasion", "technique": "Process Injection", "subtechnique": "Thread Execution Hijacking", "id": "T1055.003"}, {"parts": ["Defense Evasion", "Reflective Code Loading"], "tactic": "Defense Evasion", "technique": "Reflective Code Loading", "subtechnique": "", "id": "T1620"}], "mbc": [], "references": [], "examples": ["Practical Malware Analysis Lab 12-01.exe_:0x4010D0", "2D3EDC218A90F03089CC01715A9F047F:0x4027CF"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: inject thread\n    namespace: host-interaction/process/inject\n    authors:\n      - anamaria.martinezgom@mandiant.com\n      - 0x534a@mailbox.org\n    scope: function\n    att&ck:\n      - Defense Evasion::Process Injection::Thread Execution Hijacking [T1055.003]\n      - Defense Evasion::Reflective Code Loading [T1620]\n    examples:\n      - Practical Malware Analysis Lab 12-01.exe_:0x4010D0\n      - 2D3EDC218A90F03089CC01715A9F047F:0x4027CF\n  features:\n    - and:\n      - or:\n        - match: allocate RWX memory\n        - match: allocate RW memory\n      - match: write process memory\n      - match: create thread\n      - optional:\n        - or:\n          - match: host-interaction/process/create\n          - match: open process\n          - number: 0x3000 = MEM_COMMIT or MEM_RESERVE\n", "matches": [[{"type": "absolute", "value": 4302995}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "write process memory"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.WriteProcessMemory"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4443714}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtWriteVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.ZwWriteVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtWow64WriteVirtualMemory64"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4302995}], "captures": {}}, {"success": true, "node": {"feature": {"type": "match", "match": "create thread"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "os", "os": "linux"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "pthread_create"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "System.Threading.Thread::Start"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "System.Threading.Thread::ctor"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.CreateThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "_beginthread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "_beginthreadex"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "PsCreateSystemThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHCreateThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHCreateThreadWithHandle"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.CreateRemoteThread"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4443770}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.CreateRemoteThreadEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "RtlCreateUserThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtCreateThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtCreateThreadEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.ZwCreateThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.ZwCreateThreadEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4443748}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "match", "match": "allocate RWX memory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "match", "match": "allocate RW memory"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "allocate memory"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAlloc"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocEx"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4443626}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocExNuma"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtect"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4443488}], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 4, "description": "PAGE_READWRITE"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4443606}], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4443488}], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "match", "match": "host-interaction/process/create"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "match", "match": "open process"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.OpenProcess"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4443322}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtOpenProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4443309}], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 12288, "description": "MEM_COMMIT or MEM_RESERVE"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4443608}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "get memory capacity": {"meta": {"name": "get memory capacity", "namespace": "host-interaction/hardware/memory", "authors": ["moritz.raabe@mandiant.com"], "scope": "function", "attack": [{"parts": ["Discovery", "System Information Discovery"], "tactic": "Discovery", "technique": "System Information Discovery", "subtechnique": "", "id": "T1082"}], "mbc": [], "references": [], "examples": ["9324D1A8AE37A36AE560C37448C9705A:0x4052A0"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: get memory capacity\n    namespace: host-interaction/hardware/memory\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: function\n    att&ck:\n      - Discovery::System Information Discovery [T1082]\n    examples:\n      - 9324D1A8AE37A36AE560C37448C9705A:0x4052A0\n  features:\n    - or:\n      - api: kernel32.GlobalMemoryStatus\n      - api: kernel32.GlobalMemoryStatusEx\n        # TODO kernel32.GetSystemInfo with offset\n", "matches": [[{"type": "absolute", "value": 4303055}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GlobalMemoryStatus"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GlobalMemoryStatusEx"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4412669}], "captures": {}}], "locations": [], "captures": {}}]]}, "check for software breakpoints": {"meta": {"name": "check for software breakpoints", "namespace": "anti-analysis/anti-debugging/debugger-detection", "authors": ["michael.hunhoff@mandiant.com"], "scope": "function", "attack": [], "mbc": [{"parts": ["Anti-Behavioral Analysis", "Debugger Detection", "Software Breakpoints"], "objective": "Anti-Behavioral Analysis", "behavior": "Debugger Detection", "method": "Software Breakpoints", "id": "B0001.025"}], "references": ["https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiDebug/SoftwareBreakpoints.cpp", "https://anti-debug.checkpoint.com/techniques/assembly.html"], "examples": ["al-khaser_x86.exe_:0x431020"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: check for software breakpoints\n    namespace: anti-analysis/anti-debugging/debugger-detection\n    authors:\n      - michael.hunhoff@mandiant.com\n    scope: function\n    mbc:\n      - Anti-Behavioral Analysis::Debugger Detection::Software Breakpoints [B0001.025]\n    references:\n      - https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiDebug/SoftwareBreakpoints.cpp\n      - https://anti-debug.checkpoint.com/techniques/assembly.html\n    examples:\n      - al-khaser_x86.exe_:0x431020\n  features:\n    - and:\n      - or:\n        - instruction:\n          - mnemonic: cmp\n          - number: 0xCC = INT3\n        - and:\n          - description: INT3 (long form)\n          - instruction:\n            - mnemonic: cmp\n            - number: 0xCD = INT3 (long form byte 1)\n          - instruction:\n            - mnemonic: cmp\n            - number: 0x03 = INT3 (long form byte 2)\n      - match: contain loop\n", "matches": [[{"type": "absolute", "value": 4303320}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "contain loop"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4303320}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4303320}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"scope": "instruction", "type": "subscope"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "mnemonic", "mnemonic": "cmp"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4395135}], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 204, "description": "INT3"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4395135}], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4395135}], "captures": {}}, {"success": false, "node": {"statement": {"type": "and", "description": "INT3 (long form)"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "match", "match": "check for software breakpoints/cfd5f3d415eb4d8daef9fa59fc9ec6f9"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "check for software breakpoints/0fecce3caef14ab0a72ef9313822a924"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "set console window title": {"meta": {"name": "set console window title", "namespace": "host-interaction/gui/console", "authors": ["michael.hunhoff@mandiant.com"], "scope": "function", "attack": [], "mbc": [{"parts": ["Operating System", "Console"], "objective": "Operating System", "behavior": "Console", "method": "", "id": "C0033"}], "references": [], "examples": ["mimikatz.exe_:0x44570F"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: set console window title\n    namespace: host-interaction/gui/console\n    authors:\n      - michael.hunhoff@mandiant.com\n    scope: function\n    mbc:\n      - Operating System::Console [C0033]\n    examples:\n      - mimikatz.exe_:0x44570F\n  features:\n    - or:\n      - api: kernel32.SetConsoleTitle\n", "matches": [[{"type": "absolute", "value": 4303335}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.SetConsoleTitle"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4464383}], "captures": {}}], "locations": [], "captures": {}}]]}, "check for hardware breakpoints": {"meta": {"name": "check for hardware breakpoints", "namespace": "anti-analysis/anti-debugging/debugger-detection", "authors": ["michael.hunhoff@mandiant.com"], "scope": "function", "attack": [], "mbc": [{"parts": ["Anti-Behavioral Analysis", "Debugger Detection", "Hardware Breakpoints"], "objective": "Anti-Behavioral Analysis", "behavior": "Debugger Detection", "method": "Hardware Breakpoints", "id": "B0001.005"}], "references": ["https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiDebug/HardwareBreakpoints.cpp"], "examples": ["al-khaser_x86.exe_:0x42035D"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: check for hardware breakpoints\n    namespace: anti-analysis/anti-debugging/debugger-detection\n    authors:\n      - michael.hunhoff@mandiant.com\n    scope: function\n    mbc:\n      - Anti-Behavioral Analysis::Debugger Detection::Hardware Breakpoints [B0001.005]\n    references:\n      - https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiDebug/HardwareBreakpoints.cpp\n    examples:\n      - al-khaser_x86.exe_:0x42035D\n  features:\n    - and:\n      - api: kernel32.GetThreadContext\n      - number: 0x10010 = CONTEXT_DEBUG_REGISTERS\n      - offset: 0x4 = DR0\n      - offset: 0x8 = DR1\n      - offset: 0xC = DR2\n      - offset: 0x10 = DR3\n      - count(mnemonic(cmp)): 4 or more\n", "matches": [[{"type": "absolute", "value": 4303415}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetThreadContext"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4326265}], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 65552, "description": "CONTEXT_DEBUG_REGISTERS"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4326237}], "captures": {}}, {"success": true, "node": {"feature": {"type": "offset", "offset": 4, "description": "DR0"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4326285}], "captures": {}}, {"success": true, "node": {"feature": {"type": "offset", "offset": 8, "description": "DR1"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4326294}], "captures": {}}, {"success": true, "node": {"feature": {"type": "offset", "offset": 12, "description": "DR2"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4326303}], "captures": {}}, {"success": true, "node": {"feature": {"type": "offset", "offset": 16, "description": "DR3"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4326312}], "captures": {}}, {"success": true, "node": {"statement": {"min": 4, "max": 9223372036854775808, "child": {"type": "mnemonic", "mnemonic": "cmp"}, "type": "range"}, "type": "statement"}, "children": [], "locations": [{"type": "absolute", "value": 4326312}, {"type": "absolute", "value": 4326344}, {"type": "absolute", "value": 4326285}, {"type": "absolute", "value": 4326257}, {"type": "absolute", "value": 4326197}, {"type": "absolute", "value": 4326294}, {"type": "absolute", "value": 4326271}, {"type": "absolute", "value": 4326303}, {"type": "absolute", "value": 4326363}, {"type": "absolute", "value": 4326207}], "captures": {}}], "locations": [], "captures": {}}]]}, "check for kernel debugger via shared user data structure": {"meta": {"name": "check for kernel debugger via shared user data structure", "namespace": "anti-analysis/anti-debugging/debugger-detection", "authors": ["michael.hunhoff@mandiant.com"], "scope": "function", "attack": [], "mbc": [{"parts": ["Anti-Behavioral Analysis", "Debugger Detection"], "objective": "Anti-Behavioral Analysis", "behavior": "Debugger Detection", "method": "", "id": "B0001"}], "references": ["https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiDebug/SharedUserData_KernelDebugger.cpp", "http://www.geoffchappell.com/studies/windows/km/ntoskrnl/structs/kuser_shared_data.htm"], "examples": ["al-khaser_x86.exe_:0x430E60"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: check for kernel debugger via shared user data structure\n    namespace: anti-analysis/anti-debugging/debugger-detection\n    authors:\n      - michael.hunhoff@mandiant.com\n    scope: function\n    mbc:\n      - Anti-Behavioral Analysis::Debugger Detection [B0001]\n    references:\n      - https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiDebug/SharedUserData_KernelDebugger.cpp\n      - http://www.geoffchappell.com/studies/windows/km/ntoskrnl/structs/kuser_shared_data.htm\n    examples:\n      - al-khaser_x86.exe_:0x430E60\n  features:\n    - and:\n      - number: 0x7FFE02D4 = UserSharedData->KdDebuggerEnabled\n      - instruction:\n        - mnemonic: and\n        - number: 0x2 = KdDebuggerNotPresent\n      - instruction:\n        - mnemonic: and\n        - number: 0x1 = KdDebuggerEnabled\n", "matches": [[{"type": "absolute", "value": 4303540}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "number", "number": 2147353300, "description": "UserSharedData->KdDebuggerEnabled"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4394639}], "captures": {}}, {"success": true, "node": {"statement": {"scope": "instruction", "type": "subscope"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "mnemonic", "mnemonic": "and"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4394685}], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 2, "description": "KdDebuggerNotPresent"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4394685}], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4394685}], "captures": {}}, {"success": true, "node": {"statement": {"scope": "instruction", "type": "subscope"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "mnemonic", "mnemonic": "and"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4394651}], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 1, "description": "KdDebuggerEnabled"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4394651}], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4394651}], "captures": {}}], "locations": [], "captures": {}}]]}, "interact with driver via control codes": {"meta": {"name": "interact with driver via control codes", "namespace": "host-interaction/driver", "authors": ["moritz.raabe@mandiant.com"], "scope": "function", "attack": [{"parts": ["Execution", "System Services", "Service Execution"], "tactic": "Execution", "technique": "System Services", "subtechnique": "Service Execution", "id": "T1569.002"}], "mbc": [], "references": [], "examples": ["Practical Malware Analysis Lab 10-03.exe_:0x401000", "9412A66BC81F51A1FA916AC47C77E02AC1A7C9DFF543233ED70AA265EF6A1E76:0x10002DE0"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: interact with driver via control codes\n    namespace: host-interaction/driver\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: function\n    att&ck:\n      - Execution::System Services::Service Execution [T1569.002]\n    examples:\n      - Practical Malware Analysis Lab 10-03.exe_:0x401000\n      - 9412A66BC81F51A1FA916AC47C77E02AC1A7C9DFF543233ED70AA265EF6A1E76:0x10002DE0\n  features:\n    - or:\n      - api: DeviceIoControl\n      - api: NtUnloadDriver\n      - api: ZwUnloadDriver\n      - and:\n        - number: 38 = SystemLoadAndCallImage\n        - api: ZwSetSystemInformation\n", "matches": [[{"type": "absolute", "value": 4304105}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "DeviceIoControl"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4408754}, {"type": "absolute", "value": 4409203}, {"type": "absolute", "value": 4408982}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtUnloadDriver"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwUnloadDriver"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "number", "number": 38, "description": "SystemLoadAndCallImage"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwSetSystemInformation"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "get disk size": {"meta": {"name": "get disk size", "namespace": "host-interaction/hardware/storage", "authors": ["michael.hunhoff@mandiant.com", "anushka.virgaonkar@mandiant.com"], "scope": "function", "attack": [{"parts": ["Discovery", "System Information Discovery"], "tactic": "Discovery", "technique": "System Information Discovery", "subtechnique": "", "id": "T1082"}], "mbc": [{"parts": ["Discovery", "System Information Discovery"], "objective": "Discovery", "behavior": "System Information Discovery", "method": "", "id": "E1082"}], "references": ["https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiVM/Generic.cpp#L347"], "examples": ["al-khaser_x86.exe_:0x4343D0", "al-khaser_x86.exe_:0x434010"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: get disk size\n    namespace: host-interaction/hardware/storage\n    authors:\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scope: function\n    att&ck:\n      - Discovery::System Information Discovery [T1082]\n    mbc:\n      - Discovery::System Information Discovery [E1082]\n    references:\n      - https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiVM/Generic.cpp#L347\n    examples:\n      - al-khaser_x86.exe_:0x4343D0\n      - al-khaser_x86.exe_:0x434010\n  features:\n    - or:\n      - api: kernel32.GetDiskFreeSpace\n      - api: kernel32.GetDiskFreeSpaceEx\n      - property/read: System.IO.DriveInfo::TotalSize\n      - property/read: System.IO.DriveInfo::TotalFreeSpace\n      - property/read: System.IO.DriveInfo::AvailableFreeSpace\n      - basic block:\n        - and:\n          - api: DeviceIoControl\n          - number: 0x7405C = IOCTL_DISK_GET_LENGTH_INFO\n      - and:\n        - or:\n          - string: /SELECT\\s+\\*\\s+FROM\\s+Win32_LogicalDisk/i\n          - string: /SELECT\\s+\\*\\s+FROM\\s+Win32_DiskDrive\\s+WHERE\\s+\\(SerialNumber\\s+IS\\s+NOT\\s+NULL\\)\\s+AND\\s+\\(MediaType\\s+LIKE\\s+\\'Fixed\\s+hard\\s+disk\\%\\'\\)/i\n        - string: \"Size\"\n", "matches": [[{"type": "absolute", "value": 4304105}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetDiskFreeSpace"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetDiskFreeSpaceEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.IO.DriveInfo::TotalSize"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.IO.DriveInfo::TotalFreeSpace"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.IO.DriveInfo::AvailableFreeSpace"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"scope": "basic block", "type": "subscope"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "DeviceIoControl"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4409203}], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 475228, "description": "IOCTL_DISK_GET_LENGTH_INFO"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4409194}], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "DeviceIoControl"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4408982}], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 475228, "description": "IOCTL_DISK_GET_LENGTH_INFO"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4408973}], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4409176}, {"type": "absolute", "value": 4408955}], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+Win32_LogicalDisk/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+Win32_DiskDrive\\s+WHERE\\s+\\(SerialNumber\\s+IS\\s+NOT\\s+NULL\\)\\s+AND\\s+\\(MediaType\\s+LIKE\\s+\\'Fixed\\s+hard\\s+disk\\%\\'\\)/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "string", "string": "Size"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4304805}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetDiskFreeSpace"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetDiskFreeSpaceEx"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4407116}], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.IO.DriveInfo::TotalSize"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.IO.DriveInfo::TotalFreeSpace"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.IO.DriveInfo::AvailableFreeSpace"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "get disk size/a2fa980c77bd430298966f83129843f2"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+Win32_LogicalDisk/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+Win32_DiskDrive\\s+WHERE\\s+\\(SerialNumber\\s+IS\\s+NOT\\s+NULL\\)\\s+AND\\s+\\(MediaType\\s+LIKE\\s+\\'Fixed\\s+hard\\s+disk\\%\\'\\)/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "string", "string": "Size"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "enumerate disk properties": {"meta": {"name": "enumerate disk properties", "namespace": "host-interaction/hardware/storage", "authors": ["michael.hunhoff@mandiant.com"], "scope": "function", "attack": [{"parts": ["Discovery", "System Information Discovery"], "tactic": "Discovery", "technique": "System Information Discovery", "subtechnique": "", "id": "T1082"}], "mbc": [], "references": ["https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiVM/Generic.cpp#L518"], "examples": ["al-khaser_x86.exe_:0x4369B0"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: enumerate disk properties\n    namespace: host-interaction/hardware/storage\n    authors:\n      - michael.hunhoff@mandiant.com\n    scope: function\n    att&ck:\n      - Discovery::System Information Discovery [T1082]\n    references:\n      - https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiVM/Generic.cpp#L518\n    examples:\n      - al-khaser_x86.exe_:0x4369B0\n  features:\n    - and:\n      - basic block:\n        - and:\n          - api: setupapi.SetupDiGetClassDevs\n          - bytes: 67 E9 36 4D 25 E3 CE 11 BF C1 08 00 2B E1 03 18 = GUID_DEVCLASS_DISKDRIVE\n      - api: setupapi.SetupDiEnumDeviceInfo\n      - api: setupapi.SetupDiGetDeviceRegistryProperty\n      - optional:\n        - api: setupapi.SetupDiDestroyDeviceInfoList\n", "matches": [[{"type": "absolute", "value": 4304225}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"scope": "basic block", "type": "subscope"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "setupapi.SetupDiGetClassDevs"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4418038}], "captures": {}}, {"success": true, "node": {"feature": {"type": "bytes", "bytes": "67e9364d25e3ce11bfc108002be10318", "description": "GUID_DEVCLASS_DISKDRIVE"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4418033}], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4417968}], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "setupapi.SetupDiEnumDeviceInfo"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4418120}], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "setupapi.SetupDiGetDeviceRegistryProperty"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4418169}], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "setupapi.SetupDiDestroyDeviceInfoList"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4418437}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "check for PEB NtGlobalFlag flag": {"meta": {"name": "check for PEB NtGlobalFlag flag", "namespace": "anti-analysis/anti-debugging/debugger-detection", "authors": ["moritz.raabe@mandiant.com"], "scope": "function", "attack": [], "mbc": [{"parts": ["Anti-Behavioral Analysis", "Debugger Detection", "Process Environment Block NtGlobalFlag"], "objective": "Anti-Behavioral Analysis", "behavior": "Debugger Detection", "method": "Process Environment Block NtGlobalFlag", "id": "B0001.036"}], "references": ["Practical Malware Analysis, Chapter 16, p. 355", "https://www.geoffchappell.com/studies/windows/win32/ntdll/structs/peb/index.htm"], "examples": ["Practical Malware Analysis Lab 16-01.exe_:0x403530"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: check for PEB NtGlobalFlag flag\n    namespace: anti-analysis/anti-debugging/debugger-detection\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: function\n    mbc:\n      - Anti-Behavioral Analysis::Debugger Detection::Process Environment Block NtGlobalFlag [B0001.036]\n    references:\n      - Practical Malware Analysis, Chapter 16, p. 355\n      - https://www.geoffchappell.com/studies/windows/win32/ntdll/structs/peb/index.htm\n    examples:\n      - Practical Malware Analysis Lab 16-01.exe_:0x403530\n  features:\n    - and:\n      - basic block:\n        - and:\n          - match: PEB access\n          - or:\n            - and:\n              - arch: i386\n              - offset: 0x68 = PEB.NtGlobalFlag\n            - and:\n              - arch: amd64\n              - offset: 0xBC = PEB.NtGlobalFlag\n            - instruction:\n              - arch: i386\n              - mnemonic: add\n              - offset: 0x68 = PEB.NtGlobalFlag\n            - instruction:\n              - arch: amd64\n              - mnemonic: add\n              - offset: 0xBC = PEB.NtGlobalFlag\n      - number: 0x70 = (FLG_HEAP_ENABLE_TAIL_CHECK | FLG_HEAP_ENABLE_FREE_CHECK | FLG_HEAP_VALIDATE_PARAMETERS)\n", "matches": [[{"type": "absolute", "value": 4304340}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"scope": "basic block", "type": "subscope"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "PEB access"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "peb access"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "fs access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4328790}], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/aee9ee4a3df44121b21acb950535f6a7"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "arch", "arch": "i386"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "fs access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4328790}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "offset", "offset": 48}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4328802}], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/b86186bb56c74ecaa2b476462ebf83f3"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "arch", "arch": "amd64"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "gs access"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "offset", "offset": 96}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/fc87da307f6f4da2b8fde64519f87688"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4328736}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "arch", "arch": "i386"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"feature": {"type": "offset", "offset": 104, "description": "PEB.NtGlobalFlag"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4328811}], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "arch", "arch": "amd64"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "offset", "offset": 188, "description": "PEB.NtGlobalFlag"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"scope": "instruction", "type": "subscope"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "arch", "arch": "i386"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"feature": {"type": "mnemonic", "mnemonic": "add"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4328811}], "captures": {}}, {"success": true, "node": {"feature": {"type": "offset", "offset": 104, "description": "PEB.NtGlobalFlag"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4328811}], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4328811}], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "check for PEB NtGlobalFlag flag/ea03bc77e4e64ed092d4761d882e15f8/5ec3eec7f1df41c08418ff12b3a5da02"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4328736}], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 112, "description": "(FLG_HEAP_ENABLE_TAIL_CHECK | FLG_HEAP_ENABLE_FREE_CHECK | FLG_HEAP_VALIDATE_PARAMETERS)"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4328924}, {"type": "absolute", "value": 4328877}], "captures": {}}], "locations": [], "captures": {}}]]}, "modify access privileges": {"meta": {"name": "modify access privileges", "namespace": "host-interaction/process/modify", "authors": ["moritz.raabe@mandiant.com"], "scope": "function", "attack": [{"parts": ["Privilege Escalation", "Access Token Manipulation"], "tactic": "Privilege Escalation", "technique": "Access Token Manipulation", "subtechnique": "", "id": "T1134"}], "mbc": [], "references": [], "examples": ["9324D1A8AE37A36AE560C37448C9705A:0x403BE0"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: modify access privileges\n    namespace: host-interaction/process/modify\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: function\n    att&ck:\n      - Privilege Escalation::Access Token Manipulation [T1134]\n    examples:\n      - 9324D1A8AE37A36AE560C37448C9705A:0x403BE0\n  features:\n    - and:\n      - api: advapi32.AdjustTokenPrivileges\n      - optional:\n        - or:\n          - api: advapi32.LookupPrivilegeValue\n", "matches": [[{"type": "absolute", "value": 4304465}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "advapi32.AdjustTokenPrivileges"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4479948}], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "advapi32.LookupPrivilegeValue"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4479913}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4480208}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "advapi32.AdjustTokenPrivileges"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4480368}, {"type": "absolute", "value": 4480530}], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "advapi32.LookupPrivilegeValue"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4480277}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "find graphical window": {"meta": {"name": "find graphical window", "namespace": "host-interaction/gui/window/find", "authors": ["moritz.raabe@mandiant.com"], "scope": "function", "attack": [{"parts": ["Discovery", "Application Window Discovery"], "tactic": "Discovery", "technique": "Application Window Discovery", "subtechnique": "", "id": "T1010"}], "mbc": [], "references": [], "examples": ["7C843E75D4F02087B932FE280DF9C90C:0x41B180"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: find graphical window\n    namespace: host-interaction/gui/window/find\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: function\n    att&ck:\n      - Discovery::Application Window Discovery [T1010]\n    examples:\n      - 7C843E75D4F02087B932FE280DF9C90C:0x41B180\n  features:\n    - or:\n      - api: user32.FindWindow\n      - api: user32.FindWindowEx\n", "matches": [[{"type": "absolute", "value": 4304550}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "user32.FindWindow"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4436129}, {"type": "absolute", "value": 4436154}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.FindWindowEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "get number of processor cores": {"meta": {"name": "get number of processor cores", "namespace": "host-interaction/hardware/cpu", "authors": ["michael.hunhoff@mandiant.com"], "scope": "function", "attack": [{"parts": ["Discovery", "System Information Discovery"], "tactic": "Discovery", "technique": "System Information Discovery", "subtechnique": "", "id": "T1082"}], "mbc": [], "references": ["https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiVM/Generic.cpp#L207"], "examples": ["al-khaser_x86.exe_:0x435BA0"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: get number of processor cores\n    namespace: host-interaction/hardware/cpu\n    authors:\n      - michael.hunhoff@mandiant.com\n    scope: function\n    att&ck:\n      - Discovery::System Information Discovery [T1082]\n    references:\n      - https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiVM/Generic.cpp#L207\n    examples:\n      - al-khaser_x86.exe_:0x435BA0\n  features:\n    - and:\n      - string: /SELECT\\s+\\*\\s+FROM\\s+Win32_Processor/\n      - string: \"NumberOfCores\"\n", "matches": [[{"type": "absolute", "value": 4304635}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "string", "string": "NumberOfCores"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4414607}], "captures": {}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/SELECT\\s+\\*\\s+FROM\\s+Win32_Processor/"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4414487}], "captures": {"SELECT * FROM Win32_Processor": [{"type": "absolute", "value": 4414487}]}}], "locations": [], "captures": {}}]]}, "create mutex": {"meta": {"name": "create mutex", "namespace": "host-interaction/mutex", "authors": ["moritz.raabe@mandiant.com", "michael.hunhoff@mandiant.com"], "scope": "function", "attack": [], "mbc": [{"parts": ["Process", "Create Mutex"], "objective": "Process", "behavior": "Create Mutex", "method": "", "id": "C0042"}], "references": [], "examples": ["Practical Malware Analysis Lab 01-01.dll_:0x10001010"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: create mutex\n    namespace: host-interaction/mutex\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scope: function\n    mbc:\n      - Process::Create Mutex [C0042]\n    examples:\n      - Practical Malware Analysis Lab 01-01.dll_:0x10001010\n  features:\n    - or:\n      - api: kernel32.CreateMutex\n      - api: kernel32.CreateMutexEx\n      - api: System.Threading.Mutex::ctor\n", "matches": [[{"type": "absolute", "value": 4304785}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.CreateMutex"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4394365}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.CreateMutexEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Threading.Mutex::ctor"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "check for protected handle exception": {"meta": {"name": "check for protected handle exception", "namespace": "anti-analysis/anti-debugging/debugger-detection", "authors": ["michael.hunhoff@mandiant.com"], "scope": "function", "attack": [], "mbc": [{"parts": ["Anti-Behavioral Analysis", "Debugger Detection", "SetHandleInformation"], "objective": "Anti-Behavioral Analysis", "behavior": "Debugger Detection", "method": "SetHandleInformation", "id": "B0001.024"}], "references": ["https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiDebug/SetHandleInformation_API.cpp"], "examples": ["al-khaser_x86.exe_:0x430D20"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: check for protected handle exception\n    namespace: anti-analysis/anti-debugging/debugger-detection\n    authors:\n      - michael.hunhoff@mandiant.com\n    scope: function\n    mbc:\n      - Anti-Behavioral Analysis::Debugger Detection::SetHandleInformation [B0001.024]\n    references:\n      - https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiDebug/SetHandleInformation_API.cpp\n    examples:\n      - al-khaser_x86.exe_:0x430D20\n  features:\n    - and:\n      - basic block:\n        - and:\n          - count(number(2)): 2 or more\n          - api: SetHandleInformation\n      - api: CloseHandle\n", "matches": [[{"type": "absolute", "value": 4304785}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"scope": "basic block", "type": "subscope"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "SetHandleInformation"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4394397}], "captures": {}}, {"success": true, "node": {"statement": {"min": 2, "max": 9223372036854775808, "child": {"type": "number", "number": 2}, "type": "range"}, "type": "statement"}, "children": [], "locations": [{"type": "absolute", "value": 4394389}, {"type": "absolute", "value": 4394391}], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4394387}], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "CloseHandle"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4394423}], "captures": {}}], "locations": [], "captures": {}}]]}, "query or enumerate registry value": {"meta": {"name": "query or enumerate registry value", "namespace": "host-interaction/registry", "authors": ["william.ballenthin@mandiant.com", "michael.hunhoff@mandiant.com", "anushka.virgaonkar@mandiant.com"], "scope": "function", "attack": [{"parts": ["Discovery", "Query Registry"], "tactic": "Discovery", "technique": "Query Registry", "subtechnique": "", "id": "T1012"}], "mbc": [{"parts": ["Operating System", "Registry", "Query Registry Value"], "objective": "Operating System", "behavior": "Registry", "method": "Query Registry Value", "id": "C0036.006"}], "references": [], "examples": ["BFB9B5391A13D0AFD787E87AB90F14F5:0x13145B5A", "Practical Malware Analysis Lab 03-02.dll_:0x100047AD"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: query or enumerate registry value\n    namespace: host-interaction/registry\n    authors:\n      - william.ballenthin@mandiant.com\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scope: function\n    att&ck:\n      - Discovery::Query Registry [T1012]\n    mbc:\n      - Operating System::Registry::Query Registry Value [C0036.006]\n    examples:\n      - BFB9B5391A13D0AFD787E87AB90F14F5:0x13145B5A\n      - Practical Malware Analysis Lab 03-02.dll_:0x100047AD\n  features:\n    - and:\n      - optional:\n        - match: create or open registry key\n      - or:\n        - api: advapi32.RegGetValue\n        - api: advapi32.RegEnumValue\n        - api: advapi32.RegQueryValue\n        - api: advapi32.RegQueryValueEx\n        - api: advapi32.RegQueryMultipleValues\n        - api: ZwQueryValueKey\n        - api: ZwEnumerateValueKey\n        - api: NtQueryValueKey\n        - api: NtEnumerateValueKey\n        - api: RtlQueryRegistryValues\n        - api: SHGetValue\n        - api: SHEnumValue\n        - api: SHRegGetInt\n        - api: SHRegGetPath\n        - api: SHRegGetValue\n        - api: SHQueryValueEx\n        - api: SHRegGetUSValue\n        - api: SHOpenRegStream\n        - api: SHRegEnumUSValue\n        - api: SHOpenRegStream2\n        - api: SHRegQueryUSValue\n        - api: SHRegGetBoolUSValue\n        - api: SHRegGetValueFromHKCUHKLM\n        - api: SHRegGetBoolValueFromHKCUHKLM\n        - api: Microsoft.Win32.RegistryKey::GetValue\n        - api: Microsoft.Win32.RegistryKey::GetValueKind\n        - api: Microsoft.Win32.RegistryKey::GetValueNames\n        - api: Microsoft.Win32.Registry::GetValue\n", "matches": [[{"type": "absolute", "value": 4305120}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "create or open registry key"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenKeyEx"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4479374}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegCreateKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegCreateKeyEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenCurrentUser"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenUserClassesRoot"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegCreateKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKeyEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKeyTransactedEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtOpenKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtCreateKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegOpenUSKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegCreateUSKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "RtlCreateRegistryKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::OpenSubKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::OpenBaseKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::OpenRemoteBaseKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::CreateSubKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4479264}], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegGetValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegEnumValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegQueryValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "advapi32.RegQueryValueEx"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4479419}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegQueryMultipleValues"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwQueryValueKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwEnumerateValueKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtQueryValueKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtEnumerateValueKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "RtlQueryRegistryValues"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHGetValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHEnumValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegGetInt"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegGetPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegGetValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHQueryValueEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegGetUSValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHOpenRegStream"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegEnumUSValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHOpenRegStream2"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegQueryUSValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegGetBoolUSValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegGetValueFromHKCUHKLM"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegGetBoolValueFromHKCUHKLM"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::GetValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::GetValueKind"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::GetValueNames"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.Registry::GetValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "set application hook": {"meta": {"name": "set application hook", "namespace": "host-interaction/gui", "authors": ["michael.hunhoff@mandiant.com"], "scope": "function", "attack": [], "mbc": [], "references": [], "examples": ["Practical Malware Analysis Lab 12-03.exe_:0x401000"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: set application hook\n    namespace: host-interaction/gui\n    authors:\n      - michael.hunhoff@mandiant.com\n    scope: function\n    examples:\n      - Practical Malware Analysis Lab 12-03.exe_:0x401000\n  features:\n    - and:\n      - or:\n        - api: user32.SetWindowsHookEx\n        - api: user32.UnhookWindowsHookEx\n", "matches": [[{"type": "absolute", "value": 4305765}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "user32.SetWindowsHookEx"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4451860}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.UnhookWindowsHookEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "log keystrokes via application hook": {"meta": {"name": "log keystrokes via application hook", "namespace": "collection/keylog", "authors": ["michael.hunhoff@mandiant.com"], "scope": "function", "attack": [{"parts": ["Collection", "Input Capture", "Keylogging"], "tactic": "Collection", "technique": "Input Capture", "subtechnique": "Keylogging", "id": "T1056.001"}], "mbc": [{"parts": ["Collection", "Keylogging", "Application Hook"], "objective": "Collection", "behavior": "Keylogging", "method": "Application Hook", "id": "F0002.001"}], "references": [], "examples": ["Practical Malware Analysis Lab 12-03.exe_:0x401000"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: log keystrokes via application hook\n    namespace: collection/keylog\n    authors:\n      - michael.hunhoff@mandiant.com\n    scope: function\n    att&ck:\n      - Collection::Input Capture::Keylogging [T1056.001]\n    mbc:\n      - Collection::Keylogging::Application Hook [F0002.001]\n    examples:\n      - Practical Malware Analysis Lab 12-03.exe_:0x401000\n  features:\n    - and:\n      - match: set application hook\n      - or:\n        - number: 13 = WH_KEYBOARD_LL\n        - number: 2  = WH_KEYBOARD\n", "matches": [[{"type": "absolute", "value": 4305765}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "set application hook"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "user32.SetWindowsHookEx"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4451860}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.UnhookWindowsHookEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4305765}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "number", "number": 13, "description": "WH_KEYBOARD_LL"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 2, "description": "WH_KEYBOARD"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4451858}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "contain a resource (.rsrc) section": {"meta": {"name": "contain a resource (.rsrc) section", "namespace": "executable/pe/section/rsrc", "authors": ["moritz.raabe@mandiant.com"], "scope": "file", "attack": [], "mbc": [], "references": [], "examples": ["A933A1A402775CFA94B6BEE0963F4B46:0x41fd25"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: contain a resource (.rsrc) section\n    namespace: executable/pe/section/rsrc\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: file\n    examples:\n      - A933A1A402775CFA94B6BEE0963F4B46:0x41fd25\n  features:\n    - section: .rsrc\n", "matches": [[{"type": "no address"}, {"success": true, "node": {"feature": {"type": "section", "section": ".rsrc"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4751360}], "captures": {}}]]}, "contain a thread local storage (.tls) section": {"meta": {"name": "contain a thread local storage (.tls) section", "namespace": "executable/pe/section/tls", "authors": ["michael.hunhoff@mandiant.com"], "scope": "file", "attack": [], "mbc": [], "references": [], "examples": ["Practical Malware Analysis Lab 16-02.exe_"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: contain a thread local storage (.tls) section\n    namespace: executable/pe/section/tls\n    authors:\n      - michael.hunhoff@mandiant.com\n    scope: file\n    examples:\n      - Practical Malware Analysis Lab 16-02.exe_\n  features:\n    - section: .tls\n", "matches": [[{"type": "no address"}, {"success": true, "node": {"feature": {"type": "section", "section": ".tls"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4743168}], "captures": {}}]]}, "read raw disk data": {"meta": {"name": "read raw disk data", "namespace": "host-interaction/file-system", "authors": ["william.ballenthin@mandiant.com"], "scope": "file", "attack": [], "mbc": [], "references": [], "examples": [], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: read raw disk data\n    namespace: host-interaction/file-system\n    authors:\n      - william.ballenthin@mandiant.com\n    scope: file\n  features:\n    - or:\n      - string: \"\\\\\\\\.\\\\PhysicalDrive0\"\n      - string: \"\\\\\\\\.\\\\C:\"\n", "matches": [[{"type": "no address"}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "string", "string": "\\\\.\\PhysicalDrive0"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 261844}], "captures": {}}, {"success": false, "node": {"feature": {"type": "string", "string": "\\\\.\\C:"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "reference anti-VM strings": {"meta": {"name": "reference anti-VM strings", "namespace": "anti-analysis/anti-vm/vm-detection", "authors": ["moritz.raabe@mandiant.com"], "scope": "file", "attack": [{"parts": ["Defense Evasion", "Virtualization/Sandbox Evasion", "System Checks"], "tactic": "Defense Evasion", "technique": "Virtualization/Sandbox Evasion", "subtechnique": "System Checks", "id": "T1497.001"}], "mbc": [{"parts": ["Anti-Behavioral Analysis", "Virtual Machine Detection"], "objective": "Anti-Behavioral Analysis", "behavior": "Virtual Machine Detection", "method": "", "id": "B0009"}], "references": ["https://github.com/ctxis/CAPE/blob/master/modules/signatures/antivm_*", "https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiVM/Generic.cpp"], "examples": ["Practical Malware Analysis Lab 17-02.dll_"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: reference anti-VM strings\n    namespace: anti-analysis/anti-vm/vm-detection\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: file\n    att&ck:\n      - Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001]\n    mbc:\n      - Anti-Behavioral Analysis::Virtual Machine Detection [B0009]\n    references:\n      - https://github.com/ctxis/CAPE/blob/master/modules/signatures/antivm_*\n      - https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiVM/Generic.cpp\n    examples:\n      - Practical Malware Analysis Lab 17-02.dll_\n  features:\n    - or:\n      - string: /HARDWARE\\\\ACPI\\\\(DSDT|FADT|RSDT)\\\\BOCHS/i\n      - string: /HARDWARE\\\\DESCRIPTION\\\\System\\\\(SystemBiosVersion|VideoBiosVersion)/i\n      - string: /HARDWARE\\\\DESCRIPTION\\\\System\\\\CentralProcessor/i\n      - string: /HARDWARE\\\\DEVICEMAP\\\\Scsi\\\\Scsi Port 0\\\\Scsi Bus 0\\\\Target Id 0\\\\Logical Unit Id 0/i\n      - string: /SYSTEM\\\\(CurrentControlSet|ControlSet001)\\\\Enum\\\\IDE/i\n      - string: /SYSTEM\\\\(CurrentControlSet|ControlSet001)\\\\Services\\\\Disk\\\\Enum\\\\/i\n      - string: /SYSTEM\\\\(CurrentControlSet|ControlSet001)\\\\Control\\\\SystemInformation\\\\SystemManufacturer/i\n      - string: /A M I/i\n      - string: /Hyper-V/i\n      - string: /Kernel-VMDetection-Private/i\n      # https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiVM/Generic.cpp#L699\n      - string: /KVMKVMKVM/i\n        description: KVM\n      - string: /Microsoft Hv/i\n        description: Microsoft Hyper-V or Windows Virtual PC\n      # https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiVM/Generic.cpp#L8\n      - string: /avghookx.dll/i\n        description: AVG\n      - string: /avghooka.dll/i\n        description: AVG\n      - string: /snxhk.dll/i\n        description: Avast\n      - string: /pstorec.dll/i\n        description: SunBelt Sandbox\n      - string: /vmcheck.dll/i\n        description: Virtual PC\n      - string: /wpespy.dll/i\n        description: WPE Pro\n      - string: /cmdvrt64.dll/i\n        description: Comodo Container\n      - string: /cmdvrt32.dll/i\n        description: Comodo Container\n      # https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiVM/Generic.cpp#L46\n      - string: /sample.exe/i\n      - string: /bot.exe/i\n      - string: /sandbox.exe/i\n      - string: /malware.exe/i\n      - string: /test.exe/i\n      - string: /klavme.exe/i\n      - string: /myapp.exe/i\n      - string: /testapp.exe/i\n", "matches": [[{"type": "no address"}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "regex", "regex": "/HARDWARE\\\\ACPI\\\\(DSDT|FADT|RSDT)\\\\BOCHS/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/HARDWARE\\\\DESCRIPTION\\\\System\\\\(SystemBiosVersion|VideoBiosVersion)/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/HARDWARE\\\\DESCRIPTION\\\\System\\\\CentralProcessor/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/HARDWARE\\\\DEVICEMAP\\\\Scsi\\\\Scsi Port 0\\\\Scsi Bus 0\\\\Target Id 0\\\\Logical Unit Id 0/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 264424}], "captures": {"HARDWARE\\DEVICEMAP\\Scsi\\Scsi Port 0\\Scsi Bus 0\\Target Id 0\\Logical Unit Id 0": [{"type": "file", "value": 264424}]}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/SYSTEM\\\\(CurrentControlSet|ControlSet001)\\\\Enum\\\\IDE/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/SYSTEM\\\\(CurrentControlSet|ControlSet001)\\\\Services\\\\Disk\\\\Enum\\\\/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/SYSTEM\\\\(CurrentControlSet|ControlSet001)\\\\Control\\\\SystemInformation\\\\SystemManufacturer/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/A M I/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 262288}], "captures": {"A M I": [{"type": "file", "value": 262288}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/Hyper-V/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 262916}], "captures": {"Hyper-V": [{"type": "file", "value": 262916}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/Kernel-VMDetection-Private/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 247632}, {"type": "file", "value": 262936}], "captures": {"Checking NtQueryLicenseValue with Kernel-VMDetection-Private ": [{"type": "file", "value": 247632}], "Kernel-VMDetection-Private": [{"type": "file", "value": 262936}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/KVMKVMKVM/i", "description": "KVM"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 261952}], "captures": {"KVMKVMKVM": [{"type": "file", "value": 261952}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/Microsoft Hv/i", "description": "Microsoft Hyper-V or Windows Virtual PC"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 261984}], "captures": {"Microsoft Hv": [{"type": "file", "value": 261984}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/avghookx.dll/i", "description": "AVG"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 260612}], "captures": {"avghookx.dll": [{"type": "file", "value": 260612}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/avghooka.dll/i", "description": "AVG"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 260644}], "captures": {"avghooka.dll": [{"type": "file", "value": 260644}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/snxhk.dll/i", "description": "Avast"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 260676}], "captures": {"snxhk.dll": [{"type": "file", "value": 260676}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/pstorec.dll/i", "description": "SunBelt Sandbox"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 260820}], "captures": {"pstorec.dll": [{"type": "file", "value": 260820}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/vmcheck.dll/i", "description": "Virtual PC"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 260848}], "captures": {"vmcheck.dll": [{"type": "file", "value": 260848}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/wpespy.dll/i", "description": "WPE Pro"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 260876}], "captures": {"wpespy.dll": [{"type": "file", "value": 260876}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/cmdvrt64.dll/i", "description": "Comodo Container"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 260904}], "captures": {"cmdvrt64.dll": [{"type": "file", "value": 260904}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/cmdvrt32.dll/i", "description": "Comodo Container"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 260936}], "captures": {"cmdvrt32.dll": [{"type": "file", "value": 260936}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/sample.exe/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 261088}], "captures": {"sample.exe": [{"type": "file", "value": 261088}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/bot.exe/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 261116}], "captures": {"bot.exe": [{"type": "file", "value": 261116}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/sandbox.exe/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 261136}], "captures": {"sandbox.exe": [{"type": "file", "value": 261136}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/malware.exe/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 261164}], "captures": {"malware.exe": [{"type": "file", "value": 261164}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/test.exe/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 261192}], "captures": {"test.exe": [{"type": "file", "value": 261192}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/klavme.exe/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 261216}], "captures": {"klavme.exe": [{"type": "file", "value": 261216}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/myapp.exe/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 261244}], "captures": {"myapp.exe": [{"type": "file", "value": 261244}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/testapp.exe/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 261268}], "captures": {"testapp.exe": [{"type": "file", "value": 261268}]}}], "locations": [], "captures": {}}]]}, "reference anti-VM strings targeting VMWare": {"meta": {"name": "reference anti-VM strings targeting VMWare", "namespace": "anti-analysis/anti-vm/vm-detection", "authors": ["michael.hunhoff@mandiant.com", "@johnk3r"], "scope": "file", "attack": [{"parts": ["Defense Evasion", "Virtualization/Sandbox Evasion", "System Checks"], "tactic": "Defense Evasion", "technique": "Virtualization/Sandbox Evasion", "subtechnique": "System Checks", "id": "T1497.001"}], "mbc": [{"parts": ["Anti-Behavioral Analysis", "Virtual Machine Detection"], "objective": "Anti-Behavioral Analysis", "behavior": "Virtual Machine Detection", "method": "", "id": "B0009"}], "references": ["https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiVM/VMWare.cpp"], "examples": ["al-khaser_x86.exe_", "b83480162ede09d4aa6d4850f9faa0a4c3834152752fd04cfdb22d647aa1f825:0x17D80"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: reference anti-VM strings targeting VMWare\n    namespace: anti-analysis/anti-vm/vm-detection\n    authors:\n      - michael.hunhoff@mandiant.com\n      - \"@johnk3r\"\n    scope: file\n    att&ck:\n      - Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001]\n    mbc:\n      - Anti-Behavioral Analysis::Virtual Machine Detection [B0009]\n    references:\n      - https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiVM/VMWare.cpp\n    examples:\n      - al-khaser_x86.exe_\n      - b83480162ede09d4aa6d4850f9faa0a4c3834152752fd04cfdb22d647aa1f825:0x17D80\n  features:\n    - or:\n      - string: /VMWare/i\n      - string: /VMTools/i\n      - string: /SOFTWARE\\\\VMware, Inc\\.\\\\VMware Tools/i\n      - string: /vmnet\\.sys/i\n      - string: /vmmouse\\.sys/i\n      - string: /vmusb\\.sys/i\n      - string: /vm3dmp\\.sys/i\n      - string: /vmci\\.sys/i\n      - string: /vmhgfs\\.sys/i\n      - string: /vmmemctl\\.sys/i\n      - string: /vmx86\\.sys/i\n      - string: /vmrawdsk\\.sys/i\n      - string: /vmusbmouse\\.sys/i\n      - string: /vmkdb\\.sys/i\n      - string: /vmnetuserif\\.sys/i\n      - string: /vmnetadapter\\.sys/i\n      - string: /\\\\\\\\.\\\\HGFS/i\n      - string: /\\\\\\\\.\\\\vmci/i\n      - string: /vmtoolsd\\.exe/i\n      - string: /vmwaretray\\.exe/i\n      - string: /vmwareuser\\.exe/i\n      - string: /VGAuthService\\.exe/i\n      - string: /vmacthlp\\.exe/i\n      - string: /vmci/i\n        description: VMWare VMCI Bus Driver\n      - string: /vmhgfs/i\n        description: VMWare Host Guest Control Redirector\n      - string: /vmmouse/i\n      - string: /vmmemctl/i\n        description: VMWare Guest Memory Controller Driver\n      - string: /vmusb/i\n      - string: /vmusbmouse/i\n      - string: /vmx_svga/i\n      - string: /vmxnet/i\n      - string: /vmx86/i\n      - string: /VMwareVMware/i\n      - string: /vmGuestLib\\.dll/i\n      - string: /vmGuestLib\\.dll/i\n      - string: /Applications\\\\VMwareHostOpen\\.exe/i\n      - string: /vm3dgl\\.dll/i\n      - string: /vmdum\\.dll/i\n      - string: /vm3dver\\.dll/i\n      - string: /vmtray\\.dll/i\n      - string: /VMToolsHook\\.dll/i\n      - string: /vmmousever\\.dll/i\n      - string: /VmGuestLibJava\\.dll/i\n      - string: /vmscsi\\.sys/i\n", "matches": [[{"type": "no address"}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "regex", "regex": "/VMWare/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 262016}, {"type": "file", "value": 269572}, {"type": "file", "value": 271752}, {"type": "file", "value": 270216}, {"type": "file", "value": 250672}, {"type": "file", "value": 271760}, {"type": "file", "value": 261904}, {"type": "file", "value": 271536}, {"type": "file", "value": 250804}, {"type": "file", "value": 271220}, {"type": "file", "value": 271572}, {"type": "file", "value": 250712}, {"type": "file", "value": 262236}], "captures": {"VMware": [{"type": "file", "value": 271752}], "VMWARE": [{"type": "file", "value": 271760}, {"type": "file", "value": 269572}], "VMWare Detection": [{"type": "file", "value": 250672}], "Checking VMWare network adapter name ": [{"type": "file", "value": 250712}], "Checking VMWare directory ": [{"type": "file", "value": 250804}], "vmware": [{"type": "file", "value": 261904}], "VMwareVMware": [{"type": "file", "value": 262016}], "VMWare": [{"type": "file", "value": 262236}], "SOFTWARE\\VMware, Inc.\\VMware Tools": [{"type": "file", "value": 270216}], "VMWare\\": [{"type": "file", "value": 271220}], "vmwaretray.exe": [{"type": "file", "value": 271536}], "vmwareuser.exe": [{"type": "file", "value": 271572}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/VMTools/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 271504}], "captures": {"vmtoolsd.exe": [{"type": "file", "value": 271504}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/SOFTWARE\\\\VMware, Inc\\.\\\\VMware Tools/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 270216}], "captures": {"SOFTWARE\\VMware, Inc.\\VMware Tools": [{"type": "file", "value": 270216}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/vmnet\\.sys/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 270300}], "captures": {"System32\\drivers\\vmnet.sys": [{"type": "file", "value": 270300}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/vmmouse\\.sys/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 270364}], "captures": {"System32\\drivers\\vmmouse.sys": [{"type": "file", "value": 270364}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/vmusb\\.sys/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 270436}], "captures": {"System32\\drivers\\vmusb.sys": [{"type": "file", "value": 270436}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/vm3dmp\\.sys/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 270500}], "captures": {"System32\\drivers\\vm3dmp.sys": [{"type": "file", "value": 270500}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/vmci\\.sys/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 270568}], "captures": {"System32\\drivers\\vmci.sys": [{"type": "file", "value": 270568}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/vmhgfs\\.sys/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 270632}], "captures": {"System32\\drivers\\vmhgfs.sys": [{"type": "file", "value": 270632}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/vmmemctl\\.sys/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 270700}], "captures": {"System32\\drivers\\vmmemctl.sys": [{"type": "file", "value": 270700}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/vmx86\\.sys/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 270772}], "captures": {"System32\\drivers\\vmx86.sys": [{"type": "file", "value": 270772}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/vmrawdsk\\.sys/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 270836}], "captures": {"System32\\drivers\\vmrawdsk.sys": [{"type": "file", "value": 270836}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/vmusbmouse\\.sys/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 270912}], "captures": {"System32\\drivers\\vmusbmouse.sys": [{"type": "file", "value": 270912}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/vmkdb\\.sys/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 270988}], "captures": {"System32\\drivers\\vmkdb.sys": [{"type": "file", "value": 270988}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/vmnetuserif\\.sys/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 271056}], "captures": {"System32\\drivers\\vmnetuserif.sys": [{"type": "file", "value": 271056}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/vmnetadapter\\.sys/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 271136}], "captures": {"System32\\drivers\\vmnetadapter.sys": [{"type": "file", "value": 271136}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/\\\\\\\\.\\\\HGFS/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 271456}], "captures": {"\\\\.\\HGFS": [{"type": "file", "value": 271456}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/\\\\\\\\.\\\\vmci/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 271480}], "captures": {"\\\\.\\vmci": [{"type": "file", "value": 271480}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/vmtoolsd\\.exe/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 271504}], "captures": {"vmtoolsd.exe": [{"type": "file", "value": 271504}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/vmwaretray\\.exe/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 271536}], "captures": {"vmwaretray.exe": [{"type": "file", "value": 271536}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/vmwareuser\\.exe/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 271572}], "captures": {"vmwareuser.exe": [{"type": "file", "value": 271572}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/VGAuthService\\.exe/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 271608}], "captures": {"VGAuthService.exe": [{"type": "file", "value": 271608}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/vmacthlp\\.exe/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 271652}], "captures": {"vmacthlp.exe": [{"type": "file", "value": 271652}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/vmci/i", "description": "VMWare VMCI Bus Driver"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 265016}, {"type": "file", "value": 270568}, {"type": "file", "value": 271480}], "captures": {"vmci": [{"type": "file", "value": 265016}], "System32\\drivers\\vmci.sys": [{"type": "file", "value": 270568}], "\\\\.\\vmci": [{"type": "file", "value": 271480}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/vmhgfs/i", "description": "VMWare Host Guest Control Redirector"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 270632}, {"type": "file", "value": 265028}], "captures": {"vmhgfs": [{"type": "file", "value": 265028}], "System32\\drivers\\vmhgfs.sys": [{"type": "file", "value": 270632}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/vmmouse/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 265044}, {"type": "file", "value": 270364}], "captures": {"vmmouse": [{"type": "file", "value": 265044}], "System32\\drivers\\vmmouse.sys": [{"type": "file", "value": 270364}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/vmmemctl/i", "description": "VMWare Guest Memory Controller Driver"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 265064}, {"type": "file", "value": 270700}], "captures": {"vmmemctl": [{"type": "file", "value": 265064}], "System32\\drivers\\vmmemctl.sys": [{"type": "file", "value": 270700}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/vmusb/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 265088}, {"type": "file", "value": 270912}, {"type": "file", "value": 270436}, {"type": "file", "value": 265104}], "captures": {"vmusb": [{"type": "file", "value": 265088}], "vmusbmouse": [{"type": "file", "value": 265104}], "System32\\drivers\\vmusb.sys": [{"type": "file", "value": 270436}], "System32\\drivers\\vmusbmouse.sys": [{"type": "file", "value": 270912}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/vmusbmouse/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 265104}, {"type": "file", "value": 270912}], "captures": {"vmusbmouse": [{"type": "file", "value": 265104}], "System32\\drivers\\vmusbmouse.sys": [{"type": "file", "value": 270912}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/vmx_svga/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 265132}], "captures": {"vmx_svga": [{"type": "file", "value": 265132}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/vmxnet/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 265156}], "captures": {"vmxnet": [{"type": "file", "value": 265156}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/vmx86/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 270772}, {"type": "file", "value": 265172}], "captures": {"vmx86": [{"type": "file", "value": 265172}], "System32\\drivers\\vmx86.sys": [{"type": "file", "value": 270772}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/VMwareVMware/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 262016}], "captures": {"VMwareVMware": [{"type": "file", "value": 262016}]}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/vmGuestLib\\.dll/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/vmGuestLib\\.dll/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/Applications\\\\VMwareHostOpen\\.exe/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/vm3dgl\\.dll/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/vmdum\\.dll/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/vm3dver\\.dll/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/vmtray\\.dll/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/VMToolsHook\\.dll/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/vmmousever\\.dll/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/VmGuestLibJava\\.dll/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/vmscsi\\.sys/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "reference analysis tools strings": {"meta": {"name": "reference analysis tools strings", "namespace": "anti-analysis", "authors": ["michael.hunhoff@mandiant.com"], "scope": "file", "attack": [], "mbc": [{"parts": ["Discovery", "Analysis Tool Discovery", "Process detection"], "objective": "Discovery", "behavior": "Analysis Tool Discovery", "method": "Process detection", "id": "B0013.001"}], "references": ["https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiAnalysis/process.cpp"], "examples": ["al-khaser_x86.exe_"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: reference analysis tools strings\n    namespace: anti-analysis\n    authors:\n      - michael.hunhoff@mandiant.com\n    scope: file\n    mbc:\n      - Discovery::Analysis Tool Discovery::Process detection [B0013.001]\n    references:\n      - https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiAnalysis/process.cpp\n    examples:\n      - al-khaser_x86.exe_\n  features:\n    - or:\n      - string: /ollydbg\\.exe/i\n      - string: /ProcessHacker\\.exe/i\n      - string: /tcpview\\.exe/i\n      - string: /autoruns\\.exe/i\n      - string: /autorunsc\\.exe/i\n      - string: /filemon\\.exe/i\n      - string: /procmon\\.exe/i\n      - string: /regmon\\.exe/i\n      - string: /procexp\\.exe/i\n      - string: /idaq\\.exe/i\n      - string: /idaq64\\.exe/i\n      - string: /ImmunityDebugger\\.exe/i\n      - string: /Wireshark\\.exe/i\n      - string: /dumpcap\\.exe/i\n      - string: /HookExplorer\\.exe/i\n      - string: /ImportREC\\.exe/i\n      - string: /PETools\\.exe/i\n      - string: /LordPE\\.exe/i\n      - string: /SysInspector\\.exe/i\n      - string: /proc_analyzer\\.exe/i\n      - string: /sysAnalyzer\\.exe/i\n      - string: /sniff_hit\\.exe/i\n      - string: /windbg\\.exe/i\n      - string: /joeboxcontrol\\.exe/i\n      - string: /joeboxserver\\.exe/i\n      - string: /ResourceHacker\\.exe/i\n      - string: /x32dbg\\.exe/i\n      - string: /x64dbg\\.exe/i\n      - string: /Fiddler\\.exe/i\n      - string: /httpdebugger\\.exe/i\n      - string: /fakenet\\.exe/i\n      - string: /netmon\\.exe/i\n      - string: /WPE PRO\\.exe/i\n      - string: /decompile\\.exe/i\n", "matches": [[{"type": "no address"}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "regex", "regex": "/ollydbg\\.exe/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 253136}], "captures": {"ollydbg.exe": [{"type": "file", "value": 253136}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/ProcessHacker\\.exe/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 253164}], "captures": {"ProcessHacker.exe": [{"type": "file", "value": 253164}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/tcpview\\.exe/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 253208}], "captures": {"tcpview.exe": [{"type": "file", "value": 253208}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/autoruns\\.exe/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 253236}], "captures": {"autoruns.exe": [{"type": "file", "value": 253236}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/autorunsc\\.exe/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 253268}], "captures": {"autorunsc.exe": [{"type": "file", "value": 253268}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/filemon\\.exe/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 253304}], "captures": {"filemon.exe": [{"type": "file", "value": 253304}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/procmon\\.exe/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 253332}], "captures": {"procmon.exe": [{"type": "file", "value": 253332}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/regmon\\.exe/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 253360}], "captures": {"regmon.exe": [{"type": "file", "value": 253360}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/procexp\\.exe/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 253388}], "captures": {"procexp.exe": [{"type": "file", "value": 253388}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/idaq\\.exe/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 253416}], "captures": {"idaq.exe": [{"type": "file", "value": 253416}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/idaq64\\.exe/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 253440}], "captures": {"idaq64.exe": [{"type": "file", "value": 253440}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/ImmunityDebugger\\.exe/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 253468}], "captures": {"ImmunityDebugger.exe": [{"type": "file", "value": 253468}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/Wireshark\\.exe/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 253520}], "captures": {"Wireshark.exe": [{"type": "file", "value": 253520}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/dumpcap\\.exe/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 253556}], "captures": {"dumpcap.exe": [{"type": "file", "value": 253556}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/HookExplorer\\.exe/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 253584}], "captures": {"HookExplorer.exe": [{"type": "file", "value": 253584}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/ImportREC\\.exe/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 253624}], "captures": {"ImportREC.exe": [{"type": "file", "value": 253624}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/PETools\\.exe/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 253660}], "captures": {"PETools.exe": [{"type": "file", "value": 253660}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/LordPE\\.exe/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 253688}], "captures": {"LordPE.exe": [{"type": "file", "value": 253688}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/SysInspector\\.exe/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 253716}], "captures": {"SysInspector.exe": [{"type": "file", "value": 253716}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/proc_analyzer\\.exe/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 253756}], "captures": {"proc_analyzer.exe": [{"type": "file", "value": 253756}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/sysAnalyzer\\.exe/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 253800}], "captures": {"sysAnalyzer.exe": [{"type": "file", "value": 253800}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/sniff_hit\\.exe/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 253840}], "captures": {"sniff_hit.exe": [{"type": "file", "value": 253840}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/windbg\\.exe/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 253876}], "captures": {"windbg.exe": [{"type": "file", "value": 253876}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/joeboxcontrol\\.exe/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 253904}], "captures": {"joeboxcontrol.exe": [{"type": "file", "value": 253904}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/joeboxserver\\.exe/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 253948}], "captures": {"joeboxserver.exe": [{"type": "file", "value": 253948}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/ResourceHacker\\.exe/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 253988}], "captures": {"ResourceHacker.exe": [{"type": "file", "value": 253988}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/x32dbg\\.exe/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 254036}], "captures": {"x32dbg.exe": [{"type": "file", "value": 254036}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/x64dbg\\.exe/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 254064}], "captures": {"x64dbg.exe": [{"type": "file", "value": 254064}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/Fiddler\\.exe/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 254092}], "captures": {"Fiddler.exe": [{"type": "file", "value": 254092}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/httpdebugger\\.exe/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 254120}], "captures": {"httpdebugger.exe": [{"type": "file", "value": 254120}]}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/fakenet\\.exe/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/netmon\\.exe/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/WPE PRO\\.exe/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/decompile\\.exe/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "reference anti-VM strings targeting VirtualPC": {"meta": {"name": "reference anti-VM strings targeting VirtualPC", "namespace": "anti-analysis/anti-vm/vm-detection", "authors": ["michael.hunhoff@mandiant.com"], "scope": "file", "attack": [{"parts": ["Defense Evasion", "Virtualization/Sandbox Evasion", "System Checks"], "tactic": "Defense Evasion", "technique": "Virtualization/Sandbox Evasion", "subtechnique": "System Checks", "id": "T1497.001"}], "mbc": [{"parts": ["Anti-Behavioral Analysis", "Virtual Machine Detection"], "objective": "Anti-Behavioral Analysis", "behavior": "Virtual Machine Detection", "method": "", "id": "B0009"}], "references": ["https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiVM/VirtualPC.cpp"], "examples": ["al-khaser_x86.exe_"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: reference anti-VM strings targeting VirtualPC\n    namespace: anti-analysis/anti-vm/vm-detection\n    authors:\n      - michael.hunhoff@mandiant.com\n    scope: file\n    att&ck:\n      - Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001]\n    mbc:\n      - Anti-Behavioral Analysis::Virtual Machine Detection [B0009]\n    references:\n      - https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiVM/VirtualPC.cpp\n    examples:\n      - al-khaser_x86.exe_\n  features:\n    - or:\n      - string: /VirtualPC/i\n      - string: /VMSrvc.exe/i\n      - string: /VMUSrvc.exe/i\n      - string: /SOFTWARE\\\\Microsoft\\\\Virtual Machine\\\\Guest\\\\Parameters/i\n", "matches": [[{"type": "no address"}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "regex", "regex": "/VirtualPC/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/VMSrvc.exe/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 269304}], "captures": {"VMSrvc.exe": [{"type": "file", "value": 269304}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/VMUSrvc.exe/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 269332}], "captures": {"VMUSrvc.exe": [{"type": "file", "value": 269332}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/SOFTWARE\\\\Microsoft\\\\Virtual Machine\\\\Guest\\\\Parameters/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 269448}], "captures": {"SOFTWARE\\Microsoft\\Virtual Machine\\Guest\\Parameters": [{"type": "file", "value": 269448}]}}], "locations": [], "captures": {}}]]}, "reference anti-VM strings targeting Xen": {"meta": {"name": "reference anti-VM strings targeting Xen", "namespace": "anti-analysis/anti-vm/vm-detection", "authors": ["michael.hunhoff@mandiant.com"], "scope": "file", "attack": [{"parts": ["Defense Evasion", "Virtualization/Sandbox Evasion", "System Checks"], "tactic": "Defense Evasion", "technique": "Virtualization/Sandbox Evasion", "subtechnique": "System Checks", "id": "T1497.001"}], "mbc": [{"parts": ["Anti-Behavioral Analysis", "Virtual Machine Detection"], "objective": "Anti-Behavioral Analysis", "behavior": "Virtual Machine Detection", "method": "", "id": "B0009"}], "references": ["https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiVM/Xen.cpp"], "examples": ["al-khaser_x86.exe_"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: reference anti-VM strings targeting Xen\n    namespace: anti-analysis/anti-vm/vm-detection\n    authors:\n      - michael.hunhoff@mandiant.com\n    scope: file\n    att&ck:\n      - Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001]\n    mbc:\n      - Anti-Behavioral Analysis::Virtual Machine Detection [B0009]\n    references:\n      - https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiVM/Xen.cpp\n    examples:\n      - al-khaser_x86.exe_\n  features:\n    - or:\n      - string: /^Xen/i\n      - string: /XenVMMXenVMM/i\n      - string: /xenservice.exe/i\n      - string: /XenVMMXenVMM/i\n      - string: /HVM domU/i\n", "matches": [[{"type": "no address"}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "regex", "regex": "/^Xen/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 262048}, {"type": "file", "value": 271872}, {"type": "file", "value": 250956}], "captures": {"Xen Detection": [{"type": "file", "value": 250956}], "XenVMMXenVMM": [{"type": "file", "value": 262048}], "xenservice.exe": [{"type": "file", "value": 271872}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/XenVMMXenVMM/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 262048}], "captures": {"XenVMMXenVMM": [{"type": "file", "value": 262048}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/xenservice.exe/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 271872}], "captures": {"xenservice.exe": [{"type": "file", "value": 271872}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/XenVMMXenVMM/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 262048}], "captures": {"XenVMMXenVMM": [{"type": "file", "value": 262048}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/HVM domU/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 262432}], "captures": {"HVM domU": [{"type": "file", "value": 262432}]}}], "locations": [], "captures": {}}]]}, "reference anti-VM strings targeting VirtualBox": {"meta": {"name": "reference anti-VM strings targeting VirtualBox", "namespace": "anti-analysis/anti-vm/vm-detection", "authors": ["michael.hunhoff@mandiant.com"], "scope": "file", "attack": [{"parts": ["Defense Evasion", "Virtualization/Sandbox Evasion", "System Checks"], "tactic": "Defense Evasion", "technique": "Virtualization/Sandbox Evasion", "subtechnique": "System Checks", "id": "T1497.001"}], "mbc": [{"parts": ["Anti-Behavioral Analysis", "Virtual Machine Detection"], "objective": "Anti-Behavioral Analysis", "behavior": "Virtual Machine Detection", "method": "", "id": "B0009"}], "references": ["https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiVM/VirtualBox.cpp"], "examples": ["al-khaser_x86.exe_"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: reference anti-VM strings targeting VirtualBox\n    namespace: anti-analysis/anti-vm/vm-detection\n    authors:\n      - michael.hunhoff@mandiant.com\n    scope: file\n    att&ck:\n      - Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001]\n    mbc:\n      - Anti-Behavioral Analysis::Virtual Machine Detection [B0009]\n    references:\n      - https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiVM/VirtualBox.cpp\n    examples:\n      - al-khaser_x86.exe_\n  features:\n    - or:\n      - string: /VBOX/i\n      - string: /VEN_VBOX/i\n      - string: /VirtualBox/i\n      - string: /06/23/99/i\n      - string: /HARDWARE\\\\ACPI\\\\DSDT\\\\VBOX__/i\n      - string: /HARDWARE\\\\ACPI\\\\FADT\\\\VBOX__/i\n      - string: /HARDWARE\\\\ACPI\\\\RSDT\\\\VBOX__/i\n      - string: /SOFTWARE\\\\Oracle\\\\VirtualBox Guest Additions/i\n      - string: /SYSTEM\\\\ControlSet001\\\\Services\\\\VBoxGuest/i\n      - string: /SYSTEM\\\\ControlSet001\\\\Services\\\\VBoxMouse/i\n      - string: /SYSTEM\\\\ControlSet001\\\\Services\\\\VBoxService/i\n      - string: /SYSTEM\\\\ControlSet001\\\\Services\\\\VBoxSF/i\n      - string: /SYSTEM\\\\ControlSet001\\\\Services\\\\VBoxVideo/i\n      - string: /VBoxMouse\\.sys/i\n      - string: /VBoxGuest\\.sys/i\n      - string: /VBoxSF\\.sys/i\n      - string: /VBoxVideo\\.sys/i\n      - string: /vboxdisp\\.dll/i\n      - string: /vboxhook\\.dll/i\n      - string: /vboxmrxnp\\.dll/i\n      - string: /vboxogl\\.dll/i\n      - string: /vboxoglarrayspu\\.dll/i\n      - string: /vboxoglcrutil\\.dll/i\n      - string: /vboxoglerrorspu\\.dll/i\n      - string: /vboxoglfeedbackspu\\.dll/i\n      - string: /vboxoglpackspu\\.dll/i\n      - string: /vboxoglpassthroughspu\\.dll/i\n      - string: /vboxservice\\.exe/i\n      - string: /vboxtray\\.exe/i\n      - string: /VBoxControl\\.exe/i\n      - string: /oracle\\\\virtualbox guest additions\\\\/i\n      - string: /\\\\\\\\.\\\\VBoxMiniRdrDN/i\n      - string: /\\\\\\\\.\\\\VBoxGuest/i\n      - string: /\\\\\\\\.\\\\pipe\\\\VBoxMiniRdDN/i\n      - string: /\\\\\\\\.\\\\VBoxTrayIPC/i\n      - string: /\\\\\\\\.\\\\pipe\\\\VBoxTrayIPC/i\n      - string: /VBoxTrayToolWndClass/i\n      - string: /VBoxTrayToolWnd/i\n      - string: /vboxservice\\.exe/i\n      - string: /vboxtray.exe/i\n      - string: /vboxvideo/i\n      - string: /VBoxVideoW8/i\n      - string: /VBoxWddm/i\n      - string: /PCI\\\\VEN_80EE&DEV_CAFE/i\n      - string: /82801FB/i\n      - string: /82441FX/i\n      - string: /82371SB/i\n      - string: /OpenHCD/i\n      - string: /ACPIBus_BUS_0/i\n      - string: /PCI_BUS_0/i\n      - string: /PNP_BUS_0/i\n      - string: /Oracle Corporation/i\n      - string: /VBoxWdd/i\n      - string: /VBoxS/i\n        description: VirtualBox Shared Folders\n      - string: /VBoxMouse/i\n        description: VirtualBox Guest Mouse\n      - string: /VBoxGuest/i\n        description: VirtualBox Guest Driver\n      - string: /VBoxVBoxVBox/i\n      - string: /innotek GmbH/i\n      - string: /drivers\\\\vboxdrv/i\n", "matches": [[{"type": "no address"}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "regex", "regex": "/VBOX/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 250112}, {"type": "file", "value": 265600}, {"type": "file", "value": 265728}, {"type": "file", "value": 261892}, {"type": "file", "value": 266884}, {"type": "file", "value": 264968}, {"type": "file", "value": 265992}, {"type": "file", "value": 266376}, {"type": "file", "value": 268424}, {"type": "file", "value": 267020}, {"type": "file", "value": 266776}, {"type": "file", "value": 267676}, {"type": "file", "value": 264992}, {"type": "file", "value": 266528}, {"type": "file", "value": 267808}, {"type": "file", "value": 268448}, {"type": "file", "value": 267172}, {"type": "file", "value": 265896}, {"type": "file", "value": 266280}, {"type": "file", "value": 267436}, {"type": "file", "value": 267948}, {"type": "file", "value": 266672}, {"type": "file", "value": 249784}, {"type": "file", "value": 267324}, {"type": "file", "value": 249536}, {"type": "file", "value": 265664}, {"type": "file", "value": 267720}, {"type": "file", "value": 267848}, {"type": "file", "value": 268104}, {"type": "file", "value": 266956}, {"type": "file", "value": 266192}, {"type": "file", "value": 266832}, {"type": "file", "value": 266452}, {"type": "file", "value": 249944}, {"type": "file", "value": 267096}, {"type": "file", "value": 265308}, {"type": "file", "value": 268640}, {"type": "file", "value": 262112}, {"type": "file", "value": 264928}, {"type": "file", "value": 268000}, {"type": "file", "value": 266596}, {"type": "file", "value": 266724}, {"type": "file", "value": 269280}, {"type": "file", "value": 268648}, {"type": "file", "value": 266088}, {"type": "file", "value": 267240}, {"type": "file", "value": 267756}, {"type": "file", "value": 268144}, {"type": "file", "value": 128375}, {"type": "file", "value": 264952}, {"type": "file", "value": 267384}], "captures": {"szVBoxSources": [{"type": "file", "value": 128375}], "vbox": [{"type": "file", "value": 268640}, {"type": "file", "value": 261892}], "VBOX": [{"type": "file", "value": 268648}, {"type": "file", "value": 265308}], "Checking VBoxTrayToolWndClass / VBoxTrayToolWnd ": [{"type": "file", "value": 249536}], "Checking Win32_PnPDevice DeviceId from WMI for VBox PCI device ": [{"type": "file", "value": 249784}], "Checking Win32_PnPDevice Name from WMI for VBox controller hardware ": [{"type": "file", "value": 249944}], "Checking Win32_PnPDevice Name from WMI for VBOX names ": [{"type": "file", "value": 250112}], "VBoxVBoxVBox": [{"type": "file", "value": 262112}], "VBoxWddm": [{"type": "file", "value": 264928}], "VBoxSF": [{"type": "file", "value": 264952}], "VBoxMouse": [{"type": "file", "value": 264968}], "VBoxGuest": [{"type": "file", "value": 264992}], "HARDWARE\\ACPI\\DSDT\\VBOX__": [{"type": "file", "value": 265600}], "HARDWARE\\ACPI\\FADT\\VBOX__": [{"type": "file", "value": 265664}], "HARDWARE\\ACPI\\RSDT\\VBOX__": [{"type": "file", "value": 265728}], "SYSTEM\\ControlSet001\\Services\\VBoxGuest": [{"type": "file", "value": 265896}], "SYSTEM\\ControlSet001\\Services\\VBoxMouse": [{"type": "file", "value": 265992}], "SYSTEM\\ControlSet001\\Services\\VBoxService": [{"type": "file", "value": 266088}], "SYSTEM\\ControlSet001\\Services\\VBoxSF": [{"type": "file", "value": 266192}], "SYSTEM\\ControlSet001\\Services\\VBoxVideo": [{"type": "file", "value": 266280}], "System32\\drivers\\VBoxMouse.sys": [{"type": "file", "value": 266376}], "System32\\drivers\\VBoxGuest.sys": [{"type": "file", "value": 266452}], "System32\\drivers\\VBoxSF.sys": [{"type": "file", "value": 266528}], "System32\\drivers\\VBoxVideo.sys": [{"type": "file", "value": 266596}], "System32\\vboxdisp.dll": [{"type": "file", "value": 266672}], "System32\\vboxhook.dll": [{"type": "file", "value": 266724}], "System32\\vboxmrxnp.dll": [{"type": "file", "value": 266776}], "System32\\vboxogl.dll": [{"type": "file", "value": 266832}], "System32\\vboxoglarrayspu.dll": [{"type": "file", "value": 266884}], "System32\\vboxoglcrutil.dll": [{"type": "file", "value": 266956}], "System32\\vboxoglerrorspu.dll": [{"type": "file", "value": 267020}], "System32\\vboxoglfeedbackspu.dll": [{"type": "file", "value": 267096}], "System32\\vboxoglpackspu.dll": [{"type": "file", "value": 267172}], "System32\\vboxoglpassthroughspu.dll": [{"type": "file", "value": 267240}], "System32\\vboxservice.exe": [{"type": "file", "value": 267324}], "System32\\vboxtray.exe": [{"type": "file", "value": 267384}], "System32\\VBoxControl.exe": [{"type": "file", "value": 267436}], "\\\\.\\VBoxMiniRdrDN": [{"type": "file", "value": 267676}], "\\\\.\\VBoxGuest": [{"type": "file", "value": 267720}], "\\\\.\\pipe\\VBoxMiniRdDN": [{"type": "file", "value": 267756}], "\\\\.\\VBoxTrayIPC": [{"type": "file", "value": 267808}], "\\\\.\\pipe\\VBoxTrayIPC": [{"type": "file", "value": 267848}], "VBoxTrayToolWndClass": [{"type": "file", "value": 267948}], "VBoxTrayToolWnd": [{"type": "file", "value": 268000}], "vboxservice.exe": [{"type": "file", "value": 268104}], "vboxtray.exe": [{"type": "file", "value": 268144}], "vboxvideo": [{"type": "file", "value": 268424}], "VBoxVideoW8": [{"type": "file", "value": 268448}], "VEN_VBOX": [{"type": "file", "value": 269280}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/VEN_VBOX/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 269280}], "captures": {"VEN_VBOX": [{"type": "file", "value": 269280}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/VirtualBox/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 265792}, {"type": "file", "value": 267544}, {"type": "file", "value": 262404}, {"type": "file", "value": 249224}, {"type": "file", "value": 268040}, {"type": "file", "value": 268624}, {"type": "file", "value": 249168}, {"type": "file", "value": 265360}, {"type": "file", "value": 268176}, {"type": "file", "value": 249656}], "captures": {"VirtualBox": [{"type": "file", "value": 268624}, {"type": "file", "value": 262404}], "VirtualBox Detection": [{"type": "file", "value": 249168}], "Checking VirtualBox Guest Additions directory ": [{"type": "file", "value": 249224}], "Checking VirtualBox Shared Folders network provider ": [{"type": "file", "value": 249656}], "VIRTUALBOX": [{"type": "file", "value": 265360}], "SOFTWARE\\Oracle\\VirtualBox Guest Additions": [{"type": "file", "value": 265792}], "oracle\\virtualbox guest additions\\": [{"type": "file", "value": 267544}], "VirtualBox Shared Folders": [{"type": "file", "value": 268040}], "Checking VirtualBox process %s ": [{"type": "file", "value": 268176}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/06/23/99/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 265424}], "captures": {"06/23/99": [{"type": "file", "value": 265424}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/HARDWARE\\\\ACPI\\\\DSDT\\\\VBOX__/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 265600}], "captures": {"HARDWARE\\ACPI\\DSDT\\VBOX__": [{"type": "file", "value": 265600}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/HARDWARE\\\\ACPI\\\\FADT\\\\VBOX__/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 265664}], "captures": {"HARDWARE\\ACPI\\FADT\\VBOX__": [{"type": "file", "value": 265664}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/HARDWARE\\\\ACPI\\\\RSDT\\\\VBOX__/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 265728}], "captures": {"HARDWARE\\ACPI\\RSDT\\VBOX__": [{"type": "file", "value": 265728}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/SOFTWARE\\\\Oracle\\\\VirtualBox Guest Additions/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 265792}], "captures": {"SOFTWARE\\Oracle\\VirtualBox Guest Additions": [{"type": "file", "value": 265792}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/SYSTEM\\\\ControlSet001\\\\Services\\\\VBoxGuest/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 265896}], "captures": {"SYSTEM\\ControlSet001\\Services\\VBoxGuest": [{"type": "file", "value": 265896}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/SYSTEM\\\\ControlSet001\\\\Services\\\\VBoxMouse/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 265992}], "captures": {"SYSTEM\\ControlSet001\\Services\\VBoxMouse": [{"type": "file", "value": 265992}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/SYSTEM\\\\ControlSet001\\\\Services\\\\VBoxService/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 266088}], "captures": {"SYSTEM\\ControlSet001\\Services\\VBoxService": [{"type": "file", "value": 266088}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/SYSTEM\\\\ControlSet001\\\\Services\\\\VBoxSF/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 266192}], "captures": {"SYSTEM\\ControlSet001\\Services\\VBoxSF": [{"type": "file", "value": 266192}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/SYSTEM\\\\ControlSet001\\\\Services\\\\VBoxVideo/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 266280}], "captures": {"SYSTEM\\ControlSet001\\Services\\VBoxVideo": [{"type": "file", "value": 266280}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/VBoxMouse\\.sys/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 266376}], "captures": {"System32\\drivers\\VBoxMouse.sys": [{"type": "file", "value": 266376}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/VBoxGuest\\.sys/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 266452}], "captures": {"System32\\drivers\\VBoxGuest.sys": [{"type": "file", "value": 266452}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/VBoxSF\\.sys/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 266528}], "captures": {"System32\\drivers\\VBoxSF.sys": [{"type": "file", "value": 266528}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/VBoxVideo\\.sys/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 266596}], "captures": {"System32\\drivers\\VBoxVideo.sys": [{"type": "file", "value": 266596}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/vboxdisp\\.dll/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 266672}], "captures": {"System32\\vboxdisp.dll": [{"type": "file", "value": 266672}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/vboxhook\\.dll/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 266724}], "captures": {"System32\\vboxhook.dll": [{"type": "file", "value": 266724}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/vboxmrxnp\\.dll/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 266776}], "captures": {"System32\\vboxmrxnp.dll": [{"type": "file", "value": 266776}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/vboxogl\\.dll/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 266832}], "captures": {"System32\\vboxogl.dll": [{"type": "file", "value": 266832}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/vboxoglarrayspu\\.dll/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 266884}], "captures": {"System32\\vboxoglarrayspu.dll": [{"type": "file", "value": 266884}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/vboxoglcrutil\\.dll/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 266956}], "captures": {"System32\\vboxoglcrutil.dll": [{"type": "file", "value": 266956}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/vboxoglerrorspu\\.dll/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 267020}], "captures": {"System32\\vboxoglerrorspu.dll": [{"type": "file", "value": 267020}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/vboxoglfeedbackspu\\.dll/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 267096}], "captures": {"System32\\vboxoglfeedbackspu.dll": [{"type": "file", "value": 267096}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/vboxoglpackspu\\.dll/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 267172}], "captures": {"System32\\vboxoglpackspu.dll": [{"type": "file", "value": 267172}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/vboxoglpassthroughspu\\.dll/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 267240}], "captures": {"System32\\vboxoglpassthroughspu.dll": [{"type": "file", "value": 267240}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/vboxservice\\.exe/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 268104}, {"type": "file", "value": 267324}], "captures": {"System32\\vboxservice.exe": [{"type": "file", "value": 267324}], "vboxservice.exe": [{"type": "file", "value": 268104}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/vboxtray\\.exe/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 267384}, {"type": "file", "value": 268144}], "captures": {"System32\\vboxtray.exe": [{"type": "file", "value": 267384}], "vboxtray.exe": [{"type": "file", "value": 268144}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/VBoxControl\\.exe/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 267436}], "captures": {"System32\\VBoxControl.exe": [{"type": "file", "value": 267436}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/oracle\\\\virtualbox guest additions\\\\/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 267544}], "captures": {"oracle\\virtualbox guest additions\\": [{"type": "file", "value": 267544}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/\\\\\\\\.\\\\VBoxMiniRdrDN/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 267676}], "captures": {"\\\\.\\VBoxMiniRdrDN": [{"type": "file", "value": 267676}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/\\\\\\\\.\\\\VBoxGuest/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 267720}], "captures": {"\\\\.\\VBoxGuest": [{"type": "file", "value": 267720}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/\\\\\\\\.\\\\pipe\\\\VBoxMiniRdDN/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 267756}], "captures": {"\\\\.\\pipe\\VBoxMiniRdDN": [{"type": "file", "value": 267756}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/\\\\\\\\.\\\\VBoxTrayIPC/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 267808}], "captures": {"\\\\.\\VBoxTrayIPC": [{"type": "file", "value": 267808}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/\\\\\\\\.\\\\pipe\\\\VBoxTrayIPC/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 267848}], "captures": {"\\\\.\\pipe\\VBoxTrayIPC": [{"type": "file", "value": 267848}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/VBoxTrayToolWndClass/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 249536}, {"type": "file", "value": 267948}], "captures": {"Checking VBoxTrayToolWndClass / VBoxTrayToolWnd ": [{"type": "file", "value": 249536}], "VBoxTrayToolWndClass": [{"type": "file", "value": 267948}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/VBoxTrayToolWnd/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 249536}, {"type": "file", "value": 267948}, {"type": "file", "value": 268000}], "captures": {"Checking VBoxTrayToolWndClass / VBoxTrayToolWnd ": [{"type": "file", "value": 249536}], "VBoxTrayToolWndClass": [{"type": "file", "value": 267948}], "VBoxTrayToolWnd": [{"type": "file", "value": 268000}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/vboxservice\\.exe/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 268104}, {"type": "file", "value": 267324}], "captures": {"System32\\vboxservice.exe": [{"type": "file", "value": 267324}], "vboxservice.exe": [{"type": "file", "value": 268104}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/vboxtray.exe/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 267384}, {"type": "file", "value": 268144}], "captures": {"System32\\vboxtray.exe": [{"type": "file", "value": 267384}], "vboxtray.exe": [{"type": "file", "value": 268144}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/vboxvideo/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 266280}, {"type": "file", "value": 266596}, {"type": "file", "value": 268424}, {"type": "file", "value": 268448}], "captures": {"SYSTEM\\ControlSet001\\Services\\VBoxVideo": [{"type": "file", "value": 266280}], "System32\\drivers\\VBoxVideo.sys": [{"type": "file", "value": 266596}], "vboxvideo": [{"type": "file", "value": 268424}], "VBoxVideoW8": [{"type": "file", "value": 268448}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/VBoxVideoW8/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 268448}], "captures": {"VBoxVideoW8": [{"type": "file", "value": 268448}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/VBoxWddm/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 264928}], "captures": {"VBoxWddm": [{"type": "file", "value": 264928}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/PCI\\\\VEN_80EE&DEV_CAFE/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 268752}], "captures": {"PCI\\VEN_80EE&DEV_CAFE": [{"type": "file", "value": 268752}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/82801FB/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 268816}], "captures": {"82801FB": [{"type": "file", "value": 268816}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/82441FX/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 268836}], "captures": {"82441FX": [{"type": "file", "value": 268836}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/82371SB/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 268856}], "captures": {"82371SB": [{"type": "file", "value": 268856}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/OpenHCD/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 268876}], "captures": {"OpenHCD": [{"type": "file", "value": 268876}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/ACPIBus_BUS_0/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 268956}], "captures": {"ACPIBus_BUS_0": [{"type": "file", "value": 268956}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/PCI_BUS_0/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 268992}], "captures": {"PCI_BUS_0": [{"type": "file", "value": 268992}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/PNP_BUS_0/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 269016}], "captures": {"PNP_BUS_0": [{"type": "file", "value": 269016}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/Oracle Corporation/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 269132}], "captures": {"Oracle Corporation": [{"type": "file", "value": 269132}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/VBoxWdd/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 264928}], "captures": {"VBoxWddm": [{"type": "file", "value": 264928}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/VBoxS/i", "description": "VirtualBox Shared Folders"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 266192}, {"type": "file", "value": 266528}, {"type": "file", "value": 268104}, {"type": "file", "value": 266088}, {"type": "file", "value": 128375}, {"type": "file", "value": 264952}, {"type": "file", "value": 267324}], "captures": {"szVBoxSources": [{"type": "file", "value": 128375}], "VBoxSF": [{"type": "file", "value": 264952}], "SYSTEM\\ControlSet001\\Services\\VBoxService": [{"type": "file", "value": 266088}], "SYSTEM\\ControlSet001\\Services\\VBoxSF": [{"type": "file", "value": 266192}], "System32\\drivers\\VBoxSF.sys": [{"type": "file", "value": 266528}], "System32\\vboxservice.exe": [{"type": "file", "value": 267324}], "vboxservice.exe": [{"type": "file", "value": 268104}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/VBoxMouse/i", "description": "VirtualBox Guest Mouse"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 264968}, {"type": "file", "value": 265992}, {"type": "file", "value": 266376}], "captures": {"VBoxMouse": [{"type": "file", "value": 264968}], "SYSTEM\\ControlSet001\\Services\\VBoxMouse": [{"type": "file", "value": 265992}], "System32\\drivers\\VBoxMouse.sys": [{"type": "file", "value": 266376}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/VBoxGuest/i", "description": "VirtualBox Guest Driver"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 264992}, {"type": "file", "value": 266452}, {"type": "file", "value": 265896}, {"type": "file", "value": 267720}], "captures": {"VBoxGuest": [{"type": "file", "value": 264992}], "SYSTEM\\ControlSet001\\Services\\VBoxGuest": [{"type": "file", "value": 265896}], "System32\\drivers\\VBoxGuest.sys": [{"type": "file", "value": 266452}], "\\\\.\\VBoxGuest": [{"type": "file", "value": 267720}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/VBoxVBoxVBox/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 262112}], "captures": {"VBoxVBoxVBox": [{"type": "file", "value": 262112}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/innotek GmbH/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 262488}], "captures": {"innotek GmbH": [{"type": "file", "value": 262488}]}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/drivers\\\\vboxdrv/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "reference anti-VM strings targeting Parallels": {"meta": {"name": "reference anti-VM strings targeting Parallels", "namespace": "anti-analysis/anti-vm/vm-detection", "authors": ["michael.hunhoff@mandiant.com"], "scope": "file", "attack": [{"parts": ["Defense Evasion", "Virtualization/Sandbox Evasion", "System Checks"], "tactic": "Defense Evasion", "technique": "Virtualization/Sandbox Evasion", "subtechnique": "System Checks", "id": "T1497.001"}], "mbc": [{"parts": ["Anti-Behavioral Analysis", "Virtual Machine Detection"], "objective": "Anti-Behavioral Analysis", "behavior": "Virtual Machine Detection", "method": "", "id": "B0009"}], "references": ["https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiVM/Parallels.cpp"], "examples": ["al-khaser_x86.exe_"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: reference anti-VM strings targeting Parallels\n    namespace: anti-analysis/anti-vm/vm-detection\n    authors:\n      - michael.hunhoff@mandiant.com\n    scope: file\n    att&ck:\n      - Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001]\n    mbc:\n      - Anti-Behavioral Analysis::Virtual Machine Detection [B0009]\n    references:\n      - https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiVM/Parallels.cpp\n    examples:\n      - al-khaser_x86.exe_\n  features:\n    - or:\n      - string: /Parallels/i\n      - string: /prl_cc.exe/i\n      - string: /prl_tools.exe/i\n      - string: /prl hyperv/i\n", "matches": [[{"type": "no address"}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "regex", "regex": "/Parallels/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 264328}], "captures": {"Checking Parallels processes: %s": [{"type": "file", "value": 264328}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/prl_cc.exe/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 264260}], "captures": {"prl_cc.exe": [{"type": "file", "value": 264260}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/prl_tools.exe/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 264288}], "captures": {"prl_tools.exe": [{"type": "file", "value": 264288}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/prl hyperv/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 262080}], "captures": {"prl hyperv  ": [{"type": "file", "value": 262080}]}}], "locations": [], "captures": {}}]]}, "contains PDB path": {"meta": {"name": "contains PDB path", "namespace": "executable/pe/pdb", "authors": ["moritz.raabe@mandiant.com"], "scope": "file", "attack": [], "mbc": [], "references": [], "examples": ["464EF2CA59782CE697BC329713698CCC"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: contains PDB path\n    namespace: executable/pe/pdb\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: file\n    examples:\n      - 464EF2CA59782CE697BC329713698CCC  # level32.exe\n  features:\n    - string: /:\\\\.*\\.pdb/\n", "matches": [[{"type": "no address"}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/:\\\\.*\\.pdb/"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 291092}], "captures": {"C:\\Users\\spring\\Desktop\\al-khaser-master\\Debug\\al-khaser.pdb": [{"type": "file", "value": 291092}]}}]]}, "reference anti-VM strings targeting Qemu": {"meta": {"name": "reference anti-VM strings targeting Qemu", "namespace": "anti-analysis/anti-vm/vm-detection", "authors": ["michael.hunhoff@mandiant.com"], "scope": "file", "attack": [{"parts": ["Defense Evasion", "Virtualization/Sandbox Evasion", "System Checks"], "tactic": "Defense Evasion", "technique": "Virtualization/Sandbox Evasion", "subtechnique": "System Checks", "id": "T1497.001"}], "mbc": [{"parts": ["Anti-Behavioral Analysis", "Virtual Machine Detection"], "objective": "Anti-Behavioral Analysis", "behavior": "Virtual Machine Detection", "method": "", "id": "B0009"}], "references": ["https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiVM/Qemu.cpp"], "examples": ["al-khaser_x86.exe_"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: reference anti-VM strings targeting Qemu\n    namespace: anti-analysis/anti-vm/vm-detection\n    authors:\n      - michael.hunhoff@mandiant.com\n    scope: file\n    att&ck:\n      - Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001]\n    mbc:\n      - Anti-Behavioral Analysis::Virtual Machine Detection [B0009]\n    references:\n      - https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiVM/Qemu.cpp\n    examples:\n      - al-khaser_x86.exe_\n  features:\n    - or:\n      - string: /Qemu/i\n      - string: /qemu-ga.exe/i\n      - string: /BOCHS/i\n      - string: /^BXPC/i\n", "matches": [[{"type": "no address"}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "regex", "regex": "/Qemu/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 264896}, {"type": "file", "value": 261920}, {"type": "file", "value": 264800}, {"type": "file", "value": 262520}, {"type": "file", "value": 250920}, {"type": "file", "value": 264828}, {"type": "file", "value": 264904}], "captures": {"qemu": [{"type": "file", "value": 264896}, {"type": "file", "value": 261920}], "QEMU": [{"type": "file", "value": 264904}, {"type": "file", "value": 262520}], "QEMU Detection": [{"type": "file", "value": 250920}], "qemu-ga.exe": [{"type": "file", "value": 264800}], "Checking qemu processes %s ": [{"type": "file", "value": 264828}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/qemu-ga.exe/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 264800}], "captures": {"qemu-ga.exe": [{"type": "file", "value": 264800}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/BOCHS/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 264912}], "captures": {"BOCHS": [{"type": "file", "value": 264912}]}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/^BXPC/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 264920}], "captures": {"BXPC": [{"type": "file", "value": 264920}]}}], "locations": [], "captures": {}}]]}}}
